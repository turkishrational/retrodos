<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>IDA - C:\pcdos_7_1\MSDOS621.idb (MSDOS621.SYS)</title>
</head>
<body bgcolor="white">
<span style="white-space: pre; font-family: Fixedsys; color: blue; background: white">

<span style="color:gray">DOSDATA:0000 </span>;
<span style="color:gray">DOSDATA:0000 </span>; +-------------------------------------------------------------------------+
<span style="color:gray">DOSDATA:0000 </span>; |   This file has been generated by The Interactive Disassembler (IDA)    |
<span style="color:gray">DOSDATA:0000 </span>; |           Copyright (c) 2013 Hex-Rays, &lt;support@hex-rays.com&gt;           |
<span style="color:gray">DOSDATA:0000 </span>; |                      Licensed to: Freeware version                      |
<span style="color:gray">DOSDATA:0000 </span>; +-------------------------------------------------------------------------+
<span style="color:gray">DOSDATA:0000 </span>;
<span style="color:gray">DOSDATA:0000 </span>; Input MD5   : 75959BC417C19135B982F7959EE9C92A
<span style="color:gray">DOSDATA:0000
DOSDATA:0000
DOSDATA:0000                 .</span>686p
<span style="color:gray">DOSDATA:0000                 </span>.mmx
<span style="color:gray">DOSDATA:0000                 </span>.model flat
<span style="color:gray">DOSDATA:0000
DOSDATA:0000 ; ===========================================================================
DOSDATA:0000
DOSDATA:0000 ; Segment type: Pure data
DOSDATA:0000 </span>DOSDATA         segment para private &#039;DATA&#039; use16
<span style="color:gray">DOSDATA:0000                 </span>assume cs:DOSDATA
<span style="color:gray">DOSDATA:0000 </span><span style="color:navy">byte_0          db </span><span style="color:#008040">4 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:olive">; ...
</span><span style="color:gray">DOSDATA:0004 </span>DataVersion     <span style="color:navy">dw </span><span style="color:#008040">1                    </span><span style="color:olive">; ...
</span><span style="color:gray">DOSDATA:0006 </span>WinoldPatch1    <span style="color:navy">db </span><span style="color:#008040">8 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:000E </span>MYNUM           <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0010 </span>FCBLRU          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0012 </span>OpenLRU         <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0014 </span>OEM_HANDLER     <span style="color:navy">dd </span><span style="color:#008040">0FFFFFFFFh           </span><span style="color:olive">; ...
</span><span style="color:gray">DOSDATA:0018 </span>LeaveAddr       <span style="color:navy">dw offset </span>LeaveDOS      <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:001A </span>RetryCount      <span style="color:navy">dw </span><span style="color:#008040">3                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:001C </span>RetryLoop       <span style="color:navy">dw </span><span style="color:#008040">1                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:001E </span>LastBuffer      <span style="color:navy">dd </span><span style="color:#008040">0FFFFFFFFh           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0022 </span>CONTPOS         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0024 </span>arena_head      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0026 </span>DPBHEAD         <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:002A </span>SFT_ADDR        <span style="color:navy">dd </span>SFTABL               <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:002E </span>BCLOCK          <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0032 </span>BCON            <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0036 </span>MAXSEC          <span style="color:navy">dw </span><span style="color:#008040">128                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0038 </span>BUFFHEAD        <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:003C </span>CDSADDR         <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0040 </span>SFTFCB          <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0044 </span>KEEPCOUNT       <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0046 </span>NUMIO           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0047 </span>CDSCOUNT        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0048 </span>NULDEV          <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:004C                 </span><span style="color:navy">dw </span><span style="color:#008040">8004h
</span><span style="color:gray">DOSDATA:004E                 </span><span style="color:navy">dw offset </span>SNULDEV
<span style="color:gray">DOSDATA:0050 </span><span style="color:navy">off_50          dw offset </span>INULDEV       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0052 </span><span style="color:navy">asc_52          db &#039;NUL     &#039;           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:005A </span>SPLICES         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:005B </span>Special_Entries <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:005D </span>UU_IFS_DOS_CALL <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0061 </span>ChkCopyProt     <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0063 </span>A20OFF_PSP      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0065 </span>BUFFERS_PARM1   <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0067 </span>BUFFERS_PARM2   <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0069 </span>BOOTDRIVE       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:006A </span>DDMOVE          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:006B </span>EXT_MEM_SIZE    <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:006D </span>BufferQueue     <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0071 </span>DirtyBufferCount <span style="color:navy">dw </span><span style="color:#008040">0                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0073 </span>SC_CACHE_PTR    <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0077 </span>SC_CACHE_COUNT  <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0079 </span>BuffInHMA       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:007A </span>LoMemBuff       <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:007E </span>UU_BUF_EMS_FIRST_PAGE <span style="color:navy">db </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0081 </span>CL0FATENTRY     <span style="color:navy">dw </span><span style="color:#008040">0FFFFh               </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0083 </span>IoStatFail      <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0084 </span>ALLOCMSAVE      <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0085 </span>A20OFF_COUNT    <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0086 </span>DOS_FLAG        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0087 </span>UNPACK_OFFSET   <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0089 </span>UMBFLAG         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:008A </span>SAVE_AX         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:008C </span>UMB_HEAD        <span style="color:navy">dw </span><span style="color:#008040">0FFFFh               </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:008E </span>START_ARENA     <span style="color:navy">dw </span><span style="color:#008040">1                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0090 </span>JShare          <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0094 </span>MFT_enter       <span style="color:navy">dd </span>OKCall               <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0098 </span>MFTClose        <span style="color:navy">dd </span>OKCall               <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:009C </span>MFTclU          <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00A0 </span>MFTCloseP       <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00A4 </span>MFTCloN         <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00A8 </span>set_block       <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00AC </span>clr_block       <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00B0 </span>chk_block       <span style="color:navy">dd </span>OKCall               <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00B4 </span>MFT_get         <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00B8 </span>ShSave          <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00BC </span>ShChk           <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00C0 </span>ShCol           <span style="color:navy">dd </span>OKCall               <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00C4 </span>ShCloseFile     <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00C8 </span>ShSU            <span style="color:navy">dd </span>BadCall              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00CC </span>SFTABL          <span style="color:navy">dd </span><span style="color:#008040">0FFFFFFFFh           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:00D0                 </span><span style="color:navy">dw </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:00D2 </span>SFT0_SFTable    <span style="color:navy">db </span><span style="color:#008040">295 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:01F9 </span>CARPOS          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:01FA </span>STARTPOS        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:01FB </span>INBUF           <span style="color:navy">db </span><span style="color:#008040">128 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:027B </span>CONBUF          <span style="color:navy">db </span><span style="color:#008040">131 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:02FE </span>PFLAG           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:02FF </span>VERFLG          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0300 </span>CHARCO          <span style="color:navy">db </span><span style="color:#008040">3                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0301 </span>chSwitch        <span style="color:navy">db &#039;</span><span style="color:green">/&#039;
</span><span style="color:gray">DOSDATA:0302 </span>AllocMethod     <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0303 </span>fShare          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0304 </span>DIFFNAM         <span style="color:navy">db </span><span style="color:#008040">1                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0305 </span>MYNAME          <span style="color:navy">db </span><span style="color:#008040">16 </span><span style="color:navy">dup(</span><span style="color:#008040">32</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0315 </span>CritPatch       <span style="color:navy">dw offset </span>redir_patch   <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0317                 </span><span style="color:navy">dw offset </span>redir_patch
<span style="color:gray">DOSDATA:0319                 </span><span style="color:navy">dw offset </span>redir_patch
<span style="color:gray">DOSDATA:031B                 </span><span style="color:navy">dw offset </span>redir_patch
<span style="color:gray">DOSDATA:031D                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:031F                 </span><span style="color:navy">db </span><span style="color:#008040">90h
</span><span style="color:gray">DOSDATA:0320 </span>ERRORMODE       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0321 </span>INDOS           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0322 </span>WPERR           <span style="color:navy">db </span><span style="color:#008040">0FFh                 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0323 </span>EXTERR_LOCUS    <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0324 </span>EXTERR          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0326 </span>EXTERR_ACT_CLASS <span style="color:navy">dw </span><span style="color:#008040">0                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0328 </span>EXTERRPT        <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:032C </span>DMAADD          <span style="color:navy">dd </span><span style="color:#008040">80h                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0330 </span>CurrentPDB      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0332 </span>ConC_Spsave     <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0334 </span>exit_code       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0336 </span>CURDRV          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0337 </span>CNTCFLAG        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0338 </span>CPSWFLAG        <span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0339 </span>CPSWSAVE        <span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:033A </span>USER_IN_AX      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:033C </span>PROC_ID         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:033E </span>USER_ID         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0340 </span>FirstArena      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0342 </span>BestArena       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0344 </span>LastArena       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0346 </span>ENDMEM          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0348 </span>LASTENT         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:034A </span>FAILERR         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:034B </span>ALLOWED         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:034C </span>NoSetDir        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:034D </span>DidCTRLC        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:034E </span>SpaceFlag       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:034F                 </span><span style="color:navy">db </span><span style="color:#008040">90h
</span><span style="color:gray">DOSDATA:0350 </span>DAY             <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0351 </span>MONTH           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0352 </span>YEAR            <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0354 </span>DAYCNT          <span style="color:navy">dw </span><span style="color:#008040">0FFFFh               </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0356 </span>WEEKDAY         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0357 </span>CONSWAP         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0358 </span>IDLEINT         <span style="color:navy">db </span><span style="color:#008040">1                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0359 </span>fAborting       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:035A </span>DEVCALL         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:035B </span>DEVCALL_REQUNIT <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:035C </span>DEVCALL_REQFUNC <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:035D </span>DEVCALL_REQSTAT <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:035F                 </span><span style="color:navy">db </span><span style="color:#008040">8 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:0367 </span>CALLUNIT        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0368 </span>CALLBR          <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:036C </span>CALLBPB         <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0370 </span>CALLVIDRW       <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0374 </span>CALLNEWSC       <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0378 </span>CALLDEVAD       <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:037C </span>IOCALL          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:037D </span>IOCALL_REQUNIT  <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:037E </span>IOCALL_REQFUNC  <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:037F </span>IOCALL_REQSTAT  <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0381                 </span><span style="color:navy">db </span><span style="color:#008040">8 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:0389 </span>IOMED           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:038A </span>IOXAD           <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:038E </span>IOSCNT          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0390 </span>IOSSEC          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:olive">; ...
</span><span style="color:gray">DOSDATA:0392 </span>DSKSTCALL       <span style="color:navy">db </span><span style="color:#008040">14                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0393                 </span><span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0394 </span>DSKSTCOM        <span style="color:navy">db </span><span style="color:#008040">5                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0395 </span>DSKSTST         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0397                 </span><span style="color:navy">db </span><span style="color:#008040">8 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:039F </span>DSKCHRET        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03A0 </span>DEVIOBUF_PTR    <span style="color:navy">dw offset </span>DEVIOBUF      <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03A2 </span>DOSSEG_INIT     <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03A4 </span>DSKSTCNT        <span style="color:navy">dw </span><span style="color:#008040">1                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03A6                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:03A8 </span>CreatePDB       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03A9 </span>Lock_Buffer     <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03AD                 </span><span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:03B1                 </span><span style="color:navy">db </span><span style="color:#008040">90h
</span><span style="color:gray">DOSDATA:03B2 </span>USERNUM         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03B4 </span>USERNUM_hb      <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03B5 </span>OEMNUM          <span style="color:navy">db </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:03B6 </span>TIMEBUF         <span style="color:navy">dw </span><span style="color:#008040">3 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03BC </span>DEVIOBUF        <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:03BE </span>OPENBUF         <span style="color:navy">db </span><span style="color:#008040">128 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:043E </span>RENBUF          <span style="color:navy">db </span><span style="color:#008040">128 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:04BE </span>SEARCHBUF       <span style="color:navy">db </span><span style="color:#008040">53 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:04F3 </span>DUMMYCDS        <span style="color:navy">db </span><span style="color:#008040">88 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:054B </span>NAME1           <span style="color:navy">db </span><span style="color:#008040">12 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0557 </span>NAME2           <span style="color:navy">db </span><span style="color:#008040">13 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0564 </span>DESTSTART       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0566                 </span><span style="color:navy">db </span><span style="color:#008040">5 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:056B </span>ATTRIB          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:056C </span>EXTFCB          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:056D </span>SATTRIB         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:056E </span>OPEN_ACCESS     <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:056F </span>FOUNDDEL        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0570 </span>FOUND_DEV       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0571 </span>FSPLICE         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0572 </span>FSHARING        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0573 </span>SECCLUSPOS      <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0574 </span>TRANS           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0575 </span>READOP          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0576 </span>THISDRV         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0577 </span>CLUSFAC         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0578 </span>CLUSSPLIT       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0579 </span>INSMODE         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:057A </span>CMETA           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:057B </span>VOLID           <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:057C </span>EXIT_TYPE       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:057D                 </span><span style="color:navy">db </span><span style="color:#008040">90h
</span><span style="color:gray">DOSDATA:057E </span>CREATING        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:057F </span>DELALL          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0580 </span>EXITHOLD        <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0584 </span>USER_SP         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0586 </span>USER_SS         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0588 </span>CONTSTK         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:058A </span>THISDPB         <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:058E </span>CLUSSAVE        <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0590 </span>CLUSSEC         <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0594 </span>PREREAD         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0596 </span>FATBYT          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0598 </span>FATBYTE         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:059A </span>DEVPT           <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:059E </span>THISSFT         <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05A2 </span>THISCDS         <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05A6 </span>THISFCB         <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05AA </span>SFN             <span style="color:navy">dw </span><span style="color:#008040">0FFFFh               </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05AC </span>JFN             <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05AE </span>PJFN            <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05B2 </span>WFP_START       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05B4 </span>REN_WFP         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05B6 </span>CURR_DIR_END    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05B8 </span>NEXTADD         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05BA </span>LASTPOS         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05BC </span>CLUSNUM         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05BE </span>DIRSEC          <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05C2 </span>DIRSTART        <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05C4 </span>SECPOS          <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05C8 </span>VALSEC          <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05CC </span>BYTSECPOS       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05CE </span>BYTPOS          <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05D2 </span>BYTCNT1         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05D4 </span>BYTCNT2         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05D6 </span>SECCNT          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05D8 </span>ENTFREE         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05DA </span>ENTLAST         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05DC </span>NXTCLUSNUM      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05DE </span>GROWCNT         <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05E2 </span>CURBUF          <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05E6 </span>CONSFT          <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05EA </span>SAVEBX          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05EC </span>SAVEDS          <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05EE </span>RESTORE_TMP     <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05F0 </span>NSS             <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05F2 </span>NSP             <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05F4 </span>EXTOPEN_FLAG    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05F6 </span>EXTOPEN_ON      <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05F7 </span>EXTOPEN_IO_MODE <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05F9 </span>SAVE_DI         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05FB </span>SAVE_ES         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05FD </span>SAVE_DX         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:05FF </span>SAVE_CX         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0601 </span>SAVE_BX         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0603 </span>SAVE_SI         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0605 </span>SAVE_DS         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0607 </span>HIGH_SECTOR     <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0609 </span>OffsetMagicPatch <span style="color:navy">dw offset </span>MagicPatch   <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:060B </span>DISK_FULL       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:060C </span>TEMP_VAR        <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:060E </span>TEMP_VAR2       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0610 </span>DrvErr          <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0611 </span>DOS34_FLAG      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0613 </span>NO_FILTER_PATH  <span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0617 </span>NO_FILTER_DPATH <span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:061B </span>AbsRdWr_SS      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:061D </span>AbsRdWr_SP      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:061F                 </span><span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0620 </span>RENAMEDMA       <span style="color:navy">db </span><span style="color:#008040">180h </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)          </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:07A0 </span>AUXSTACK        <span style="color:navy">db </span><span style="color:#008040">384 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0920 </span>DSKSTACK        <span style="color:navy">db </span><span style="color:#008040">384 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)           </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AA0 </span>PRINTER_FLAG    <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AA1 </span>VOLCHNG_FLAG    <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AA2 </span>VIRTUAL_OPEN    <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AA3 </span>FSeek_drive     <span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0AA4 </span>FSeek_firclus   <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0AA6 </span>FSeek_logclus   <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0AA8 </span>FSeek_logsave   <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0AAA </span>TEMP_DOSLOC     <span style="color:navy">dw </span><span style="color:#008040">0FFFFh               </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AAC </span>SWAP_END        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AAD </span>UCASE_TAB       <span style="color:navy">dw </span><span style="color:#008040">128                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AAF </span>UCASE_TAB_2     <span style="color:navy">db </span><span style="color:#008040">128</span><span style="color:navy">,</span><span style="color:#008040">154</span><span style="color:navy">, </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">65</span><span style="color:navy">,</span><span style="color:#008040">142</span><span style="color:navy">, </span><span style="color:#008040">65</span><span style="color:navy">,</span><span style="color:#008040">143</span><span style="color:navy">,</span><span style="color:#008040">128 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db  </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">,</span><span style="color:#008040">142</span><span style="color:navy">,</span><span style="color:#008040">143
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">144</span><span style="color:navy">,</span><span style="color:#008040">146</span><span style="color:navy">,</span><span style="color:#008040">146</span><span style="color:navy">, </span><span style="color:#008040">79</span><span style="color:navy">,</span><span style="color:#008040">153</span><span style="color:navy">, </span><span style="color:#008040">79</span><span style="color:navy">, </span><span style="color:#008040">85</span><span style="color:navy">, </span><span style="color:#008040">85
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db  </span><span style="color:#008040">89</span><span style="color:navy">,</span><span style="color:#008040">153</span><span style="color:navy">,</span><span style="color:#008040">154</span><span style="color:navy">,</span><span style="color:#008040">155</span><span style="color:navy">,</span><span style="color:#008040">156</span><span style="color:navy">,</span><span style="color:#008040">157</span><span style="color:navy">,</span><span style="color:#008040">158</span><span style="color:navy">,</span><span style="color:#008040">159
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db  </span><span style="color:#008040">65</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">, </span><span style="color:#008040">79</span><span style="color:navy">, </span><span style="color:#008040">85</span><span style="color:navy">,</span><span style="color:#008040">165</span><span style="color:navy">,</span><span style="color:#008040">165</span><span style="color:navy">,</span><span style="color:#008040">166</span><span style="color:navy">,</span><span style="color:#008040">167
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">168</span><span style="color:navy">,</span><span style="color:#008040">169</span><span style="color:navy">,</span><span style="color:#008040">170</span><span style="color:navy">,</span><span style="color:#008040">171</span><span style="color:navy">,</span><span style="color:#008040">172</span><span style="color:navy">,</span><span style="color:#008040">173</span><span style="color:navy">,</span><span style="color:#008040">174</span><span style="color:navy">,</span><span style="color:#008040">175
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">176</span><span style="color:navy">,</span><span style="color:#008040">177</span><span style="color:navy">,</span><span style="color:#008040">178</span><span style="color:navy">,</span><span style="color:#008040">179</span><span style="color:navy">,</span><span style="color:#008040">180</span><span style="color:navy">,</span><span style="color:#008040">181</span><span style="color:navy">,</span><span style="color:#008040">182</span><span style="color:navy">,</span><span style="color:#008040">183
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">184</span><span style="color:navy">,</span><span style="color:#008040">185</span><span style="color:navy">,</span><span style="color:#008040">186</span><span style="color:navy">,</span><span style="color:#008040">187</span><span style="color:navy">,</span><span style="color:#008040">188</span><span style="color:navy">,</span><span style="color:#008040">189</span><span style="color:navy">,</span><span style="color:#008040">190</span><span style="color:navy">,</span><span style="color:#008040">191
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">192</span><span style="color:navy">,</span><span style="color:#008040">193</span><span style="color:navy">,</span><span style="color:#008040">194</span><span style="color:navy">,</span><span style="color:#008040">195</span><span style="color:navy">,</span><span style="color:#008040">196</span><span style="color:navy">,</span><span style="color:#008040">197</span><span style="color:navy">,</span><span style="color:#008040">198</span><span style="color:navy">,</span><span style="color:#008040">199
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">200</span><span style="color:navy">,</span><span style="color:#008040">201</span><span style="color:navy">,</span><span style="color:#008040">202</span><span style="color:navy">,</span><span style="color:#008040">203</span><span style="color:navy">,</span><span style="color:#008040">204</span><span style="color:navy">,</span><span style="color:#008040">205</span><span style="color:navy">,</span><span style="color:#008040">206</span><span style="color:navy">,</span><span style="color:#008040">207
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">208</span><span style="color:navy">,</span><span style="color:#008040">209</span><span style="color:navy">,</span><span style="color:#008040">210</span><span style="color:navy">,</span><span style="color:#008040">211</span><span style="color:navy">,</span><span style="color:#008040">212</span><span style="color:navy">,</span><span style="color:#008040">213</span><span style="color:navy">,</span><span style="color:#008040">214</span><span style="color:navy">,</span><span style="color:#008040">215
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">216</span><span style="color:navy">,</span><span style="color:#008040">217</span><span style="color:navy">,</span><span style="color:#008040">218</span><span style="color:navy">,</span><span style="color:#008040">219</span><span style="color:navy">,</span><span style="color:#008040">220</span><span style="color:navy">,</span><span style="color:#008040">221</span><span style="color:navy">,</span><span style="color:#008040">222</span><span style="color:navy">,</span><span style="color:#008040">223
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">224</span><span style="color:navy">,</span><span style="color:#008040">225</span><span style="color:navy">,</span><span style="color:#008040">226</span><span style="color:navy">,</span><span style="color:#008040">227</span><span style="color:navy">,</span><span style="color:#008040">228</span><span style="color:navy">,</span><span style="color:#008040">229</span><span style="color:navy">,</span><span style="color:#008040">230</span><span style="color:navy">,</span><span style="color:#008040">231
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">232</span><span style="color:navy">,</span><span style="color:#008040">233</span><span style="color:navy">,</span><span style="color:#008040">234</span><span style="color:navy">,</span><span style="color:#008040">235</span><span style="color:navy">,</span><span style="color:#008040">236</span><span style="color:navy">,</span><span style="color:#008040">237</span><span style="color:navy">,</span><span style="color:#008040">238</span><span style="color:navy">,</span><span style="color:#008040">239
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">240</span><span style="color:navy">,</span><span style="color:#008040">241</span><span style="color:navy">,</span><span style="color:#008040">242</span><span style="color:navy">,</span><span style="color:#008040">243</span><span style="color:navy">,</span><span style="color:#008040">244</span><span style="color:navy">,</span><span style="color:#008040">245</span><span style="color:navy">,</span><span style="color:#008040">246</span><span style="color:navy">,</span><span style="color:#008040">247
</span><span style="color:gray">DOSDATA:0AAF                 </span><span style="color:navy">db </span><span style="color:#008040">248</span><span style="color:navy">,</span><span style="color:#008040">249</span><span style="color:navy">,</span><span style="color:#008040">250</span><span style="color:navy">,</span><span style="color:#008040">251</span><span style="color:navy">,</span><span style="color:#008040">252</span><span style="color:navy">,</span><span style="color:#008040">253</span><span style="color:navy">,</span><span style="color:#008040">254</span><span style="color:navy">,</span><span style="color:#008040">255
</span><span style="color:gray">DOSDATA:0B2F </span>FILE_UCASE_TAB  <span style="color:navy">dw </span><span style="color:#008040">128                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0B31 </span>FILE_UCASE_TAB_2 <span style="color:navy">db </span><span style="color:#008040">128</span><span style="color:navy">,</span><span style="color:#008040">154</span><span style="color:navy">, </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">65</span><span style="color:navy">,</span><span style="color:#008040">142</span><span style="color:navy">, </span><span style="color:#008040">65</span><span style="color:navy">,</span><span style="color:#008040">143</span><span style="color:navy">,</span><span style="color:#008040">128 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db  </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">69</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">,</span><span style="color:#008040">142</span><span style="color:navy">,</span><span style="color:#008040">143
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">144</span><span style="color:navy">,</span><span style="color:#008040">146</span><span style="color:navy">,</span><span style="color:#008040">146</span><span style="color:navy">, </span><span style="color:#008040">79</span><span style="color:navy">,</span><span style="color:#008040">153</span><span style="color:navy">, </span><span style="color:#008040">79</span><span style="color:navy">, </span><span style="color:#008040">85</span><span style="color:navy">, </span><span style="color:#008040">85
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db  </span><span style="color:#008040">89</span><span style="color:navy">,</span><span style="color:#008040">153</span><span style="color:navy">,</span><span style="color:#008040">154</span><span style="color:navy">,</span><span style="color:#008040">155</span><span style="color:navy">,</span><span style="color:#008040">156</span><span style="color:navy">,</span><span style="color:#008040">157</span><span style="color:navy">,</span><span style="color:#008040">158</span><span style="color:navy">,</span><span style="color:#008040">159
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db  </span><span style="color:#008040">65</span><span style="color:navy">, </span><span style="color:#008040">73</span><span style="color:navy">, </span><span style="color:#008040">79</span><span style="color:navy">, </span><span style="color:#008040">85</span><span style="color:navy">,</span><span style="color:#008040">165</span><span style="color:navy">,</span><span style="color:#008040">165</span><span style="color:navy">,</span><span style="color:#008040">166</span><span style="color:navy">,</span><span style="color:#008040">167
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">168</span><span style="color:navy">,</span><span style="color:#008040">169</span><span style="color:navy">,</span><span style="color:#008040">170</span><span style="color:navy">,</span><span style="color:#008040">171</span><span style="color:navy">,</span><span style="color:#008040">172</span><span style="color:navy">,</span><span style="color:#008040">173</span><span style="color:navy">,</span><span style="color:#008040">174</span><span style="color:navy">,</span><span style="color:#008040">175
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">176</span><span style="color:navy">,</span><span style="color:#008040">177</span><span style="color:navy">,</span><span style="color:#008040">178</span><span style="color:navy">,</span><span style="color:#008040">179</span><span style="color:navy">,</span><span style="color:#008040">180</span><span style="color:navy">,</span><span style="color:#008040">181</span><span style="color:navy">,</span><span style="color:#008040">182</span><span style="color:navy">,</span><span style="color:#008040">183
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">184</span><span style="color:navy">,</span><span style="color:#008040">185</span><span style="color:navy">,</span><span style="color:#008040">186</span><span style="color:navy">,</span><span style="color:#008040">187</span><span style="color:navy">,</span><span style="color:#008040">188</span><span style="color:navy">,</span><span style="color:#008040">189</span><span style="color:navy">,</span><span style="color:#008040">190</span><span style="color:navy">,</span><span style="color:#008040">191
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">192</span><span style="color:navy">,</span><span style="color:#008040">193</span><span style="color:navy">,</span><span style="color:#008040">194</span><span style="color:navy">,</span><span style="color:#008040">195</span><span style="color:navy">,</span><span style="color:#008040">196</span><span style="color:navy">,</span><span style="color:#008040">197</span><span style="color:navy">,</span><span style="color:#008040">198</span><span style="color:navy">,</span><span style="color:#008040">199
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">200</span><span style="color:navy">,</span><span style="color:#008040">201</span><span style="color:navy">,</span><span style="color:#008040">202</span><span style="color:navy">,</span><span style="color:#008040">203</span><span style="color:navy">,</span><span style="color:#008040">204</span><span style="color:navy">,</span><span style="color:#008040">205</span><span style="color:navy">,</span><span style="color:#008040">206</span><span style="color:navy">,</span><span style="color:#008040">207
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">208</span><span style="color:navy">,</span><span style="color:#008040">209</span><span style="color:navy">,</span><span style="color:#008040">210</span><span style="color:navy">,</span><span style="color:#008040">211</span><span style="color:navy">,</span><span style="color:#008040">212</span><span style="color:navy">,</span><span style="color:#008040">213</span><span style="color:navy">,</span><span style="color:#008040">214</span><span style="color:navy">,</span><span style="color:#008040">215
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">216</span><span style="color:navy">,</span><span style="color:#008040">217</span><span style="color:navy">,</span><span style="color:#008040">218</span><span style="color:navy">,</span><span style="color:#008040">219</span><span style="color:navy">,</span><span style="color:#008040">220</span><span style="color:navy">,</span><span style="color:#008040">221</span><span style="color:navy">,</span><span style="color:#008040">222</span><span style="color:navy">,</span><span style="color:#008040">223
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">224</span><span style="color:navy">,</span><span style="color:#008040">225</span><span style="color:navy">,</span><span style="color:#008040">226</span><span style="color:navy">,</span><span style="color:#008040">227</span><span style="color:navy">,</span><span style="color:#008040">228</span><span style="color:navy">,</span><span style="color:#008040">229</span><span style="color:navy">,</span><span style="color:#008040">230</span><span style="color:navy">,</span><span style="color:#008040">231
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">232</span><span style="color:navy">,</span><span style="color:#008040">233</span><span style="color:navy">,</span><span style="color:#008040">234</span><span style="color:navy">,</span><span style="color:#008040">235</span><span style="color:navy">,</span><span style="color:#008040">236</span><span style="color:navy">,</span><span style="color:#008040">237</span><span style="color:navy">,</span><span style="color:#008040">238</span><span style="color:navy">,</span><span style="color:#008040">239
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">240</span><span style="color:navy">,</span><span style="color:#008040">241</span><span style="color:navy">,</span><span style="color:#008040">242</span><span style="color:navy">,</span><span style="color:#008040">243</span><span style="color:navy">,</span><span style="color:#008040">244</span><span style="color:navy">,</span><span style="color:#008040">245</span><span style="color:navy">,</span><span style="color:#008040">246</span><span style="color:navy">,</span><span style="color:#008040">247
</span><span style="color:gray">DOSDATA:0B31                 </span><span style="color:navy">db </span><span style="color:#008040">248</span><span style="color:navy">,</span><span style="color:#008040">249</span><span style="color:navy">,</span><span style="color:#008040">250</span><span style="color:navy">,</span><span style="color:#008040">251</span><span style="color:navy">,</span><span style="color:#008040">252</span><span style="color:navy">,</span><span style="color:#008040">253</span><span style="color:navy">,</span><span style="color:#008040">254</span><span style="color:navy">,</span><span style="color:#008040">255
</span><span style="color:gray">DOSDATA:0BB1 </span>FILE_CHAR_TAB   <span style="color:navy">dw </span><span style="color:#008040">22                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0BB3                 </span><span style="color:navy">db </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">255</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">32</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">14
</span><span style="color:gray">DOSDATA:0BBB                 </span><span style="color:navy">db &#039;.&quot;/\[]:|&lt;&gt;+=;,&#039;
</span><span style="color:gray">DOSDATA:0BC9                 </span><span style="color:navy">db </span><span style="color:#008040">24 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:0BE1 </span>COLLATE_TAB     <span style="color:navy">dw </span><span style="color:#008040">256                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0BE3                 </span><span style="color:navy">db  </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">7
</span><span style="color:gray">DOSDATA:0BE3                 </span><span style="color:navy">db  </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">9</span><span style="color:navy">,</span><span style="color:#008040">10</span><span style="color:navy">,</span><span style="color:#008040">11</span><span style="color:navy">,</span><span style="color:#008040">12</span><span style="color:navy">,</span><span style="color:#008040">13</span><span style="color:navy">,</span><span style="color:#008040">14</span><span style="color:navy">,</span><span style="color:#008040">15
</span><span style="color:gray">DOSDATA:0BE3                 </span><span style="color:navy">db </span><span style="color:#008040">16</span><span style="color:navy">,</span><span style="color:#008040">17</span><span style="color:navy">,</span><span style="color:#008040">18</span><span style="color:navy">,</span><span style="color:#008040">19</span><span style="color:navy">,</span><span style="color:#008040">20</span><span style="color:navy">,</span><span style="color:#008040">21</span><span style="color:navy">,</span><span style="color:#008040">22</span><span style="color:navy">,</span><span style="color:#008040">23
</span><span style="color:gray">DOSDATA:0BE3                 </span><span style="color:navy">db </span><span style="color:#008040">24</span><span style="color:navy">,</span><span style="color:#008040">25</span><span style="color:navy">,</span><span style="color:#008040">26</span><span style="color:navy">,</span><span style="color:#008040">27</span><span style="color:navy">,</span><span style="color:#008040">28</span><span style="color:navy">,</span><span style="color:#008040">29</span><span style="color:navy">,</span><span style="color:#008040">30</span><span style="color:navy">,</span><span style="color:#008040">31
</span><span style="color:gray">DOSDATA:0C03                 </span><span style="color:navy">db &#039; !&quot;#$%&amp;&#039;,27h,&#039;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]&#039;
</span><span style="color:gray">DOSDATA:0C03                 </span><span style="color:navy">db &#039;^_`ABCDEFGHIJKLMNOPQRSTUVWXYZ{|}~&#039;
</span><span style="color:gray">DOSDATA:0C62                 </span><span style="color:navy">db </span><span style="color:#008040">127
</span><span style="color:gray">DOSDATA:0C63                 </span><span style="color:navy">db &#039;CUEAAAACEEEIIIAAEAAOOOUUYOU$$$$$AIOUNN&#039;
</span><span style="color:gray">DOSDATA:0C89                 </span><span style="color:navy">db </span><span style="color:#008040">166</span><span style="color:navy">, </span><span style="color:#008040">167
</span><span style="color:gray">DOSDATA:0C8B                 </span><span style="color:navy">db &#039;</span><span style="color:green">?&#039;
</span><span style="color:gray">DOSDATA:0C8C                 </span><span style="color:navy">db </span><span style="color:#008040">169</span><span style="color:navy">, </span><span style="color:#008040">170</span><span style="color:navy">, </span><span style="color:#008040">171</span><span style="color:navy">, </span><span style="color:#008040">172
</span><span style="color:gray">DOSDATA:0C90                 </span><span style="color:navy">db &#039;</span><span style="color:green">!&#039;</span><span style="color:navy">, &#039;&quot;&#039;, &#039;&quot;&#039;
</span><span style="color:gray">DOSDATA:0C93                 </span><span style="color:navy">db </span><span style="color:#008040">176</span><span style="color:navy">, </span><span style="color:#008040">177</span><span style="color:navy">, </span><span style="color:#008040">178</span><span style="color:navy">, </span><span style="color:#008040">179</span><span style="color:navy">, </span><span style="color:#008040">180</span><span style="color:navy">, </span><span style="color:#008040">181</span><span style="color:navy">, </span><span style="color:#008040">182</span><span style="color:navy">, </span><span style="color:#008040">183</span><span style="color:navy">, </span><span style="color:#008040">184</span><span style="color:navy">, </span><span style="color:#008040">185</span><span style="color:navy">, </span><span style="color:#008040">186
</span><span style="color:gray">DOSDATA:0C93                 </span><span style="color:navy">db </span><span style="color:#008040">187</span><span style="color:navy">, </span><span style="color:#008040">188</span><span style="color:navy">, </span><span style="color:#008040">189</span><span style="color:navy">, </span><span style="color:#008040">190</span><span style="color:navy">, </span><span style="color:#008040">191</span><span style="color:navy">, </span><span style="color:#008040">192</span><span style="color:navy">, </span><span style="color:#008040">193</span><span style="color:navy">, </span><span style="color:#008040">194</span><span style="color:navy">, </span><span style="color:#008040">195</span><span style="color:navy">, </span><span style="color:#008040">196</span><span style="color:navy">, </span><span style="color:#008040">197
</span><span style="color:gray">DOSDATA:0C93                 </span><span style="color:navy">db </span><span style="color:#008040">198</span><span style="color:navy">, </span><span style="color:#008040">199</span><span style="color:navy">, </span><span style="color:#008040">200</span><span style="color:navy">, </span><span style="color:#008040">201</span><span style="color:navy">, </span><span style="color:#008040">202</span><span style="color:navy">, </span><span style="color:#008040">203</span><span style="color:navy">, </span><span style="color:#008040">204</span><span style="color:navy">, </span><span style="color:#008040">205</span><span style="color:navy">, </span><span style="color:#008040">206</span><span style="color:navy">, </span><span style="color:#008040">207</span><span style="color:navy">, </span><span style="color:#008040">208
</span><span style="color:gray">DOSDATA:0C93                 </span><span style="color:navy">db </span><span style="color:#008040">209</span><span style="color:navy">, </span><span style="color:#008040">210</span><span style="color:navy">, </span><span style="color:#008040">211</span><span style="color:navy">, </span><span style="color:#008040">212</span><span style="color:navy">, </span><span style="color:#008040">213</span><span style="color:navy">, </span><span style="color:#008040">214</span><span style="color:navy">, </span><span style="color:#008040">215</span><span style="color:navy">, </span><span style="color:#008040">216</span><span style="color:navy">, </span><span style="color:#008040">217</span><span style="color:navy">, </span><span style="color:#008040">218</span><span style="color:navy">, </span><span style="color:#008040">219
</span><span style="color:gray">DOSDATA:0C93                 </span><span style="color:navy">db </span><span style="color:#008040">220</span><span style="color:navy">, </span><span style="color:#008040">221</span><span style="color:navy">, </span><span style="color:#008040">222</span><span style="color:navy">, </span><span style="color:#008040">223</span><span style="color:navy">, </span><span style="color:#008040">224
</span><span style="color:gray">DOSDATA:0CC4                 </span><span style="color:navy">db &#039;</span><span style="color:green">S&#039;
</span><span style="color:gray">DOSDATA:0CC5                 </span><span style="color:navy">db </span><span style="color:#008040">226</span><span style="color:navy">, </span><span style="color:#008040">227</span><span style="color:navy">, </span><span style="color:#008040">228</span><span style="color:navy">, </span><span style="color:#008040">229</span><span style="color:navy">, </span><span style="color:#008040">230</span><span style="color:navy">, </span><span style="color:#008040">231</span><span style="color:navy">, </span><span style="color:#008040">232</span><span style="color:navy">, </span><span style="color:#008040">233</span><span style="color:navy">, </span><span style="color:#008040">234</span><span style="color:navy">, </span><span style="color:#008040">235</span><span style="color:navy">, </span><span style="color:#008040">236
</span><span style="color:gray">DOSDATA:0CC5                 </span><span style="color:navy">db </span><span style="color:#008040">237</span><span style="color:navy">, </span><span style="color:#008040">238</span><span style="color:navy">, </span><span style="color:#008040">239</span><span style="color:navy">, </span><span style="color:#008040">240</span><span style="color:navy">, </span><span style="color:#008040">241</span><span style="color:navy">, </span><span style="color:#008040">242</span><span style="color:navy">, </span><span style="color:#008040">243</span><span style="color:navy">, </span><span style="color:#008040">244</span><span style="color:navy">, </span><span style="color:#008040">245</span><span style="color:navy">, </span><span style="color:#008040">246</span><span style="color:navy">, </span><span style="color:#008040">247
</span><span style="color:gray">DOSDATA:0CC5                 </span><span style="color:navy">db </span><span style="color:#008040">248</span><span style="color:navy">, </span><span style="color:#008040">249</span><span style="color:navy">, </span><span style="color:#008040">250</span><span style="color:navy">, </span><span style="color:#008040">251</span><span style="color:navy">, </span><span style="color:#008040">252</span><span style="color:navy">, </span><span style="color:#008040">253</span><span style="color:navy">, </span><span style="color:#008040">254</span><span style="color:navy">, </span><span style="color:#008040">255
</span><span style="color:gray">DOSDATA:0CE3 </span>DBCS_TAB        <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0CE5 </span>DBCS_TAB_2      <span style="color:navy">db </span><span style="color:#008040">16 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:black">DOSDATA:0CF5
DOSDATA:0CF5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSDATA:0CF5
DOSDATA:0CF5
DOSDATA:0CF5 </span>MAP_CASE        proc far                <span style="color:#8080ff">; ...
</span><span style="color:black">DOSDATA:0CF5                 </span><span style="color:navy">cmp     al, </span><span style="color:green">80h
</span><span style="color:black">DOSDATA:0CF7                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Map1
</span><span style="color:black">DOSDATA:0CF9                 </span><span style="color:navy">retf
</span><span style="color:black">DOSDATA:0CFA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSDATA:0CFA
DOSDATA:0CFA </span><span style="color:gray">Map1</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSDATA:0CFA                 </span><span style="color:navy">sub     al, </span><span style="color:green">80h
</span><span style="color:black">DOSDATA:0CFC                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSDATA:0CFD                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSDATA:0CFE                 </span><span style="color:navy">mov     bx, offset </span>UCASE_TAB_2
<span style="color:black">DOSDATA:0D01                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSDATA:0D02                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSDATA:0D03                 </span><span style="color:navy">xlat
</span><span style="color:black">DOSDATA:0D04                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSDATA:0D05                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSDATA:0D06                 </span><span style="color:navy">retf
</span><span style="color:black">DOSDATA:0D06 </span>MAP_CASE        endp
<span style="color:black">DOSDATA:0D06
DOSDATA:0D06 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSDATA:0D07 </span>InterChar       <span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D08 </span>InterCon        <span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D09 </span>SaveCurFlg      <span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D0A </span>TEMPSEG         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D0C </span>redir_patch     <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D0D </span>Mark1           <span style="color:navy">db </span><span style="color:#008040">5 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:0D12 </span>MSVERSION       <span style="color:navy">db </span><span style="color:#008040">6
</span><span style="color:gray">DOSDATA:0D13                 </span><span style="color:navy">db </span><span style="color:#008040">20
</span><span style="color:gray">DOSDATA:0D14 </span>YRTAB           <span style="color:navy">db </span><span style="color:#008040">200</span><span style="color:navy">, </span><span style="color:#008040">166</span><span style="color:navy">, </span><span style="color:#008040">200</span><span style="color:navy">, </span><span style="color:#008040">165</span><span style="color:navy">, </span><span style="color:#008040">200</span><span style="color:navy">, </span><span style="color:#008040">165</span><span style="color:navy">, </span><span style="color:#008040">200</span><span style="color:navy">, </span><span style="color:#008040">165 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D1C </span>MONTAB          <span style="color:navy">db </span><span style="color:#008040">31                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D1D </span>february        <span style="color:navy">db </span><span style="color:#008040">28                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D1E                 </span><span style="color:navy">db </span><span style="color:#008040">31</span><span style="color:navy">, </span><span style="color:#008040">30</span><span style="color:navy">, </span><span style="color:#008040">31</span><span style="color:navy">, </span><span style="color:#008040">30</span><span style="color:navy">, </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">31</span><span style="color:navy">), </span><span style="color:#008040">30</span><span style="color:navy">, </span><span style="color:#008040">31</span><span style="color:navy">, </span><span style="color:#008040">30</span><span style="color:navy">, </span><span style="color:#008040">31
</span><span style="color:gray">DOSDATA:0D28 </span>SysInitTable    <span style="color:navy">dd </span>DPBHEAD              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D2C                 </span><span style="color:navy">dd </span>COUNTRY_CDPG
<span style="color:gray">DOSDATA:0D30 </span>FastOpenTable   <span style="color:navy">dw </span><span style="color:#008040">2                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D32 </span>FastTable_2     <span style="color:navy">dw offset </span>FastRet       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D34                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D36                 </span><span style="color:navy">dw offset </span>FastRet
<span style="color:gray">DOSDATA:0D38                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D3A </span>FastOpenFlg     <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D3B </span>FastOpen_Ext_Info <span style="color:navy">db </span><span style="color:#008040">11 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)          </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D46 </span>Dir_Info_Buff   <span style="color:navy">db </span><span style="color:#008040">32 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D66 </span>Next_Element_Start <span style="color:navy">dw </span><span style="color:#008040">0                 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D68 </span>Del_ExtCluster  <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D6A </span>USER_SP_2F      <span style="color:navy">dw offset </span>FAKE_STACK_2F <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D6C </span>FAKE_STACK_2F   <span style="color:navy">dw </span><span style="color:#008040">14 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D88 </span>Hash_Temp       <span style="color:navy">dw </span><span style="color:#008040">4 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:0D90 </span>SCAN_FLAG       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D91 </span>DATE_FLAG       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0D93 </span>FETCHI_TAG      <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D95 </span>MSG_EXTERROR    <span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D99                 </span><span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0D9D                 </span><span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0DA1                 </span><span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0DA5                 </span><span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0DA9 </span>SEQ_SECTOR      <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(</span><span style="color:#008040">0FFFFh</span><span style="color:navy">)        </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DAD </span>SC_SECTOR_SIZE  <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DAF </span>SC_DRIVE        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DB0 </span>CurSC_DRIVE     <span style="color:navy">db </span><span style="color:#008040">0FFh                 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DB1 </span>CurSC_SECTOR    <span style="color:navy">dw </span><span style="color:#008040">2 </span><span style="color:navy">dup(     </span><span style="color:#008040">0</span><span style="color:navy">)        </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DB5 </span>SC_STATUS       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DB7 </span>SC_FLAG         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DB8 </span>AbsDskErr       <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DBA </span>NO_NAME_ID      <span style="color:navy">db &#039;NO NAME    &#039;        </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DC5 </span>LOOKSIZ         <span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:maroon">DOSDATA:0DC6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:0DC6
DOSDATA:0DC6 </span>SNULDEV<span style="color:navy">:                                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:0DC6                 </span><span style="color:navy">or      word ptr es:[bx+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">100h
</span><span style="color:maroon">DOSDATA:0DCC
DOSDATA:0DCC </span>INULDEV<span style="color:navy">:                                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:0DCC                 </span><span style="color:navy">retf
</span><span style="color:maroon">DOSDATA:0DCC </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSDATA:0DCD </span>WinoldPatch2    <span style="color:navy">db </span><span style="color:#008040">8 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DD5 </span>UmbSave2        <span style="color:navy">db </span><span style="color:#008040">5 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DDA </span>UmbSaveFlag     <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DDB </span>ERR_TABLE_21    <span style="color:navy">db </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">0FFh        </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">0Bh</span><span style="color:navy">, </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">0Ch</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">0Fh</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">10h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">11h</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">12h</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">50h</span><span style="color:navy">, </span><span style="color:#008040">0Ch</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">21h</span><span style="color:navy">, </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">54h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">56h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">52h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">32h</span><span style="color:navy">, </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">55h</span><span style="color:navy">, </span><span style="color:#008040">0Ch</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">57h</span><span style="color:navy">, </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">53h</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">24h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">26h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">27h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">5Ah</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0DDB                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0E5B </span>ERR_TABLE_24    <span style="color:navy">db </span><span style="color:#008040">13h</span><span style="color:navy">, </span><span style="color:#008040">0Bh</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">2       </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">14h</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">15h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">16h</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">17h</span><span style="color:navy">, </span><span style="color:#008040">0Bh</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">18h</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">19h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">1Ah</span><span style="color:navy">, </span><span style="color:#008040">0Bh</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">1Bh</span><span style="color:navy">, </span><span style="color:#008040">0Bh</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">1Ch</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">4
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">1Dh</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">1Eh</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">1Fh</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">21h</span><span style="color:navy">, </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">22h</span><span style="color:navy">, </span><span style="color:#008040">0Bh</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">32h</span><span style="color:navy">, </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">23h</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">24h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:0E5B                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:0EAB </span>ErrMap24        <span style="color:navy">db </span><span style="color:#008040">13h</span><span style="color:navy">, </span><span style="color:#008040">14h</span><span style="color:navy">, </span><span style="color:#008040">15h</span><span style="color:navy">, </span><span style="color:#008040">16h</span><span style="color:navy">, </span><span style="color:#008040">17h</span><span style="color:navy">, </span><span style="color:#008040">18h</span><span style="color:navy">, </span><span style="color:#008040">19h</span><span style="color:navy">, </span><span style="color:#008040">1Ah </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0EAB                 </span><span style="color:navy">db </span><span style="color:#008040">1Bh</span><span style="color:navy">, </span><span style="color:#008040">1Ch</span><span style="color:navy">, </span><span style="color:#008040">1Dh</span><span style="color:navy">, </span><span style="color:#008040">1Eh</span><span style="color:navy">, </span><span style="color:#008040">1Fh</span><span style="color:navy">, </span><span style="color:#008040">1Fh</span><span style="color:navy">, </span><span style="color:#008040">1Fh</span><span style="color:navy">, </span><span style="color:#008040">22h
</span><span style="color:gray">DOSDATA:0EBB </span>FIRST_BUFF_ADDR <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0EBD </span>SPECIAL_VERSION <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0EBF </span>FAKE_COUNT      <span style="color:navy">db </span><span style="color:#008040">255 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:0FBE </span>OLD_FIRSTCLUS   <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FC0 </span>exec_init_SP    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FC2 </span>exec_init_SS    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FC4 </span>exec_init_IP    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FC6 </span>exec_init_CS    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FC8 </span>exec_signature  <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FCA </span>exec_len_mod_512 <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0FCC </span>exec_pages      <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FCE </span>exec_rle_count  <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FD0 </span>exec_par_dir    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FD2 </span>exec_min_BSS    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FD4 </span>exec_max_BSS    <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FD6 </span>exec_SS         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FD8 </span>exec_SP         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FDA </span>exec_chksum     <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0FDC </span>exec_IP         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FDE </span>exec_CS         <span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0FE0 </span>exec_rle_table  <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FE2 </span>Win386_Info     <span style="color:navy">db </span><span style="color:#008040">3                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FE3                 </span><span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0FE4                 </span><span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0FE8 </span>Win386_Info_6   <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FEC                 </span><span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0FF0 </span>SIS_Instance_Data_Ptr <span style="color:navy">dw offset </span>Instance_Table
<span style="color:gray">DOSDATA:0FF2 </span>SIS_Instance_Data_Ptr_2 <span style="color:navy">dw </span><span style="color:#008040">0            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FF4 </span>Instance_Table  <span style="color:navy">dw offset </span>CONTPOS       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FF6 </span>Instance_Table_2 <span style="color:navy">dw </span><span style="color:#008040">0                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:0FF8                 </span><span style="color:navy">dw </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:0FFA                 </span><span style="color:navy">dw offset </span>BCON
<span style="color:gray">DOSDATA:0FFC                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:0FFE                 </span><span style="color:navy">dw </span><span style="color:#008040">4
</span><span style="color:gray">DOSDATA:1000                 </span><span style="color:navy">dw offset </span>CARPOS
<span style="color:gray">DOSDATA:1002                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1004                 </span><span style="color:navy">dw </span><span style="color:#008040">106h
</span><span style="color:gray">DOSDATA:1006                 </span><span style="color:navy">dw offset </span>CHARCO
<span style="color:gray">DOSDATA:1008                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:100A                 </span><span style="color:navy">dw </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:100C                 </span><span style="color:navy">dw offset </span>exec_init_SP
<span style="color:gray">DOSDATA:100E                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1010                 </span><span style="color:navy">dw </span><span style="color:#008040">34
</span><span style="color:gray">DOSDATA:1012                 </span><span style="color:navy">dw offset </span>UMBFLAG
<span style="color:gray">DOSDATA:1014                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1016                 </span><span style="color:navy">dw </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:1018                 </span><span style="color:navy">dw offset </span>UMB_HEAD
<span style="color:gray">DOSDATA:101A                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:101C                 </span><span style="color:navy">dw </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:101E                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1020                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1022 </span>Win386_DOSVars  <span style="color:navy">db </span><span style="color:#008040">5                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1023                 </span><span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1024                 </span><span style="color:navy">dw offset </span>SAVEDS
<span style="color:gray">DOSDATA:1026                 </span><span style="color:navy">dw offset </span>SAVEBX
<span style="color:gray">DOSDATA:1028                 </span><span style="color:navy">dw offset </span>INDOS
<span style="color:gray">DOSDATA:102A                 </span><span style="color:navy">dw offset </span>USER_ID
<span style="color:gray">DOSDATA:102C                 </span><span style="color:navy">dw offset </span>CritPatch
<span style="color:gray">DOSDATA:102E                 </span><span style="color:navy">dw offset </span>UMB_HEAD
<span style="color:gray">DOSDATA:1030 </span>IsWin386        <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1031 </span>VxDpath         <span style="color:navy">db &#039;c:\wina20.386&#039;,0    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:103F </span>DriverLoad      <span style="color:navy">db </span><span style="color:#008040">1                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1040 </span>BiosDataPtr     <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1044                 </span><span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">0F6h</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSDATA:104A                 </span><span style="color:navy">db </span><span style="color:#008040">75h</span><span style="color:navy">, </span><span style="color:#008040">0Ch
</span><span style="color:gray">DOSDATA:104C                 </span><span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">58h</span><span style="color:navy">, </span><span style="color:#008040">3
</span><span style="color:gray">DOSDATA:1051                 </span><span style="color:navy">db </span><span style="color:#008040">0CDh</span><span style="color:navy">, </span><span style="color:#008040">28h
</span><span style="color:gray">DOSDATA:1053                 </span><span style="color:navy">db </span><span style="color:#008040">80h</span><span style="color:navy">, </span><span style="color:#008040">3Eh</span><span style="color:navy">, </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1058                 </span><span style="color:navy">db </span><span style="color:#008040">75h</span><span style="color:navy">, </span><span style="color:#008040">37h
</span><span style="color:gray">DOSDATA:105A                 </span><span style="color:navy">db </span><span style="color:#008040">0BCh</span><span style="color:navy">, </span><span style="color:#008040">0A0h</span><span style="color:navy">, </span><span style="color:#008040">0Ah
</span><span style="color:gray">DOSDATA:105D </span>LocalSFT        <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1061                 </span><span style="color:navy">db </span><span style="color:#008040">90h
</span><span style="color:gray">DOSDATA:1062 </span>DOSINTTABLE     <span style="color:navy">dd </span>DIVOV                <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1066 </span>DOSINTTABLE_4   <span style="color:navy">dd </span>quit                 <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:106A </span>DOSINTTABLE_8   <span style="color:navy">dd </span>command              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:106E </span>DOSINTTABLE_12  <span style="color:navy">dd </span>ABSDRD               <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1072 </span>DOSINTTABLE_16  <span style="color:navy">dd </span>ABSDWRT              <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1076 </span>DOSINTTABLE_20  <span style="color:navy">dd </span>stay_resident        <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:107A </span>DOSINTTABLE_24  <span style="color:navy">dd </span>INT2F                <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:107E </span>DOSINTTABLE_28  <span style="color:navy">dd </span>call_entry           <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1082 </span>DOSINTTABLE_32  <span style="color:navy">dd </span>irett
<span style="color:gray">DOSDATA:1086 </span>SS_Save         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1088 </span>SP_Save         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:108A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:108A
DOSDATA:108A </span>ldivov<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:108A                 </span><span style="color:navy">jmp     short </span>divov_cont
<span style="color:maroon">DOSDATA:108C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:108C                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:108F
DOSDATA:108F </span>divov_cont<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:108F                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE
<span style="color:maroon">DOSDATA:1094 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:1094
DOSDATA:1094 </span>lquit<span style="color:navy">:                                  </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:1094                 </span><span style="color:navy">jmp     short </span>quit_cont
<span style="color:maroon">DOSDATA:1096 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:1096                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:1099
DOSDATA:1099 </span>quit_cont<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:1099                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE_4
<span style="color:maroon">DOSDATA:109E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:109E
DOSDATA:109E </span>lcommand<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:109E                 </span><span style="color:navy">jmp     short </span>command_cont
<span style="color:maroon">DOSDATA:10A0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10A0                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:10A3
DOSDATA:10A3 </span>command_cont<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:10A3                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE_8
<span style="color:maroon">DOSDATA:10A8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10A8
DOSDATA:10A8 </span>labsdrd<span style="color:navy">:                                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10A8                 </span><span style="color:navy">jmp     short </span>absdrd_cont
<span style="color:maroon">DOSDATA:10AA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10AA                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:10AD
DOSDATA:10AD </span>absdrd_cont<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:10AD                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE_12
<span style="color:maroon">DOSDATA:10B2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10B2
DOSDATA:10B2 </span>labsdwrt<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10B2                 </span><span style="color:navy">jmp     short </span>absdwrt_cont
<span style="color:maroon">DOSDATA:10B4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10B4                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:10B7
DOSDATA:10B7 </span>absdwrt_cont<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:10B7                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE_16
<span style="color:maroon">DOSDATA:10BC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10BC
DOSDATA:10BC </span>lstay_resident<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10BC                 </span><span style="color:navy">jmp     short </span>sr_cont
<span style="color:maroon">DOSDATA:10BE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10BE                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:10C1
DOSDATA:10C1 </span>sr_cont<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:10C1                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE_20
<span style="color:maroon">DOSDATA:10C6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10C6
DOSDATA:10C6 </span>lint2f<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10C6                 </span><span style="color:navy">jmp     short </span>int2f_cont
<span style="color:maroon">DOSDATA:10C8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10C8                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:10CB
DOSDATA:10CB </span>int2f_cont<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:10CB                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE_24
<span style="color:maroon">DOSDATA:10D0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10D0
DOSDATA:10D0 </span>lcall_entry<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10D0                 </span><span style="color:navy">jmp     short </span>callentry_cont
<span style="color:maroon">DOSDATA:10D2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10D2                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:10D5
DOSDATA:10D5 </span>callentry_cont<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:10D5                 </span><span style="color:navy">jmp     cs:</span>DOSINTTABLE_28
<span style="color:maroon">DOSDATA:10DA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10DA
DOSDATA:10DA </span>lirett<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10DA                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSDATA:10DA </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSDATA:10DB </span>DosRetAddr23    <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:10DF </span>DosRetAddr24    <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:10E3 </span>DosRetAddr28    <span style="color:navy">dd </span><span style="color:#008040">0
</span><span style="color:maroon">DOSDATA:10E7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10E7
DOSDATA:10E7 </span>LowInt23<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10E7                 </span><span style="color:navy">pop     word ptr cs:</span>DosRetAddr23
<span style="color:maroon">DOSDATA:10EC                 </span><span style="color:navy">pop     word ptr cs:</span>DosRetAddr23<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSDATA:10F1                 </span><span style="color:navy">int     </span><span style="color:green">23h             </span>; DOS - CONTROL &quot;C&quot; EXIT ADDRESS
<span style="color:maroon">DOSDATA:10F1                                         </span>; Return: return via RETF 2 with CF set
<span style="color:maroon">DOSDATA:10F1                                         </span>; DOS will abort program with errorlevel 0
<span style="color:maroon">DOSDATA:10F1                                         </span>; else
<span style="color:maroon">DOSDATA:10F1                                         </span>; interrupted DOS call continues
<span style="color:maroon">DOSDATA:10F3                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:10F6                 </span><span style="color:navy">jmp     cs:</span>DosRetAddr23
<span style="color:maroon">DOSDATA:10FB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:10FB
DOSDATA:10FB </span>LowInt24<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:10FB                 </span><span style="color:navy">pop     word ptr cs:</span>DosRetAddr24
<span style="color:maroon">DOSDATA:1100                 </span><span style="color:navy">pop     word ptr cs:</span>DosRetAddr24<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSDATA:1105                 </span><span style="color:navy">int     </span><span style="color:green">24h             </span>; DOS - FATAL ERROR HANDLER ADDRESS
<span style="color:maroon">DOSDATA:1105                                         </span>; Automatically called upon detection of unrecoverable I/O error.
<span style="color:maroon">DOSDATA:1107                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:110A                 </span><span style="color:navy">jmp     cs:</span>DosRetAddr24
<span style="color:maroon">DOSDATA:110F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:110F
DOSDATA:110F </span>LowInt28<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:110F                 </span><span style="color:navy">int     </span><span style="color:green">28h             </span>; DOS 2+ internal - KEYBOARD BUSY LOOP
<span style="color:maroon">DOSDATA:1111                 </span><span style="color:navy">call    </span>EnsureA20ON
<span style="color:maroon">DOSDATA:1114                 </span><span style="color:navy">retf
</span><span style="color:maroon">DOSDATA:1115 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:1115
DOSDATA:1115 </span>disa20_xfer<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:1115                 </span><span style="color:navy">call    </span>XMMDisableA20
<span style="color:maroon">DOSDATA:1118                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSDATA:1119                 </span><span style="color:navy">mov     cs:</span>INDOS<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSDATA:111F                 </span><span style="color:navy">mov     ss, ax
</span><span style="color:maroon">DOSDATA:1121                 </span><span style="color:navy">mov     sp, di
</span><span style="color:maroon">DOSDATA:1123                 </span><span style="color:navy">sti
</span><span style="color:maroon">DOSDATA:1124                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSDATA:1125                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSDATA:1126                 </span><span style="color:navy">mov     es, dx
</span><span style="color:maroon">DOSDATA:1128                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:maroon">DOSDATA:112A                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:maroon">DOSDATA:112C                 </span><span style="color:navy">retf
</span><span style="color:maroon">DOSDATA:112D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:112D
DOSDATA:112D </span>disa20_iret<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:112D                 </span><span style="color:navy">call    </span>XMMDisableA20
<span style="color:maroon">DOSDATA:1130                 </span><span style="color:navy">dec     ds:</span>INDOS
<span style="color:maroon">DOSDATA:1134                 </span><span style="color:navy">mov     ss, ds:</span>USER_SS
<span style="color:maroon">DOSDATA:1138                 </span><span style="color:navy">mov     sp, ds:</span>USER_SP
<span style="color:maroon">DOSDATA:113C                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:maroon">DOSDATA:113E                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">0</span><span style="color:navy">], al
</span><span style="color:maroon">DOSDATA:1141                 </span><span style="color:navy">mov     ax, ds:</span>NSP
<span style="color:maroon">DOSDATA:1144                 </span><span style="color:navy">mov     ds:</span>USER_SP<span style="color:navy">, ax
</span><span style="color:maroon">DOSDATA:1147                 </span><span style="color:navy">mov     ax, ds:</span>NSS
<span style="color:maroon">DOSDATA:114A                 </span><span style="color:navy">mov     ds:</span>USER_SS<span style="color:navy">, ax
</span><span style="color:maroon">DOSDATA:114D                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSDATA:114E                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSDATA:114F                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSDATA:1150                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSDATA:1151                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSDATA:1152                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSDATA:1153                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSDATA:1154                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSDATA:1155                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSDATA:1156                 </span><span style="color:navy">iret
</span><span style="color:black">DOSDATA:1157
DOSDATA:1157 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSDATA:1157
DOSDATA:1157
DOSDATA:1157 </span>XMMDisableA20   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSDATA:1157                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSDATA:1158                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSDATA:1159                 </span><span style="color:navy">mov     ah, </span><span style="color:green">6
</span><span style="color:black">DOSDATA:115B                 </span><span style="color:navy">call    cs:</span>XMMcontrol
<span style="color:black">DOSDATA:1160                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSDATA:1161                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSDATA:1162                 </span><span style="color:navy">retn
</span><span style="color:black">DOSDATA:1162 </span>XMMDisableA20   endp
<span style="color:black">DOSDATA:1162
DOSDATA:1162 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSDATA:1163 </span>XMMcontrol      <span style="color:navy">dd </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1167 </span>LowMemory       <span style="color:navy">dd </span><span style="color:#008040">80h                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:116B </span>HighMemory      <span style="color:navy">dd </span><span style="color:#008040">0FFFF0090h           </span><span style="color:#8080ff">; ...
</span><span style="color:black">DOSDATA:116F
DOSDATA:116F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSDATA:116F
DOSDATA:116F
DOSDATA:116F </span>EnsureA20ON     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSDATA:116F                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSDATA:1170                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSDATA:1171                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSDATA:1172                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSDATA:1173                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSDATA:1174                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSDATA:1175                 </span><span style="color:navy">lds     si, cs:</span>LowMemory
<span style="color:black">DOSDATA:117A                 </span><span style="color:navy">les     di, cs:</span>HighMemory
<span style="color:black">DOSDATA:117F                 </span><span style="color:navy">mov     cx, </span><span style="color:green">4
</span><span style="color:black">DOSDATA:1182                 </span><span style="color:navy">cld
</span><span style="color:black">DOSDATA:1183                 </span><span style="color:navy">repe cmpsw
</span><span style="color:black">DOSDATA:1185                 </span><span style="color:navy">jz      short </span><span style="color:gray">EA20_OFF
</span><span style="color:black">DOSDATA:1187
DOSDATA:1187 </span><span style="color:gray">EA20_RET</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSDATA:1187                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSDATA:1188                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSDATA:1189                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSDATA:118A                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSDATA:118B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSDATA:118C                 </span><span style="color:navy">popf
</span><span style="color:black">DOSDATA:118D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSDATA:118E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSDATA:118E
DOSDATA:118E </span><span style="color:gray">EA20_OFF</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSDATA:118E                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSDATA:118F                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSDATA:1190                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:black">DOSDATA:1192                 </span><span style="color:navy">mov     cs:</span>SS_Save<span style="color:navy">, ax
</span><span style="color:black">DOSDATA:1196                 </span><span style="color:navy">mov     cs:</span>SP_Save<span style="color:navy">, sp
</span><span style="color:black">DOSDATA:119B                 </span><span style="color:navy">mov     ax, cs
</span><span style="color:black">DOSDATA:119D                 </span><span style="color:navy">mov     ss, ax
</span><span style="color:black">DOSDATA:119F                 </span><span style="color:navy">mov     sp, offset </span>AUXSTACK
<span style="color:black">DOSDATA:11A2                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSDATA:11A4                 </span><span style="color:navy">call    cs:</span>XMMcontrol
<span style="color:black">DOSDATA:11A9                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSDATA:11AB                 </span><span style="color:navy">jz      short </span><span style="color:gray">XMMerror
</span><span style="color:black">DOSDATA:11AD                 </span><span style="color:navy">mov     ax, cs:</span>SS_Save
<span style="color:black">DOSDATA:11B1                 </span><span style="color:navy">mov     ss, ax
</span><span style="color:black">DOSDATA:11B3                 </span><span style="color:navy">mov     sp, cs:</span>SP_Save
<span style="color:black">DOSDATA:11B8                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSDATA:11B9                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSDATA:11BA                 </span><span style="color:navy">jmp     short </span><span style="color:gray">EA20_RET
</span><span style="color:black">DOSDATA:11BC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSDATA:11BC
DOSDATA:11BC </span><span style="color:gray">XMMerror</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSDATA:11BC                 </span><span style="color:navy">mov     ah, </span><span style="color:green">0Fh
</span><span style="color:black">DOSDATA:11BE                 </span><span style="color:navy">int     </span><span style="color:green">10h             </span>; - VIDEO - GET CURRENT VIDEO MODE
<span style="color:black">DOSDATA:11BE                                         </span>; Return: AH = number of columns on screen
<span style="color:black">DOSDATA:11BE                                         </span>; AL = current video mode
<span style="color:black">DOSDATA:11BE                                         </span>; BH = current active display page
<span style="color:black">DOSDATA:11C0                 </span><span style="color:navy">cmp     al, </span><span style="color:green">7
</span><span style="color:black">DOSDATA:11C2                 </span><span style="color:navy">jz      short </span><span style="color:gray">XMMcont
</span><span style="color:black">DOSDATA:11C4                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSDATA:11C6                 </span><span style="color:navy">mov     al, </span><span style="color:green">2
</span><span style="color:black">DOSDATA:11C8                 </span><span style="color:navy">int     </span><span style="color:green">10h             </span>; - VIDEO - SET VIDEO MODE
<span style="color:black">DOSDATA:11C8                                         </span>; AL = mode
<span style="color:black">DOSDATA:11CA
DOSDATA:11CA </span><span style="color:gray">XMMcont</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSDATA:11CA                 </span><span style="color:navy">mov     ah, </span><span style="color:green">5
</span><span style="color:black">DOSDATA:11CC                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSDATA:11CE                 </span><span style="color:navy">int     </span><span style="color:green">10h             </span>; - VIDEO - SELECT DISPLAY PAGE
<span style="color:black">DOSDATA:11CE                                         </span>; AL = display page, 0-7  for modes 0 &amp; 1, 0-3  for modes 2 &amp; 3
<span style="color:black">DOSDATA:11D0                 </span><span style="color:navy">mov     si, offset </span>XMMERRMSG <span style="color:gray">; &quot;\r\nA20 Hardware Error\r\n$&quot;
</span><span style="color:black">DOSDATA:11D3                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSDATA:11D4                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSDATA:11D5                 </span><span style="color:navy">cld
</span><span style="color:black">DOSDATA:11D6
DOSDATA:11D6 </span><span style="color:gray">XMMprnt</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSDATA:11D6                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSDATA:11D7                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">$&#039;
</span><span style="color:black">DOSDATA:11D9                 </span><span style="color:navy">jz      short </span><span style="color:gray">XMMStall
</span><span style="color:black">DOSDATA:11DB                 </span><span style="color:navy">mov     ah, </span><span style="color:green">0Eh
</span><span style="color:black">DOSDATA:11DD                 </span><span style="color:navy">mov     bx, </span><span style="color:green">7
</span><span style="color:black">DOSDATA:11E0                 </span><span style="color:navy">int     </span><span style="color:green">10h             </span>; - VIDEO - WRITE CHARACTER AND ADVANCE CURSOR (TTY WRITE)
<span style="color:black">DOSDATA:11E0                                         </span>; AL = character, BH = display page (alpha modes)
<span style="color:black">DOSDATA:11E0                                         </span>; BL = foreground color (graphics modes)
<span style="color:black">DOSDATA:11E2                 </span><span style="color:navy">jmp     short </span><span style="color:gray">XMMprnt
</span><span style="color:black">DOSDATA:11E4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSDATA:11E4
DOSDATA:11E4 </span><span style="color:gray">XMMStall</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSDATA:11E4                 </span><span style="color:navy">sti
</span><span style="color:black">DOSDATA:11E5                 </span><span style="color:navy">jmp     short </span><span style="color:gray">XMMStall
</span><span style="color:black">DOSDATA:11E5 </span>EnsureA20ON     endp
<span style="color:black">DOSDATA:11E5
DOSDATA:11E5 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSDATA:11E7 </span>OldInstanceJunk <span style="color:navy">dw </span><span style="color:#008040">70h                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:11E9                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:11EB                 </span><span style="color:navy">dw </span><span style="color:#008040">6
</span><span style="color:gray">DOSDATA:11ED </span>OldInstanceJunk_6 <span style="color:navy">dw </span><span style="color:#008040">0                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:11EF                 </span><span style="color:navy">dw offset </span>CONTPOS
<span style="color:gray">DOSDATA:11F1                 </span><span style="color:navy">dw </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:11F3                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:11F5                 </span><span style="color:navy">dw offset </span>BCON
<span style="color:gray">DOSDATA:11F7                 </span><span style="color:navy">dw </span><span style="color:#008040">4
</span><span style="color:gray">DOSDATA:11F9                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:11FB                 </span><span style="color:navy">dw offset </span>CARPOS
<span style="color:gray">DOSDATA:11FD                 </span><span style="color:navy">dw </span><span style="color:#008040">106h
</span><span style="color:gray">DOSDATA:11FF                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1201                 </span><span style="color:navy">dw offset </span>CHARCO
<span style="color:gray">DOSDATA:1203                 </span><span style="color:navy">dw </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:1205                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1207                 </span><span style="color:navy">dw offset </span>exec_init_SP
<span style="color:gray">DOSDATA:1209                 </span><span style="color:navy">dw </span><span style="color:#008040">34
</span><span style="color:gray">DOSDATA:120B                 </span><span style="color:navy">dw </span><span style="color:#008040">70h
</span><span style="color:gray">DOSDATA:120D                 </span><span style="color:navy">dw </span><span style="color:#008040">0Ch
</span><span style="color:gray">DOSDATA:120F                 </span><span style="color:navy">dw </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:1211 </span>DosHasHMA       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1212 </span>FixExePatch     <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1214 </span>RationalPatchPtr <span style="color:navy">dw </span><span style="color:#008040">0                   </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:1216 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:1216
DOSDATA:1216 </span>RatBugCode<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:1216                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSDATA:1217                 </span><span style="color:navy">mov     cx, </span>ds:10h
<span style="color:maroon">DOSDATA:121B
DOSDATA:121B </span>rbc_loop<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSDATA:121B                 </span><span style="color:navy">loop    </span>rbc_loop
<span style="color:maroon">DOSDATA:121D                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSDATA:121E                 </span><span style="color:navy">retf
</span><span style="color:maroon">DOSDATA:121E </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSDATA:121F </span>UmbSave1        <span style="color:navy">db </span><span style="color:#008040">11 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:122A </span>COUNTRY_CDPG    <span style="color:navy">db </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1232                 </span><span style="color:navy">db &#039;\COUNTRY.SYS&#039;,0
</span><span style="color:gray">DOSDATA:123F                 </span><span style="color:navy">db </span><span style="color:#008040">51 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)
</span><span style="color:gray">DOSDATA:1272                 </span><span style="color:navy">dw </span><span style="color:#008040">437
</span><span style="color:gray">DOSDATA:1274                 </span><span style="color:navy">dw </span><span style="color:#008040">6
</span><span style="color:gray">DOSDATA:1276 </span>COUNTRY_CDPG_76 <span style="color:navy">db </span><span style="color:#008040">2                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1277                 </span><span style="color:navy">dw offset </span>UCASE_TAB
<span style="color:gray">DOSDATA:1279                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:127B                 </span><span style="color:navy">db </span><span style="color:#008040">4
</span><span style="color:gray">DOSDATA:127C                 </span><span style="color:navy">dw offset </span>FILE_UCASE_TAB
<span style="color:gray">DOSDATA:127E                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1280                 </span><span style="color:navy">db </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:1281                 </span><span style="color:navy">dw offset </span>FILE_CHAR_TAB
<span style="color:gray">DOSDATA:1283                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:1285                 </span><span style="color:navy">db </span><span style="color:#008040">6
</span><span style="color:gray">DOSDATA:1286                 </span><span style="color:navy">dw offset </span>COLLATE_TAB
<span style="color:gray">DOSDATA:1288                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:128A                 </span><span style="color:navy">db </span><span style="color:#008040">7
</span><span style="color:gray">DOSDATA:128B                 </span><span style="color:navy">dw offset </span>DBCS_TAB
<span style="color:gray">DOSDATA:128D                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:128F                 </span><span style="color:navy">db </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:1290                 </span><span style="color:navy">dw </span><span style="color:#008040">38
</span><span style="color:gray">DOSDATA:1292                 </span><span style="color:navy">dw </span><span style="color:#008040">1
</span><span style="color:gray">DOSDATA:1294                 </span><span style="color:navy">dw </span><span style="color:#008040">437
</span><span style="color:gray">DOSDATA:1296 </span>COUNTRY_CDPG_108 <span style="color:navy">dw </span><span style="color:#008040">0                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:1298                 </span><span style="color:navy">db &#039;$&#039;,0,0,0,0
</span><span style="color:gray">DOSDATA:129D                 </span><span style="color:navy">db &#039;,&#039;,0
</span><span style="color:gray">DOSDATA:129F                 </span><span style="color:navy">db &#039;.&#039;,0
</span><span style="color:gray">DOSDATA:12A1                 </span><span style="color:navy">db &#039;-&#039;,0
</span><span style="color:gray">DOSDATA:12A3                 </span><span style="color:navy">db &#039;:&#039;,0
</span><span style="color:gray">DOSDATA:12A5                 </span><span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:12A6                 </span><span style="color:navy">db </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:12A7                 </span><span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:12A8                 </span><span style="color:navy">dw offset </span>MAP_CASE
<span style="color:gray">DOSDATA:12AA                 </span><span style="color:navy">dw </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:12AC                 </span><span style="color:navy">db &#039;,&#039;,0
</span><span style="color:gray">DOSDATA:12AE                 </span><span style="color:navy">dw </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0
</span><span style="color:gray">DOSDATA:12B8 </span>XMMERRMSG       <span style="color:navy">db </span><span style="color:green">0Dh</span><span style="color:navy">,</span><span style="color:green">0Ah              </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSDATA:12B8                 </span><span style="color:navy">db &#039;A20 Hardware Error&#039;,0Dh,0Ah,&#039;$&#039;
</span><span style="color:gray">DOSDATA:12CF </span>DOSP1_ID        <span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">0C5h</span><span style="color:navy">, </span><span style="color:#008040">36h
</span><span style="color:gray">DOSDATA:12D2 </span>DOSP1_THISSFT   <span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">0C5h</span><span style="color:navy">, </span><span style="color:#008040">74h</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">0E8h
</span><span style="color:gray">DOSDATA:12D8                 </span><span style="color:navy">db </span><span style="color:#008040">90h</span><span style="color:navy">, </span><span style="color:#008040">90h
</span><span style="color:gray">DOSDATA:12DA </span>DOSP12_ID       <span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">0C5h</span><span style="color:navy">, </span><span style="color:#008040">36h
</span><span style="color:gray">DOSDATA:12DD </span>DOSP12_THISSFT  <span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">0C5h</span><span style="color:navy">, </span><span style="color:#008040">74h</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">0E8h
</span><span style="color:gray">DOSDATA:12E3 </span>DOSP3_ID        <span style="color:navy">db </span><span style="color:#008040">51h</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">57h</span><span style="color:navy">, </span><span style="color:#008040">0BAh
</span><span style="color:gray">DOSDATA:12E7 </span>DOSP3_CONBUF    <span style="color:navy">db </span><span style="color:#008040">29h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">0E8h
</span><span style="color:gray">DOSDATA:12EA                 </span><span style="color:navy">db </span><span style="color:#008040">9Ah</span><span style="color:navy">, </span><span style="color:#008040">0E3h</span><span style="color:navy">, </span><span style="color:#008040">5Fh</span><span style="color:navy">, </span><span style="color:#008040">7
</span><span style="color:gray">DOSDATA:12EE </span>DOSP4_ID        <span style="color:navy">db </span><span style="color:#008040">59h
</span><span style="color:gray">DOSDATA:12EF </span>DOSP5_ID        <span style="color:navy">db </span><span style="color:#008040">51h
</span><span style="color:gray">DOSDATA:12F0                 </span><span style="color:navy">db </span><span style="color:#008040">0ACh</span><span style="color:navy">, </span><span style="color:#008040">3Ch</span><span style="color:navy">, </span><span style="color:#008040">1Ah</span><span style="color:navy">, </span><span style="color:#008040">74h</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:12F5                 </span><span style="color:navy">db </span><span style="color:#008040">0E8h
</span><span style="color:gray">DOSDATA:12F6 </span>DOSP7_ID        <span style="color:navy">db </span><span style="color:#008040">2Eh</span><span style="color:navy">, </span><span style="color:#008040">8Ch</span><span style="color:navy">, </span><span style="color:#008040">1Eh
</span><span style="color:gray">DOSDATA:12F9 </span>DOSP7_SAVEDS    <span style="color:navy">db </span><span style="color:#008040">7Eh</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:12FB                 </span><span style="color:navy">db </span><span style="color:#008040">2Eh</span><span style="color:navy">, </span><span style="color:#008040">89h</span><span style="color:navy">, </span><span style="color:#008040">1Eh
</span><span style="color:gray">DOSDATA:12FE </span>DOSP7_SAVEBX    <span style="color:navy">db </span><span style="color:#008040">7Ch</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSDATA:1300                 </span><span style="color:navy">db </span><span style="color:#008040">8Ch</span><span style="color:navy">, </span><span style="color:#008040">0CBh
</span><span style="color:gray">DOSDATA:1302                 </span><span style="color:navy">db </span><span style="color:#008040">8Eh</span><span style="color:navy">, </span><span style="color:#008040">0DBh
</span><span style="color:gray">DOSDATA:1304                 </span><span style="color:navy">db </span><span style="color:#008040">0FEh</span><span style="color:navy">, </span><span style="color:#008040">6
</span><span style="color:gray">DOSDATA:1306 </span>DOSP7_INDOS     <span style="color:navy">db </span><span style="color:#008040">0CFh</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:1308                 </span><span style="color:navy">db </span><span style="color:#008040">33h</span><span style="color:navy">, </span><span style="color:#008040">0C0h
</span><span style="color:gray">DOSDATA:130A </span>DOSP8_ID        <span style="color:navy">db </span><span style="color:#008040">50h
</span><span style="color:gray">DOSDATA:130B                 </span><span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">0A1h
</span><span style="color:gray">DOSDATA:130D </span>DOSP8_USER_ID   <span style="color:navy">db </span><span style="color:#008040">0EAh</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSDATA:130F                 </span><span style="color:navy">db </span><span style="color:#008040">26h</span><span style="color:navy">, </span><span style="color:#008040">3Bh</span><span style="color:navy">, </span><span style="color:#008040">45h
</span><span style="color:gray">DOSDATA:1312                 </span><span style="color:navy">db </span><span style="color:#008040">2Fh</span><span style="color:navy">, </span><span style="color:#008040">58h
</span><span style="color:gray">DOSDATA:1314 </span>DOSP10_ID       <span style="color:navy">db </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">1Fh
</span><span style="color:gray">DOSDATA:1316 </span>DOSP10_LOC      <span style="color:navy">db </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0DFh
</span><span style="color:gray">DOSDATA:1318                 </span><span style="color:navy">db </span><span style="color:#008040">33h</span><span style="color:navy">, </span><span style="color:#008040">0C0h</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0D0h</span><span style="color:navy">, </span><span style="color:#008040">0E8h
</span><span style="color:gray">DOSDATA:131D                 </span><span style="color:navy">db </span><span style="color:#008040">0DFh</span><span style="color:navy">, </span><span style="color:#008040">0Eh
</span><span style="color:gray">DOSDATA:131F                 </span><span style="color:navy">db </span><span style="color:#008040">1Eh</span><span style="color:navy">, </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">0C5h</span><span style="color:navy">, </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">0E8h</span><span style="color:navy">, </span><span style="color:#008040">0AFh</span><span style="color:navy">, </span><span style="color:#008040">0Eh
</span><span style="color:gray">DOSDATA:1328                 </span><span style="color:navy">db </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0D7h</span><span style="color:navy">, </span><span style="color:#008040">0B4h</span><span style="color:navy">, </span><span style="color:#008040">86h</span><span style="color:navy">, </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">3Eh
</span><span style="color:gray">DOSDATA:132F                 </span><span style="color:navy">db </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">3
</span><span style="color:gray">DOSDATA:1331                 </span><span style="color:navy">db </span><span style="color:#008040">0F7h</span><span style="color:navy">, </span><span style="color:#008040">0C7h</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">80h</span><span style="color:navy">, </span><span style="color:#008040">74h</span><span style="color:navy">, </span><span style="color:#008040">19h</span><span style="color:navy">, </span><span style="color:#008040">0E8h</span><span style="color:navy">, </span><span style="color:#008040">47h</span><span style="color:navy">, </span><span style="color:#008040">17h
</span><span style="color:gray">DOSDATA:133A                 </span><span style="color:navy">db </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0FAh</span><span style="color:navy">, </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">0C0h</span><span style="color:navy">, </span><span style="color:#008040">74h</span><span style="color:navy">, </span><span style="color:#008040">10h</span><span style="color:navy">, </span><span style="color:#008040">3Ch</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">74h</span><span style="color:navy">, </span><span style="color:#008040">3
</span><span style="color:gray">DOSDATA:1344                 </span><span style="color:navy">db </span><span style="color:#008040">1Fh</span><span style="color:navy">, </span><span style="color:#008040">0EBh</span><span style="color:navy">, </span><span style="color:#008040">0CFh
</span><span style="color:gray">DOSDATA:1347                 </span><span style="color:navy">db </span><span style="color:#008040">5Fh
</span><span style="color:gray">DOSDATA:1348                 </span><span style="color:navy">db </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">0C4h</span><span style="color:navy">, </span><span style="color:#008040">3Eh</span><span style="color:navy">, </span><span style="color:#008040">36h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">0E9h</span><span style="color:navy">, </span><span style="color:#008040">0A1h</span><span style="color:navy">, </span><span style="color:#008040">4
</span><span style="color:gray">DOSDATA:1350                 </span><span style="color:navy">db </span><span style="color:#008040">5Fh</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0FAh
</span><span style="color:gray">DOSDATA:1353 </span>DOSP13_ID       <span style="color:navy">db </span><span style="color:#008040">0ACh
</span><span style="color:gray">DOSDATA:1354                 </span><span style="color:navy">db </span><span style="color:#008040">3Ch</span><span style="color:navy">, </span><span style="color:#008040">24h
</span><span style="color:gray">DOSDATA:1356                 </span><span style="color:navy">db </span><span style="color:#008040">74h</span><span style="color:navy">, </span><span style="color:#008040">8
</span><span style="color:gray">DOSDATA:1358                 </span><span style="color:navy">db </span><span style="color:#008040">0B3h</span><span style="color:navy">, </span><span style="color:#008040">7
</span><span style="color:gray">DOSDATA:135A                 </span><span style="color:navy">db </span><span style="color:#008040">0B4h</span><span style="color:navy">, </span><span style="color:#008040">0Eh
</span><span style="color:gray">DOSDATA:135C                 </span><span style="color:navy">db </span><span style="color:#008040">0CDh</span><span style="color:navy">, </span><span style="color:#008040">10h
</span><span style="color:gray">DOSDATA:135E                 </span><span style="color:navy">db </span><span style="color:#008040">0EBh</span><span style="color:navy">, </span><span style="color:#008040">0F3h
</span><span style="color:gray">DOSDATA:1360                 </span><span style="color:navy">db </span><span style="color:#008040">0EBh</span><span style="color:navy">, </span><span style="color:#008040">0FEh
</span><span style="color:gray">DOSDATA:1362 </span>Rational386PatchPtr <span style="color:navy">dw </span><span style="color:#008040">0                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:1364 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:1364
DOSDATA:1364 </span>MagicPatch<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSDATA:1364                 </span><span style="color:navy">retf
</span><span style="color:maroon">DOSDATA:1365 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSDATA:1365                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSDATA:1366                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSDATA:1367                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSDATA:1368                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSDATA:1369                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSDATA:1369 </span>DOSDATA         ends
<span style="color:maroon">DOSDATA:1369
DOSCODE:3DE0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:3DE0 </span>; File Name   : C:\retrodos4\MSDOS621.SYS
<span style="color:maroon">DOSCODE:3DE0 </span>; Format      : Binary file
<span style="color:maroon">DOSCODE:3DE0 </span>; Base Address: 0000h Range: 0000h - 94FAh Loaded length: 94FAh
<span style="color:maroon">DOSCODE:3DE0 </span><span style="color:gray">; ===========================================================================
</span><span style="color:maroon">DOSCODE:3DE0
DOSCODE:3DE0 </span><span style="color:gray">; Segment type: Pure code
</span><span style="color:maroon">DOSCODE:3DE0 </span>DOSCODE         segment byte public &#039;CODE&#039; use16
<span style="color:maroon">DOSCODE:3DE0                 </span>assume cs:DOSCODE
<span style="color:maroon">DOSCODE:3DE0                 </span><span style="color:gray">;org 3DE0h
</span><span style="color:maroon">DOSCODE:3DE0                 </span>assume es:DOSDATA, ss:DOSDATA, ds:DOSDATA, fs:DOSDATA, gs:DOSDATA
<span style="color:maroon">DOSCODE:3DE0
DOSCODE:3DE0 </span>$STARTCODE<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:3DE0                 </span><span style="color:navy">jmp     </span>DOSINIT
<span style="color:maroon">DOSCODE:3DE0 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:3DE3                 </span><span style="color:navy">dw offset </span>$STARTCODE
<span style="color:gray">DOSCODE:3DE5 </span>BioDataSeg      <span style="color:navy">dw </span><span style="color:#008040">70h
</span><span style="color:gray">DOSCODE:3DE7 </span>DosDSeg         <span style="color:navy">dw </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:3DE9 </span>MSMAJOR         <span style="color:navy">db </span><span style="color:#008040">6
</span><span style="color:gray">DOSCODE:3DEA </span>MSMINOR         <span style="color:navy">db </span><span style="color:#008040">20
</span><span style="color:gray">DOSCODE:3DEB </span>I21_MAP_E_TAB   <span style="color:navy">db </span><span style="color:#008040">38h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">2         </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:3DEF                 </span><span style="color:navy">db </span><span style="color:#008040">39h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3DF4                 </span><span style="color:navy">db </span><span style="color:#008040">3Ah</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">10h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3DFA                 </span><span style="color:navy">db </span><span style="color:#008040">3Bh</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">3
</span><span style="color:gray">DOSCODE:3DFE                 </span><span style="color:navy">db </span><span style="color:#008040">3Ch</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E04                 </span><span style="color:navy">db </span><span style="color:#008040">3Dh</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">0Ch</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">1Ah</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E0C                 </span><span style="color:navy">db </span><span style="color:#008040">3Eh</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">6
</span><span style="color:gray">DOSCODE:3E0F                 </span><span style="color:navy">db </span><span style="color:#008040">3Fh</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E13                 </span><span style="color:navy">db </span><span style="color:#008040">40h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E17                 </span><span style="color:navy">db </span><span style="color:#008040">41h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E1C                 </span><span style="color:navy">db </span><span style="color:#008040">42h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSCODE:3E20                 </span><span style="color:navy">db </span><span style="color:#008040">43h</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E26                 </span><span style="color:navy">db </span><span style="color:#008040">44h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">0Fh</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E2D                 </span><span style="color:navy">db </span><span style="color:#008040">45h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">4
</span><span style="color:gray">DOSCODE:3E31                 </span><span style="color:navy">db </span><span style="color:#008040">46h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">4
</span><span style="color:gray">DOSCODE:3E35                 </span><span style="color:navy">db </span><span style="color:#008040">47h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">1Ah</span><span style="color:navy">, </span><span style="color:#008040">0Fh
</span><span style="color:gray">DOSCODE:3E39                 </span><span style="color:navy">db </span><span style="color:#008040">48h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">8
</span><span style="color:gray">DOSCODE:3E3D                 </span><span style="color:navy">db </span><span style="color:#008040">49h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">9
</span><span style="color:gray">DOSCODE:3E41                 </span><span style="color:navy">db </span><span style="color:#008040">4Ah</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">9</span><span style="color:navy">, </span><span style="color:#008040">8
</span><span style="color:gray">DOSCODE:3E46                 </span><span style="color:navy">db </span><span style="color:#008040">4Bh</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">0Bh</span><span style="color:navy">, </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E50                 </span><span style="color:navy">db </span><span style="color:#008040">4Eh</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">12h
</span><span style="color:gray">DOSCODE:3E55                 </span><span style="color:navy">db </span><span style="color:#008040">4Fh</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">12h
</span><span style="color:gray">DOSCODE:3E58                 </span><span style="color:navy">db </span><span style="color:#008040">56h</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">11h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">10h</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E5F                 </span><span style="color:navy">db </span><span style="color:#008040">57h</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSCODE:3E65                 </span><span style="color:navy">db </span><span style="color:#008040">58h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSCODE:3E68                 </span><span style="color:navy">db </span><span style="color:#008040">5Ah</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E6E                 </span><span style="color:navy">db </span><span style="color:#008040">5Bh</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">50h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E75                 </span><span style="color:navy">db </span><span style="color:#008040">5Ch</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">24h</span><span style="color:navy">, </span><span style="color:#008040">21h
</span><span style="color:gray">DOSCODE:3E7B                 </span><span style="color:navy">db </span><span style="color:#008040">65h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSCODE:3E7F                 </span><span style="color:navy">db </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">2
</span><span style="color:gray">DOSCODE:3E83                 </span><span style="color:navy">db </span><span style="color:#008040">68h</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">6
</span><span style="color:gray">DOSCODE:3E86                 </span><span style="color:navy">db </span><span style="color:#008040">67h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">1
</span><span style="color:gray">DOSCODE:3E8B                 </span><span style="color:navy">db </span><span style="color:#008040">6Ch</span><span style="color:navy">, </span><span style="color:#008040">0Ah</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">2</span><span style="color:navy">, </span><span style="color:#008040">0Ch</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">50h</span><span style="color:navy">, </span><span style="color:#008040">8</span><span style="color:navy">, </span><span style="color:#008040">1Ah</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:3E97                 </span><span style="color:navy">db </span><span style="color:#008040">69h</span><span style="color:navy">, </span><span style="color:#008040">4</span><span style="color:navy">, </span><span style="color:#008040">0Fh</span><span style="color:navy">, </span><span style="color:#008040">0Dh</span><span style="color:navy">, </span><span style="color:#008040">1</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:olive">DOSCODE:3E9D                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh
</span><span style="color:gray">DOSCODE:3E9E </span>DISPATCH        <span style="color:navy">dw offset </span>$ABORT        <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:3EA0                 </span><span style="color:navy">dw offset </span>$STD_CON_INPUT
<span style="color:gray">DOSCODE:3EA2                 </span><span style="color:navy">dw offset </span>$STD_CON_OUTPUT
<span style="color:gray">DOSCODE:3EA4                 </span><span style="color:navy">dw offset </span>$STD_AUX_INPUT
<span style="color:gray">DOSCODE:3EA6                 </span><span style="color:navy">dw offset </span>$STD_AUX_OUTPUT
<span style="color:gray">DOSCODE:3EA8                 </span><span style="color:navy">dw offset </span>$STD_PRINTER_OUTPUT
<span style="color:gray">DOSCODE:3EAA                 </span><span style="color:navy">dw offset </span>$RAW_CON_IO
<span style="color:gray">DOSCODE:3EAC                 </span><span style="color:navy">dw offset </span>$RAW_CON_INPUT
<span style="color:gray">DOSCODE:3EAE                 </span><span style="color:navy">dw offset </span>$STD_CON_INPUT_NO_ECHO
<span style="color:gray">DOSCODE:3EB0                 </span><span style="color:navy">dw offset </span>$STD_CON_STRING_OUTPUT
<span style="color:gray">DOSCODE:3EB2                 </span><span style="color:navy">dw offset </span>$STD_CON_STRING_INPUT
<span style="color:gray">DOSCODE:3EB4                 </span><span style="color:navy">dw offset </span>$STD_CON_INPUT_STATUS
<span style="color:gray">DOSCODE:3EB6                 </span><span style="color:navy">dw offset </span>$STD_CON_INPUT_FLUSH
<span style="color:gray">DOSCODE:3EB8                 </span><span style="color:navy">dw offset </span>$DISK_RESET
<span style="color:gray">DOSCODE:3EBA                 </span><span style="color:navy">dw offset </span>$SET_DEFAULT_DRIVE
<span style="color:gray">DOSCODE:3EBC                 </span><span style="color:navy">dw offset </span>$FCB_OPEN
<span style="color:gray">DOSCODE:3EBE                 </span><span style="color:navy">dw offset </span>$FCB_CLOSE
<span style="color:gray">DOSCODE:3EC0                 </span><span style="color:navy">dw offset </span>$DIR_SEARCH_FIRST
<span style="color:gray">DOSCODE:3EC2                 </span><span style="color:navy">dw offset </span>$DIR_SEARCH_NEXT
<span style="color:gray">DOSCODE:3EC4                 </span><span style="color:navy">dw offset </span>$FCB_DELETE
<span style="color:gray">DOSCODE:3EC6                 </span><span style="color:navy">dw offset </span>$FCB_SEQ_READ
<span style="color:gray">DOSCODE:3EC8                 </span><span style="color:navy">dw offset </span>$FCB_SEQ_WRITE
<span style="color:gray">DOSCODE:3ECA                 </span><span style="color:navy">dw offset </span>$FCB_CREATE
<span style="color:gray">DOSCODE:3ECC                 </span><span style="color:navy">dw offset </span>$FCB_RENAME
<span style="color:gray">DOSCODE:3ECE                 </span><span style="color:navy">dw offset </span>NO_OP
<span style="color:gray">DOSCODE:3ED0                 </span><span style="color:navy">dw offset </span>$GET_DEFAULT_DRIVE
<span style="color:gray">DOSCODE:3ED2                 </span><span style="color:navy">dw offset </span>$SET_DMA
<span style="color:gray">DOSCODE:3ED4                 </span><span style="color:navy">dw offset </span>$SLEAZEFUNC
<span style="color:gray">DOSCODE:3ED6                 </span><span style="color:navy">dw offset </span>$SLEAZEFUNCDL
<span style="color:gray">DOSCODE:3ED8                 </span><span style="color:navy">dw offset </span>NO_OP
<span style="color:gray">DOSCODE:3EDA                 </span><span style="color:navy">dw offset </span>NO_OP
<span style="color:gray">DOSCODE:3EDC                 </span><span style="color:navy">dw offset </span>$GET_DEFAULT_DPB
<span style="color:gray">DOSCODE:3EDE                 </span><span style="color:navy">dw offset </span>NO_OP
<span style="color:gray">DOSCODE:3EE0                 </span><span style="color:navy">dw offset </span>$FCB_RANDOM_READ
<span style="color:gray">DOSCODE:3EE2                 </span><span style="color:navy">dw offset </span>$FCB_RANDOM_WRITE
<span style="color:gray">DOSCODE:3EE4                 </span><span style="color:navy">dw offset </span>$GET_FCB_FILE_LENGTH
<span style="color:gray">DOSCODE:3EE6                 </span><span style="color:navy">dw offset </span>$GET_FCB_POSITION
<span style="color:gray">DOSCODE:3EE8                 </span><span style="color:navy">dw offset </span>$SET_INTERRUPT_VECTOR
<span style="color:gray">DOSCODE:3EEA                 </span><span style="color:navy">dw offset </span>$CREATE_PROCESS_DATA_BLOCK
<span style="color:gray">DOSCODE:3EEC                 </span><span style="color:navy">dw offset </span>$FCB_RANDOM_READ_BLOCK
<span style="color:gray">DOSCODE:3EEE                 </span><span style="color:navy">dw offset </span>$FCB_RANDOM_WRITE_BLOCK
<span style="color:gray">DOSCODE:3EF0                 </span><span style="color:navy">dw offset </span>$PARSE_FILE_DESCRIPTOR
<span style="color:gray">DOSCODE:3EF2                 </span><span style="color:navy">dw offset </span>$GET_DATE
<span style="color:gray">DOSCODE:3EF4                 </span><span style="color:navy">dw offset </span>$SET_DATE
<span style="color:gray">DOSCODE:3EF6                 </span><span style="color:navy">dw offset </span>$GET_TIME
<span style="color:gray">DOSCODE:3EF8                 </span><span style="color:navy">dw offset </span>$SET_TIME
<span style="color:gray">DOSCODE:3EFA                 </span><span style="color:navy">dw offset </span>$SET_VERIFY_ON_WRITE
<span style="color:gray">DOSCODE:3EFC                 </span><span style="color:navy">dw offset </span>$GET_DMA
<span style="color:gray">DOSCODE:3EFE                 </span><span style="color:navy">dw offset </span>$GET_VERSION
<span style="color:gray">DOSCODE:3F00                 </span><span style="color:navy">dw offset </span>$KEEP_PROCESS
<span style="color:gray">DOSCODE:3F02                 </span><span style="color:navy">dw offset </span>$GET_DPB
<span style="color:gray">DOSCODE:3F04                 </span><span style="color:navy">dw offset </span>$SET_CTRL_C_TRAPPING
<span style="color:gray">DOSCODE:3F06                 </span><span style="color:navy">dw offset </span>$GET_INDOS_FLAG
<span style="color:gray">DOSCODE:3F08                 </span><span style="color:navy">dw offset </span>$GET_INTERRUPT_VECTOR
<span style="color:gray">DOSCODE:3F0A                 </span><span style="color:navy">dw offset </span>$GET_DRIVE_FREESPACE
<span style="color:gray">DOSCODE:3F0C                 </span><span style="color:navy">dw offset </span>$CHAR_OPER
<span style="color:gray">DOSCODE:3F0E                 </span><span style="color:navy">dw offset </span>$INTERNATIONAL
<span style="color:gray">DOSCODE:3F10                 </span><span style="color:navy">dw offset </span>$MKDIR
<span style="color:gray">DOSCODE:3F12                 </span><span style="color:navy">dw offset </span>$RMDIR
<span style="color:gray">DOSCODE:3F14                 </span><span style="color:navy">dw offset </span>$CHDIR
<span style="color:gray">DOSCODE:3F16                 </span><span style="color:navy">dw offset </span>$CREAT
<span style="color:gray">DOSCODE:3F18                 </span><span style="color:navy">dw offset </span>$OPEN
<span style="color:gray">DOSCODE:3F1A                 </span><span style="color:navy">dw offset </span>$CLOSE
<span style="color:gray">DOSCODE:3F1C                 </span><span style="color:navy">dw offset </span>$READ
<span style="color:gray">DOSCODE:3F1E                 </span><span style="color:navy">dw offset </span>$WRITE
<span style="color:gray">DOSCODE:3F20                 </span><span style="color:navy">dw offset </span>$UNLINK
<span style="color:gray">DOSCODE:3F22                 </span><span style="color:navy">dw offset </span>$LSEEK
<span style="color:gray">DOSCODE:3F24                 </span><span style="color:navy">dw offset </span>$CHMOD
<span style="color:gray">DOSCODE:3F26                 </span><span style="color:navy">dw offset </span>$IOCTL
<span style="color:gray">DOSCODE:3F28                 </span><span style="color:navy">dw offset </span>$DUP
<span style="color:gray">DOSCODE:3F2A                 </span><span style="color:navy">dw offset </span>$DUP2
<span style="color:gray">DOSCODE:3F2C                 </span><span style="color:navy">dw offset </span>$CURRENT_DIR
<span style="color:gray">DOSCODE:3F2E                 </span><span style="color:navy">dw offset </span>$ALLOC
<span style="color:gray">DOSCODE:3F30                 </span><span style="color:navy">dw offset </span>$DEALLOC
<span style="color:gray">DOSCODE:3F32                 </span><span style="color:navy">dw offset </span>$SETBLOCK
<span style="color:gray">DOSCODE:3F34                 </span><span style="color:navy">dw offset </span>$EXEC
<span style="color:gray">DOSCODE:3F36                 </span><span style="color:navy">dw offset </span>$EXIT
<span style="color:gray">DOSCODE:3F38                 </span><span style="color:navy">dw offset </span>$WAIT
<span style="color:gray">DOSCODE:3F3A                 </span><span style="color:navy">dw offset </span>$FIND_FIRST
<span style="color:gray">DOSCODE:3F3C                 </span><span style="color:navy">dw offset </span>$FIND_NEXT
<span style="color:gray">DOSCODE:3F3E                 </span><span style="color:navy">dw offset </span>$SET_CURRENT_PDB
<span style="color:gray">DOSCODE:3F40                 </span><span style="color:navy">dw offset </span>$GET_CURRENT_PDB
<span style="color:gray">DOSCODE:3F42                 </span><span style="color:navy">dw offset </span>$GET_IN_VARS
<span style="color:gray">DOSCODE:3F44                 </span><span style="color:navy">dw offset </span>$SETDPB
<span style="color:gray">DOSCODE:3F46                 </span><span style="color:navy">dw offset </span>$GET_VERIFY_ON_WRITE
<span style="color:gray">DOSCODE:3F48                 </span><span style="color:navy">dw offset </span>$DUP_PDB
<span style="color:gray">DOSCODE:3F4A                 </span><span style="color:navy">dw offset </span>$RENAME
<span style="color:gray">DOSCODE:3F4C                 </span><span style="color:navy">dw offset </span>$FILE_TIMES
<span style="color:gray">DOSCODE:3F4E                 </span><span style="color:navy">dw offset </span>$ALLOCOPER
<span style="color:gray">DOSCODE:3F50                 </span><span style="color:navy">dw offset </span>$GetExtendedError
<span style="color:gray">DOSCODE:3F52                 </span><span style="color:navy">dw offset </span>$CreateTempFile
<span style="color:gray">DOSCODE:3F54                 </span><span style="color:navy">dw offset </span>$CreateNewFile
<span style="color:gray">DOSCODE:3F56                 </span><span style="color:navy">dw offset </span>$LockOper
<span style="color:gray">DOSCODE:3F58                 </span><span style="color:navy">dw offset </span>$ServerCall
<span style="color:gray">DOSCODE:3F5A                 </span><span style="color:navy">dw offset </span>$UserOper
<span style="color:gray">DOSCODE:3F5C                 </span><span style="color:navy">dw offset </span>$AssignOper
<span style="color:gray">DOSCODE:3F5E                 </span><span style="color:navy">dw offset </span>$NameTrans
<span style="color:gray">DOSCODE:3F60                 </span><span style="color:navy">dw offset </span>NO_OP
<span style="color:gray">DOSCODE:3F62                 </span><span style="color:navy">dw offset </span>$GET_CURRENT_PDB
<span style="color:gray">DOSCODE:3F64                 </span><span style="color:navy">dw offset </span>$ECS_Call
<span style="color:gray">DOSCODE:3F66                 </span><span style="color:navy">dw offset </span>$SET_PRINTER_FLAG
<span style="color:gray">DOSCODE:3F68                 </span><span style="color:navy">dw offset </span>$GetExtCntry
<span style="color:gray">DOSCODE:3F6A                 </span><span style="color:navy">dw offset </span>$GetSetCdPg
<span style="color:gray">DOSCODE:3F6C                 </span><span style="color:navy">dw offset </span>$ExtHandle
<span style="color:gray">DOSCODE:3F6E                 </span><span style="color:navy">dw offset </span>$COMMIT
<span style="color:gray">DOSCODE:3F70                 </span><span style="color:navy">dw offset </span>$GSetMediaID
<span style="color:gray">DOSCODE:3F72                 </span><span style="color:navy">dw offset </span>$COMMIT
<span style="color:gray">DOSCODE:3F74                 </span><span style="color:navy">dw offset </span>NO_OP
<span style="color:gray">DOSCODE:3F76                 </span><span style="color:navy">dw offset </span>$Extended_Open
<span style="color:gray">DOSCODE:3F78 </span>FOO             <span style="color:navy">dw offset </span>Leave2F       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:3F7A </span>DTab            <span style="color:navy">dw offset </span>DOSTable      <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:3F7C </span>DOSTable        <span style="color:navy">db </span><span style="color:#008040">48                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:3F7D                 </span><span style="color:navy">dw offset </span>DOSInstall
<span style="color:gray">DOSCODE:3F7F                 </span><span style="color:navy">dw offset </span>DOS_CLOSE
<span style="color:gray">DOSCODE:3F81                 </span><span style="color:navy">dw offset </span>RECSET
<span style="color:gray">DOSCODE:3F83                 </span><span style="color:navy">dw offset </span>DOSGetGroup
<span style="color:gray">DOSCODE:3F85                 </span><span style="color:navy">dw offset </span>PATHCHRCMP
<span style="color:gray">DOSCODE:3F87                 </span><span style="color:navy">dw offset </span>OUTT
<span style="color:gray">DOSCODE:3F89                 </span><span style="color:navy">dw offset </span>NET_I24_ENTRY
<span style="color:gray">DOSCODE:3F8B                 </span><span style="color:navy">dw offset </span>PLACEBUF
<span style="color:gray">DOSCODE:3F8D                 </span><span style="color:navy">dw offset </span>FREE_SFT
<span style="color:gray">DOSCODE:3F8F                 </span><span style="color:navy">dw offset </span>BUFWRITE
<span style="color:gray">DOSCODE:3F91                 </span><span style="color:navy">dw offset </span>SHARE_VIOLATION
<span style="color:gray">DOSCODE:3F93                 </span><span style="color:navy">dw offset </span>SHARE_ERROR
<span style="color:gray">DOSCODE:3F95                 </span><span style="color:navy">dw offset </span>SET_SFT_MODE
<span style="color:gray">DOSCODE:3F97                 </span><span style="color:navy">dw offset </span>DATE16
<span style="color:gray">DOSCODE:3F99                 </span><span style="color:navy">dw offset </span>Idle
<span style="color:gray">DOSCODE:3F9B                 </span><span style="color:navy">dw offset </span>SCANPLACE
<span style="color:gray">DOSCODE:3F9D                 </span><span style="color:navy">dw offset </span>Idle
<span style="color:gray">DOSCODE:3F9F                 </span><span style="color:navy">dw offset </span>StrCpy
<span style="color:gray">DOSCODE:3FA1                 </span><span style="color:navy">dw offset </span>StrLen
<span style="color:gray">DOSCODE:3FA3                 </span><span style="color:navy">dw offset </span>UCase
<span style="color:gray">DOSCODE:3FA5                 </span><span style="color:navy">dw offset </span>POINTCOMP
<span style="color:gray">DOSCODE:3FA7                 </span><span style="color:navy">dw offset </span>CHECKFLUSH
<span style="color:gray">DOSCODE:3FA9                 </span><span style="color:navy">dw offset </span>SFFromSFN
<span style="color:gray">DOSCODE:3FAB                 </span><span style="color:navy">dw offset </span>GetCDSFromDrv
<span style="color:gray">DOSCODE:3FAD                 </span><span style="color:navy">dw offset </span>Get_User_Stack
<span style="color:gray">DOSCODE:3FAF                 </span><span style="color:navy">dw offset </span>GETTHISDRV
<span style="color:gray">DOSCODE:3FB1                 </span><span style="color:navy">dw offset </span>DriveFromText
<span style="color:gray">DOSCODE:3FB3                 </span><span style="color:navy">dw offset </span>SETYEAR
<span style="color:gray">DOSCODE:3FB5                 </span><span style="color:navy">dw offset </span>DSUM
<span style="color:gray">DOSCODE:3FB7                 </span><span style="color:navy">dw offset </span>DSLIDE
<span style="color:gray">DOSCODE:3FB9                 </span><span style="color:navy">dw offset </span>StrCmp
<span style="color:gray">DOSCODE:3FBB                 </span><span style="color:navy">dw offset </span>InitCDS
<span style="color:gray">DOSCODE:3FBD                 </span><span style="color:navy">dw offset </span>pJFNFromHandle
<span style="color:gray">DOSCODE:3FBF                 </span><span style="color:navy">dw offset </span>$NameTrans
<span style="color:gray">DOSCODE:3FC1                 </span><span style="color:navy">dw offset </span>CAL_LK
<span style="color:gray">DOSCODE:3FC3                 </span><span style="color:navy">dw offset </span>DEVNAME
<span style="color:gray">DOSCODE:3FC5                 </span><span style="color:navy">dw offset </span>Idle
<span style="color:gray">DOSCODE:3FC7                 </span><span style="color:navy">dw offset </span>DStrLen
<span style="color:gray">DOSCODE:3FC9                 </span><span style="color:navy">dw offset </span>NLS_OPEN
<span style="color:gray">DOSCODE:3FCB                 </span><span style="color:navy">dw offset </span>$CLOSE
<span style="color:gray">DOSCODE:3FCD                 </span><span style="color:navy">dw offset </span>NLS_LSEEK
<span style="color:gray">DOSCODE:3FCF                 </span><span style="color:navy">dw offset </span>$READ
<span style="color:gray">DOSCODE:3FD1                 </span><span style="color:navy">dw offset </span>FastInit
<span style="color:gray">DOSCODE:3FD3                 </span><span style="color:navy">dw offset </span>NLS_IOCTL
<span style="color:gray">DOSCODE:3FD5                 </span><span style="color:navy">dw offset </span>GetDevList
<span style="color:gray">DOSCODE:3FD7                 </span><span style="color:navy">dw offset </span>NLS_GETEXT
<span style="color:gray">DOSCODE:3FD9                 </span><span style="color:navy">dw offset </span>MSG_RETRIEVAL
<span style="color:gray">DOSCODE:3FDB                 </span><span style="color:navy">dw offset </span>NO_OP
<span style="color:gray">DOSCODE:3FDD </span>ms_copyright    <span style="color:navy">db &#039;MS DOS Version 6 (C)Copyright 1981-1993 Microsoft Corp Licensed M&#039;
</span><span style="color:gray">DOSCODE:3FDD                 </span><span style="color:navy">db &#039;aterial - Property of Microsoft All rights reserved &#039;
</span><span style="color:maroon">DOSCODE:4052 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4052
DOSCODE:4052 </span>$SET_CTRL_C_TRAPPING<span style="color:navy">:                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4052                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:4054                 </span><span style="color:navy">jbe     short </span>scct_1
<span style="color:maroon">DOSCODE:4056                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4058                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:4059 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4059
DOSCODE:4059 </span>scct_1<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4059                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:405A                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:405F                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:4060                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:4061                 </span><span style="color:navy">mov     si, offset </span>CNTCFLAG
<span style="color:maroon">DOSCODE:4064                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:4066                 </span><span style="color:navy">or      ax, ax
</span><span style="color:maroon">DOSCODE:4068                 </span><span style="color:navy">jnz     short </span>scct_2
<span style="color:maroon">DOSCODE:406A                 </span><span style="color:navy">mov     dl, [si]
</span><span style="color:maroon">DOSCODE:406C                 </span><span style="color:navy">jmp     short </span>scct_9s
<span style="color:maroon">DOSCODE:406E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:406E
DOSCODE:406E </span>scct_2<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:406E                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:406F                 </span><span style="color:navy">jnz     short </span>scct_3
<span style="color:maroon">DOSCODE:4071                 </span><span style="color:navy">and     dl, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4074                 </span><span style="color:navy">mov     [si], dl
</span><span style="color:maroon">DOSCODE:4076                 </span><span style="color:navy">jmp     short </span>scct_9s
<span style="color:maroon">DOSCODE:4078 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4078
DOSCODE:4078 </span>scct_3<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4078                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:4079                 </span><span style="color:navy">jnz     short </span>scct_4
<span style="color:maroon">DOSCODE:407B                 </span><span style="color:navy">and     dl, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:407E                 </span><span style="color:navy">xchg    dl, [si]
</span><span style="color:maroon">DOSCODE:4080                 </span><span style="color:navy">jmp     short </span>scct_9s
<span style="color:maroon">DOSCODE:4082 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4082
DOSCODE:4082 </span>scct_4<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4082                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:4085                 </span><span style="color:navy">jnz     short </span>scct_5
<span style="color:maroon">DOSCODE:4087                 </span><span style="color:navy">mov     dl, </span>BOOTDRIVE
<span style="color:maroon">DOSCODE:408B                 </span><span style="color:navy">jmp     short </span>scct_9s
<span style="color:maroon">DOSCODE:408D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:408D
DOSCODE:408D </span>scct_5<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:408D                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:4090                 </span><span style="color:navy">jnz     short </span>scct_9s
<span style="color:maroon">DOSCODE:4092                 </span><span style="color:navy">mov     bx, </span><span style="color:green">1406h
</span><span style="color:maroon">DOSCODE:4095                 </span><span style="color:navy">mov     dl, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4097                 </span><span style="color:navy">xor     dh, dh
</span><span style="color:maroon">DOSCODE:4099                 </span><span style="color:navy">cmp     </span>DosHasHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:409E                 </span><span style="color:navy">jz      short </span>scct_9s
<span style="color:maroon">DOSCODE:40A0                 </span><span style="color:navy">or      dh, </span><span style="color:green">10h
</span><span style="color:maroon">DOSCODE:40A3
DOSCODE:40A3 </span>scct_9s<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40A3                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:40A4                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:40A5                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:40A6                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:40A7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:40A7
DOSCODE:40A7 </span>SetCtrlShortEntry<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40A7                 </span><span style="color:navy">jmp     short </span>$SET_CTRL_C_TRAPPING
<span style="color:maroon">DOSCODE:40A9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:40A9
DOSCODE:40A9 </span>$SET_CURRENT_PDB<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40A9                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:40AA                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:40AF                 </span><span style="color:navy">mov     </span>CurrentPDB<span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:40B3                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:40B4                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:40B5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:40B5
DOSCODE:40B5 </span>$GET_CURRENT_PDB<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40B5                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:40B6                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:40BB                 </span><span style="color:navy">mov     bx, </span>CurrentPDB
<span style="color:maroon">DOSCODE:40BF                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:40C0                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:40C1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:40C1
DOSCODE:40C1 </span>$SET_PRINTER_FLAG<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40C1                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:40C2                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:40C7                 </span><span style="color:navy">mov     </span>PRINTER_FLAG<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:40CA                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:40CB                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:40CC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:40CC
DOSCODE:40CC </span>quit<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40CC                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:40CE                 </span><span style="color:navy">jmp     short </span>SAVREGS
<span style="color:black">DOSCODE:40D0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:40D0 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR STATCHK
</span><span style="color:black">DOSCODE:40D0
DOSCODE:40D0 </span>BADCALL<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:40D0                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:40D2
DOSCODE:40D2 </span>irett<span style="color:navy">:                                  </span><span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:40D2                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:40D2 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR STATCHK
</span><span style="color:maroon">DOSCODE:40D3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:40D3
DOSCODE:40D3 </span>call_entry<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40D3                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:40D4                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:40D9                 </span><span style="color:navy">pop     </span>SAVEDS
<span style="color:maroon">DOSCODE:40DD                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:40DE                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:40DF                 </span><span style="color:navy">pop     </span>USER_SP
<span style="color:maroon">DOSCODE:40E3                 </span><span style="color:navy">pushf
</span><span style="color:maroon">DOSCODE:40E4                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:40E5                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:40E6                 </span><span style="color:navy">push    </span>USER_SP
<span style="color:maroon">DOSCODE:40EA                 </span><span style="color:navy">push    </span>SAVEDS
<span style="color:maroon">DOSCODE:40EE                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:40EF                 </span><span style="color:navy">cmp     cl, </span><span style="color:green">36
</span><span style="color:maroon">DOSCODE:40F2                 </span><span style="color:navy">ja      short </span>BADCALL
<span style="color:maroon">DOSCODE:40F4                 </span><span style="color:navy">mov     ah, cl
</span><span style="color:maroon">DOSCODE:40F6                 </span><span style="color:navy">jmp     short </span>SAVREGS
<span style="color:black">DOSCODE:40F8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:40F8 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR STATCHK
</span><span style="color:black">DOSCODE:40F8
DOSCODE:40F8 </span>command<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:40F8                 </span><span style="color:navy">cli
</span><span style="color:black">DOSCODE:40F9                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">6Ch
</span><span style="color:black">DOSCODE:40FC                 </span><span style="color:navy">ja      short </span>BADCALL
<span style="color:black">DOSCODE:40FC </span><span style="color:gray">; END OF FUNCTION CHUNK FOR STATCHK
</span><span style="color:maroon">DOSCODE:40FE
DOSCODE:40FE </span>SAVREGS<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:40FE                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">33h
</span><span style="color:maroon">DOSCODE:4101                 </span><span style="color:navy">jb      short </span>SaveAllRegs
<span style="color:maroon">DOSCODE:4103                 </span><span style="color:navy">jz      short </span>SetCtrlShortEntry
<span style="color:maroon">DOSCODE:4105                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">64h
</span><span style="color:maroon">DOSCODE:4108                 </span><span style="color:navy">ja      short </span>SaveAllRegs
<span style="color:maroon">DOSCODE:410A                 </span><span style="color:navy">jz      short </span>$SET_PRINTER_FLAG
<span style="color:maroon">DOSCODE:410C                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">51h
</span><span style="color:maroon">DOSCODE:410F                 </span><span style="color:navy">jz      short </span>$GET_CURRENT_PDB
<span style="color:maroon">DOSCODE:4111                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">62h
</span><span style="color:maroon">DOSCODE:4114                 </span><span style="color:navy">jz      short </span>$GET_CURRENT_PDB
<span style="color:maroon">DOSCODE:4116                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">50h
</span><span style="color:maroon">DOSCODE:4119                 </span><span style="color:navy">jz      short </span>$SET_CURRENT_PDB
<span style="color:maroon">DOSCODE:411B
DOSCODE:411B </span>SaveAllRegs<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:411B                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:411C                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:411D                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:411E                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:411F                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:4120                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:4121                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:4122                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:4123                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:4124                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:4126                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:412B                 </span><span style="color:navy">mov     </span>SAVEDS<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:412E                 </span><span style="color:navy">mov     </span>SAVEBX<span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:4132                 </span><span style="color:navy">mov     ax, </span>USER_SP
<span style="color:maroon">DOSCODE:4135                 </span><span style="color:navy">mov     </span>NSP<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:4138                 </span><span style="color:navy">mov     ax, </span>USER_SS
<span style="color:maroon">DOSCODE:413B                 </span><span style="color:navy">mov     </span>NSS<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:413E                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:4140                 </span><span style="color:navy">mov     </span>FSHARING<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:4143                 </span><span style="color:navy">test    </span>IsWin386<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4148                 </span><span style="color:navy">jnz     short </span>set_indos_flag
<span style="color:maroon">DOSCODE:414A                 </span><span style="color:navy">mov     </span>USER_ID<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:414D
DOSCODE:414D </span>set_indos_flag<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:414D                 </span><span style="color:navy">inc     </span>INDOS
<span style="color:maroon">DOSCODE:4151                 </span><span style="color:navy">mov     </span>USER_SP<span style="color:navy">, sp
</span><span style="color:maroon">DOSCODE:4155                 </span><span style="color:navy">mov     </span>USER_SS<span style="color:navy">, ss
</span><span style="color:maroon">DOSCODE:4159                 </span><span style="color:navy">mov     ax, </span>CurrentPDB
<span style="color:maroon">DOSCODE:415C                 </span><span style="color:navy">mov     </span>PROC_ID<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:415F                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:4161                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:4162                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:4163                 </span><span style="color:navy">mov     word ptr </span>BCLOCK<span style="color:navy">, sp
</span><span style="color:maroon">DOSCODE:4167                 </span><span style="color:navy">mov     word ptr </span>BCLOCK<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ss
</span><span style="color:maroon">DOSCODE:416B                 </span><span style="color:navy">mov     ss, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:4170
DOSCODE:4170 </span>REDISP<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4170                 </span><span style="color:navy">mov     sp, offset </span>AUXSTACK
<span style="color:maroon">DOSCODE:4173                 </span><span style="color:navy">sti
</span><span style="color:maroon">DOSCODE:4174                 </span><span style="color:navy">mov     bx, ss
</span><span style="color:maroon">DOSCODE:4176                 </span><span style="color:navy">mov     ds, bx
</span><span style="color:maroon">DOSCODE:4178                 </span><span style="color:navy">xchg    ax, bx
</span><span style="color:maroon">DOSCODE:4179                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:417B                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_ON<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:417F                 </span><span style="color:navy">and     ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">800h
</span><span style="color:maroon">DOSCODE:4186                 </span><span style="color:navy">mov     ss:</span>CONSWAP<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:418A                 </span><span style="color:navy">mov     ss:</span>NoSetDir<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:418E                 </span><span style="color:navy">mov     ss:</span>FAILERR<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:4192                 </span><span style="color:navy">inc     ax
</span><span style="color:maroon">DOSCODE:4193                 </span><span style="color:navy">mov     ss:</span>IDLEINT<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:4197                 </span><span style="color:navy">xchg    ax, bx
</span><span style="color:maroon">DOSCODE:4198                 </span><span style="color:navy">mov     bl, ah
</span><span style="color:maroon">DOSCODE:419A                 </span><span style="color:navy">shl     bx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:419C                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:419D                 </span><span style="color:navy">or      ah, ah
</span><span style="color:maroon">DOSCODE:419F                 </span><span style="color:navy">jz      short </span>DSKROUT
<span style="color:maroon">DOSCODE:41A1                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">59h
</span><span style="color:maroon">DOSCODE:41A4                 </span><span style="color:navy">jz      short </span>DISPCALL
<span style="color:maroon">DOSCODE:41A6                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">0Ch
</span><span style="color:maroon">DOSCODE:41A9                 </span><span style="color:navy">ja      short </span>DSKROUT
<span style="color:maroon">DOSCODE:41AB
DOSCODE:41AB </span>IOROUT<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:41AB                 </span><span style="color:navy">cmp     ss:</span>ERRORMODE<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:41B1                 </span><span style="color:navy">jnz     short </span>DISPCALL
<span style="color:maroon">DOSCODE:41B3                 </span><span style="color:navy">mov     sp, offset </span>PRINTER_FLAG
<span style="color:maroon">DOSCODE:41B6                 </span><span style="color:navy">jmp     short </span>DISPCALL
<span style="color:maroon">DOSCODE:41B8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:41B8
DOSCODE:41B8 </span>DSKROUT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:41B8                 </span><span style="color:navy">mov     ss:</span>USER_IN_AX<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:41BC                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:41C2                 </span><span style="color:navy">mov     ss:</span>ERRORMODE<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:41C8                 </span><span style="color:navy">mov     ss:</span>WPERR<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:41CE                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:41CF                 </span><span style="color:navy">mov     ah, </span><span style="color:green">82h
</span><span style="color:maroon">DOSCODE:41D1                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - END DOS CRITICAL SECTIONS 0 THROUGH 7
<span style="color:maroon">DOSCODE:41D3                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:41D4                 </span><span style="color:navy">mov     ss:</span>IDLEINT<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:41DA                 </span><span style="color:navy">mov     sp, offset </span>DSKSTACK
<span style="color:maroon">DOSCODE:41DD                 </span><span style="color:navy">test    ss:</span>CNTCFLAG<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:41E3                 </span><span style="color:navy">jz      short </span>DISPCALL
<span style="color:maroon">DOSCODE:41E5                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:41E6                 </span><span style="color:navy">call    </span>DSKSTATCHK
<span style="color:maroon">DOSCODE:41E9                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:41EA
DOSCODE:41EA </span>DISPCALL<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:41EA                 </span><span style="color:navy">mov     bx, cs:</span>DISPATCH<span style="color:navy">[bx]
</span><span style="color:maroon">DOSCODE:41EF                 </span><span style="color:navy">xchg    bx, ss:</span>SAVEBX
<span style="color:maroon">DOSCODE:41F4                 </span><span style="color:navy">mov     ds, ss:</span>SAVEDS
<span style="color:maroon">DOSCODE:41F9                 </span><span style="color:navy">call    ss:</span>SAVEBX
<span style="color:maroon">DOSCODE:41FE                 </span><span style="color:navy">and     ss:</span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">0FBh
</span><span style="color:maroon">DOSCODE:4204
DOSCODE:4204 </span>LeaveDOS<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4204                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:4205                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:420A                 </span><span style="color:navy">cmp     </span>A20OFF_COUNT<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:420F                 </span><span style="color:navy">jnz     short </span>disa20
<span style="color:maroon">DOSCODE:4211
DOSCODE:4211 </span>LeaveA20On<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4211                 </span><span style="color:navy">dec     </span>INDOS
<span style="color:maroon">DOSCODE:4215                 </span><span style="color:navy">mov     ss, </span>USER_SS
<span style="color:maroon">DOSCODE:4219                 </span><span style="color:navy">mov     sp, </span>USER_SP
<span style="color:maroon">DOSCODE:421D                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:maroon">DOSCODE:421F                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">0</span><span style="color:navy">], al
</span><span style="color:maroon">DOSCODE:4222                 </span><span style="color:navy">mov     ax, </span>NSP
<span style="color:maroon">DOSCODE:4225                 </span><span style="color:navy">mov     </span>USER_SP<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:4228                 </span><span style="color:navy">mov     ax, </span>NSS
<span style="color:maroon">DOSCODE:422B                 </span><span style="color:navy">mov     </span>USER_SS<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:422E                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:422F                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:4230                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:4231                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:4232                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:4233                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:4234                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:4235                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4236                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4237                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:4238 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4238
DOSCODE:4238 </span>disa20<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4238                 </span><span style="color:navy">mov     bx, </span>A20OFF_PSP
<span style="color:maroon">DOSCODE:423C                 </span><span style="color:navy">cmp     bx, </span>CurrentPDB
<span style="color:maroon">DOSCODE:4240                 </span><span style="color:navy">jnz     short </span>LeaveA20On
<span style="color:maroon">DOSCODE:4242                 </span><span style="color:navy">dec     </span>A20OFF_COUNT
<span style="color:maroon">DOSCODE:4246                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:4247                 </span><span style="color:navy">mov     bx, offset </span>disa20_iret
<span style="color:maroon">DOSCODE:424A                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:424B                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:424C
DOSCODE:424C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:424C
DOSCODE:424C
DOSCODE:424C </span>restore_world   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:424C                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4251                 </span><span style="color:navy">pop     es:</span>RESTORE_TMP
<span style="color:black">DOSCODE:4256                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:4257                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:4258                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:4259                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:425A                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:425B                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:425C                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:425D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:425E                 </span><span style="color:navy">jmp     es:</span>RESTORE_TMP
<span style="color:black">DOSCODE:425E </span>restore_world   endp
<span style="color:black">DOSCODE:425E
DOSCODE:4263
DOSCODE:4263 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4263
DOSCODE:4263 </span><span style="color:gray">; Attributes: bp-based frame
</span><span style="color:black">DOSCODE:4263
DOSCODE:4263 </span>save_world      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4263                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4268                 </span><span style="color:navy">pop     es:</span>RESTORE_TMP
<span style="color:black">DOSCODE:426D                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:426E                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:426F                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:4270                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:4271                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:4272                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:4273                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:4274                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:4275                 </span><span style="color:navy">push    es:</span>RESTORE_TMP
<span style="color:black">DOSCODE:427A                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:427B                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:black">DOSCODE:427D                 </span><span style="color:navy">mov     es, word ptr [bp+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4280                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:4281                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4281 </span>save_world      endp
<span style="color:black">DOSCODE:4281
DOSCODE:4282
DOSCODE:4282 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4282
DOSCODE:4282
DOSCODE:4282 </span>Get_User_Stack  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4282                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4287                 </span><span style="color:navy">lds     si, dword ptr </span>USER_SP
<span style="color:black">DOSCODE:428B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:428B </span>Get_User_Stack  endp
<span style="color:black">DOSCODE:428B
DOSCODE:428B </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:428C </span>ERRIN           <span style="color:navy">db </span><span style="color:#008040">2                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:428D                 </span><span style="color:navy">db </span><span style="color:#008040">6
</span><span style="color:gray">DOSCODE:428E                 </span><span style="color:navy">db </span><span style="color:#008040">12
</span><span style="color:gray">DOSCODE:428F                 </span><span style="color:navy">db </span><span style="color:#008040">4
</span><span style="color:gray">DOSCODE:4290                 </span><span style="color:navy">db </span><span style="color:#008040">8
</span><span style="color:gray">DOSCODE:4291                 </span><span style="color:navy">db </span><span style="color:#008040">0
</span><span style="color:gray">DOSCODE:4292 </span>ERROUT          <span style="color:navy">db </span><span style="color:#008040">80h
</span><span style="color:gray">DOSCODE:4293                 </span><span style="color:navy">db </span><span style="color:#008040">40h
</span><span style="color:gray">DOSCODE:4294                 </span><span style="color:navy">db </span><span style="color:#008040">2
</span><span style="color:gray">DOSCODE:4295                 </span><span style="color:navy">db </span><span style="color:#008040">10h
</span><span style="color:gray">DOSCODE:4296                 </span><span style="color:navy">db </span><span style="color:#008040">4
</span><span style="color:gray">DOSCODE:4297                 </span><span style="color:navy">db </span><span style="color:#008040">3
</span><span style="color:black">DOSCODE:4298
DOSCODE:4298 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4298
DOSCODE:4298
DOSCODE:4298 </span>AbsSetup        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4298                 </span><span style="color:navy">inc     ss:</span>INDOS
<span style="color:black">DOSCODE:429D                 </span><span style="color:navy">sti
</span><span style="color:black">DOSCODE:429E                 </span><span style="color:navy">cld
</span><span style="color:black">DOSCODE:429F                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:42A0                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:42A1                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:42A2                 </span><span style="color:navy">call    </span>GETBP
<span style="color:black">DOSCODE:42A5                 </span><span style="color:navy">jb      short </span><span style="color:gray">errdriv
</span><span style="color:black">DOSCODE:42A7                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:42AD
DOSCODE:42AD </span><span style="color:gray">errdriv</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:42AD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:42AE                 </span><span style="color:navy">jnb     short </span><span style="color:gray">AbsSetup2
</span><span style="color:black">DOSCODE:42B0
DOSCODE:42B0 </span><span style="color:gray">AbsSetup_retn</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:42B0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:42B1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:42B1
DOSCODE:42B1 </span><span style="color:gray">AbsSetup2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:42B1                 </span><span style="color:navy">mov     ss:</span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:42B8                 </span><span style="color:navy">call    </span>RW32_CONVERT
<span style="color:black">DOSCODE:42BB                 </span><span style="color:navy">jb      short </span><span style="color:gray">AbsSetup_retn
</span><span style="color:black">DOSCODE:42BD                 </span><span style="color:navy">call    </span>SET_RQ_SC_PARMS
<span style="color:black">DOSCODE:42C0                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:42C1                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:42C2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:42C3                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:42C4                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:42C5                 </span><span style="color:navy">mov     si, offset </span>OPENBUF
<span style="color:black">DOSCODE:42C8                 </span><span style="color:navy">mov     [si], al
</span><span style="color:black">DOSCODE:42CA                 </span><span style="color:navy">add     byte ptr [si], &#039;</span><span style="color:green">A&#039;
</span><span style="color:black">DOSCODE:42CD                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">1</span><span style="color:navy">], &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:42D2                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">300h
</span><span style="color:black">DOSCODE:42D5                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:42D6                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - CHECK DIRECT I/O
<span style="color:black">DOSCODE:42D6                                         </span>; DS:SI -&gt; ASCIZ disk device name (may be full path or only drive
<span style="color:black">DOSCODE:42D6                                         </span>; specifier--must include the colon)
<span style="color:black">DOSCODE:42D6                                         </span>; Return: CF clear if absolute disk access allowed
<span style="color:black">DOSCODE:42D8                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:42D9                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:42DA                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:42DB                 </span><span style="color:navy">jnb     short </span><span style="color:gray">AbsSetup_retn
</span><span style="color:black">DOSCODE:42DD                 </span><span style="color:navy">mov     ss:</span>EXTERR<span style="color:navy">, </span><span style="color:#ff8000">32h </span><span style="color:gray">; &#039;2&#039;
</span><span style="color:black">DOSCODE:42E4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:42E4 </span>AbsSetup        endp
<span style="color:black">DOSCODE:42E4
</span><span style="color:maroon">DOSCODE:42E5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:42E5
DOSCODE:42E5 </span>ABSDRD<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:42E5                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:42E6                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:42E7                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:42E9                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:42EE                 </span><span style="color:navy">mov     </span>TEMPSEG<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:42F1                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:42F2                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:42F3                 </span><span style="color:navy">mov     </span>AbsRdWr_SS<span style="color:navy">, ss
</span><span style="color:maroon">DOSCODE:42F7                 </span><span style="color:navy">mov     </span>AbsRdWr_SP<span style="color:navy">, sp
</span><span style="color:maroon">DOSCODE:42FB                 </span><span style="color:navy">mov     ss, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:4300                 </span><span style="color:navy">mov     sp, offset </span>DSKSTACK
<span style="color:maroon">DOSCODE:4303                 </span><span style="color:navy">mov     ds, </span>TEMPSEG
<span style="color:maroon">DOSCODE:4307                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:4308                 </span><span style="color:navy">call    </span>save_world
<span style="color:maroon">DOSCODE:430B                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:430C                 </span><span style="color:navy">call    </span>AbsSetup
<span style="color:maroon">DOSCODE:430F                 </span><span style="color:navy">jb      short </span>ILEAVE
<span style="color:maroon">DOSCODE:4311                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:4314                 </span><span style="color:navy">mov     ss:</span>CurSC_DRIVE<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:431A                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:431D                 </span><span style="color:navy">call    </span>DSKREAD
<span style="color:maroon">DOSCODE:4320                 </span><span style="color:navy">jnz     short </span>ERR_LEAVE
<span style="color:maroon">DOSCODE:4322                 </span><span style="color:navy">mov     cx, di
</span><span style="color:maroon">DOSCODE:4324                 </span><span style="color:navy">mov     ss:</span>TEMP_VAR2<span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:4329                 </span><span style="color:navy">mov     ss:</span>TEMP_VAR<span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:432E                 </span><span style="color:navy">call    </span>DskRdBufScan
<span style="color:maroon">DOSCODE:4331                 </span><span style="color:navy">jmp     short </span>ILEAVE
<span style="color:maroon">DOSCODE:4333 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4333
DOSCODE:4333 </span>TLEAVE<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4333                 </span><span style="color:navy">jz      short </span>ILEAVE
<span style="color:maroon">DOSCODE:4335
DOSCODE:4335 </span>ERR_LEAVE<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4335                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:4336                 </span><span style="color:navy">push    cs
</span><span style="color:maroon">DOSCODE:4337                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4338                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:433A                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:433D                 </span><span style="color:navy">mov     di, offset </span>ERRIN
<span style="color:maroon">DOSCODE:4340                 </span><span style="color:navy">repne scasb
</span><span style="color:maroon">DOSCODE:4342                 </span><span style="color:navy">jnz     short </span>LEAVECODE
<span style="color:maroon">DOSCODE:4344                 </span><span style="color:navy">mov     ah, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4348
DOSCODE:4348 </span>LEAVECODE<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4348                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4349                 </span><span style="color:navy">mov     ss:</span>AbsDskErr<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:434D                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:434E
DOSCODE:434E </span>ILEAVE<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:434E                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:434F                 </span><span style="color:navy">call    </span>restore_world
<span style="color:maroon">DOSCODE:4352                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4353                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:4354                 </span><span style="color:navy">mov     ax, ss:</span>AbsDskErr
<span style="color:maroon">DOSCODE:4358                 </span><span style="color:navy">dec     ss:</span>INDOS
<span style="color:maroon">DOSCODE:435D                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:435E                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:435F                 </span><span style="color:navy">mov     ss, es:</span>AbsRdWr_SS
<span style="color:maroon">DOSCODE:4364                 </span><span style="color:navy">mov     sp, es:</span>AbsRdWr_SP
<span style="color:maroon">DOSCODE:4369                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:436A                 </span><span style="color:navy">sti
</span><span style="color:maroon">DOSCODE:436B                 </span><span style="color:navy">retf
</span><span style="color:maroon">DOSCODE:436C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:436C
DOSCODE:436C </span>ABSDWRT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:436C                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:436D                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:436E                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:4370                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:4375                 </span><span style="color:navy">mov     </span>TEMPSEG<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:4378                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:4379                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:437A                 </span><span style="color:navy">mov     </span>AbsRdWr_SS<span style="color:navy">, ss
</span><span style="color:maroon">DOSCODE:437E                 </span><span style="color:navy">mov     </span>AbsRdWr_SP<span style="color:navy">, sp
</span><span style="color:maroon">DOSCODE:4382                 </span><span style="color:navy">mov     ss, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:4387                 </span><span style="color:navy">mov     sp, offset </span>DSKSTACK
<span style="color:maroon">DOSCODE:438A                 </span><span style="color:navy">mov     ds, </span>TEMPSEG
<span style="color:maroon">DOSCODE:438E                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:438F                 </span><span style="color:navy">call    </span>save_world
<span style="color:maroon">DOSCODE:4392                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:4393                 </span><span style="color:navy">call    </span>AbsSetup
<span style="color:maroon">DOSCODE:4396                 </span><span style="color:navy">jb      short </span>ILEAVE
<span style="color:maroon">DOSCODE:4398                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:439B                 </span><span style="color:navy">mov     ss:</span>CurSC_DRIVE<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:43A1                 </span><span style="color:navy">call    </span>Fastxxx_Purge
<span style="color:maroon">DOSCODE:43A4                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:43A7                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:43A8                 </span><span style="color:navy">call    </span>DskWrtBufPurge
<span style="color:maroon">DOSCODE:43AB                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:43AC                 </span><span style="color:navy">call    </span>DSKWRITE
<span style="color:maroon">DOSCODE:43AF                 </span><span style="color:navy">jmp     short </span>TLEAVE
<span style="color:maroon">DOSCODE:43B1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:43B1
DOSCODE:43B1 </span>GETBP<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:43B1                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:43B2                 </span><span style="color:navy">add     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:43B4                 </span><span style="color:navy">jb      short </span>SKIPGET
<span style="color:maroon">DOSCODE:43B6                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:maroon">DOSCODE:43B9                 </span><span style="color:navy">jnb     short </span>SKIPGET
<span style="color:maroon">DOSCODE:43BB                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:43BD                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">1Ah
</span><span style="color:maroon">DOSCODE:43C0                 </span><span style="color:navy">jz      short </span>SKIPGET
<span style="color:maroon">DOSCODE:43C2                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:43C3                 </span><span style="color:navy">mov     </span>EXTERR<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:43C6                 </span><span style="color:navy">mov     </span>AbsDskErr<span style="color:navy">, </span><span style="color:#ff8000">201h
</span><span style="color:maroon">DOSCODE:43CC
DOSCODE:43CC </span>SKIPGET<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:43CC                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:43CD                 </span><span style="color:navy">jnb     short </span>GETBP_@f
<span style="color:maroon">DOSCODE:43CF                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:43D0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:43D0
DOSCODE:43D0 </span>GETBP_@f<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:43D0                 </span><span style="color:navy">les     bp, </span>THISCDS
<span style="color:maroon">DOSCODE:43D4                 </span><span style="color:navy">test    word ptr es:[bp+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:maroon">DOSCODE:43DA                 </span><span style="color:navy">jz      short </span>GETBP_CDS
<span style="color:maroon">DOSCODE:43DC                 </span><span style="color:navy">mov     </span>EXTERR<span style="color:navy">, </span><span style="color:#ff8000">32h </span><span style="color:gray">; &#039;2&#039;
</span><span style="color:maroon">DOSCODE:43E2                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:43E3                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:43E4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:43E4
DOSCODE:43E4 </span>GETBP_CDS<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:43E4                 </span><span style="color:navy">les     bp, es:[bp+</span><span style="color:#ff8000">45h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:43E8
DOSCODE:43E8 </span>GOTDPB<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:43E8                 </span><span style="color:navy">mov     word ptr </span>THISDPB<span style="color:navy">, bp
</span><span style="color:maroon">DOSCODE:43EC                 </span><span style="color:navy">mov     word ptr </span>THISDPB<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:43F0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:43F1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:43F1 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $Extended_Open
</span><span style="color:black">DOSCODE:43F1
DOSCODE:43F1 </span>SYS_RET_OK<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:43F1                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:43F4                 </span><span style="color:navy">and     word ptr [si+</span><span style="color:#ff8000">16h</span><span style="color:navy">], </span><span style="color:green">0FFFEh
</span><span style="color:black">DOSCODE:43F8                 </span><span style="color:navy">jmp     short </span>DO_RET
<span style="color:black">DOSCODE:43F8 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $Extended_Open
</span><span style="color:black">DOSCODE:43FA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:43FA </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:black">DOSCODE:43FA
DOSCODE:43FA </span>SYS_RET_ERR<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:43FA                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:43FC                 </span><span style="color:navy">call    </span>ETAB_LK
<span style="color:black">DOSCODE:43FF                 </span><span style="color:navy">call    </span>ErrorMap
<span style="color:black">DOSCODE:4402
DOSCODE:4402 </span>From_GetSet<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4402                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:4405                 </span><span style="color:navy">or      word ptr [si+</span><span style="color:green">16h</span><span style="color:navy">], </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4409                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:440A
DOSCODE:440A </span>DO_RET<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:440A                 </span><span style="color:navy">mov     [si], ax
</span><span style="color:black">DOSCODE:440C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:440C </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:maroon">DOSCODE:440D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:440D
DOSCODE:440D </span>NO_OP<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:440D                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:440F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4410
DOSCODE:4410 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4410
DOSCODE:4410
DOSCODE:4410 </span>FCB_RET_ERR     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4410                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:4412                 </span><span style="color:navy">mov     ss:</span>EXTERR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:4416                 </span><span style="color:navy">call    </span>ErrorMap
<span style="color:black">DOSCODE:4419                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:441B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:441B </span>FCB_RET_ERR     endp
<span style="color:black">DOSCODE:441B
DOSCODE:441C
DOSCODE:441C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:441C
DOSCODE:441C
DOSCODE:441C </span>ErrorMap        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:441C                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:441D                 </span><span style="color:navy">mov     si, offset </span>ERR_TABLE_21
<span style="color:black">DOSCODE:4420                 </span><span style="color:navy">cmp     ss:</span>FAILERR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4426                 </span><span style="color:navy">jz      short </span><span style="color:gray">EXTENDED_NORMAL
</span><span style="color:black">DOSCODE:4428                 </span><span style="color:navy">mov     ss:</span>EXTERR<span style="color:navy">, </span><span style="color:#ff8000">53h </span><span style="color:gray">; &#039;S&#039;
</span><span style="color:black">DOSCODE:442F
DOSCODE:442F </span><span style="color:gray">EXTENDED_NORMAL</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:442F                 </span><span style="color:navy">call    </span>CAL_LK
<span style="color:black">DOSCODE:4432                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:4433                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4433 </span>ErrorMap        endp
<span style="color:black">DOSCODE:4433
DOSCODE:4434
DOSCODE:4434 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4434
DOSCODE:4434
DOSCODE:4434 </span>CAL_LK          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4434                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:4435                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:4436                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:4437                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:443C                 </span><span style="color:navy">mov     bx, </span>EXTERR
<span style="color:black">DOSCODE:4440
DOSCODE:4440 </span><span style="color:gray">TABLK1</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4440                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4441                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:4443                 </span><span style="color:navy">jz      short </span><span style="color:gray">GOT_VALS
</span><span style="color:black">DOSCODE:4445                 </span><span style="color:navy">cmp     al, bl
</span><span style="color:black">DOSCODE:4447                 </span><span style="color:navy">jz      short </span><span style="color:gray">GOT_VALS
</span><span style="color:black">DOSCODE:4449                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:444C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">TABLK1
</span><span style="color:black">DOSCODE:444E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:444E
DOSCODE:444E </span><span style="color:gray">GOT_VALS</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:444E                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:444F                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:4452                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_SET_ACT
</span><span style="color:black">DOSCODE:4454                 </span><span style="color:navy">mov     byte ptr </span>EXTERR_ACT_CLASS<span style="color:navy">, ah
</span><span style="color:black">DOSCODE:4458
DOSCODE:4458 </span><span style="color:gray">NO_SET_ACT</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4458                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:445A                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_SET_CLS
</span><span style="color:black">DOSCODE:445C                 </span><span style="color:navy">mov     byte ptr </span>EXTERR_ACT_CLASS<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, al
</span><span style="color:black">DOSCODE:445F
DOSCODE:445F </span><span style="color:gray">NO_SET_CLS</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:445F                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4460                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:4462                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_SET_LOC
</span><span style="color:black">DOSCODE:4464                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, al
</span><span style="color:black">DOSCODE:4467
DOSCODE:4467 </span><span style="color:gray">NO_SET_LOC</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4467                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:4468                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:4469                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:446A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:446A </span>CAL_LK          endp
<span style="color:black">DOSCODE:446A
DOSCODE:446B
DOSCODE:446B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:446B
DOSCODE:446B
DOSCODE:446B </span>ETAB_LK         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:446B                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:446C                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:446D                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:446E                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:446F                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:4470                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:4471                 </span><span style="color:navy">mov     </span>EXTERR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:4474                 </span><span style="color:navy">mov     si, offset </span>I21_MAP_E_TAB
<span style="color:black">DOSCODE:4477                 </span><span style="color:navy">mov     bh, al
</span><span style="color:black">DOSCODE:4479                 </span><span style="color:navy">mov     bl, byte ptr </span>USER_IN_AX<span style="color:navy">+</span><span style="color:green">1
</span><span style="color:black">DOSCODE:447D
DOSCODE:447D </span><span style="color:gray">TABLK2</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:447D                 </span><span style="color:navy">lods    word ptr cs:[si]
</span><span style="color:black">DOSCODE:447F                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:4481                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOT_IN_TABLE
</span><span style="color:black">DOSCODE:4483                 </span><span style="color:navy">cmp     al, bl
</span><span style="color:black">DOSCODE:4485                 </span><span style="color:navy">jz      short </span><span style="color:gray">GOT_CALL
</span><span style="color:black">DOSCODE:4487                 </span><span style="color:navy">xchg    ah, al
</span><span style="color:black">DOSCODE:4489                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:448B                 </span><span style="color:navy">add     si, ax
</span><span style="color:black">DOSCODE:448D                 </span><span style="color:navy">jmp     short </span><span style="color:gray">TABLK2
</span><span style="color:black">DOSCODE:448F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:448F
DOSCODE:448F </span><span style="color:gray">NOT_IN_TABLE</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:448F                 </span><span style="color:navy">mov     al, bh
</span><span style="color:black">DOSCODE:4491                 </span><span style="color:navy">jmp     short </span><span style="color:gray">NO_MAP
</span><span style="color:black">DOSCODE:4493 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4493
DOSCODE:4493 </span><span style="color:gray">GOT_CALL</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4493                 </span><span style="color:navy">mov     cl, ah
</span><span style="color:black">DOSCODE:4495                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:4497
DOSCODE:4497 </span><span style="color:gray">CHECK_CODE</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4497                 </span><span style="color:navy">lods    byte ptr cs:[si]
</span><span style="color:black">DOSCODE:4499                 </span><span style="color:navy">cmp     al, bh
</span><span style="color:black">DOSCODE:449B                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_MAP
</span><span style="color:black">DOSCODE:449D                 </span><span style="color:navy">loop    </span><span style="color:gray">CHECK_CODE
</span><span style="color:black">DOSCODE:449F
DOSCODE:449F </span><span style="color:gray">NO_MAP</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:449F                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:44A1                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:44A2                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:44A3                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:44A4                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:44A5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:44A5 </span>ETAB_LK         endp
<span style="color:black">DOSCODE:44A5
DOSCODE:44A6
DOSCODE:44A6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:44A6
DOSCODE:44A6
DOSCODE:44A6 </span>SetBad          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:44A6                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:44A9                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:44AA                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:44AF                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:44B4                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:44B5                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:44B6                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:44B6 </span>SetBad          endp
<span style="color:black">DOSCODE:44B6
DOSCODE:44B7
DOSCODE:44B7 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:44B7
DOSCODE:44B7
DOSCODE:44B7 </span>BadCall         proc far                <span style="color:green">; ...
</span><span style="color:black">DOSCODE:44B7                 </span><span style="color:navy">call    </span>SetBad
<span style="color:black">DOSCODE:44BA                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:44BA </span>BadCall         endp
<span style="color:black">DOSCODE:44BA
DOSCODE:44BB
DOSCODE:44BB </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:44BB
DOSCODE:44BB
DOSCODE:44BB </span>OKCall          proc far                <span style="color:green">; ...
</span><span style="color:black">DOSCODE:44BB                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:44BC                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:44BC </span>OKCall          endp
<span style="color:black">DOSCODE:44BC
</span><span style="color:maroon">DOSCODE:44BD </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:44BD
DOSCODE:44BD </span>INT2F<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44BD                 </span><span style="color:navy">sti
</span><span style="color:maroon">DOSCODE:44BE                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">11h         </span>; MultNET
<span style="color:maroon">DOSCODE:44C1                 </span><span style="color:navy">jnz     short </span>INT2FSHR
<span style="color:maroon">DOSCODE:44C3
DOSCODE:44C3 </span>TestInstall<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44C3                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:44C5                 </span><span style="color:navy">jz      short </span>Leave2F
<span style="color:maroon">DOSCODE:44C7
DOSCODE:44C7 </span>BadFunc<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44C7                 </span><span style="color:navy">call    </span>SetBad
<span style="color:maroon">DOSCODE:44CA
DOSCODE:44CA </span>Leave2F<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44CA                 </span><span style="color:navy">retf    </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:44CD </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:44CD
DOSCODE:44CD </span>INT2FSHR<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44CD                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">10h         </span>; MultSHARE
<span style="color:maroon">DOSCODE:44D0                 </span><span style="color:navy">jz      short </span>TestInstall
<span style="color:maroon">DOSCODE:44D2                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">14h         </span>; NLSFUNC
<span style="color:maroon">DOSCODE:44D5                 </span><span style="color:navy">jz      short </span>TestInstall
<span style="color:maroon">DOSCODE:44D7                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">12h         </span>; MultDOS
<span style="color:maroon">DOSCODE:44DA                 </span><span style="color:navy">jnz     short </span>check_win
<span style="color:maroon">DOSCODE:44DC                 </span><span style="color:navy">jmp     </span>DispatchDOS
<span style="color:maroon">DOSCODE:44DF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:44DF
DOSCODE:44DF </span>check_win<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44DF                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">16h
</span><span style="color:maroon">DOSCODE:44E2                 </span><span style="color:navy">jz      short </span>Win386_Msg
<span style="color:maroon">DOSCODE:44E4                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">46h </span><span style="color:gray">; &#039;F&#039;
</span><span style="color:maroon">DOSCODE:44E7                 </span><span style="color:navy">jnz     short </span>next_i2f
<span style="color:maroon">DOSCODE:44E9                 </span><span style="color:navy">jmp     </span>Winold_swap
<span style="color:maroon">DOSCODE:44EC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:44EC
DOSCODE:44EC </span>next_i2f<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44EC                 </span><span style="color:navy">jmp     far ptr </span><span style="background:blue"><span style="color:navy">70h:5</span></span>
<span style="color:maroon">DOSCODE:44F1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:44F1
DOSCODE:44F1 </span>Win386_Msg<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44F1                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:44F2                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:44F7                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:44F9                 </span><span style="color:navy">jnz     short </span>Win386_Msg_exit
<span style="color:maroon">DOSCODE:44FB                 </span><span style="color:navy">jmp     </span>OldWin386Init
<span style="color:maroon">DOSCODE:44FE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:44FE
DOSCODE:44FE </span>Win386_Msg_exit<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:44FE                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:4500                 </span><span style="color:navy">jnz     short </span>Win386_Msg_devcall
<span style="color:maroon">DOSCODE:4502                 </span><span style="color:navy">jmp     </span>Win386_Leaving
<span style="color:maroon">DOSCODE:4505 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4505
DOSCODE:4505 </span>Win386_Msg_devcall<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4505                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:4507                 </span><span style="color:navy">jnz     short </span>Win386_Msg_init
<span style="color:maroon">DOSCODE:4509                 </span><span style="color:navy">jmp     </span>Win386_Query
<span style="color:maroon">DOSCODE:450C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:450C
DOSCODE:450C </span>Win386_Msg_init<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:450C                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:450E                 </span><span style="color:navy">jz      short </span>Win386_Starting
<span style="color:maroon">DOSCODE:4510                 </span><span style="color:navy">jmp     </span>win_nexti2f
<span style="color:maroon">DOSCODE:4513 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4513
DOSCODE:4513 </span>Win386_Starting<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4513                 </span><span style="color:navy">test    dx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4517                 </span><span style="color:navy">jz      short </span>Win386_vchk
<span style="color:maroon">DOSCODE:4519                 </span><span style="color:navy">jmp     </span>win_nexti2f
<span style="color:maroon">DOSCODE:451C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:451C
DOSCODE:451C </span>Win386_vchk<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:451C                 </span><span style="color:navy">mov     word ptr </span>Win386_Info_6<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4522                 </span><span style="color:navy">mov     word ptr </span>Win386_Info_6<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4528                 </span><span style="color:navy">cmp     di, </span><span style="color:green">30Ah
</span><span style="color:maroon">DOSCODE:452C                 </span><span style="color:navy">jb      short </span>Win386_vxd
<span style="color:maroon">DOSCODE:452E                 </span><span style="color:navy">jmp     </span>noVxD31
<span style="color:maroon">DOSCODE:4531 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4531
DOSCODE:4531 </span>Win386_vxd<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4531                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:4532                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:4533                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:4534                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:4535                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:4536                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:4537                 </span><span style="color:navy">mov     bx, </span>UMB_HEAD
<span style="color:maroon">DOSCODE:453B                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:453E                 </span><span style="color:navy">jz      short </span>Vxd31
<span style="color:maroon">DOSCODE:4540                 </span><span style="color:navy">mov     </span>UmbSaveFlag<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4545                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:4546                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:4547                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:4549                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:454B                 </span><span style="color:navy">mov     ds, bx
</span><span style="color:maroon">DOSCODE:454D                 </span>assume ds:nothing
<span style="color:maroon">DOSCODE:454D                 </span><span style="color:navy">xor     si, si
</span><span style="color:maroon">DOSCODE:454F                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:4550                 </span><span style="color:navy">mov     di, offset </span>UmbSave1
<span style="color:maroon">DOSCODE:4553                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:maroon">DOSCODE:4556                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:4558                 </span><span style="color:navy">mov     di, offset </span>UmbSave2
<span style="color:maroon">DOSCODE:455B                 </span><span style="color:navy">mov     cx, </span><span style="color:green">5
</span><span style="color:maroon">DOSCODE:455E                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:4560                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4561                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4562                 </span>assume ds:DOSDATA
<span style="color:maroon">DOSCODE:4562
DOSCODE:4562 </span>Vxd31<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4562                 </span><span style="color:navy">test    </span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:4567                 </span><span style="color:navy">jz      short </span>Dont_Supress
<span style="color:maroon">DOSCODE:4569                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:456A                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:456B                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:456C                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:456D                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:456E                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:456F                 </span><span style="color:navy">jmp     short </span>noVxD31
<span style="color:maroon">DOSCODE:4571 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4571
DOSCODE:4571 </span>Dont_Supress<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4571                 </span><span style="color:navy">mov     al, </span>BOOTDRIVE
<span style="color:maroon">DOSCODE:4574                 </span><span style="color:navy">add     al, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;
</span><span style="color:maroon">DOSCODE:4576                 </span><span style="color:navy">mov     byte ptr </span>VxDpath<span style="color:navy">, al </span><span style="color:gray">; &quot;c:\\wina20.386&quot;
</span><span style="color:maroon">DOSCODE:4579                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">6Ch </span><span style="color:gray">; &#039;l&#039;
</span><span style="color:maroon">DOSCODE:457B                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:457D                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">2080h
</span><span style="color:maroon">DOSCODE:4580                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:4583                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4586                 </span><span style="color:navy">mov     si, offset </span>VxDpath <span style="color:gray">; &quot;c:\\wina20.386&quot;
</span><span style="color:maroon">DOSCODE:4589                 </span><span style="color:navy">mov     di, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:458C                 </span><span style="color:navy">int     </span><span style="color:green">21h             </span>; DOS - 4.0 - EXTENDED OPEN/CREATE
<span style="color:maroon">DOSCODE:458C                                         </span>; BL = open mode as in AL for normal open (INT 21h/AH=3Dh)
<span style="color:maroon">DOSCODE:458C                                         </span>; BH = flags, CX = create attribute, DL = action if file exists/does not exists
<span style="color:maroon">DOSCODE:458C                                         </span>; DH = 00h (reserved), DS:SI -&gt; ASCIZ file name
<span style="color:maroon">DOSCODE:458E                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:458F                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:4590                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:4591                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:4592                 </span><span style="color:navy">jnb     short </span>VxDthere
<span style="color:maroon">DOSCODE:4594                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:4595                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:4596                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:4597                 </span><span style="color:navy">mov     si, offset </span>NoVxDErrMsg <span style="color:gray">; &quot;You must have the file WINA20.386 in th&quot;...
</span><span style="color:maroon">DOSCODE:459A                 </span><span style="color:navy">push    cs
</span><span style="color:maroon">DOSCODE:459B                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:459C                 </span><span style="color:navy">mov     cx, </span><span style="color:green">99
</span><span style="color:maroon">DOSCODE:459F                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:45A1                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:45A2
DOSCODE:45A2 </span>vxdlp<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:45A2                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:45A3                 </span><span style="color:navy">xchg    dl, al
</span><span style="color:maroon">DOSCODE:45A5                 </span><span style="color:navy">int     </span><span style="color:green">21h             </span>; DOS -
<span style="color:maroon">DOSCODE:45A7                 </span><span style="color:navy">loop    </span>vxdlp
<span style="color:maroon">DOSCODE:45A9                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:45AA                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:45AB                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:45AC                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:45AD                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:45AE                 </span><span style="color:navy">inc     cx
</span><span style="color:maroon">DOSCODE:45AF                 </span><span style="color:navy">jmp     </span>win_nexti2f
<span style="color:maroon">DOSCODE:45B2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:45B2
DOSCODE:45B2 </span>VxDthere<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:45B2                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:maroon">DOSCODE:45B4                 </span><span style="color:navy">mov     ah, </span><span style="color:green">3Eh
</span><span style="color:maroon">DOSCODE:45B6                 </span><span style="color:navy">int     </span><span style="color:green">21h             </span>; DOS - 2+ - CLOSE A FILE WITH HANDLE
<span style="color:maroon">DOSCODE:45B6                                         </span>; BX = file handle
<span style="color:maroon">DOSCODE:45B8                 </span><span style="color:navy">mov     bx, offset </span>Win386_Info
<span style="color:maroon">DOSCODE:45BB                 </span><span style="color:navy">mov     word ptr [bx+</span><span style="color:#ff8000">6</span><span style="color:navy">], offset </span>VxDpath <span style="color:gray">; &quot;c:\\wina20.386&quot;
</span><span style="color:maroon">DOSCODE:45C0                 </span><span style="color:navy">mov     word ptr [bx+</span><span style="color:#ff8000">8</span><span style="color:navy">], ds
</span><span style="color:maroon">DOSCODE:45C3                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:45C4                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:45C5
DOSCODE:45C5 </span>noVxD31<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:45C5                 </span><span style="color:navy">or      </span>IsWin386<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:45CA                 </span><span style="color:navy">or      </span>redir_patch<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:45CF                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:45D0                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:maroon">DOSCODE:45D2                 </span><span style="color:navy">mov     bx, offset </span>Win386_Info
<span style="color:maroon">DOSCODE:45D5                 </span><span style="color:navy">mov     [bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:45D8                 </span><span style="color:navy">mov     word ptr [bx+</span><span style="color:#ff8000">4</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:45DB                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:45DC                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:45DD                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:45DE                 </span><span style="color:navy">jmp     </span>win_nexti2f
<span style="color:maroon">DOSCODE:45E1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:45E1
DOSCODE:45E1 </span>Win386_Leaving<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:45E1                 </span><span style="color:navy">test    dx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:45E5                 </span><span style="color:navy">jz      short </span>Win386_Leaving_c
<span style="color:maroon">DOSCODE:45E7                 </span><span style="color:navy">jmp     </span>win_nexti2f
<span style="color:maroon">DOSCODE:45EA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:45EA
DOSCODE:45EA </span>Win386_Leaving_c<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:45EA                 </span><span style="color:navy">cmp     </span>UmbSaveFlag<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:45EF                 </span><span style="color:navy">jnz     short </span>noumb
<span style="color:maroon">DOSCODE:45F1                 </span><span style="color:navy">mov     </span>UmbSaveFlag<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:45F6                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:45F7                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:45F8                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:45F9                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:45FA                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:45FB                 </span><span style="color:navy">mov     ax, </span>UMB_HEAD
<span style="color:maroon">DOSCODE:45FE                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:4600                 </span><span style="color:navy">xor     di, di
</span><span style="color:maroon">DOSCODE:4602                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:4603                 </span><span style="color:navy">mov     si, offset </span>UmbSave1
<span style="color:maroon">DOSCODE:4606                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:maroon">DOSCODE:4609                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:460B                 </span><span style="color:navy">mov     si, offset </span>UmbSave2
<span style="color:maroon">DOSCODE:460E                 </span><span style="color:navy">mov     cx, </span><span style="color:green">5
</span><span style="color:maroon">DOSCODE:4611                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:4613                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:4614                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:4615                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:4616                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4617                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:4618
DOSCODE:4618 </span>noumb<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4618                 </span><span style="color:navy">and     </span>IsWin386<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:461D                 </span><span style="color:navy">and     </span>redir_patch<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:4622                 </span><span style="color:navy">jmp     short </span>win_nexti2f
<span style="color:maroon">DOSCODE:4624 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4624
DOSCODE:4624 </span>Win386_Query<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4624                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">15h
</span><span style="color:maroon">DOSCODE:4627                 </span><span style="color:navy">jnz     short </span>win_nexti2f
<span style="color:maroon">DOSCODE:4629                 </span><span style="color:navy">or      cx, cx
</span><span style="color:maroon">DOSCODE:462B                 </span><span style="color:navy">jnz     short </span>dosmgr_func
<span style="color:maroon">DOSCODE:462D                 </span><span style="color:navy">inc     cx
</span><span style="color:maroon">DOSCODE:462E                 </span><span style="color:navy">mov     bx, offset </span>Win386_DOSVars
<span style="color:maroon">DOSCODE:4631                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:4632                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4633                 </span><span style="color:navy">jmp     short </span>PopIret
<span style="color:maroon">DOSCODE:4635 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4635
DOSCODE:4635 </span>OldWin386Init<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4635                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:4636                 </span><span style="color:navy">mov     si, offset </span>OldInstanceJunk
<span style="color:maroon">DOSCODE:4639                 </span><span style="color:navy">mov     ax, </span><span style="color:green">5248h
</span><span style="color:maroon">DOSCODE:463C                 </span><span style="color:navy">jmp     </span>next_i2f
<span style="color:maroon">DOSCODE:463F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:463F
DOSCODE:463F </span>dosmgr_func<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:463F                 </span><span style="color:navy">dec     cx
</span><span style="color:maroon">DOSCODE:4640                 </span><span style="color:navy">jz      short </span>win386_patch
<span style="color:maroon">DOSCODE:4642                 </span><span style="color:navy">dec     cx
</span><span style="color:maroon">DOSCODE:4643                 </span><span style="color:navy">jz      short </span>PopIret
<span style="color:maroon">DOSCODE:4645                 </span><span style="color:navy">dec     cx
</span><span style="color:maroon">DOSCODE:4646                 </span><span style="color:navy">jz      short </span>win386_size
<span style="color:maroon">DOSCODE:4648                 </span><span style="color:navy">dec     cx
</span><span style="color:maroon">DOSCODE:4649                 </span><span style="color:navy">jz      short </span>win386_inst
<span style="color:maroon">DOSCODE:464B                 </span><span style="color:navy">dec     cx
</span><span style="color:maroon">DOSCODE:464C                 </span><span style="color:navy">jnz     short </span>PopIret
<span style="color:maroon">DOSCODE:464E                 </span><span style="color:navy">mov     ax, es
</span><span style="color:maroon">DOSCODE:4650                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:4651                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:4652                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:4654                 </span><span style="color:navy">cmp     byte ptr es:[di], &#039;</span><span style="color:green">D&#039;
</span><span style="color:maroon">DOSCODE:4658                 </span><span style="color:navy">jnz     short </span>cantsize
<span style="color:maroon">DOSCODE:465A                 </span><span style="color:navy">inc     ax
</span><span style="color:maroon">DOSCODE:465B                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">1</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:465F                 </span><span style="color:navy">jnz     short </span>cantsize
<span style="color:maroon">DOSCODE:4661                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">3</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4665                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4666                 </span><span style="color:navy">mov     bx, </span><span style="color:green">16
</span><span style="color:maroon">DOSCODE:4669                 </span><span style="color:navy">mul     bx
</span><span style="color:maroon">DOSCODE:466B                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:maroon">DOSCODE:466D                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:maroon">DOSCODE:466F                 </span><span style="color:navy">jmp     short </span>win386_done
<span style="color:maroon">DOSCODE:4671 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4671
DOSCODE:4671 </span>cantsize<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4671                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4672                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:4674                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:maroon">DOSCODE:4676                 </span><span style="color:navy">jmp     short </span>PopIret
<span style="color:maroon">DOSCODE:4678 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4678
DOSCODE:4678 </span>win386_patch<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4678                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:maroon">DOSCODE:467A                 </span><span style="color:navy">jmp     short </span>win386_done
<span style="color:maroon">DOSCODE:467C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:467C
DOSCODE:467C </span>win386_size<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:467C                 </span><span style="color:navy">test    dx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4680                 </span><span style="color:navy">jz      short </span>PopIret
<span style="color:maroon">DOSCODE:4682                 </span><span style="color:navy">mov     cx, </span><span style="color:green">88
</span><span style="color:maroon">DOSCODE:4685                 </span><span style="color:navy">jmp     short </span>win386_done
<span style="color:maroon">DOSCODE:4687 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4687
DOSCODE:4687 </span>win386_inst<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4687                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:maroon">DOSCODE:4689                 </span><span style="color:navy">jmp     short </span>PopIret
<span style="color:maroon">DOSCODE:468B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:468B
DOSCODE:468B </span>win386_done<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:468B                 </span><span style="color:navy">mov     ax, </span><span style="color:green">0B97Ch
</span><span style="color:maroon">DOSCODE:468E                 </span><span style="color:navy">mov     dx, </span><span style="color:green">0A2ABh
</span><span style="color:maroon">DOSCODE:4691
DOSCODE:4691 </span>PopIret<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4691                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4692                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:4693 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4693
DOSCODE:4693 </span>win_nexti2f<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4693                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4694                 </span><span style="color:navy">jmp     </span>next_i2f
<span style="color:black">DOSCODE:4697
DOSCODE:4697 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4697
DOSCODE:4697
DOSCODE:4697 </span>getwinlast      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4697                 </span><span style="color:navy">mov     si, </span>CurrentPDB
<span style="color:black">DOSCODE:469B                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:469C                 </span><span style="color:navy">mov     es, si
</span><span style="color:black">DOSCODE:469E                 </span><span style="color:navy">add     si, word ptr es:byte_0+</span><span style="color:green">3
</span><span style="color:black">DOSCODE:46A3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:46A3 </span>getwinlast      endp
<span style="color:black">DOSCODE:46A3
</span><span style="color:maroon">DOSCODE:46A4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:46A4
DOSCODE:46A4 </span>Winold_swap<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:46A4                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:46A5                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:46A6                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:46A7                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:46A8                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:46A9                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:46AE                 </span><span style="color:navy">cmp     al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:46B0                 </span><span style="color:navy">jnz     short </span>swapin
<span style="color:maroon">DOSCODE:46B2                 </span><span style="color:navy">call    </span>getwinlast
<span style="color:maroon">DOSCODE:46B5                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:46B6                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:46B7                 </span><span style="color:navy">mov     ds, si
</span><span style="color:maroon">DOSCODE:46B9                 </span><span style="color:navy">xor     si, si
</span><span style="color:maroon">DOSCODE:46BB                 </span><span style="color:navy">mov     di, offset </span>WinoldPatch1
<span style="color:maroon">DOSCODE:46BE                 </span><span style="color:navy">mov     cx, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:46C1                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:46C2                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:46C3                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:46C5                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:46C6                 </span><span style="color:navy">mov     di, offset </span>WinoldPatch2
<span style="color:maroon">DOSCODE:46C9                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:46CB                 </span><span style="color:navy">jmp     short </span>winold_done
<span style="color:maroon">DOSCODE:46CD </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:46CD
DOSCODE:46CD </span>swapin<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:46CD                 </span><span style="color:navy">cmp     al, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:46CF                 </span><span style="color:navy">jnz     short </span>winold_done
<span style="color:maroon">DOSCODE:46D1                 </span><span style="color:navy">call    </span>getwinlast
<span style="color:maroon">DOSCODE:46D4                 </span><span style="color:navy">mov     es, si
</span><span style="color:maroon">DOSCODE:46D6                 </span><span style="color:navy">xor     di, di
</span><span style="color:maroon">DOSCODE:46D8                 </span><span style="color:navy">mov     si, offset </span>WinoldPatch1
<span style="color:maroon">DOSCODE:46DB                 </span><span style="color:navy">mov     cx, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:46DE                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:46DF                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:46E0                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:46E2                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:46E3                 </span><span style="color:navy">mov     si, offset </span>WinoldPatch2
<span style="color:maroon">DOSCODE:46E6                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:46E8
DOSCODE:46E8 </span>winold_done<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:46E8                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:46E9                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:46EA                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:46EB                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:46EC                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:46ED                 </span><span style="color:navy">jmp     </span>next_i2f
<span style="color:maroon">DOSCODE:46F0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:46F0
DOSCODE:46F0 </span>DispatchDOS<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:46F0                 </span><span style="color:navy">push    cs:</span>FOO
<span style="color:maroon">DOSCODE:46F5                 </span><span style="color:navy">push    cs:</span>DTab
<span style="color:maroon">DOSCODE:46FA                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:46FB                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:46FC                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:maroon">DOSCODE:46FE                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4701                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:4702                 </span><span style="color:navy">call    </span>TableDispatch
<span style="color:maroon">DOSCODE:4705                 </span><span style="color:navy">jmp     </span>BadFunc
<span style="color:maroon">DOSCODE:4708 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4708
DOSCODE:4708 </span>DOSGetGroup<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4708                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:470D                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:470E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:470E
DOSCODE:470E </span>DOSInstall<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:470E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4710                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4711
DOSCODE:4711 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4711
DOSCODE:4711
DOSCODE:4711 </span>RW32_CONVERT    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4711                 </span><span style="color:navy">cmp     cx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:4714                 </span><span style="color:navy">jz      short </span><span style="color:gray">new32format
</span><span style="color:black">DOSCODE:4716                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:4717                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:4718                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:471C                 </span><span style="color:navy">mov     dl, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4720                 </span><span style="color:navy">cmp     dl, </span><span style="color:#ff8000">0FEh </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:4723                 </span><span style="color:navy">jz      short </span><span style="color:gray">letold
</span><span style="color:black">DOSCODE:4725                 </span><span style="color:navy">inc     dl
</span><span style="color:black">DOSCODE:4727                 </span><span style="color:navy">xor     dh, dh
</span><span style="color:black">DOSCODE:4729                 </span><span style="color:navy">mul     dx
</span><span style="color:black">DOSCODE:472B                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:472D
DOSCODE:472D </span><span style="color:gray">letold</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:472D                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:472E                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:472F                 </span><span style="color:navy">jz      short </span><span style="color:gray">old_style
</span><span style="color:black">DOSCODE:4731                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:4732                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4737                 </span><span style="color:navy">mov     </span>AbsDskErr<span style="color:navy">, </span><span style="color:#ff8000">207h
</span><span style="color:black">DOSCODE:473D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:473E                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:473F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4740 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4740
DOSCODE:4740 </span><span style="color:gray">new32format</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4740                 </span><span style="color:navy">mov     dx, [bx+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4743                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:4744                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4749                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:474D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:474E                 </span><span style="color:navy">mov     dx, [bx]
</span><span style="color:black">DOSCODE:4750                 </span><span style="color:navy">mov     cx, [bx+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4753                 </span><span style="color:navy">lds     bx, [bx+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4756
DOSCODE:4756 </span><span style="color:gray">old_style</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4756                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:4757                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4757 </span>RW32_CONVERT    endp
<span style="color:black">DOSCODE:4757
DOSCODE:4758
DOSCODE:4758 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4758
DOSCODE:4758
DOSCODE:4758 </span>Fastxxx_Purge   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4758                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:4759                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:475A                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:475B                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:475C                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4761                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:4766                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:4767                 </span><span style="color:navy">jz      short </span><span style="color:gray">nofast
</span><span style="color:black">DOSCODE:4769                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:476B                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:476D                 </span><span style="color:navy">mov     dl, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4771                 </span><span style="color:navy">call    </span>Fast_Dispatch
<span style="color:black">DOSCODE:4774
DOSCODE:4774 </span><span style="color:gray">nofast</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4774                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:4775                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:4776                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:4777                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4777 </span>Fastxxx_Purge   endp
<span style="color:black">DOSCODE:4777
DOSCODE:4777 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:4778 </span>DIVMES          <span style="color:navy">db </span><span style="color:green">0Dh</span><span style="color:navy">,</span><span style="color:green">0Ah              </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:4778                 </span><span style="color:navy">db &#039;Divide overflow&#039;,0Dh,0Ah
</span><span style="color:gray">DOSCODE:478B </span>DivMesLen       <span style="color:navy">dw </span><span style="color:#008040">19                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:478D </span>NoVxDErrMsg     <span style="color:navy">db &#039;You must have the file WINA20.386 in the root of your boot drive&#039;,0Dh </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:478D                 </span><span style="color:navy">db </span><span style="color:green">0Ah
</span><span style="color:gray">DOSCODE:478D                 </span><span style="color:navy">db &#039;to run Windows in Enhanced Mode&#039;,0Dh,0Ah
</span><span style="color:gray">DOSCODE:47F0 </span>NLS_YES         <span style="color:navy">db &#039;</span><span style="color:green">Y&#039;                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:47F1 </span>NLS_NO          <span style="color:navy">db &#039;</span><span style="color:green">N&#039;                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:47F2 </span>NLS_yes2        <span style="color:navy">db &#039;</span><span style="color:green">y&#039;                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:47F3 </span>NLS_no2         <span style="color:navy">db &#039;</span><span style="color:green">n&#039;                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:47F4 </span>CANCHAR         <span style="color:navy">db </span><span style="color:#008040">1Bh                  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:47F5 </span>ESCCHAR         <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:47F6 </span>ESCTAB          <span style="color:navy">db </span><span style="color:#008040">64</span><span style="color:navy">, </span><span style="color:#008040">77</span><span style="color:navy">, </span><span style="color:#008040">59</span><span style="color:navy">, </span><span style="color:#008040">83</span><span style="color:navy">, </span><span style="color:#008040">60</span><span style="color:navy">, </span><span style="color:#008040">62</span><span style="color:navy">, </span><span style="color:#008040">61 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:47F6                 </span><span style="color:navy">db </span><span style="color:#008040">61</span><span style="color:navy">, </span><span style="color:#008040">63</span><span style="color:navy">, </span><span style="color:#008040">75</span><span style="color:navy">, </span><span style="color:#008040">82</span><span style="color:navy">, </span><span style="color:#008040">82</span><span style="color:navy">, </span><span style="color:#008040">65</span><span style="color:navy">, </span><span style="color:#008040">65
</span><span style="color:gray">DOSCODE:4804 </span>ESCFUNC         <span style="color:navy">dw offset </span>GETCH         <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:4806                 </span><span style="color:navy">dw offset </span>TWOESC
<span style="color:gray">DOSCODE:4808                 </span><span style="color:navy">dw offset </span>EXITINS_ENTERINS
<span style="color:gray">DOSCODE:480A                 </span><span style="color:navy">dw offset </span>EXITINS_ENTERINS
<span style="color:gray">DOSCODE:480C                 </span><span style="color:navy">dw offset </span>BACKSP
<span style="color:gray">DOSCODE:480E                 </span><span style="color:navy">dw offset </span>REEDIT
<span style="color:gray">DOSCODE:4810                 </span><span style="color:navy">dw offset </span>KILNEW
<span style="color:gray">DOSCODE:4812                 </span><span style="color:navy">dw offset </span>COPYLIN
<span style="color:gray">DOSCODE:4814                 </span><span style="color:navy">dw offset </span>SKIPSTR
<span style="color:gray">DOSCODE:4816                 </span><span style="color:navy">dw offset </span>COPYSTR
<span style="color:gray">DOSCODE:4818                 </span><span style="color:navy">dw offset </span>SKIPONE
<span style="color:gray">DOSCODE:481A                 </span><span style="color:navy">dw offset </span>COPYONE
<span style="color:gray">DOSCODE:481C                 </span><span style="color:navy">dw offset </span>COPYONE
<span style="color:gray">DOSCODE:481E                 </span><span style="color:navy">dw offset </span>CTRLZ
<span style="color:black">DOSCODE:4820 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4820 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:black">DOSCODE:4820
DOSCODE:4820 </span><span style="color:gray">OEMFunctionKey</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4820                 </span><span style="color:navy">call    </span>$STD_CON_INPUT_NO_ECHO
<span style="color:black">DOSCODE:4823                 </span><span style="color:navy">mov     cl, </span><span style="color:green">14
</span><span style="color:black">DOSCODE:4825                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:4826                 </span><span style="color:navy">mov     di, offset </span>ESCTAB
<span style="color:black">DOSCODE:4829                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:482A                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:482B                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:482C                 </span><span style="color:navy">repne scasb
</span><span style="color:black">DOSCODE:482E                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:482F                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:4830                 </span><span style="color:navy">shl     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4832                 </span><span style="color:navy">mov     bp, cx
</span><span style="color:black">DOSCODE:4834                 </span><span style="color:navy">jmp     cs:</span>ESCFUNC<span style="color:navy">[bp]
</span><span style="color:black">DOSCODE:4834 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:maroon">DOSCODE:4839 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4839
DOSCODE:4839 </span>$GET_DATE<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4839                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:483A                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:483B                 </span><span style="color:navy">call    </span>READTIME
<span style="color:maroon">DOSCODE:483E                 </span><span style="color:navy">mov     ax, </span>YEAR
<span style="color:maroon">DOSCODE:4841                 </span><span style="color:navy">mov     bx, word ptr </span>DAY
<span style="color:maroon">DOSCODE:4845                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4848                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:484B                 </span><span style="color:navy">add     ax, </span><span style="color:green">1980
</span><span style="color:maroon">DOSCODE:484E                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:4851                 </span><span style="color:navy">mov     al, ss:</span>WEEKDAY
<span style="color:maroon">DOSCODE:4855
DOSCODE:4855 </span>_RET24<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4855                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4856 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4856
DOSCODE:4856 </span>$SET_DATE<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4856                 </span><span style="color:navy">mov     al, -</span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4858                 </span><span style="color:navy">sub     cx, </span><span style="color:green">1980
</span><span style="color:maroon">DOSCODE:485C                 </span><span style="color:navy">jb      short </span>_RET24
<span style="color:maroon">DOSCODE:485E                 </span><span style="color:navy">cmp     cx, </span><span style="color:green">119
</span><span style="color:maroon">DOSCODE:4861                 </span><span style="color:navy">ja      short </span>RET24
<span style="color:maroon">DOSCODE:4863                 </span><span style="color:navy">or      dh, dh
</span><span style="color:maroon">DOSCODE:4865                 </span><span style="color:navy">jz      short </span>_RET24
<span style="color:maroon">DOSCODE:4867                 </span><span style="color:navy">or      dl, dl
</span><span style="color:maroon">DOSCODE:4869                 </span><span style="color:navy">jz      short </span>_RET24
<span style="color:maroon">DOSCODE:486B                 </span><span style="color:navy">cmp     dh, </span><span style="color:green">12
</span><span style="color:maroon">DOSCODE:486E                 </span><span style="color:navy">ja      short </span>RET24
<span style="color:maroon">DOSCODE:4870                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4871                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4872                 </span><span style="color:navy">call    </span>DODATE
<span style="color:maroon">DOSCODE:4875
DOSCODE:4875 </span>RET24<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4875                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4876 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4876
DOSCODE:4876 </span>$GET_TIME<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4876                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4877                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4878                 </span><span style="color:navy">call    </span>READTIME
<span style="color:maroon">DOSCODE:487B                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:487E                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:4881                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:4884                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:4886
DOSCODE:4886 </span>RET26<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4886                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4887 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4887
DOSCODE:4887 </span>$SET_TIME<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4887                 </span><span style="color:navy">mov     al, -</span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4889                 </span><span style="color:navy">cmp     ch, </span><span style="color:green">24
</span><span style="color:maroon">DOSCODE:488C                 </span><span style="color:navy">jnb     short </span>RET26
<span style="color:maroon">DOSCODE:488E                 </span><span style="color:navy">cmp     cl, </span><span style="color:green">60
</span><span style="color:maroon">DOSCODE:4891                 </span><span style="color:navy">jnb     short </span>RET26
<span style="color:maroon">DOSCODE:4893                 </span><span style="color:navy">cmp     dh, </span><span style="color:green">60
</span><span style="color:maroon">DOSCODE:4896                 </span><span style="color:navy">jnb     short </span>RET26
<span style="color:maroon">DOSCODE:4898                 </span><span style="color:navy">cmp     dl, </span><span style="color:green">100
</span><span style="color:maroon">DOSCODE:489B                 </span><span style="color:navy">jnb     short </span>RET26
<span style="color:maroon">DOSCODE:489D                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:489E                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:489F                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:48A0                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:48A1                 </span><span style="color:navy">mov     bx, offset </span>TIMEBUF
<span style="color:maroon">DOSCODE:48A4                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:48A7                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:maroon">DOSCODE:48A9                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:maroon">DOSCODE:48AB                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:48AC                 </span><span style="color:navy">call    </span>SETREAD
<span style="color:maroon">DOSCODE:48AF                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:48B0                 </span><span style="color:navy">lds     si, </span>BCLOCK
<span style="color:maroon">DOSCODE:48B4                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:maroon">DOSCODE:48B7                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:48B8                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:48B9                 </span><span style="color:navy">call    </span>SETWRITE
<span style="color:maroon">DOSCODE:48BC                 </span><span style="color:navy">pop     </span>TIMEBUF<span style="color:navy">+</span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:48C0                 </span><span style="color:navy">pop     </span>TIMEBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:48C4                 </span><span style="color:navy">lds     si, </span>BCLOCK
<span style="color:maroon">DOSCODE:48C8                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:maroon">DOSCODE:48CB                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:48CD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:48CE
DOSCODE:48CE </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:48CE
DOSCODE:48CE
DOSCODE:48CE </span>DATE16          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:48CE                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:48D3                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:48D4                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:48D5                 </span><span style="color:navy">call    </span>READTIME
<span style="color:black">DOSCODE:48D8                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:48D9                 </span><span style="color:navy">shl     cl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:48DB                 </span><span style="color:navy">shl     cl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:48DD                 </span><span style="color:navy">shl     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:48DF                 </span><span style="color:navy">shl     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:48E1                 </span><span style="color:navy">shl     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:48E3                 </span><span style="color:navy">shr     dh, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:48E5                 </span><span style="color:navy">or      cl, dh
</span><span style="color:black">DOSCODE:48E7                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:48E9                 </span><span style="color:navy">mov     ax, word ptr </span>MONTH
<span style="color:black">DOSCODE:48EC                 </span><span style="color:navy">mov     cl, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:48EE                 </span><span style="color:navy">shl     al, cl
</span><span style="color:black">DOSCODE:48F0                 </span><span style="color:navy">shl     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:48F2                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:48F3                 </span><span style="color:navy">or      al, </span>DAY
<span style="color:black">DOSCODE:48F7
DOSCODE:48F7 </span>RET21<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:48F7                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:48F7 </span>DATE16          endp
<span style="color:black">DOSCODE:48F7
DOSCODE:48F8
DOSCODE:48F8 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:48F8
DOSCODE:48F8
DOSCODE:48F8 </span>READTIME        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:48F8                 </span><span style="color:navy">mov     </span>DATE_FLAG<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:48FE                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:48FF                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:4900                 </span><span style="color:navy">mov     bx, offset </span>TIMEBUF
<span style="color:black">DOSCODE:4903                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:4906                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:4908                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:490A                 </span><span style="color:navy">call    </span>SETREAD
<span style="color:black">DOSCODE:490D                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:490E                 </span><span style="color:navy">lds     si, </span>BCLOCK
<span style="color:black">DOSCODE:4912                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:4915                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:4916                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:4917                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:4918                 </span><span style="color:navy">mov     ax, </span>TIMEBUF
<span style="color:black">DOSCODE:491B                 </span><span style="color:navy">mov     cx, </span>TIMEBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:491F                 </span><span style="color:navy">mov     dx, </span>TIMEBUF<span style="color:navy">+</span><span style="color:green">4
</span><span style="color:black">DOSCODE:4923                 </span><span style="color:navy">cmp     ax, </span>DAYCNT
<span style="color:black">DOSCODE:4927                 </span><span style="color:navy">jz      short </span>RET21
<span style="color:black">DOSCODE:4929                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">43830
</span><span style="color:black">DOSCODE:492C                 </span><span style="color:navy">jnb     short </span>RET22
<span style="color:black">DOSCODE:492E                 </span><span style="color:navy">mov     </span>DAYCNT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:4931                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:4932                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:4933                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:4934                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:4936                 </span><span style="color:navy">mov     cx, </span><span style="color:green">1461
</span><span style="color:black">DOSCODE:4939                 </span><span style="color:navy">div     cx
</span><span style="color:black">DOSCODE:493B                 </span><span style="color:navy">shl     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:493D                 </span><span style="color:navy">shl     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:493F                 </span><span style="color:navy">shl     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4941                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:4943                 </span><span style="color:navy">mov     si, offset </span>YRTAB
<span style="color:black">DOSCODE:4946                 </span><span style="color:navy">call    </span>DSLIDE
<span style="color:black">DOSCODE:4949                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:494B                 </span><span style="color:navy">jnb     short </span><span style="color:gray">SK
</span><span style="color:black">DOSCODE:494D                 </span><span style="color:navy">add     dx, </span><span style="color:green">200
</span><span style="color:black">DOSCODE:4951
DOSCODE:4951 </span><span style="color:gray">SK</span><span style="color:navy">:                                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4951                 </span><span style="color:navy">call    </span>SETYEAR
<span style="color:black">DOSCODE:4954                 </span><span style="color:navy">mov     cl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4956                 </span><span style="color:navy">mov     si, offset </span>MONTAB
<span style="color:black">DOSCODE:4959                 </span><span style="color:navy">call    </span>DSLIDE
<span style="color:black">DOSCODE:495C                 </span><span style="color:navy">mov     </span>MONTH<span style="color:navy">, cl
</span><span style="color:black">DOSCODE:4960                 </span><span style="color:navy">inc     dx
</span><span style="color:black">DOSCODE:4961                 </span><span style="color:navy">mov     </span>DAY<span style="color:navy">, dl
</span><span style="color:black">DOSCODE:4965                 </span><span style="color:navy">call    </span>WKDAY
<span style="color:black">DOSCODE:4968                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:4969                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:496A                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:496B
DOSCODE:496B </span>RET22<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:496B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:496B </span>READTIME        endp
<span style="color:black">DOSCODE:496B
DOSCODE:496C
DOSCODE:496C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:496C
DOSCODE:496C
DOSCODE:496C </span>DSLIDE          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:496C                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:496E
DOSCODE:496E </span><span style="color:gray">DSLIDE1</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:496E                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:496F                 </span><span style="color:navy">cmp     dx, ax
</span><span style="color:black">DOSCODE:4971                 </span><span style="color:navy">jb      short </span>RET22
<span style="color:black">DOSCODE:4973                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:black">DOSCODE:4975                 </span><span style="color:navy">inc     cx
</span><span style="color:black">DOSCODE:4976                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DSLIDE1
</span><span style="color:black">DOSCODE:4976 </span>DSLIDE          endp
<span style="color:black">DOSCODE:4976
DOSCODE:4978
DOSCODE:4978 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4978
DOSCODE:4978
DOSCODE:4978 </span>SETYEAR         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4978                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:497D                 </span><span style="color:navy">mov     byte ptr </span>YEAR<span style="color:navy">, cl
</span><span style="color:black">DOSCODE:4981
DOSCODE:4981 </span>CHKYR<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4981                 </span><span style="color:navy">test    cl, </span><span style="color:green">3
</span><span style="color:black">DOSCODE:4984                 </span><span style="color:navy">mov     al, </span><span style="color:green">28
</span><span style="color:black">DOSCODE:4986                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SAVFEB
</span><span style="color:black">DOSCODE:4988                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:498A
DOSCODE:498A </span><span style="color:gray">SAVFEB</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:498A                 </span><span style="color:navy">mov     </span>february<span style="color:navy">, al
</span><span style="color:black">DOSCODE:498D
DOSCODE:498D </span>RET23<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:498D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:498D </span>SETYEAR         endp
<span style="color:black">DOSCODE:498D
DOSCODE:498E
DOSCODE:498E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:498E
DOSCODE:498E
DOSCODE:498E </span>DODATE          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:498E                 </span><span style="color:navy">call    </span>CHKYR
<span style="color:black">DOSCODE:4991                 </span><span style="color:navy">mov     al, dh
</span><span style="color:black">DOSCODE:4993                 </span><span style="color:navy">mov     bx, (offset </span>YRTAB<span style="color:navy">+</span><span style="color:green">7</span><span style="color:navy">) </span>; MONTAB-1
<span style="color:black">DOSCODE:4996                 </span><span style="color:navy">xlat
</span><span style="color:black">DOSCODE:4997                 </span><span style="color:navy">cmp     al, dl
</span><span style="color:black">DOSCODE:4999                 </span><span style="color:navy">mov     al, -</span><span style="color:green">1
</span><span style="color:black">DOSCODE:499B                 </span><span style="color:navy">jb      short </span>RET23
<span style="color:black">DOSCODE:499D                 </span><span style="color:navy">call    </span>SETYEAR
<span style="color:black">DOSCODE:49A0                 </span><span style="color:navy">mov     word ptr </span>DAY<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:49A4                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:49A6                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:49A8                 </span><span style="color:navy">mov     ax, </span><span style="color:green">1461
</span><span style="color:black">DOSCODE:49AB                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:black">DOSCODE:49AD                 </span><span style="color:navy">mul     cx
</span><span style="color:black">DOSCODE:49AF                 </span><span style="color:navy">mov     cl, byte ptr </span>YEAR
<span style="color:black">DOSCODE:49B3                 </span><span style="color:navy">and     cl, </span><span style="color:green">3
</span><span style="color:black">DOSCODE:49B6                 </span><span style="color:navy">mov     si, offset </span>YRTAB
<span style="color:black">DOSCODE:49B9                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:49BB                 </span><span style="color:navy">shl     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:49BD                 </span><span style="color:navy">call    </span>DSUM
<span style="color:black">DOSCODE:49C0                 </span><span style="color:navy">mov     cl, bh
</span><span style="color:black">DOSCODE:49C2                 </span><span style="color:navy">mov     si, offset </span>MONTAB
<span style="color:black">DOSCODE:49C5                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:49C6                 </span><span style="color:navy">call    </span>DSUM
<span style="color:black">DOSCODE:49C9                 </span><span style="color:navy">mov     cl, bl
</span><span style="color:black">DOSCODE:49CB                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:49CC                 </span><span style="color:navy">add     dx, cx
</span><span style="color:black">DOSCODE:49CE                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:49CF                 </span><span style="color:navy">mov     </span>DAYCNT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:49D2                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:49D3                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:49D4                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:49D5                 </span><span style="color:navy">mov     bx, offset </span>TIMEBUF
<span style="color:black">DOSCODE:49D8                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:49DB                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:49DD                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:49DF                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:49E0                 </span><span style="color:navy">call    </span>SETREAD
<span style="color:black">DOSCODE:49E3                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:49E4                 </span><span style="color:navy">lds     si, </span>BCLOCK
<span style="color:black">DOSCODE:49E8                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:49EB                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:49EC                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:49ED                 </span><span style="color:navy">call    </span>SETWRITE
<span style="color:black">DOSCODE:49F0                 </span><span style="color:navy">pop     </span>TIMEBUF
<span style="color:black">DOSCODE:49F4                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:49F5                 </span><span style="color:navy">lds     si, </span>BCLOCK
<span style="color:black">DOSCODE:49F9                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:49FC                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:49FD                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:49FE                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:49FF
DOSCODE:49FF </span>WKDAY<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:49FF                 </span><span style="color:navy">mov     ax, </span>DAYCNT
<span style="color:black">DOSCODE:4A02                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:4A04                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:4A07                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:4A08                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:4A09                 </span><span style="color:navy">div     cx
</span><span style="color:black">DOSCODE:4A0B                 </span><span style="color:navy">mov     </span>WEEKDAY<span style="color:navy">, dl
</span><span style="color:black">DOSCODE:4A0F                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:4A11                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4A11 </span>DODATE          endp
<span style="color:black">DOSCODE:4A11
DOSCODE:4A12
DOSCODE:4A12 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4A12
DOSCODE:4A12
DOSCODE:4A12 </span>DSUM            proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4A12                 </span><span style="color:navy">mov     ah, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:4A14                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">DSUM9
</span><span style="color:black">DOSCODE:4A16
DOSCODE:4A16 </span><span style="color:gray">DSUM1</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4A16                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4A17                 </span><span style="color:navy">add     dx, ax
</span><span style="color:black">DOSCODE:4A19                 </span><span style="color:navy">loop    </span><span style="color:gray">DSUM1
</span><span style="color:black">DOSCODE:4A1B
DOSCODE:4A1B </span><span style="color:gray">DSUM9</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4A1B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4A1B </span>DSUM            endp
<span style="color:black">DOSCODE:4A1B
</span><span style="color:maroon">DOSCODE:4A1C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4A1C
DOSCODE:4A1C </span>$GET_VERSION<span style="color:navy">:                           </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4A1C                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4A1D                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4A1E                 </span><span style="color:navy">mov     bx, word ptr </span>USERNUM_hb
<span style="color:maroon">DOSCODE:4A22                 </span><span style="color:navy">mov     cx, </span>USERNUM
<span style="color:maroon">DOSCODE:4A26                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4A28                 </span><span style="color:navy">jnz     short </span>norm_vers
<span style="color:maroon">DOSCODE:4A2A                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:maroon">DOSCODE:4A2C
DOSCODE:4A2C </span>norm_vers<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4A2C                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:4A2D                 </span><span style="color:navy">mov     ds, </span>CurrentPDB
<span style="color:maroon">DOSCODE:4A31                 </span><span style="color:navy">mov     ax, word ptr </span>SFTFCB
<span style="color:maroon">DOSCODE:4A34                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4A35                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4A38                 </span><span style="color:navy">mov     [si], ax
</span><span style="color:maroon">DOSCODE:4A3A                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:4A3D                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:4A40                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4A41 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4A41
DOSCODE:4A41 </span>$GET_VERIFY_ON_WRITE<span style="color:navy">:                   </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4A41                 </span><span style="color:navy">mov     al, ss:</span>VERFLG
<span style="color:maroon">DOSCODE:4A45                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4A46 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4A46
DOSCODE:4A46 </span>$SET_VERIFY_ON_WRITE<span style="color:navy">:                   </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4A46                 </span><span style="color:navy">and     al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4A48                 </span><span style="color:navy">mov     ss:</span>VERFLG<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:4A4C
DOSCODE:4A4C </span>RET27<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4A4C                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4A4D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4A4D
DOSCODE:4A4D </span>$INTERNATIONAL<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4A4D                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4A4F                 </span><span style="color:navy">jz      short </span>BX_HAS_CODE
<span style="color:maroon">DOSCODE:4A51                 </span><span style="color:navy">mov     bl, al
</span><span style="color:maroon">DOSCODE:4A53                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:maroon">DOSCODE:4A55
DOSCODE:4A55 </span>BX_HAS_CODE<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4A55                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:4A56                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4A57                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:4A58                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:4A59                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4A5A                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4A5B                 </span><span style="color:navy">cmp     di, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:4A5E                 </span><span style="color:navy">jz      short </span>international_set
<span style="color:maroon">DOSCODE:4A60                 </span><span style="color:navy">or      bx, bx
</span><span style="color:maroon">DOSCODE:4A62                 </span><span style="color:navy">jnz     short </span>international_find
<span style="color:maroon">DOSCODE:4A64                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG
<span style="color:maroon">DOSCODE:4A67                 </span><span style="color:navy">jmp     short </span>international_copy
<span style="color:maroon">DOSCODE:4A69 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4A69
DOSCODE:4A69 </span>international_find<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4A69                 </span><span style="color:navy">mov     bp, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4A6C                 </span><span style="color:navy">call    </span>international_get
<span style="color:maroon">DOSCODE:4A6F                 </span><span style="color:navy">jb      short </span>errtn
<span style="color:maroon">DOSCODE:4A71                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4A74                 </span><span style="color:navy">jnz     short </span>international_copy
<span style="color:maroon">DOSCODE:4A76                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:maroon">DOSCODE:4A78                 </span><span style="color:navy">jmp     short </span>international_ok3
<span style="color:black">DOSCODE:4A7A
DOSCODE:4A7A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4A7A
DOSCODE:4A7A
DOSCODE:4A7A </span>international_get proc near             <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4A7A                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG
<span style="color:black">DOSCODE:4A7D                 </span><span style="color:navy">cmp     bx, ss:[si+</span><span style="color:#ff8000">68h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4A81                 </span><span style="color:navy">jz      short </span>RET27
<span style="color:black">DOSCODE:4A83                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:black">DOSCODE:4A85                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:4A87                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1400h
</span><span style="color:black">DOSCODE:4A8A                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - NLSFUNC.COM - INSTALLATION CHECK
<span style="color:black">DOSCODE:4A8A                                         </span>; Return: AL = 00h not installed, OK to install
<span style="color:black">DOSCODE:4A8A                                         </span>; 01h not installed, not OK
<span style="color:black">DOSCODE:4A8A                                         </span>; FFh installed
<span style="color:black">DOSCODE:4A8C                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:4A8E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">interr
</span><span style="color:black">DOSCODE:4A90                 </span><span style="color:navy">or      bp, bp
</span><span style="color:black">DOSCODE:4A92                 </span><span style="color:navy">jnz     short </span><span style="color:gray">stcdpg
</span><span style="color:black">DOSCODE:4A94                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1404h
</span><span style="color:black">DOSCODE:4A97                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - NLSFUNC.COM - GET COUNTRY INFO
<span style="color:black">DOSCODE:4A97                                         </span>; BX = code page, DX = country code, DS:SI -&gt; internal code page structure
<span style="color:black">DOSCODE:4A97                                         </span>; ES:DI -&gt; user buffer
<span style="color:black">DOSCODE:4A97                                         </span>; Return: AL = status
<span style="color:black">DOSCODE:4A99                 </span><span style="color:navy">jmp     short </span><span style="color:gray">chkok
</span><span style="color:black">DOSCODE:4A9B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4A9B
DOSCODE:4A9B </span><span style="color:gray">stcdpg</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4A9B                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1403h
</span><span style="color:black">DOSCODE:4A9E                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - NLSFUNC.COM - SET COUNTRY INFO
<span style="color:black">DOSCODE:4A9E                                         </span>; DS:SI -&gt; internal code page structure
<span style="color:black">DOSCODE:4A9E                                         </span>; BX = code page, DX = country code
<span style="color:black">DOSCODE:4A9E                                         </span>; Return: AL = status
<span style="color:black">DOSCODE:4AA0
DOSCODE:4AA0 </span><span style="color:gray">chkok</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4AA0                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:4AA2                 </span><span style="color:navy">jz      short </span>RET27
<span style="color:black">DOSCODE:4AA4
DOSCODE:4AA4 </span><span style="color:gray">setcarry</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4AA4                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:4AA5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4AA6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4AA6
DOSCODE:4AA6 </span><span style="color:gray">interr</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4AA6                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:4AA8                 </span><span style="color:navy">jmp     short </span><span style="color:gray">setcarry
</span><span style="color:black">DOSCODE:4AA8 </span>international_get endp
<span style="color:black">DOSCODE:4AA8
</span><span style="color:maroon">DOSCODE:4AAA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4AAA
DOSCODE:4AAA </span>international_copy<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AAA                 </span><span style="color:navy">mov     bx, ss:[si+</span><span style="color:#ff8000">68h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4AAE                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG_108
<span style="color:maroon">DOSCODE:4AB1                 </span><span style="color:navy">mov     cx, </span><span style="color:green">24
</span><span style="color:maroon">DOSCODE:4AB4                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:4AB5                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4AB6                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4AB7                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:4AB9                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4ABA
DOSCODE:4ABA </span>international_ok3<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4ABA                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4ABD                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:4AC0
DOSCODE:4AC0 </span>international_ok<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AC0                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:maroon">DOSCODE:4AC2
DOSCODE:4AC2 </span>SYS_RET_OK_jmp<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AC2                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:4AC5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4AC5
DOSCODE:4AC5 </span>international_set<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AC5                 </span><span style="color:navy">mov     bp, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4AC8                 </span><span style="color:navy">call    </span>international_get
<span style="color:maroon">DOSCODE:4ACB                 </span><span style="color:navy">jnb     short </span>international_ok
<span style="color:maroon">DOSCODE:4ACD
DOSCODE:4ACD </span>errtn<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4ACD                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4ACF                 </span><span style="color:navy">jz      short </span>errtn2
<span style="color:maroon">DOSCODE:4AD1
DOSCODE:4AD1 </span>errtn1<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AD1                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:4AD4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4AD4
DOSCODE:4AD4 </span>errtn2<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AD4                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4AD6                 </span><span style="color:navy">jmp     short </span>errtn1
<span style="color:maroon">DOSCODE:4AD8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4AD8
DOSCODE:4AD8 </span>$GetExtCntry<span style="color:navy">:                           </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4AD8                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:maroon">DOSCODE:4ADA                 </span><span style="color:navy">jb      short </span>notcap
<span style="color:maroon">DOSCODE:4ADC                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:maroon">DOSCODE:4ADE                 </span><span style="color:navy">jnz     short </span>fileupper
<span style="color:maroon">DOSCODE:4AE0                 </span><span style="color:navy">mov     bx, offset </span>UCASE_TAB_2
<span style="color:maroon">DOSCODE:4AE3                 </span><span style="color:navy">jmp     short </span>capit
<span style="color:maroon">DOSCODE:4AE5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4AE5
DOSCODE:4AE5 </span>fileupper<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AE5                 </span><span style="color:navy">mov     bx, offset </span>FILE_UCASE_TAB_2
<span style="color:maroon">DOSCODE:4AE8
DOSCODE:4AE8 </span>capit<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AE8                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:maroon">DOSCODE:4AEA                 </span><span style="color:navy">jnz     short </span>chkyes
<span style="color:maroon">DOSCODE:4AEC                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:4AEE                 </span><span style="color:navy">call    </span>GETLET3
<span style="color:maroon">DOSCODE:4AF1                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4AF4                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], al
</span><span style="color:maroon">DOSCODE:4AF7                 </span><span style="color:navy">jmp     short </span>nono
<span style="color:maroon">DOSCODE:4AF9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4AF9
DOSCODE:4AF9 </span>chkyes<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4AF9                 </span><span style="color:navy">cmp     al, </span><span style="color:green">23h
</span><span style="color:maroon">DOSCODE:4AFB                 </span><span style="color:navy">jnz     short </span>capstring
<span style="color:maroon">DOSCODE:4AFD                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:4AFF                 </span><span style="color:navy">cmp     dl, cs:</span>NLS_YES
<span style="color:maroon">DOSCODE:4B04                 </span><span style="color:navy">jz      short </span>yesyes
<span style="color:maroon">DOSCODE:4B06                 </span><span style="color:navy">cmp     dl, cs:</span>NLS_yes2
<span style="color:maroon">DOSCODE:4B0B                 </span><span style="color:navy">jz      short </span>yesyes
<span style="color:maroon">DOSCODE:4B0D                 </span><span style="color:navy">cmp     dl, cs:</span>NLS_NO
<span style="color:maroon">DOSCODE:4B12                 </span><span style="color:navy">jz      short </span>nono
<span style="color:maroon">DOSCODE:4B14                 </span><span style="color:navy">cmp     dl, cs:</span>NLS_no2
<span style="color:maroon">DOSCODE:4B19                 </span><span style="color:navy">jz      short </span>nono
<span style="color:maroon">DOSCODE:4B1B                 </span><span style="color:navy">inc     ax
</span><span style="color:maroon">DOSCODE:4B1C
DOSCODE:4B1C </span>yesyes<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B1C                 </span><span style="color:navy">inc     ax
</span><span style="color:maroon">DOSCODE:4B1D
DOSCODE:4B1D </span>nono<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B1D                 </span><span style="color:navy">jmp     short </span>SYS_RET_OK_jmp
<span style="color:maroon">DOSCODE:4B1F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4B1F
DOSCODE:4B1F </span>capstring<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B1F                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:4B21                 </span><span style="color:navy">cmp     al, </span><span style="color:green">21h
</span><span style="color:maroon">DOSCODE:4B23                 </span><span style="color:navy">jnz     short </span>capascii
<span style="color:maroon">DOSCODE:4B25                 </span><span style="color:navy">or      cx, cx
</span><span style="color:maroon">DOSCODE:4B27                 </span><span style="color:navy">jz      short </span>nono
<span style="color:maroon">DOSCODE:4B29
DOSCODE:4B29 </span>concap<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B29                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:4B2A                 </span><span style="color:navy">call    </span>GETLET3
<span style="color:maroon">DOSCODE:4B2D                 </span><span style="color:navy">mov     [si-</span><span style="color:green">1</span><span style="color:navy">], al
</span><span style="color:maroon">DOSCODE:4B30                 </span><span style="color:navy">loop    </span>concap
<span style="color:maroon">DOSCODE:4B32                 </span><span style="color:navy">jmp     short </span>nono
<span style="color:maroon">DOSCODE:4B34 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4B34
DOSCODE:4B34 </span>capascii<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B34                 </span><span style="color:navy">cmp     al, </span><span style="color:green">22h
</span><span style="color:maroon">DOSCODE:4B36                 </span><span style="color:navy">jnz     short </span>capinval
<span style="color:maroon">DOSCODE:4B38
DOSCODE:4B38 </span>concap2<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B38                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:4B39                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:4B3B                 </span><span style="color:navy">jz      short </span>nono
<span style="color:maroon">DOSCODE:4B3D                 </span><span style="color:navy">call    </span>GETLET3
<span style="color:maroon">DOSCODE:4B40                 </span><span style="color:navy">mov     [si-</span><span style="color:green">1</span><span style="color:navy">], al
</span><span style="color:maroon">DOSCODE:4B43                 </span><span style="color:navy">jmp     short </span>concap2
<span style="color:maroon">DOSCODE:4B45 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4B45
DOSCODE:4B45 </span>notcap<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B45                 </span><span style="color:navy">cmp     cx, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:4B48                 </span><span style="color:navy">jb      short </span>sizeerror
<span style="color:maroon">DOSCODE:4B4A                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4B4B                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4B4C                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG
<span style="color:maroon">DOSCODE:4B4F                 </span><span style="color:navy">cmp     dx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:4B52                 </span><span style="color:navy">jnz     short </span>GETCDPG
<span style="color:maroon">DOSCODE:4B54                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">68h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4B57
DOSCODE:4B57 </span>GETCDPG<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B57                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:4B5A                 </span><span style="color:navy">jnz     short </span>CHKAGAIN
<span style="color:maroon">DOSCODE:4B5C                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">6Ah</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4B5F
DOSCODE:4B5F </span>CHKAGAIN<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B5F                 </span><span style="color:navy">cmp     dx, [si+</span><span style="color:#ff8000">68h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4B62                 </span><span style="color:navy">jnz     short </span>CHKNLS
<span style="color:maroon">DOSCODE:4B64                 </span><span style="color:navy">cmp     bx, [si+</span><span style="color:#ff8000">6Ah</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4B67                 </span><span style="color:navy">jnz     short </span>CHKNLS
<span style="color:maroon">DOSCODE:4B69                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">48h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4B6C                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:4B6D                 </span><span style="color:navy">mov     cx, [si+</span><span style="color:#ff8000">4Ah</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4B70                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG_76
<span style="color:maroon">DOSCODE:4B73
DOSCODE:4B73 </span>NXTENTRY<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B73                 </span><span style="color:navy">cmp     al, [si]
</span><span style="color:maroon">DOSCODE:4B75                 </span><span style="color:navy">jz      short </span>FOUNDIT
<span style="color:maroon">DOSCODE:4B77                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:4B7A                 </span><span style="color:navy">loop    </span>NXTENTRY
<span style="color:maroon">DOSCODE:4B7C                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:4B7D
DOSCODE:4B7D </span>capinval<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B7D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4B7F
DOSCODE:4B7F </span>SYS_RET_ERR_jmp<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B7F                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:4B82 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4B82
DOSCODE:4B82 </span>FOUNDIT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B82                 </span><span style="color:navy">movsb
</span><span style="color:maroon">DOSCODE:4B83                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:4B84                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4B86                 </span><span style="color:navy">jz      short </span>setsize
<span style="color:maroon">DOSCODE:4B88                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:4B8B                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:4B8E
DOSCODE:4B8E </span>OK_RETN<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B8E                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:4B90                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:maroon">DOSCODE:4B92                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:maroon">DOSCODE:4B94
DOSCODE:4B94 </span>GETDONE<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B94                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4B97                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:4B9A
DOSCODE:4B9A </span>jmp_to_nono<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B9A                 </span><span style="color:navy">jmp     short </span>nono
<span style="color:maroon">DOSCODE:4B9C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4B9C
DOSCODE:4B9C </span>setsize<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4B9C                 </span><span style="color:navy">sub     cx, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:4B9F                 </span><span style="color:navy">cmp     [si], cx
</span><span style="color:maroon">DOSCODE:4BA1                 </span><span style="color:navy">jnb     short </span>setsize2
<span style="color:maroon">DOSCODE:4BA3                 </span><span style="color:navy">mov     cx, [si]
</span><span style="color:maroon">DOSCODE:4BA5
DOSCODE:4BA5 </span>setsize2<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BA5                 </span><span style="color:navy">mov     es:[di], cx
</span><span style="color:maroon">DOSCODE:4BA8                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:4BAB                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:4BAE                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:maroon">DOSCODE:4BB0                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:4BB3                 </span><span style="color:navy">jmp     short </span>OK_RETN
<span style="color:maroon">DOSCODE:4BB5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4BB5
DOSCODE:4BB5 </span>CHKNLS<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BB5                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:4BB7                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:4BB8                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:4BB9                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1400h
</span><span style="color:maroon">DOSCODE:4BBC                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - NLSFUNC.COM - INSTALLATION CHECK
<span style="color:maroon">DOSCODE:4BBC                                         </span>; Return: AL = 00h not installed, OK to install
<span style="color:maroon">DOSCODE:4BBC                                         </span>; 01h not installed, not OK
<span style="color:maroon">DOSCODE:4BBC                                         </span>; FFh installed
<span style="color:maroon">DOSCODE:4BBE                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4BC0                 </span><span style="color:navy">jz      short </span>NLSNXT
<span style="color:maroon">DOSCODE:4BC2
DOSCODE:4BC2 </span>sizeerror<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BC2                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4BC4
DOSCODE:4BC4 </span>sizeerror_jmp<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BC4                 </span><span style="color:navy">jmp     short </span>SYS_RET_ERR_jmp
<span style="color:maroon">DOSCODE:4BC6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4BC6
DOSCODE:4BC6 </span>NLSNXT<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BC6                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1402h
</span><span style="color:maroon">DOSCODE:4BC9                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - NLSFUNC.COM - GET COUNTRY INFO
<span style="color:maroon">DOSCODE:4BC9                                         </span>; BP = subfunction, BX = code page
<span style="color:maroon">DOSCODE:4BC9                                         </span>; DX = country code, DS:SI -&gt; internal code page structure
<span style="color:maroon">DOSCODE:4BC9                                         </span>; ES:DI -&gt; user buffer, CX = size of user buffer
<span style="color:maroon">DOSCODE:4BC9                                         </span>; Return: AL = status
<span style="color:maroon">DOSCODE:4BC9                                         </span>; 00h successful
<span style="color:maroon">DOSCODE:4BC9                                         </span>; else DOS error code
<span style="color:maroon">DOSCODE:4BCB                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4BCD                 </span><span style="color:navy">jnz     short </span>NLSERROR
<span style="color:maroon">DOSCODE:4BCF                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">48h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4BD2                 </span><span style="color:navy">jmp     short </span>GETDONE
<span style="color:maroon">DOSCODE:4BD4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4BD4
DOSCODE:4BD4 </span>NLSERROR<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BD4                 </span><span style="color:navy">jmp     short </span>sizeerror_jmp
<span style="color:maroon">DOSCODE:4BD6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4BD6
DOSCODE:4BD6 </span>$GetSetCdPg<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4BD6                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4BD7                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4BD8                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG
<span style="color:maroon">DOSCODE:4BDB                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4BDD                 </span><span style="color:navy">jnz     short </span>setglpg
<span style="color:maroon">DOSCODE:4BDF                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">6Ah</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4BE2                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">48h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4BE5                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4BE8                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:4BEB                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:4BEE
DOSCODE:4BEE </span>OK_RETURN<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BEE                 </span><span style="color:navy">jmp     short </span>jmp_to_nono
<span style="color:maroon">DOSCODE:4BF0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4BF0
DOSCODE:4BF0 </span>setglpg<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4BF0                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:4BF2                 </span><span style="color:navy">jnz     short </span>nomem
<span style="color:maroon">DOSCODE:4BF4                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">68h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4BF7                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1400h
</span><span style="color:maroon">DOSCODE:4BFA                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - NLSFUNC.COM - INSTALLATION CHECK
<span style="color:maroon">DOSCODE:4BFA                                         </span>; Return: AL = 00h not installed, OK to install
<span style="color:maroon">DOSCODE:4BFA                                         </span>; 01h not installed, not OK
<span style="color:maroon">DOSCODE:4BFA                                         </span>; FFh installed
<span style="color:maroon">DOSCODE:4BFC                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4BFE                 </span><span style="color:navy">jnz     short </span>nomem
<span style="color:maroon">DOSCODE:4C00                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1401h
</span><span style="color:maroon">DOSCODE:4C03                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - NLSFUNC.COM - CHANGE CODE PAGE
<span style="color:maroon">DOSCODE:4C03                                         </span>; DS:SI -&gt; internal code page structure
<span style="color:maroon">DOSCODE:4C03                                         </span>; BX = new code page, DX = country code???
<span style="color:maroon">DOSCODE:4C03                                         </span>; Return: AL = status
<span style="color:maroon">DOSCODE:4C03                                         </span>; 00h successful
<span style="color:maroon">DOSCODE:4C03                                         </span>; else DOS error code
<span style="color:maroon">DOSCODE:4C05                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:4C07                 </span><span style="color:navy">jz      short </span>OK_RETURN
<span style="color:maroon">DOSCODE:4C09                 </span><span style="color:navy">cmp     al, </span><span style="color:green">65
</span><span style="color:maroon">DOSCODE:4C0B                 </span><span style="color:navy">jnz     short </span>seterr
<span style="color:maroon">DOSCODE:4C0D                 </span><span style="color:navy">mov     ax, </span><span style="color:green">65
</span><span style="color:maroon">DOSCODE:4C10                 </span><span style="color:navy">mov     </span>EXTERR<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:4C13                 </span><span style="color:navy">mov     byte ptr </span>EXTERR_ACT_CLASS<span style="color:navy">, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:4C18                 </span><span style="color:navy">mov     byte ptr </span>EXTERR_ACT_CLASS<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:4C1D                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:4C22                 </span><span style="color:navy">jmp     </span>From_GetSet
<span style="color:maroon">DOSCODE:4C25 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C25
DOSCODE:4C25 </span>seterr<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4C25                 </span><span style="color:navy">jmp     short </span>NLSERROR
<span style="color:maroon">DOSCODE:4C27 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C27
DOSCODE:4C27 </span>nomem<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4C27                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4C29                 </span><span style="color:navy">jmp     short </span>seterr
<span style="color:maroon">DOSCODE:4C2B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C2B
DOSCODE:4C2B </span>$GET_DRIVE_FREESPACE<span style="color:navy">:                   </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4C2B                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4C2C                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4C2D                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:4C2F                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:maroon">DOSCODE:4C32
DOSCODE:4C32 </span>SET_AX_RET<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4C32                 </span><span style="color:navy">jb      short </span>BADFDRV
<span style="color:maroon">DOSCODE:4C34                 </span><span style="color:navy">call    </span>DISK_INFO
<span style="color:maroon">DOSCODE:4C37                 </span><span style="color:navy">xchg    dx, bx
</span><span style="color:maroon">DOSCODE:4C39                 </span><span style="color:navy">jb      short </span>SET_AX_RET
<span style="color:maroon">DOSCODE:4C3B                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:4C3D
DOSCODE:4C3D </span>DoSt<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4C3D                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4C40                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:4C43                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:4C46                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:4C49                 </span><span style="color:navy">mov     [si], ax
</span><span style="color:maroon">DOSCODE:4C4B                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4C4C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C4C
DOSCODE:4C4C </span>BADFDRV<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4C4C                 </span><span style="color:navy">call    </span>FCB_RET_ERR
<span style="color:maroon">DOSCODE:4C4F                 </span><span style="color:navy">mov     ax, -</span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4C52                 </span><span style="color:navy">jmp     short </span>DoSt
<span style="color:maroon">DOSCODE:4C54 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C54
DOSCODE:4C54 </span>$GET_DMA<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4C54                 </span><span style="color:navy">mov     bx, word ptr ss:</span>DMAADD
<span style="color:maroon">DOSCODE:4C59                 </span><span style="color:navy">mov     cx, word ptr ss:</span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:4C5E                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4C61                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:4C64                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:4C67                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4C68 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C68
DOSCODE:4C68 </span>$SET_DMA<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4C68                 </span><span style="color:navy">mov     word ptr ss:</span>DMAADD<span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:4C6D                 </span><span style="color:navy">mov     word ptr ss:</span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:4C72                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4C73 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C73
DOSCODE:4C73 </span>$GET_DEFAULT_DRIVE<span style="color:navy">:                     </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4C73                 </span><span style="color:navy">mov     al, ss:</span>CURDRV
<span style="color:maroon">DOSCODE:4C77                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4C78 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C78
DOSCODE:4C78 </span>$SET_DEFAULT_DRIVE<span style="color:navy">:                     </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4C78                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:4C7A                 </span><span style="color:navy">inc     al
</span><span style="color:maroon">DOSCODE:4C7C                 </span><span style="color:navy">call    </span>GetVisDrv
<span style="color:maroon">DOSCODE:4C7F                 </span><span style="color:navy">jb      short </span>SETRET
<span style="color:maroon">DOSCODE:4C81                 </span><span style="color:navy">mov     ss:</span>CURDRV<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:4C85
DOSCODE:4C85 </span>SETRET<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4C85                 </span><span style="color:navy">mov     al, ss:</span>CDSCOUNT
<span style="color:maroon">DOSCODE:4C89                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4C8A
DOSCODE:4C8A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4C8A
DOSCODE:4C8A
DOSCODE:4C8A </span>$GET_INTERRUPT_VECTOR proc near         <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4C8A                 </span><span style="color:navy">call    </span>RECSET
<span style="color:black">DOSCODE:4C8D                 </span><span style="color:navy">les     bx, es:[bx]
</span><span style="color:black">DOSCODE:4C90                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:4C93                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:4C96                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], es
</span><span style="color:black">DOSCODE:4C99                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4C99 </span>$GET_INTERRUPT_VECTOR endp
<span style="color:black">DOSCODE:4C99
</span><span style="color:maroon">DOSCODE:4C9A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4C9A
DOSCODE:4C9A </span>$SET_INTERRUPT_VECTOR<span style="color:navy">:                  </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4C9A                 </span><span style="color:navy">call    </span>RECSET
<span style="color:maroon">DOSCODE:4C9D                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:4C9E                 </span><span style="color:navy">mov     es:[bx], dx
</span><span style="color:maroon">DOSCODE:4CA1                 </span><span style="color:navy">mov     word ptr es:[bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], ds
</span><span style="color:maroon">DOSCODE:4CA5                 </span><span style="color:navy">sti
</span><span style="color:maroon">DOSCODE:4CA6                 </span><span style="color:navy">test    ss:</span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:4CAC                 </span><span style="color:navy">jnz     short </span>siv_1
<span style="color:maroon">DOSCODE:4CAE                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4CAF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4CAF
DOSCODE:4CAF </span>siv_1<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4CAF                 </span><span style="color:navy">cmp     ss:</span>A20OFF_COUNT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4CB5                 </span><span style="color:navy">jnz     short </span>siv_2
<span style="color:maroon">DOSCODE:4CB7                 </span><span style="color:navy">mov     ss:</span>A20OFF_COUNT<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4CBD
DOSCODE:4CBD </span>siv_2<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4CBD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4CBE
DOSCODE:4CBE </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4CBE
DOSCODE:4CBE
DOSCODE:4CBE </span>RECSET          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4CBE                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:4CC0                 </span><span style="color:navy">mov     es, bx
</span><span style="color:black">DOSCODE:4CC2                 </span><span style="color:navy">mov     bl, al
</span><span style="color:black">DOSCODE:4CC4                 </span><span style="color:navy">shl     bx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4CC6                 </span><span style="color:navy">shl     bx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4CC8                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4CC8 </span>RECSET          endp
<span style="color:black">DOSCODE:4CC8
</span><span style="color:maroon">DOSCODE:4CC9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4CC9
DOSCODE:4CC9 </span>$CHAR_OPER<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4CC9                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:4CCB                 </span><span style="color:navy">mov     dl, &#039;</span><span style="color:green">/&#039;
</span><span style="color:maroon">DOSCODE:4CCD                 </span><span style="color:navy">jz      short </span>chop_1
<span style="color:maroon">DOSCODE:4CCF                 </span><span style="color:navy">cmp     al, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:4CD1                 </span><span style="color:navy">mov     dl, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:4CD3                 </span><span style="color:navy">jz      short </span>chop_1
<span style="color:maroon">DOSCODE:4CD5                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4CD6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4CD6
DOSCODE:4CD6 </span>chop_1<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4CD6                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4CD9                 </span><span style="color:navy">mov     [si+</span><span style="color:green">6</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:4CDC                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4CDD </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4CDD
DOSCODE:4CDD </span>$GetExtendedError<span style="color:navy">:                      </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4CDD                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4CDE                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4CDF                 </span><span style="color:navy">mov     ax, </span>EXTERR
<span style="color:maroon">DOSCODE:4CE2                 </span><span style="color:navy">les     di, </span>EXTERRPT
<span style="color:maroon">DOSCODE:4CE6                 </span><span style="color:navy">mov     bx, </span>EXTERR_ACT_CLASS
<span style="color:maroon">DOSCODE:4CEA                 </span><span style="color:navy">mov     ch, </span>EXTERR_LOCUS
<span style="color:maroon">DOSCODE:4CEE                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4CF1                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">], di
</span><span style="color:maroon">DOSCODE:4CF4                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:4CF7                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:4CFA                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:4CFD
DOSCODE:4CFD </span>jmp_SYS_RET_OK<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4CFD                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:4D00 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D00                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:4D01                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG
<span style="color:maroon">DOSCODE:4D04                 </span><span style="color:navy">mov     ax, ss:[si+</span><span style="color:#ff8000">6Ah</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4D08                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:4D09                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4D0A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D0A
DOSCODE:4D0A </span>$ECS_Call<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D0A                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:4D0C                 </span><span style="color:navy">jnz     short </span>_okok
<span style="color:maroon">DOSCODE:4D0E                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4D11                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:green">8</span><span style="color:navy">], offset </span>DBCS_TAB_2
<span style="color:maroon">DOSCODE:4D16                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:4D17                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:4D1C                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:green">14</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:4D1F                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:4D20
DOSCODE:4D20 </span>_okok<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4D20                 </span><span style="color:navy">jmp     short </span>jmp_SYS_RET_OK
<span style="color:maroon">DOSCODE:4D22 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D22
DOSCODE:4D22 </span>$PARSE_FILE_DESCRIPTOR<span style="color:navy">:                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D22                 </span><span style="color:navy">call    </span>MAKEFCB
<span style="color:maroon">DOSCODE:4D25                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:4D26                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4D29                 </span><span style="color:navy">pop     word ptr [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:4D2C                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4D2D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D2D
DOSCODE:4D2D </span>$SLEAZEFUNC<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D2D                 </span><span style="color:navy">mov     dl, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4D2F
DOSCODE:4D2F </span>$SLEAZEFUNCDL<span style="color:navy">:                          </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D2F                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4D30                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4D31                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:4D33                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:maroon">DOSCODE:4D36
DOSCODE:4D36 </span>SET_AL_RET<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4D36                 </span><span style="color:navy">jb      short </span>BADSLDRIVE
<span style="color:maroon">DOSCODE:4D38                 </span><span style="color:navy">call    </span>DISK_INFO
<span style="color:maroon">DOSCODE:4D3B                 </span><span style="color:navy">jb      short </span>SET_AL_RET
<span style="color:maroon">DOSCODE:4D3D                 </span><span style="color:navy">mov     byte ptr </span>FATBYTE<span style="color:navy">, ah
</span><span style="color:maroon">DOSCODE:4D41                 </span><span style="color:navy">mov     di, offset </span>FATBYTE
<span style="color:maroon">DOSCODE:4D44                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:4D46                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4D49                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:4D4C                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:4D4F                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], di
</span><span style="color:maroon">DOSCODE:4D52                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], ss
</span><span style="color:maroon">DOSCODE:4D55                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4D56 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D56
DOSCODE:4D56 </span>BADSLDRIVE<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4D56                 </span><span style="color:navy">jmp     </span>FCB_RET_ERR
<span style="color:maroon">DOSCODE:4D59 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D59
DOSCODE:4D59 </span>$GET_INDOS_FLAG<span style="color:navy">:                        </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D59                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4D5C                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], offset </span>INDOS
<span style="color:maroon">DOSCODE:4D61                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], ss
</span><span style="color:maroon">DOSCODE:4D64                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4D65 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D65
DOSCODE:4D65 </span>$GET_IN_VARS<span style="color:navy">:                           </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D65                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4D68                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], offset </span>DPBHEAD
<span style="color:maroon">DOSCODE:4D6D                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], ss
</span><span style="color:maroon">DOSCODE:4D70                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4D71 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D71
DOSCODE:4D71 </span>$GET_DEFAULT_DPB<span style="color:navy">:                       </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D71                 </span><span style="color:navy">mov     dl, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4D73
DOSCODE:4D73 </span>$GET_DPB<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4D73                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4D74                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4D75                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:4D77                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:maroon">DOSCODE:4D7A                 </span><span style="color:navy">jb      short </span>ISNODRV
<span style="color:maroon">DOSCODE:4D7C                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:maroon">DOSCODE:4D80                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:maroon">DOSCODE:4D85                 </span><span style="color:navy">jnz     short </span>ISNODRV
<span style="color:maroon">DOSCODE:4D87                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:4D8A                 </span><span style="color:navy">call    </span>FATREAD_CDS
<span style="color:maroon">DOSCODE:4D8D                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:4D90                 </span><span style="color:navy">jb      short </span>ISNODRV
<span style="color:maroon">DOSCODE:4D92                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:4D95                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bp
</span><span style="color:maroon">DOSCODE:4D98                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:4D9B                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:4D9D                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4D9E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4D9E
DOSCODE:4D9E </span>ISNODRV<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4D9E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4DA0                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4DA1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4DA1
DOSCODE:4DA1 </span>$DISK_RESET<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4DA1                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:4DA3                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:4DA4                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:4DA5                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:4DA8                 </span><span style="color:navy">or      </span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:4DAD                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:maroon">DOSCODE:4DB0                 </span><span style="color:navy">and     </span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">0FFFBh
</span><span style="color:maroon">DOSCODE:4DB5                 </span><span style="color:navy">mov     </span>SC_STATUS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:4DBB                 </span><span style="color:navy">mov     bx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:4DBE                 </span><span style="color:navy">mov     word ptr </span>LastBuffer<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:4DC2                 </span><span style="color:navy">mov     word ptr </span>LastBuffer<span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:4DC6                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:4DC9                 </span><span style="color:navy">mov     ax, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:4DCC                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:4DCD                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1120h
</span><span style="color:maroon">DOSCODE:4DD0                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - FLUSH ALL DISK BUFFERS
<span style="color:maroon">DOSCODE:4DD0                                         </span>; DS = DOS CS
<span style="color:maroon">DOSCODE:4DD0                                         </span>; Return: CF clear (successful)
<span style="color:maroon">DOSCODE:4DD2                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:4DD3                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4DD3 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:4DD4 </span>word3           <span style="color:navy">dw </span><span style="color:#008040">3                    </span><span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:4DD6
DOSCODE:4DD6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4DD6
DOSCODE:4DD6
DOSCODE:4DD6 </span>$SETDPB         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4DD6                 </span><span style="color:navy">mov     di, bp
</span><span style="color:black">DOSCODE:4DD8                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:4DDB                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:4DDC                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:4DDD                 </span><span style="color:navy">cmp     byte ptr [si+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4DE1                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesfat
</span><span style="color:black">DOSCODE:4DE3                 </span><span style="color:navy">mov     byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4DE8                 </span><span style="color:navy">jmp     short </span><span style="color:gray">setend
</span><span style="color:black">DOSCODE:4DEA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4DEA
DOSCODE:4DEA </span><span style="color:gray">yesfat</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4DEA                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:4DEC                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4DED                 </span><span style="color:navy">dec     al
</span><span style="color:black">DOSCODE:4DEF                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:4DF0                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:4DF2                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:4DF4
DOSCODE:4DF4 </span><span style="color:gray">LOG2LOOP</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4DF4                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4DF6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SAVLOG
</span><span style="color:black">DOSCODE:4DF8                 </span><span style="color:navy">inc     ah
</span><span style="color:black">DOSCODE:4DFA                 </span><span style="color:navy">shr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4DFC                 </span><span style="color:navy">jmp     short </span><span style="color:gray">LOG2LOOP
</span><span style="color:black">DOSCODE:4DFE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4DFE
DOSCODE:4DFE </span><span style="color:gray">SAVLOG</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4DFE                 </span><span style="color:navy">mov     al, ah
</span><span style="color:black">DOSCODE:4E00                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:4E01                 </span><span style="color:navy">mov     bl, al
</span><span style="color:black">DOSCODE:4E03                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:4E04                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4E05                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:4E06                 </span><span style="color:navy">mov     bh, al
</span><span style="color:black">DOSCODE:4E08                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:4E09                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:4E0A                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:4E0C                 </span><span style="color:navy">shr     dx, cl
</span><span style="color:black">DOSCODE:4E0E                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:4E0F                 </span><span style="color:navy">add     ax, dx
</span><span style="color:black">DOSCODE:4E11                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:black">DOSCODE:4E13                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:4E15                 </span><span style="color:navy">div     cx
</span><span style="color:black">DOSCODE:4E17                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:4E19                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:4E1A                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:4E1B                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:4E1C                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4E1D                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">17h</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:4E21                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:4E22                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:4E23                 </span><span style="color:navy">mov     dl, bh
</span><span style="color:black">DOSCODE:4E25                 </span><span style="color:navy">xor     dh, dh
</span><span style="color:black">DOSCODE:4E27                 </span><span style="color:navy">mul     dx
</span><span style="color:black">DOSCODE:4E29                 </span><span style="color:navy">add     ax, es:[bp+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4E2D                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:4E2E                 </span><span style="color:navy">add     ax, cx
</span><span style="color:black">DOSCODE:4E30                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:4E34                 </span><span style="color:navy">mov     cl, bl
</span><span style="color:black">DOSCODE:4E36                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4E3B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">normal_dpb
</span><span style="color:black">DOSCODE:4E3D                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:4E3F                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4E42                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4E45                 </span><span style="color:navy">sub     bx, ax
</span><span style="color:black">DOSCODE:4E47                 </span><span style="color:navy">sbb     dx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4E4A                 </span><span style="color:navy">or      cx, cx
</span><span style="color:black">DOSCODE:4E4C                 </span><span style="color:navy">jz      short </span><span style="color:gray">norot
</span><span style="color:black">DOSCODE:4E4E
DOSCODE:4E4E </span><span style="color:gray">rott</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E4E                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:4E4F                 </span><span style="color:navy">rcr     dx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4E51                 </span><span style="color:navy">rcr     bx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4E53                 </span><span style="color:navy">loop    </span><span style="color:gray">rott
</span><span style="color:black">DOSCODE:4E55
DOSCODE:4E55 </span><span style="color:gray">norot</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E55                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:4E57                 </span><span style="color:navy">jmp     short </span><span style="color:gray">setend
</span><span style="color:black">DOSCODE:4E59 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4E59
DOSCODE:4E59 </span><span style="color:gray">normal_dpb</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E59                 </span><span style="color:navy">sub     ax, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4E5D                 </span><span style="color:navy">neg     ax
</span><span style="color:black">DOSCODE:4E5F                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:black">DOSCODE:4E61
DOSCODE:4E61 </span><span style="color:gray">setend</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E61                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:4E62                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:black">DOSCODE:4E64                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4E68                 </span><span style="color:navy">mul     word ptr es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4E6C                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">0FF6h
</span><span style="color:black">DOSCODE:4E70                 </span><span style="color:navy">jb      short </span><span style="color:gray">setend_fat12
</span><span style="color:black">DOSCODE:4E72                 </span><span style="color:navy">shr     dx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4E74                 </span><span style="color:navy">jnz     short </span><span style="color:gray">setend_faterr
</span><span style="color:black">DOSCODE:4E76                 </span><span style="color:navy">rcr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:4E78                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">0FF7h
</span><span style="color:black">DOSCODE:4E7B                 </span><span style="color:navy">jb      short </span><span style="color:gray">setend_faterr
</span><span style="color:black">DOSCODE:4E7D                 </span><span style="color:navy">jmp     short </span><span style="color:gray">setend_fat16
</span><span style="color:black">DOSCODE:4E7F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:4E7F
DOSCODE:4E7F </span><span style="color:gray">setend_fat12</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E7F                 </span><span style="color:navy">add     ax, ax
</span><span style="color:black">DOSCODE:4E81                 </span><span style="color:navy">adc     dx, dx
</span><span style="color:black">DOSCODE:4E83                 </span><span style="color:navy">cmp     dx, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:4E86                 </span><span style="color:navy">jnb     short </span><span style="color:gray">setend_faterr
</span><span style="color:black">DOSCODE:4E88                 </span><span style="color:navy">div     cs:</span>word3
<span style="color:black">DOSCODE:4E8D
DOSCODE:4E8D </span><span style="color:gray">setend_fat16</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E8D                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:4E8E                 </span><span style="color:navy">cmp     ax, bx
</span><span style="color:black">DOSCODE:4E90                 </span><span style="color:navy">jbe     short </span><span style="color:gray">setend_fat
</span><span style="color:black">DOSCODE:4E92
DOSCODE:4E92 </span><span style="color:gray">setend_faterr</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E92                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:4E94
DOSCODE:4E94 </span><span style="color:gray">setend_fat</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4E94                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:4E98                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4E9E                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:4EA4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4EA4 </span>$SETDPB         endp
<span style="color:black">DOSCODE:4EA4
DOSCODE:4EA5
DOSCODE:4EA5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4EA5
DOSCODE:4EA5
DOSCODE:4EA5 </span>$DUP_PDB        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4EA5                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4EAA                 </span><span style="color:navy">mov     </span>CreatePDB<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:4EAF                 </span><span style="color:navy">mov     ds, </span>CurrentPDB
<span style="color:black">DOSCODE:4EB3                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:4EB4                 </span><span style="color:navy">jmp     short </span>CreateCopy
<span style="color:black">DOSCODE:4EB4 </span>$DUP_PDB        endp
<span style="color:black">DOSCODE:4EB4
DOSCODE:4EB6
DOSCODE:4EB6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4EB6
DOSCODE:4EB6
DOSCODE:4EB6 </span>$CREATE_PROCESS_DATA_BLOCK proc near    <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:4EB6                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:4EB9                 </span><span style="color:navy">mov     ds, word ptr [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4EBC                 </span><span style="color:navy">push    word ptr byte_0+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:4EC0
DOSCODE:4EC0 </span>CreateCopy<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4EC0                 </span><span style="color:navy">mov     es, dx
</span><span style="color:black">DOSCODE:4EC2                 </span><span style="color:navy">xor     si, si
</span><span style="color:black">DOSCODE:4EC4                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:4EC6                 </span><span style="color:navy">mov     cx, </span><span style="color:green">128
</span><span style="color:black">DOSCODE:4EC9                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:4ECB                 </span><span style="color:navy">mov     cx, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:4ECE                 </span><span style="color:navy">mov     di, </span><span style="color:green">18h
</span><span style="color:black">DOSCODE:4ED1                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:4ED2                 </span><span style="color:navy">lds     si, </span>BCON<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:4ED6                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:4ED8                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:4ED9                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4EDE                 </span><span style="color:navy">cmp     </span>CreatePDB<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:4EE3                 </span><span style="color:navy">jz      short </span><span style="color:gray">Create_PDB_cont
</span><span style="color:black">DOSCODE:4EE5                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4EEA                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:4EEC                 </span><span style="color:navy">mov     cx, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:4EEF
DOSCODE:4EEF </span><span style="color:gray">Create_dup_jfn</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4EEF                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:4EF0                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:black">DOSCODE:4EF3                 </span><span style="color:navy">mov     al, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:4EF5                 </span><span style="color:navy">jb      short </span><span style="color:gray">CreateStash
</span><span style="color:black">DOSCODE:4EF7                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:4EFC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CreateStash
</span><span style="color:black">DOSCODE:4EFE                 </span><span style="color:navy">mov     ah, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:4F02                 </span><span style="color:navy">and     ah, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:4F05                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">70h
</span><span style="color:black">DOSCODE:4F08                 </span><span style="color:navy">jz      short </span><span style="color:gray">CreateStash
</span><span style="color:black">DOSCODE:4F0A                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:4F0E                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:4F12                 </span><span style="color:navy">call    </span>DOS_DUP
<span style="color:black">DOSCODE:4F15                 </span><span style="color:navy">call    </span>pJFNFromHandle
<span style="color:black">DOSCODE:4F18                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:4F1B
DOSCODE:4F1B </span><span style="color:gray">CreateStash</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4F1B                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:4F1C                 </span><span style="color:navy">mov     es:[bx+</span><span style="color:#ff8000">18h</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:4F20                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:4F21                 </span><span style="color:navy">loop    </span><span style="color:gray">Create_dup_jfn
</span><span style="color:black">DOSCODE:4F23                 </span><span style="color:navy">mov     bx, </span>CurrentPDB
<span style="color:black">DOSCODE:4F27                 </span><span style="color:navy">mov     word ptr es:</span>OEM_HANDLER<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, bx
</span><span style="color:black">DOSCODE:4F2C                 </span><span style="color:navy">mov     </span>CurrentPDB<span style="color:navy">, es
</span><span style="color:black">DOSCODE:4F30                 </span><span style="color:navy">mov     ds, bx
</span><span style="color:black">DOSCODE:4F32
DOSCODE:4F32 </span><span style="color:gray">Create_PDB_cont</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4F32                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:4F33                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:4F38                 </span><span style="color:navy">mov     </span>CreatePDB<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4F3D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:4F3E                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:4F3F
DOSCODE:4F3F </span>SETMEM<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4F3F                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:4F41                 </span><span style="color:navy">mov     ds, cx
</span><span style="color:black">DOSCODE:4F43                 </span><span style="color:navy">mov     es, dx
</span><span style="color:black">DOSCODE:4F45                 </span><span style="color:navy">mov     si, </span><span style="color:green">88h
</span><span style="color:black">DOSCODE:4F48                 </span><span style="color:navy">mov     di, </span><span style="color:green">10
</span><span style="color:black">DOSCODE:4F4B                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:4F4E                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:4F50                 </span><span style="color:navy">mov     word ptr es:byte_0+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:4F54                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:black">DOSCODE:4F56                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">0FFFh
</span><span style="color:black">DOSCODE:4F59                 </span><span style="color:navy">jbe     short </span><span style="color:gray">HAVDIF
</span><span style="color:black">DOSCODE:4F5B                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">0FFFh
</span><span style="color:black">DOSCODE:4F5E
DOSCODE:4F5E </span><span style="color:gray">HAVDIF</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4F5E                 </span><span style="color:navy">sub     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:4F61                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">0Ch
</span><span style="color:black">DOSCODE:4F64                 </span><span style="color:navy">sub     bx, ax
</span><span style="color:black">DOSCODE:4F66                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:4F68                 </span><span style="color:navy">shl     ax, cl
</span><span style="color:black">DOSCODE:4F6A                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:black">DOSCODE:4F6C                 </span><span style="color:navy">mov     word ptr </span>WinoldPatch1<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:4F6F                 </span><span style="color:navy">mov     word ptr </span>WinoldPatch1<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, bx
</span><span style="color:black">DOSCODE:4F73                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0FEF0h
</span><span style="color:black">DOSCODE:4F76                 </span><span style="color:navy">jz      short </span><span style="color:gray">addr_ok
</span><span style="color:black">DOSCODE:4F78                 </span><span style="color:navy">mov     word ptr </span>WinoldPatch1<span style="color:navy">, </span><span style="color:#ff8000">0C0h </span><span style="color:gray">; &#039;L&#039;
</span><span style="color:black">DOSCODE:4F7E                 </span><span style="color:navy">mov     word ptr </span>WinoldPatch1<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:4F84
DOSCODE:4F84 </span><span style="color:gray">addr_ok</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4F84                 </span><span style="color:navy">mov     </span>word ptr 0<span style="color:navy">, </span><span style="color:#ff8000">20CDh
</span><span style="color:black">DOSCODE:4F8A                 </span><span style="color:navy">mov     byte ptr </span>DataVersion<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:#ff8000">9Ah </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:4F8F                 </span><span style="color:navy">mov     off_50, </span><span style="color:#ff8000">21CDh
</span><span style="color:black">DOSCODE:4F95                 </span><span style="color:navy">mov     byte ptr asc_52, </span><span style="color:#ff8000">0CBh </span><span style="color:gray">; &#039;T&#039; ; &quot;NUL     &quot;
</span><span style="color:black">DOSCODE:4F9A                 </span><span style="color:navy">mov     word ptr </span>BCON<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:green">18h
</span><span style="color:black">DOSCODE:4FA0                 </span><span style="color:navy">mov     </span>MAXSEC<span style="color:navy">, ds
</span><span style="color:black">DOSCODE:4FA4                 </span><span style="color:navy">mov     word ptr </span>BCON<span style="color:navy">, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:4FAA                 </span><span style="color:navy">mov     word ptr </span>BUFFHEAD<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:4FB0                 </span><span style="color:navy">mov     word ptr </span>BUFFHEAD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:4FB6                 </span><span style="color:navy">mov     word ptr es:</span>SFTFCB<span style="color:navy">, </span><span style="color:green">1406h
</span><span style="color:black">DOSCODE:4FBD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4FBD </span>$CREATE_PROCESS_DATA_BLOCK endp
<span style="color:black">DOSCODE:4FBD
</span><span style="color:maroon">DOSCODE:4FBE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4FBE
DOSCODE:4FBE </span>$GSetMediaID<span style="color:navy">:                           </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:4FBE                 </span><span style="color:navy">mov     cx, </span><span style="color:green">866h
</span><span style="color:maroon">DOSCODE:4FC1                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:4FC3                 </span><span style="color:navy">jz      short </span>doioctl
<span style="color:maroon">DOSCODE:4FC5                 </span><span style="color:navy">cmp     al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:4FC7                 </span><span style="color:navy">jnz     short </span>errorfunc
<span style="color:maroon">DOSCODE:4FC9                 </span><span style="color:navy">mov     cx, </span><span style="color:green">846h
</span><span style="color:maroon">DOSCODE:4FCC
DOSCODE:4FCC </span>doioctl<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4FCC                 </span><span style="color:navy">mov     al, </span><span style="color:green">0Dh
</span><span style="color:maroon">DOSCODE:4FCE                 </span><span style="color:navy">call    </span>$IOCTL
<span style="color:maroon">DOSCODE:4FD1                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:4FD2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:4FD2
DOSCODE:4FD2 </span>errorfunc<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:4FD2                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:4FD4                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:4FD7
DOSCODE:4FD7 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4FD7
DOSCODE:4FD7
DOSCODE:4FD7 </span>StrCmp          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4FD7                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:4FD8                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:4FD9                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:4FDA
DOSCODE:4FDA </span><span style="color:gray">Cmplp</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4FDA                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4FDB                 </span><span style="color:navy">call    </span>UCase
<span style="color:black">DOSCODE:4FDE                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:4FE1                 </span><span style="color:navy">mov     ah, al
</span><span style="color:black">DOSCODE:4FE3                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:4FE6                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:4FE7                 </span><span style="color:navy">call    </span>UCase
<span style="color:black">DOSCODE:4FEA                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:4FED                 </span><span style="color:navy">cmp     ah, al
</span><span style="color:black">DOSCODE:4FEF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">PopRet
</span><span style="color:black">DOSCODE:4FF1                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:4FF3                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Cmplp
</span><span style="color:black">DOSCODE:4FF5
DOSCODE:4FF5 </span><span style="color:gray">PopRet</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4FF5                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:4FF6                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:4FF7                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:4FF8                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:4FF8 </span>StrCmp          endp
<span style="color:black">DOSCODE:4FF8
DOSCODE:4FF9
DOSCODE:4FF9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:4FF9
DOSCODE:4FF9
DOSCODE:4FF9 </span>StrCpy          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:4FF9                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:4FFA
DOSCODE:4FFA </span><span style="color:gray">CPYLoop</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:4FFA                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:4FFB                 </span><span style="color:navy">call    </span>UCase
<span style="color:black">DOSCODE:4FFE                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:5001                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:5002                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:5004                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CPYLoop
</span><span style="color:black">DOSCODE:5006                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5007                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5007 </span>StrCpy          endp
<span style="color:black">DOSCODE:5007
DOSCODE:5008
DOSCODE:5008 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5008
DOSCODE:5008
DOSCODE:5008 </span>FStrCpy         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5008                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5009
DOSCODE:5009 </span><span style="color:gray">FCPYLoop</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5009                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:500A                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:500B                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:500D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FCPYLoop
</span><span style="color:black">DOSCODE:500F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5010                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5010 </span>FStrCpy         endp
<span style="color:black">DOSCODE:5010
DOSCODE:5011
DOSCODE:5011 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5011
DOSCODE:5011
DOSCODE:5011 </span>StrLen          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5011                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:5012                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5013                 </span><span style="color:navy">mov     cx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:5016                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:5018                 </span><span style="color:navy">repne scasb
</span><span style="color:black">DOSCODE:501A                 </span><span style="color:navy">not     cx
</span><span style="color:black">DOSCODE:501C                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:501D                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:501E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:501E </span>StrLen          endp
<span style="color:black">DOSCODE:501E
DOSCODE:501F
DOSCODE:501F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:501F
DOSCODE:501F
DOSCODE:501F </span>DStrLen         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:501F                 </span><span style="color:navy">call    </span>XCHGP
<span style="color:black">DOSCODE:5022                 </span><span style="color:navy">call    </span>StrLen
<span style="color:black">DOSCODE:5025                 </span><span style="color:navy">call    </span>XCHGP
<span style="color:black">DOSCODE:5028                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5028 </span>DStrLen         endp
<span style="color:black">DOSCODE:5028
DOSCODE:5029
DOSCODE:5029 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5029
DOSCODE:5029
DOSCODE:5029 </span>XCHGP           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5029                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:502A                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:502B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:502C                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:502D                 </span><span style="color:navy">xchg    si, di
</span><span style="color:black">DOSCODE:502F
DOSCODE:502F </span>xchgp_retn<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:502F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:502F </span>XCHGP           endp
<span style="color:black">DOSCODE:502F
DOSCODE:5030
DOSCODE:5030 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5030
DOSCODE:5030
DOSCODE:5030 </span>Idle            proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5030                 </span><span style="color:navy">cmp     ss:</span>FSHARING<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5036                 </span><span style="color:navy">jnz     short </span>xchgp_retn
<span style="color:black">DOSCODE:5038                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:5039                 </span><span style="color:navy">mov     cx, ss:</span>RetryLoop
<span style="color:black">DOSCODE:503E                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">Idle3
</span><span style="color:black">DOSCODE:5040
DOSCODE:5040 </span><span style="color:gray">Idle1</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5040                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:5041                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:5043
DOSCODE:5043 </span>Idle2<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5043                 </span><span style="color:navy">loop    </span>Idle2
<span style="color:black">DOSCODE:5045                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:5046                 </span><span style="color:navy">loop    </span><span style="color:gray">Idle1
</span><span style="color:black">DOSCODE:5048
DOSCODE:5048 </span><span style="color:gray">Idle3</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5048                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:5049                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5049 </span>Idle            endp
<span style="color:black">DOSCODE:5049
DOSCODE:504A
DOSCODE:504A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:504A
DOSCODE:504A </span><span style="color:gray">; Attributes: bp-based frame
</span><span style="color:black">DOSCODE:504A
DOSCODE:504A </span>TableDispatch   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:504A
DOSCODE:504A </span><span style="color:green">arg_0           </span><span style="color:navy">= byte ptr  </span><span style="color:#008040">4
</span><span style="color:black">DOSCODE:504A </span><span style="color:green">arg_2           </span><span style="color:navy">= word ptr  </span><span style="color:#008040">6
</span><span style="color:black">DOSCODE:504A
DOSCODE:504A                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:504B                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:black">DOSCODE:504D                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:504E                 </span><span style="color:navy">mov     bx, [bp+</span><span style="color:green">arg_2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5051                 </span><span style="color:navy">mov     bl, cs:[bx]
</span><span style="color:black">DOSCODE:5054                 </span><span style="color:navy">cmp     [bp+</span><span style="color:green">arg_0</span><span style="color:navy">], bl
</span><span style="color:black">DOSCODE:5057                 </span><span style="color:navy">jnb     short </span><span style="color:gray">TableError
</span><span style="color:black">DOSCODE:5059                 </span><span style="color:navy">mov     bl, [bp+</span><span style="color:green">arg_0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:505C                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:black">DOSCODE:505E                 </span><span style="color:navy">shl     bx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:5060                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:5061                 </span><span style="color:navy">add     bx, [bp+</span><span style="color:green">arg_2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5064                 </span><span style="color:navy">mov     bx, cs:[bx]
</span><span style="color:black">DOSCODE:5067                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">arg_2</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:506A                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:506B                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:506C                 </span><span style="color:navy">add     sp, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:506F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5070 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5070
DOSCODE:5070 </span><span style="color:gray">TableError</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5070                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:5071                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:5072                 </span><span style="color:navy">retn    </span><span style="color:green">6
</span><span style="color:black">DOSCODE:5072 </span>TableDispatch   endp
<span style="color:black">DOSCODE:5072
DOSCODE:5075
DOSCODE:5075 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5075
DOSCODE:5075
DOSCODE:5075 </span>TestNet         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5075                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:507A                 </span><span style="color:navy">les     di, es:</span>THISCDS
<span style="color:black">DOSCODE:507F                 </span><span style="color:navy">cmp     di, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:5082                 </span><span style="color:navy">jz      short </span><span style="color:gray">CMCRet
</span><span style="color:black">DOSCODE:5084                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5089                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CMCRet
</span><span style="color:black">DOSCODE:508B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:508C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:508C
DOSCODE:508C </span><span style="color:gray">CMCRet</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:508C                 </span><span style="color:navy">cmc
</span><span style="color:black">DOSCODE:508D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:508D </span>TestNet         endp
<span style="color:black">DOSCODE:508D
DOSCODE:508E
DOSCODE:508E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:508E
DOSCODE:508E
DOSCODE:508E </span>IsSFTNet        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:508E                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5093                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5093 </span>IsSFTNet        endp
<span style="color:black">DOSCODE:5093
</span><span style="color:maroon">DOSCODE:5094 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5094
DOSCODE:5094 </span>FastInit<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5094                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:5095                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:509A                 </span><span style="color:navy">mov     di, offset </span>FastTable_2
<span style="color:maroon">DOSCODE:509D                 </span><span style="color:navy">dec     bx
</span><span style="color:maroon">DOSCODE:509E                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:maroon">DOSCODE:50A0                 </span><span style="color:navy">shl     bx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:50A2                 </span><span style="color:navy">shl     bx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:50A4                 </span><span style="color:navy">add     di, bx
</span><span style="color:maroon">DOSCODE:50A6                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:50AA                 </span><span style="color:navy">mov     cx, cs
</span><span style="color:maroon">DOSCODE:50AC                 </span><span style="color:navy">cmp     ax, cx
</span><span style="color:maroon">DOSCODE:50AE                 </span><span style="color:navy">jz      short </span>ok_install
<span style="color:maroon">DOSCODE:50B0                 </span><span style="color:navy">or      ax, ax
</span><span style="color:maroon">DOSCODE:50B2                 </span><span style="color:navy">jz      short </span>ok_install
<span style="color:maroon">DOSCODE:50B4                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:50B5                 </span><span style="color:navy">jmp     short </span>FSret
<span style="color:maroon">DOSCODE:50B7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:50B7
DOSCODE:50B7 </span>ok_install<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:50B7                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:50BA                 </span><span style="color:navy">jz      short </span>FSret
<span style="color:maroon">DOSCODE:50BC                 </span><span style="color:navy">mov     cx, ds
</span><span style="color:maroon">DOSCODE:50BE                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:50C2                 </span><span style="color:navy">mov     es:[di], si
</span><span style="color:maroon">DOSCODE:50C5                 </span><span style="color:navy">mov     di, offset </span>FastOpenFlg
<span style="color:maroon">DOSCODE:50C8                 </span><span style="color:navy">add     di, dx
</span><span style="color:maroon">DOSCODE:50CA                 </span><span style="color:navy">or      byte ptr es:[di], </span><span style="color:green">80h
</span><span style="color:maroon">DOSCODE:50CE
DOSCODE:50CE </span>FSret<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:50CE                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:50CF                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:50D0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:50D0
DOSCODE:50D0 </span>FastRet<span style="color:navy">:                                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:50D0                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:50D1                 </span><span style="color:navy">sbb     ax, ax
</span><span style="color:maroon">DOSCODE:50D3                 </span><span style="color:navy">retf
</span><span style="color:maroon">DOSCODE:50D4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:50D4
DOSCODE:50D4 </span>NLS_OPEN<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:50D4                 </span><span style="color:navy">mov     al, cl
</span><span style="color:maroon">DOSCODE:50D6                 </span><span style="color:navy">call    </span>$OPEN
<span style="color:maroon">DOSCODE:50D9                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:50DA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:50DA
DOSCODE:50DA </span>NLS_LSEEK<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:50DA                 </span><span style="color:navy">push    ss:</span>USER_SP
<span style="color:maroon">DOSCODE:50DF                 </span><span style="color:navy">push    ss:</span>USER_SS
<span style="color:maroon">DOSCODE:50E4                 </span><span style="color:navy">call    </span>Fake_User_Stack
<span style="color:maroon">DOSCODE:50E7                 </span><span style="color:navy">mov     ax, bp
</span><span style="color:maroon">DOSCODE:50E9                 </span><span style="color:navy">call    </span>$LSEEK
<span style="color:maroon">DOSCODE:50EC                 </span><span style="color:navy">pop     ss:</span>USER_SS
<span style="color:maroon">DOSCODE:50F1                 </span><span style="color:navy">pop     ss:</span>USER_SP
<span style="color:maroon">DOSCODE:50F6                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:50F7
DOSCODE:50F7 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:50F7
DOSCODE:50F7
DOSCODE:50F7 </span>Fake_User_Stack proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:50F7                 </span><span style="color:navy">mov     ax, ss:</span>USER_SP_2F
<span style="color:black">DOSCODE:50FB                 </span><span style="color:navy">mov     ss:</span>USER_SP<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:50FF                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:black">DOSCODE:5101                 </span><span style="color:navy">mov     ss:</span>USER_SS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:5105                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5105 </span>Fake_User_Stack endp
<span style="color:black">DOSCODE:5105
</span><span style="color:maroon">DOSCODE:5106 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5106
DOSCODE:5106 </span>GetDevList<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5106                 </span><span style="color:navy">mov     si, offset </span>SysInitTable
<span style="color:maroon">DOSCODE:5109                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:510E                 </span><span style="color:navy">lds     si, [si]
</span><span style="color:maroon">DOSCODE:5110                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">22h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:5113                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">24h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:5116                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:5117 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5117
DOSCODE:5117 </span>NLS_IOCTL<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5117                 </span><span style="color:navy">push    ss:</span>USER_SP
<span style="color:maroon">DOSCODE:511C                 </span><span style="color:navy">push    ss:</span>USER_SS
<span style="color:maroon">DOSCODE:5121                 </span><span style="color:navy">call    </span>Fake_User_Stack
<span style="color:maroon">DOSCODE:5124                 </span><span style="color:navy">mov     ax, bp
</span><span style="color:maroon">DOSCODE:5126                 </span><span style="color:navy">call    </span>$IOCTL
<span style="color:maroon">DOSCODE:5129                 </span><span style="color:navy">pop     ss:</span>USER_SS
<span style="color:maroon">DOSCODE:512E                 </span><span style="color:navy">pop     ss:</span>USER_SP
<span style="color:maroon">DOSCODE:5133                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:5134 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5134
DOSCODE:5134 </span>NLS_GETEXT<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5134                 </span><span style="color:navy">mov     ax, ss:</span>EXTERR
<span style="color:maroon">DOSCODE:5138                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:5139 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5139
DOSCODE:5139 </span>MSG_RETRIEVAL<span style="color:navy">:                          </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5139                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:513A
DOSCODE:513A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:513A
DOSCODE:513A
DOSCODE:513A </span>ECritDisk       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:513A
DOSCODE:513A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:5146 SIZE 0000000E BYTES
</span><span style="color:black">DOSCODE:513A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:5155 SIZE 00000005 BYTES
</span><span style="color:black">DOSCODE:513A
DOSCODE:513A                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:513B                 </span><span style="color:navy">cmp     ss:</span>redir_patch<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5141                 </span><span style="color:navy">jz      short </span><span style="color:gray">ECritDisk_2
</span><span style="color:black">DOSCODE:5143                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ECritDisk_1
</span><span style="color:black">DOSCODE:5143 </span>ECritDisk       endp
<span style="color:black">DOSCODE:5143
</span><span style="color:maroon">DOSCODE:5145 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5145
DOSCODE:5145 </span>ECritDisk_iret<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5145                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:5146 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5146 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR ECritDisk
</span><span style="color:black">DOSCODE:5146
DOSCODE:5146 </span><span style="color:gray">ECritDisk_1</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5146                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:5147                 </span><span style="color:navy">call    </span>ECritDisk_iret
<span style="color:black">DOSCODE:514A
DOSCODE:514A </span><span style="color:gray">ECritDisk_0</span><span style="color:navy">:
</span><span style="color:black">DOSCODE:514A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:514B                 </span><span style="color:navy">mov     ax, </span><span style="color:green">8001h
</span><span style="color:black">DOSCODE:514E                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - BEGIN DOS CRITICAL SECTION
<span style="color:black">DOSCODE:514E                                         </span>; AL = critical section number (00h-0Fh)
<span style="color:black">DOSCODE:5150                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5151                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5152 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5152
DOSCODE:5152 </span><span style="color:gray">ECritDisk_2</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5152                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ECritDisk_3
</span><span style="color:black">DOSCODE:5152 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR ECritDisk
</span><span style="color:maroon">DOSCODE:5154 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5154
DOSCODE:5154 </span>ECritDisk_iret2<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5154                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:5155 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5155 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR ECritDisk
</span><span style="color:black">DOSCODE:5155
DOSCODE:5155 </span><span style="color:gray">ECritDisk_3</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5155                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:5156                 </span><span style="color:navy">call    </span>ECritDisk_iret2
<span style="color:black">DOSCODE:5159                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5159 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR ECritDisk
</span><span style="color:black">DOSCODE:515A
DOSCODE:515A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:515A
DOSCODE:515A
DOSCODE:515A </span>LCritDisk       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:515A
DOSCODE:515A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:5166 SIZE 0000000E BYTES
</span><span style="color:black">DOSCODE:515A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:5175 SIZE 00000005 BYTES
</span><span style="color:black">DOSCODE:515A
DOSCODE:515A                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:515B                 </span><span style="color:navy">cmp     ss:</span>redir_patch<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5161                 </span><span style="color:navy">jz      short </span><span style="color:gray">LCritDisk_2
</span><span style="color:black">DOSCODE:5163                 </span><span style="color:navy">jmp     short </span><span style="color:gray">LCritDisk_1
</span><span style="color:black">DOSCODE:5163 </span>LCritDisk       endp
<span style="color:black">DOSCODE:5163
</span><span style="color:maroon">DOSCODE:5165 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5165
DOSCODE:5165 </span>LCritDisk_iret<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5165                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:5166 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5166 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR LCritDisk
</span><span style="color:black">DOSCODE:5166
DOSCODE:5166 </span><span style="color:gray">LCritDisk_1</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5166                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:5167                 </span><span style="color:navy">call    </span>LCritDisk_iret
<span style="color:black">DOSCODE:516A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:516B                 </span><span style="color:navy">mov     ax, </span><span style="color:green">8101h
</span><span style="color:black">DOSCODE:516E                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - END DOS CRITICAL SECTION
<span style="color:black">DOSCODE:516E                                         </span>; AL = critical section number (00h-0Fh)
<span style="color:black">DOSCODE:5170                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5171                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5172 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5172
DOSCODE:5172 </span><span style="color:gray">LCritDisk_2</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5172                 </span><span style="color:navy">jmp     short </span><span style="color:gray">LCritDisk_3
</span><span style="color:black">DOSCODE:5172 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR LCritDisk
</span><span style="color:maroon">DOSCODE:5174 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5174
DOSCODE:5174 </span>LCritDisk_iret2<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5174                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:5175 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5175 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR LCritDisk
</span><span style="color:black">DOSCODE:5175
DOSCODE:5175 </span><span style="color:gray">LCritDisk_3</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5175                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:5176                 </span><span style="color:navy">call    </span>LCritDisk_iret2
<span style="color:black">DOSCODE:5179                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5179 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR LCritDisk
</span><span style="color:black">DOSCODE:517A
DOSCODE:517A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:517A
DOSCODE:517A
DOSCODE:517A </span>ECritDevice     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:517A
DOSCODE:517A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:5186 SIZE 0000000E BYTES
</span><span style="color:black">DOSCODE:517A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:5195 SIZE 00000005 BYTES
</span><span style="color:black">DOSCODE:517A
DOSCODE:517A                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:517B                 </span><span style="color:navy">cmp     ss:</span>redir_patch<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5181                 </span><span style="color:navy">jz      short </span><span style="color:gray">ECritDevice_2
</span><span style="color:black">DOSCODE:5183                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ECritDevice_1
</span><span style="color:black">DOSCODE:5183 </span>ECritDevice     endp
<span style="color:black">DOSCODE:5183
</span><span style="color:maroon">DOSCODE:5185 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5185
DOSCODE:5185 </span>ECritDevice_iret<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5185                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:5186 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5186 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR ECritDevice
</span><span style="color:black">DOSCODE:5186
DOSCODE:5186 </span><span style="color:gray">ECritDevice_1</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5186                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:5187                 </span><span style="color:navy">call    </span>ECritDevice_iret
<span style="color:black">DOSCODE:518A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:518B                 </span><span style="color:navy">mov     ax, </span><span style="color:green">8002h
</span><span style="color:black">DOSCODE:518E                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - BEGIN DOS CRITICAL SECTION
<span style="color:black">DOSCODE:518E                                         </span>; AL = critical section number (00h-0Fh)
<span style="color:black">DOSCODE:5190                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5191                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5192 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5192
DOSCODE:5192 </span><span style="color:gray">ECritDevice_2</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5192                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ECritDevice_3
</span><span style="color:black">DOSCODE:5192 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR ECritDevice
</span><span style="color:maroon">DOSCODE:5194 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5194
DOSCODE:5194 </span>ECritDevice_iret2<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5194                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:5195 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5195 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR ECritDevice
</span><span style="color:black">DOSCODE:5195
DOSCODE:5195 </span><span style="color:gray">ECritDevice_3</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5195                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:5196                 </span><span style="color:navy">call    </span>ECritDevice_iret2
<span style="color:black">DOSCODE:5199                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5199 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR ECritDevice
</span><span style="color:black">DOSCODE:519A
DOSCODE:519A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:519A
DOSCODE:519A
DOSCODE:519A </span>LCritDevice     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:519A
DOSCODE:519A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:51A6 SIZE 0000000E BYTES
</span><span style="color:black">DOSCODE:519A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:51B5 SIZE 00000005 BYTES
</span><span style="color:black">DOSCODE:519A
DOSCODE:519A                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:519B                 </span><span style="color:navy">cmp     ss:</span>redir_patch<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:51A1                 </span><span style="color:navy">jz      short </span><span style="color:gray">LCritDevice_2
</span><span style="color:black">DOSCODE:51A3                 </span><span style="color:navy">jmp     short </span><span style="color:gray">LCritDevice_1
</span><span style="color:black">DOSCODE:51A3 </span>LCritDevice     endp
<span style="color:black">DOSCODE:51A3
</span><span style="color:maroon">DOSCODE:51A5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:51A5
DOSCODE:51A5 </span>LCritDevice_iret<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:51A5                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:51A6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:51A6 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR LCritDevice
</span><span style="color:black">DOSCODE:51A6
DOSCODE:51A6 </span><span style="color:gray">LCritDevice_1</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:51A6                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:51A7                 </span><span style="color:navy">call    </span>LCritDevice_iret
<span style="color:black">DOSCODE:51AA                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:51AB                 </span><span style="color:navy">mov     ax, </span><span style="color:green">8102h
</span><span style="color:black">DOSCODE:51AE                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - END DOS CRITICAL SECTION
<span style="color:black">DOSCODE:51AE                                         </span>; AL = critical section number (00h-0Fh)
<span style="color:black">DOSCODE:51B0                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:51B1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:51B2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:51B2
DOSCODE:51B2 </span><span style="color:gray">LCritDevice_2</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:51B2                 </span><span style="color:navy">jmp     short </span><span style="color:gray">LCritDevice_3
</span><span style="color:black">DOSCODE:51B2 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR LCritDevice
</span><span style="color:maroon">DOSCODE:51B4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:51B4
DOSCODE:51B4 </span>LCritDevice_iret2<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:51B4                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:51B5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:51B5 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR LCritDevice
</span><span style="color:black">DOSCODE:51B5
DOSCODE:51B5 </span><span style="color:gray">LCritDevice_3</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:51B5                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:51B6                 </span><span style="color:navy">call    </span>LCritDevice_iret2
<span style="color:black">DOSCODE:51B9                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:51B9 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR LCritDevice
</span><span style="color:black">DOSCODE:51BA
DOSCODE:51BA </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:51BA
DOSCODE:51BA
DOSCODE:51BA </span>$STD_CON_INPUT_NO_ECHO proc near        <span style="color:green">; ...
</span><span style="color:black">DOSCODE:51BA                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:51BB                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:51BC
DOSCODE:51BC </span><span style="color:gray">INTEST</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:51BC                 </span><span style="color:navy">call    near ptr </span>STATCHK
<span style="color:black">DOSCODE:51BF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GET
</span><span style="color:black">DOSCODE:51C1                 </span><span style="color:navy">cmp     ss:</span>PRINTER_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:51C7                 </span><span style="color:navy">jnz     short </span><span style="color:gray">no_sys_wait
</span><span style="color:black">DOSCODE:51C9                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:51CB                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:51CE
DOSCODE:51CE </span><span style="color:gray">no_sys_wait</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:51CE                 </span><span style="color:navy">mov     ah, </span><span style="color:green">84h
</span><span style="color:black">DOSCODE:51D0                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - KEYBOARD BUSY LOOP
<span style="color:black">DOSCODE:51D2                 </span><span style="color:navy">cmp     byte ptr ss:</span>DATE_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:51D8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NoUpdate
</span><span style="color:black">DOSCODE:51DA                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:51DB                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:51DC                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:51DD                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:51DE                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:51DF                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:51E0                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:51E1                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:51E4                 </span><span style="color:navy">call    </span>Save_Restore_Packet
<span style="color:black">DOSCODE:51E7                 </span><span style="color:navy">call    </span>READTIME
<span style="color:black">DOSCODE:51EA                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:51ED                 </span><span style="color:navy">call    </span>Save_Restore_Packet
<span style="color:black">DOSCODE:51F0                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:51F1                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:51F2                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:51F3                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:51F4                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:51F5
DOSCODE:51F5 </span><span style="color:gray">NoUpdate</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:51F5                 </span><span style="color:navy">inc     ss:</span>DATE_FLAG
<span style="color:black">DOSCODE:51FA                 </span><span style="color:navy">jmp     short </span><span style="color:gray">INTEST
</span><span style="color:black">DOSCODE:51FC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:51FC
DOSCODE:51FC </span><span style="color:gray">GET</span><span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:51FC                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:51FE                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:5201                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:5202                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5203                 </span><span style="color:navy">mov     ss:</span>SCAN_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5209                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:520B                 </span><span style="color:navy">jnz     short </span>noscan
<span style="color:black">DOSCODE:520D                 </span><span style="color:navy">mov     ss:</span>SCAN_FLAG<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5213
DOSCODE:5213 </span>noscan<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5213                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5213 </span>$STD_CON_INPUT_NO_ECHO endp
<span style="color:black">DOSCODE:5213
</span><span style="color:maroon">DOSCODE:5214 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5214
DOSCODE:5214 </span>$STD_CON_STRING_OUTPUT<span style="color:navy">:                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5214                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:5216
DOSCODE:5216 </span>STRING_OUT1<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5216                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:5217                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">$&#039;
</span><span style="color:maroon">DOSCODE:5219                 </span><span style="color:navy">jz      short </span>noscan
<span style="color:maroon">DOSCODE:521B                 </span><span style="color:navy">call    </span>OUTT
<span style="color:maroon">DOSCODE:521E                 </span><span style="color:navy">jmp     short </span>STRING_OUT1
<span style="color:black">DOSCODE:5220
DOSCODE:5220 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5220
DOSCODE:5220
DOSCODE:5220 </span>$STD_CON_STRING_INPUT proc near         <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5220
DOSCODE:5220 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:4820 SIZE 00000019 BYTES
</span><span style="color:black">DOSCODE:5220 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:52C5 SIZE 00000005 BYTES
</span><span style="color:black">DOSCODE:5220 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:52F3 SIZE 00000019 BYTES
</span><span style="color:black">DOSCODE:5220 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:537D SIZE 00000044 BYTES
</span><span style="color:black">DOSCODE:5220 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:53F1 SIZE 00000021 BYTES
</span><span style="color:black">DOSCODE:5220
DOSCODE:5220                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:black">DOSCODE:5222                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:5224                 </span><span style="color:navy">mov     si, dx
</span><span style="color:black">DOSCODE:5226                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:5228                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:5229                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:522B                 </span><span style="color:navy">jz      short </span>noscan
<span style="color:black">DOSCODE:522D                 </span><span style="color:navy">mov     bl, ah
</span><span style="color:black">DOSCODE:522F                 </span><span style="color:navy">mov     bh, ch
</span><span style="color:black">DOSCODE:5231                 </span><span style="color:navy">cmp     al, bl
</span><span style="color:black">DOSCODE:5233                 </span><span style="color:navy">jbe     short </span><span style="color:gray">NOEDIT
</span><span style="color:black">DOSCODE:5235                 </span><span style="color:navy">cmp     byte ptr [bx+si], </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:5238                 </span><span style="color:navy">jz      short </span><span style="color:gray">EDITON
</span><span style="color:black">DOSCODE:523A
DOSCODE:523A </span><span style="color:gray">NOEDIT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:523A                 </span><span style="color:navy">mov     bl, ch
</span><span style="color:black">DOSCODE:523C
DOSCODE:523C </span><span style="color:gray">EDITON</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:523C                 </span><span style="color:navy">mov     dl, al
</span><span style="color:black">DOSCODE:523E                 </span><span style="color:navy">dec     dx
</span><span style="color:black">DOSCODE:523F
DOSCODE:523F </span><span style="color:gray">NEWLIN</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:523F                 </span><span style="color:navy">mov     al, ss:</span>CARPOS
<span style="color:black">DOSCODE:5243                 </span><span style="color:navy">mov     ss:</span>STARTPOS<span style="color:navy">, al
</span><span style="color:black">DOSCODE:5247                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:5248                 </span><span style="color:navy">mov     di, offset </span>INBUF
<span style="color:black">DOSCODE:524B                 </span><span style="color:navy">mov     ss:</span>INSMODE<span style="color:navy">, ch
</span><span style="color:black">DOSCODE:5250                 </span><span style="color:navy">mov     bh, ch
</span><span style="color:black">DOSCODE:5252                 </span><span style="color:navy">mov     dh, ch
</span><span style="color:black">DOSCODE:5254                 </span><span style="color:navy">call    </span>$STD_CON_INPUT_NO_ECHO
<span style="color:black">DOSCODE:5257                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:black">DOSCODE:5259                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GOTCH
</span><span style="color:black">DOSCODE:525B
DOSCODE:525B </span>GETCH<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:525B                 </span><span style="color:navy">call    </span>$STD_CON_INPUT_NO_ECHO
<span style="color:black">DOSCODE:525E
DOSCODE:525E </span><span style="color:gray">GOTCH</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:525E                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:5260                 </span><span style="color:navy">jz      short </span>GETCH
<span style="color:black">DOSCODE:5262                 </span><span style="color:navy">cmp     al, cs:</span>ESCCHAR
<span style="color:black">DOSCODE:5267                 </span><span style="color:navy">jz      short </span><span style="color:gray">ESCAPE
</span><span style="color:black">DOSCODE:5269                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">7Fh </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:526B                 </span><span style="color:navy">jz      short </span><span style="color:gray">BACKSPJ
</span><span style="color:black">DOSCODE:526D                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:526F                 </span><span style="color:navy">jz      short </span><span style="color:gray">BACKSPJ
</span><span style="color:black">DOSCODE:5271                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">17h
</span><span style="color:black">DOSCODE:5273                 </span><span style="color:navy">nop
</span><span style="color:black">DOSCODE:5274                 </span><span style="color:navy">nop
</span><span style="color:black">DOSCODE:5275                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">15h
</span><span style="color:black">DOSCODE:5277                 </span><span style="color:navy">nop
</span><span style="color:black">DOSCODE:5278                 </span><span style="color:navy">nop
</span><span style="color:black">DOSCODE:5279                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:527B                 </span><span style="color:navy">jz      short </span><span style="color:gray">ENDLIN
</span><span style="color:black">DOSCODE:527D                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:black">DOSCODE:527F                 </span><span style="color:navy">jz      short </span><span style="color:gray">PHYCRLF
</span><span style="color:black">DOSCODE:5281                 </span><span style="color:navy">cmp     al, cs:</span>CANCHAR
<span style="color:black">DOSCODE:5286                 </span><span style="color:navy">jz      short </span>KILNEW
<span style="color:black">DOSCODE:5288
DOSCODE:5288 </span><span style="color:gray">SAVCH</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5288                 </span><span style="color:navy">cmp     dh, dl
</span><span style="color:black">DOSCODE:528A                 </span><span style="color:navy">jnb     short </span><span style="color:gray">BUFFUL
</span><span style="color:black">DOSCODE:528C                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:528D                 </span><span style="color:navy">inc     dh
</span><span style="color:black">DOSCODE:528F                 </span><span style="color:navy">call    </span>BUFOUT
<span style="color:black">DOSCODE:5292                 </span><span style="color:navy">cmp     ss:</span>INSMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5298                 </span><span style="color:navy">jnz     short </span>GETCH
<span style="color:black">DOSCODE:529A                 </span><span style="color:navy">cmp     bh, bl
</span><span style="color:black">DOSCODE:529C                 </span><span style="color:navy">jnb     short </span>GETCH
<span style="color:black">DOSCODE:529E                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:529F                 </span><span style="color:navy">inc     bh
</span><span style="color:black">DOSCODE:52A1                 </span><span style="color:navy">jmp     short </span>GETCH
<span style="color:black">DOSCODE:52A3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:52A3
DOSCODE:52A3 </span><span style="color:gray">BACKSPJ</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52A3                 </span><span style="color:navy">jmp     short </span>BACKSP
<span style="color:black">DOSCODE:52A5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:52A5
DOSCODE:52A5 </span><span style="color:gray">BUFFUL</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52A5                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:52A7                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:52AA                 </span><span style="color:navy">jmp     short </span>GETCH
<span style="color:black">DOSCODE:52AC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:52AC
DOSCODE:52AC </span><span style="color:gray">ESCAPE</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52AC                 </span><span style="color:navy">jmp     </span><span style="color:gray">OEMFunctionKey
</span><span style="color:black">DOSCODE:52AF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:52AF
DOSCODE:52AF </span><span style="color:gray">ENDLIN</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52AF                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:52B0                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:52B3                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:52B4                 </span><span style="color:navy">mov     [di-</span><span style="color:green">1</span><span style="color:navy">], dh
</span><span style="color:black">DOSCODE:52B7                 </span><span style="color:navy">inc     dh
</span><span style="color:black">DOSCODE:52B7 </span>$STD_CON_STRING_INPUT endp
<span style="color:black">DOSCODE:52B7
DOSCODE:52B9
DOSCODE:52B9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:52B9
DOSCODE:52B9
DOSCODE:52B9 </span>COPYNEW         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:52B9                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:52BA                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:52BB                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:52BC                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:52BD                 </span><span style="color:navy">mov     si, offset </span>INBUF
<span style="color:black">DOSCODE:52C0                 </span><span style="color:navy">mov     cl, dh
</span><span style="color:black">DOSCODE:52C2                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:52C4
DOSCODE:52C4 </span>OLDBAK_RETN<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52C4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:52C4 </span>COPYNEW         endp
<span style="color:black">DOSCODE:52C4
DOSCODE:52C5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:52C5 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:black">DOSCODE:52C5
DOSCODE:52C5 </span><span style="color:gray">PHYCRLF</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52C5                 </span><span style="color:navy">call    </span>CRLF
<span style="color:black">DOSCODE:52C8                 </span><span style="color:navy">jmp     short </span>GETCH
<span style="color:black">DOSCODE:52C8 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:maroon">DOSCODE:52CA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:52CA
DOSCODE:52CA </span>LineDel<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:52CA                 </span><span style="color:navy">or      dh, dh
</span><span style="color:maroon">DOSCODE:52CC                 </span><span style="color:navy">jz      short </span>GETCH
<span style="color:maroon">DOSCODE:52CE                 </span><span style="color:navy">call    </span>BackSpace
<span style="color:maroon">DOSCODE:52D1                 </span><span style="color:navy">jmp     short </span>LineDel
<span style="color:maroon">DOSCODE:52D3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:52D3
DOSCODE:52D3 </span>WordDel<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:52D3                 </span><span style="color:navy">call    </span>BackSpace
<span style="color:maroon">DOSCODE:52D6                 </span><span style="color:navy">or      dh, dh
</span><span style="color:maroon">DOSCODE:52D8                 </span><span style="color:navy">jz      short </span>getchj
<span style="color:maroon">DOSCODE:52DA                 </span><span style="color:navy">mov     al, es:[di-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:52DE                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">0&#039;
</span><span style="color:maroon">DOSCODE:52E0                 </span><span style="color:navy">jb      short </span>getchj
<span style="color:maroon">DOSCODE:52E2                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">9&#039;
</span><span style="color:maroon">DOSCODE:52E4                 </span><span style="color:navy">jbe     short </span>WordDel
<span style="color:maroon">DOSCODE:52E6                 </span><span style="color:navy">or      al, </span><span style="color:green">20h
</span><span style="color:maroon">DOSCODE:52E8                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">a&#039;
</span><span style="color:maroon">DOSCODE:52EA                 </span><span style="color:navy">jb      short </span>getchj
<span style="color:maroon">DOSCODE:52EC                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">z&#039;
</span><span style="color:maroon">DOSCODE:52EE                 </span><span style="color:navy">jbe     short </span>WordDel
<span style="color:maroon">DOSCODE:52F0
DOSCODE:52F0 </span>getchj<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:52F0                 </span><span style="color:navy">jmp     </span>GETCH
<span style="color:black">DOSCODE:52F3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:52F3 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:black">DOSCODE:52F3
DOSCODE:52F3 </span>KILNEW<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52F3                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:52F5                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:52F8                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:52F9
DOSCODE:52F9 </span><span style="color:gray">PUTNEW</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:52F9                 </span><span style="color:navy">call    </span>CRLF
<span style="color:black">DOSCODE:52FC                 </span><span style="color:navy">mov     al, ss:</span>STARTPOS
<span style="color:black">DOSCODE:5300                 </span><span style="color:navy">call    </span>TAB
<span style="color:black">DOSCODE:5303                 </span><span style="color:navy">jmp     </span><span style="color:gray">NEWLIN
</span><span style="color:black">DOSCODE:5306 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5306
DOSCODE:5306 </span>BACKSP<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5306                 </span><span style="color:navy">call    </span>BackSpace
<span style="color:black">DOSCODE:5309                 </span><span style="color:navy">jmp     </span>GETCH
<span style="color:black">DOSCODE:5309 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:black">DOSCODE:530C
DOSCODE:530C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:530C
DOSCODE:530C
DOSCODE:530C </span>BackSpace       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:530C                 </span><span style="color:navy">or      dh, dh
</span><span style="color:black">DOSCODE:530E                 </span><span style="color:navy">jz      short </span><span style="color:gray">OLDBAK
</span><span style="color:black">DOSCODE:5310                 </span><span style="color:navy">call    </span>BACKUP
<span style="color:black">DOSCODE:5313                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:5316                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:black">DOSCODE:5318                 </span><span style="color:navy">jnb     short </span><span style="color:gray">OLDBAK
</span><span style="color:black">DOSCODE:531A                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">9
</span><span style="color:black">DOSCODE:531C                 </span><span style="color:navy">jz      short </span><span style="color:gray">BAKTAB
</span><span style="color:black">DOSCODE:531E                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">15h
</span><span style="color:black">DOSCODE:5320                 </span><span style="color:navy">jz      short </span><span style="color:gray">OLDBAK
</span><span style="color:black">DOSCODE:5322                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">14h
</span><span style="color:black">DOSCODE:5324                 </span><span style="color:navy">jz      short </span><span style="color:gray">OLDBAK
</span><span style="color:black">DOSCODE:5326                 </span><span style="color:navy">call    </span>BACKMES
<span style="color:black">DOSCODE:5329
DOSCODE:5329 </span><span style="color:gray">OLDBAK</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5329                 </span><span style="color:navy">cmp     ss:</span>INSMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:532F                 </span><span style="color:navy">jnz     short </span>OLDBAK_RETN
<span style="color:black">DOSCODE:5331                 </span><span style="color:navy">or      bh, bh
</span><span style="color:black">DOSCODE:5333                 </span><span style="color:navy">jz      short </span>OLDBAK_RETN
<span style="color:black">DOSCODE:5335                 </span><span style="color:navy">dec     bh
</span><span style="color:black">DOSCODE:5337                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:5338                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5339 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5339
DOSCODE:5339 </span><span style="color:gray">BAKTAB</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5339                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:533A                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:533B                 </span><span style="color:navy">std
</span><span style="color:black">DOSCODE:533C                 </span><span style="color:navy">mov     cl, dh
</span><span style="color:black">DOSCODE:533E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:black">DOSCODE:5340                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:5341                 </span><span style="color:navy">mov     bl, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:5343                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">FIGTAB
</span><span style="color:black">DOSCODE:5345
DOSCODE:5345 </span><span style="color:gray">FNDPOS</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5345                 </span><span style="color:navy">scasb
</span><span style="color:black">DOSCODE:5346                 </span><span style="color:navy">jbe     short </span><span style="color:gray">CHKCNT
</span><span style="color:black">DOSCODE:5348                 </span><span style="color:navy">cmp     byte ptr es:[di+</span><span style="color:#ff8000">1</span><span style="color:navy">], </span><span style="color:#ff8000">9
</span><span style="color:black">DOSCODE:534D                 </span><span style="color:navy">jz      short </span><span style="color:gray">HAVTAB
</span><span style="color:black">DOSCODE:534F                 </span><span style="color:navy">dec     bl
</span><span style="color:black">DOSCODE:5351
DOSCODE:5351 </span><span style="color:gray">CHKCNT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5351                 </span><span style="color:navy">loop    </span><span style="color:gray">FNDPOS
</span><span style="color:black">DOSCODE:5353
DOSCODE:5353 </span><span style="color:gray">FIGTAB</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5353                 </span><span style="color:navy">sub     bl, ss:</span>STARTPOS
<span style="color:black">DOSCODE:5358
DOSCODE:5358 </span><span style="color:gray">HAVTAB</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5358                 </span><span style="color:navy">sub     bl, dh
</span><span style="color:black">DOSCODE:535A                 </span><span style="color:navy">add     cl, bl
</span><span style="color:black">DOSCODE:535C                 </span><span style="color:navy">and     cl, </span><span style="color:green">7
</span><span style="color:black">DOSCODE:535F                 </span><span style="color:navy">cld
</span><span style="color:black">DOSCODE:5360                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:5361                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:5362                 </span><span style="color:navy">jz      short </span><span style="color:gray">OLDBAK
</span><span style="color:black">DOSCODE:5364
DOSCODE:5364 </span><span style="color:gray">TABBAK</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5364                 </span><span style="color:navy">call    </span>BACKMES
<span style="color:black">DOSCODE:5367                 </span><span style="color:navy">loop    </span><span style="color:gray">TABBAK
</span><span style="color:black">DOSCODE:5369                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OLDBAK
</span><span style="color:black">DOSCODE:5369 </span>BackSpace       endp
<span style="color:black">DOSCODE:5369
DOSCODE:536B
DOSCODE:536B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:536B
DOSCODE:536B
DOSCODE:536B </span>BACKUP          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:536B                 </span><span style="color:navy">dec     dh
</span><span style="color:black">DOSCODE:536D                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:536D </span>BACKUP          endp
<span style="color:black">DOSCODE:536D
DOSCODE:536E
DOSCODE:536E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:536E
DOSCODE:536E
DOSCODE:536E </span>BACKMES         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:536E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:5370                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:5373                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:black">DOSCODE:5375                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:5378                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:537A                 </span><span style="color:navy">jmp     </span>OUTT
<span style="color:black">DOSCODE:537A </span>BACKMES         endp
<span style="color:black">DOSCODE:537A
DOSCODE:537D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:537D </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:black">DOSCODE:537D
DOSCODE:537D </span>TWOESC<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:537D                 </span><span style="color:navy">mov     al, cs:</span>ESCCHAR
<span style="color:black">DOSCODE:5381                 </span><span style="color:navy">jmp     </span><span style="color:gray">SAVCH
</span><span style="color:black">DOSCODE:5384 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5384
DOSCODE:5384 </span>COPYLIN<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5384                 </span><span style="color:navy">mov     cl, bl
</span><span style="color:black">DOSCODE:5386                 </span><span style="color:navy">sub     cl, bh
</span><span style="color:black">DOSCODE:5388                 </span><span style="color:navy">jmp     short </span><span style="color:gray">COPYEACH
</span><span style="color:black">DOSCODE:538A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:538A
DOSCODE:538A </span>COPYSTR<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:538A                 </span><span style="color:navy">call    </span>FINDOLD
<span style="color:black">DOSCODE:538D                 </span><span style="color:navy">jmp     short </span><span style="color:gray">COPYEACH
</span><span style="color:black">DOSCODE:538F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:538F
DOSCODE:538F </span>COPYONE<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:538F                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5391
DOSCODE:5391 </span><span style="color:gray">COPYEACH</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5391                 </span><span style="color:navy">mov     ss:</span>INSMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5397                 </span><span style="color:navy">cmp     dh, dl
</span><span style="color:black">DOSCODE:5399                 </span><span style="color:navy">jz      short </span><span style="color:gray">GETCH2
</span><span style="color:black">DOSCODE:539B                 </span><span style="color:navy">cmp     bh, bl
</span><span style="color:black">DOSCODE:539D                 </span><span style="color:navy">jz      short </span><span style="color:gray">GETCH2
</span><span style="color:black">DOSCODE:539F                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:53A0                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:53A1                 </span><span style="color:navy">call    </span>BUFOUT
<span style="color:black">DOSCODE:53A4                 </span><span style="color:navy">inc     bh
</span><span style="color:black">DOSCODE:53A6                 </span><span style="color:navy">inc     dh
</span><span style="color:black">DOSCODE:53A8                 </span><span style="color:navy">loop    </span><span style="color:gray">COPYEACH
</span><span style="color:black">DOSCODE:53AA
DOSCODE:53AA </span><span style="color:gray">GETCH2</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:53AA                 </span><span style="color:navy">jmp     </span>GETCH
<span style="color:black">DOSCODE:53AD </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:53AD
DOSCODE:53AD </span>SKIPONE<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:53AD                 </span><span style="color:navy">cmp     bh, bl
</span><span style="color:black">DOSCODE:53AF                 </span><span style="color:navy">jz      short </span><span style="color:gray">GETCH2
</span><span style="color:black">DOSCODE:53B1                 </span><span style="color:navy">inc     bh
</span><span style="color:black">DOSCODE:53B3                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:53B4                 </span><span style="color:navy">jmp     </span>GETCH
<span style="color:black">DOSCODE:53B7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:53B7
DOSCODE:53B7 </span>SKIPSTR<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:53B7                 </span><span style="color:navy">call    </span>FINDOLD
<span style="color:black">DOSCODE:53BA                 </span><span style="color:navy">add     si, cx
</span><span style="color:black">DOSCODE:53BC                 </span><span style="color:navy">add     bh, cl
</span><span style="color:black">DOSCODE:53BE                 </span><span style="color:navy">jmp     </span>GETCH
<span style="color:black">DOSCODE:53BE </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:maroon">DOSCODE:53C1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:53C1
DOSCODE:53C1 </span>FINDOLD<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:53C1                 </span><span style="color:navy">call    </span>$STD_CON_INPUT_NO_ECHO
<span style="color:maroon">DOSCODE:53C4                 </span><span style="color:navy">cmp     al, cs:</span>ESCCHAR
<span style="color:maroon">DOSCODE:53C9                 </span><span style="color:navy">jnz     short </span>FINDSETUP
<span style="color:maroon">DOSCODE:53CB                 </span><span style="color:navy">call    </span>$STD_CON_INPUT_NO_ECHO
<span style="color:maroon">DOSCODE:53CE                 </span><span style="color:navy">jmp     short </span>NOTFND
<span style="color:maroon">DOSCODE:53D0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:53D0
DOSCODE:53D0 </span>FINDSETUP<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:53D0                 </span><span style="color:navy">mov     cl, bl
</span><span style="color:maroon">DOSCODE:53D2                 </span><span style="color:navy">sub     cl, bh
</span><span style="color:maroon">DOSCODE:53D4                 </span><span style="color:navy">jz      short </span>NOTFND
<span style="color:maroon">DOSCODE:53D6                 </span><span style="color:navy">dec     cx
</span><span style="color:maroon">DOSCODE:53D7                 </span><span style="color:navy">jz      short </span>NOTFND
<span style="color:maroon">DOSCODE:53D9                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:53DA                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:53DB                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:53DC                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:53DD                 </span><span style="color:navy">mov     di, si
</span><span style="color:maroon">DOSCODE:53DF                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:53E0                 </span><span style="color:navy">repne scasb
</span><span style="color:maroon">DOSCODE:53E2                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:53E3                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:53E4                 </span><span style="color:navy">jnz     short </span>NOTFND
<span style="color:maroon">DOSCODE:53E6                 </span><span style="color:navy">not     cl
</span><span style="color:maroon">DOSCODE:53E8                 </span><span style="color:navy">add     cl, bl
</span><span style="color:maroon">DOSCODE:53EA                 </span><span style="color:navy">sub     cl, bh
</span><span style="color:maroon">DOSCODE:53EC
DOSCODE:53EC </span>FINDOLD_RETN<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:53EC                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:53ED </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:53ED
DOSCODE:53ED </span>NOTFND<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:53ED                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:53EE                 </span><span style="color:navy">jmp     </span>GETCH
<span style="color:black">DOSCODE:53F1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:53F1 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:black">DOSCODE:53F1
DOSCODE:53F1 </span>REEDIT<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:53F1                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">@&#039;
</span><span style="color:black">DOSCODE:53F3                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:53F6                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:53F7                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:53F8                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:53F9                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:53FA                 </span><span style="color:navy">call    </span>COPYNEW
<span style="color:black">DOSCODE:53FD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:53FE                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:53FF                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:5400                 </span><span style="color:navy">mov     bl, dh
</span><span style="color:black">DOSCODE:5402                 </span><span style="color:navy">jmp     </span><span style="color:gray">PUTNEW
</span><span style="color:black">DOSCODE:5405 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5405
DOSCODE:5405 </span>EXITINS_ENTERINS<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5405                 </span><span style="color:navy">not     ss:</span>INSMODE
<span style="color:black">DOSCODE:540A                 </span><span style="color:navy">jmp     </span>GETCH
<span style="color:black">DOSCODE:540D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:540D
DOSCODE:540D </span>CTRLZ<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:540D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:540F                 </span><span style="color:navy">jmp     </span><span style="color:gray">SAVCH
</span><span style="color:black">DOSCODE:540F </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $STD_CON_STRING_INPUT
</span><span style="color:black">DOSCODE:5412
DOSCODE:5412 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5412
DOSCODE:5412
DOSCODE:5412 </span>CRLF            proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5412                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:5414                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:5417                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:black">DOSCODE:5419                 </span><span style="color:navy">jmp     </span>OUTT
<span style="color:black">DOSCODE:5419 </span>CRLF            endp
<span style="color:black">DOSCODE:5419
</span><span style="color:maroon">DOSCODE:541C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:541C
DOSCODE:541C </span>$RAW_CON_IO<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:541C                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:541E                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:5420                 </span><span style="color:navy">jz      short </span>rcio1
<span style="color:maroon">DOSCODE:5422                 </span><span style="color:navy">jmp     short </span>RAWOUT
<span style="color:maroon">DOSCODE:5424 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5424                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSCODE:5425
DOSCODE:5425 </span>rcio1<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5425                 </span><span style="color:navy">les     di, dword ptr ss:</span>USER_SP
<span style="color:maroon">DOSCODE:542A                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:maroon">DOSCODE:542C                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:maroon">DOSCODE:542F                 </span><span style="color:navy">jb      short </span>FINDOLD_RETN
<span style="color:maroon">DOSCODE:5431                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:5433                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:maroon">DOSCODE:5436                 </span><span style="color:navy">jnz     short </span>RESFLG
<span style="color:maroon">DOSCODE:5438                 </span><span style="color:navy">call    </span>SPOOLINT
<span style="color:maroon">DOSCODE:543B                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">16h</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:maroon">DOSCODE:5440                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:5442
DOSCODE:5442 </span>RET17<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5442                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:5443 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5443
DOSCODE:5443 </span>RESFLG<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5443                 </span><span style="color:navy">and     byte ptr es:[di+</span><span style="color:#ff8000">16h</span><span style="color:navy">], </span><span style="color:green">0BFh
</span><span style="color:maroon">DOSCODE:5448
DOSCODE:5448 </span>rci0<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5448                 </span><span style="color:navy">call    </span>SPOOLINT
<span style="color:maroon">DOSCODE:544B
DOSCODE:544B </span>$RAW_CON_INPUT<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:544B                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:544C                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:maroon">DOSCODE:544E                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:maroon">DOSCODE:5451                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:5452                 </span><span style="color:navy">jb      short </span>RET17
<span style="color:maroon">DOSCODE:5454                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:5456                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:maroon">DOSCODE:5459                 </span><span style="color:navy">jnz     short </span>rci5
<span style="color:maroon">DOSCODE:545B                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">84h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:maroon">DOSCODE:545D                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - KEYBOARD BUSY LOOP
<span style="color:maroon">DOSCODE:545F                 </span><span style="color:navy">jmp     short </span>rci0
<span style="color:maroon">DOSCODE:5461 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5461
DOSCODE:5461 </span>rci5<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5461                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:5463                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:maroon">DOSCODE:5466                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5467
DOSCODE:5467 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5467
DOSCODE:5467
DOSCODE:5467 </span>RAWOUT          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5467                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:5468                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:546B                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:546E                 </span><span style="color:navy">jb      short </span><span style="color:gray">RAWRET1
</span><span style="color:black">DOSCODE:5470                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5473                 </span><span style="color:navy">and     bx, </span><span style="color:green">8080h
</span><span style="color:black">DOSCODE:5477                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">80h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:547B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">RAWNORM
</span><span style="color:black">DOSCODE:547D                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:547E                 </span><span style="color:navy">lds     bx, [si+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5481                 </span><span style="color:navy">test    byte ptr [bx+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:5485                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5486                 </span><span style="color:navy">jz      short </span><span style="color:gray">RAWNORM
</span><span style="color:black">DOSCODE:5488                 </span><span style="color:navy">int     </span><span style="color:green">29h             </span>; DOS 2+ internal - FAST PUTCHAR
<span style="color:black">DOSCODE:5488                                         </span>; AL = character to display
<span style="color:black">DOSCODE:548A
DOSCODE:548A </span><span style="color:gray">RAWRET</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:548A                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:548B
DOSCODE:548B </span><span style="color:gray">RAWRET1</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:548B                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:548C
DOSCODE:548C </span>RAWRET2<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:548C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:548D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:548D
DOSCODE:548D </span><span style="color:gray">RAWNORM</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:548D                 </span><span style="color:navy">call    </span>RAWOUT3
<span style="color:black">DOSCODE:5490                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RAWRET
</span><span style="color:black">DOSCODE:5490 </span>RAWOUT          endp
<span style="color:black">DOSCODE:5490
DOSCODE:5492
DOSCODE:5492 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5492
DOSCODE:5492
DOSCODE:5492 </span>RAWOUT2         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5492                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:5495                 </span><span style="color:navy">jb      short </span>RAWRET2
<span style="color:black">DOSCODE:5495 </span>RAWOUT2         endp
<span style="color:black">DOSCODE:5495
DOSCODE:5497
DOSCODE:5497 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5497
DOSCODE:5497
DOSCODE:5497 </span>RAWOUT3         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5497                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5498                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RAWOSTRT
</span><span style="color:black">DOSCODE:549A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:549A
DOSCODE:549A </span><span style="color:gray">ROLP</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:549A                 </span><span style="color:navy">call    </span>SPOOLINT
<span style="color:black">DOSCODE:549D                 </span><span style="color:navy">or      ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">200h
</span><span style="color:black">DOSCODE:54A4                 </span><span style="color:navy">call    </span>DSKSTATCHK
<span style="color:black">DOSCODE:54A7
DOSCODE:54A7 </span><span style="color:gray">RAWOSTRT</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:54A7                 </span><span style="color:navy">mov     ah, </span><span style="color:green">3
</span><span style="color:black">DOSCODE:54A9                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:54AC                 </span><span style="color:navy">jz      short </span><span style="color:gray">ROLP
</span><span style="color:black">DOSCODE:54AE                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:54AF                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:54B0                 </span><span style="color:navy">jz      short </span><span style="color:gray">nosend
</span><span style="color:black">DOSCODE:54B2                 </span><span style="color:navy">mov     ah, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:54B4                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:54B7
DOSCODE:54B7 </span><span style="color:gray">nosend</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:54B7                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:54B8                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:54B8 </span>RAWOUT3         endp
<span style="color:black">DOSCODE:54B8
DOSCODE:54B9
DOSCODE:54B9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:54B9
DOSCODE:54B9
DOSCODE:54B9 </span>Save_Restore_Packet proc near           <span style="color:green">; ...
</span><span style="color:black">DOSCODE:54B9                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:54BA                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:54BB                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:54BC                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:54BD                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:54C0                 </span><span style="color:navy">jz      short </span><span style="color:gray">save_packet
</span><span style="color:black">DOSCODE:54C2
DOSCODE:54C2 </span>restore_packet<span style="color:navy">:
</span><span style="color:black">DOSCODE:54C2                 </span><span style="color:navy">mov     si, offset </span>FAKE_STACK_2F
<span style="color:black">DOSCODE:54C5                 </span><span style="color:navy">mov     di, offset </span>DEVCALL
<span style="color:black">DOSCODE:54C8                 </span><span style="color:navy">jmp     short </span><span style="color:gray">set_seg
</span><span style="color:black">DOSCODE:54CA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:54CA
DOSCODE:54CA </span><span style="color:gray">save_packet</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:54CA                 </span><span style="color:navy">mov     di, offset </span>FAKE_STACK_2F
<span style="color:black">DOSCODE:54CD                 </span><span style="color:navy">mov     si, offset </span>DEVCALL
<span style="color:black">DOSCODE:54D0
DOSCODE:54D0 </span><span style="color:gray">set_seg</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:54D0                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:black">DOSCODE:54D2                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:54D4                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:54D6                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:54D9                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:54DB                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:54DC                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:54DD                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:54DE                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:54DF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:54DF </span>Save_Restore_Packet endp
<span style="color:black">DOSCODE:54DF
</span><span style="color:maroon">DOSCODE:54E0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:54E0
DOSCODE:54E0 </span>$STD_CON_INPUT<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:54E0                 </span><span style="color:navy">call    </span>$STD_CON_INPUT_NO_ECHO
<span style="color:maroon">DOSCODE:54E3                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:54E4                 </span><span style="color:navy">call    </span>OUTT
<span style="color:maroon">DOSCODE:54E7                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:54E8
DOSCODE:54E8 </span>CON_INPUT_RETN<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:54E8                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:54E9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:54E9
DOSCODE:54E9 </span>$STD_CON_OUTPUT<span style="color:navy">:                        </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:54E9                 </span><span style="color:navy">mov     al, dl
</span><span style="color:black">DOSCODE:54EB
DOSCODE:54EB </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:54EB
DOSCODE:54EB
DOSCODE:54EB </span>OUTT            proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:54EB
DOSCODE:54EB </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:556F SIZE 00000008 BYTES
</span><span style="color:black">DOSCODE:54EB </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:557A SIZE 00000008 BYTES
</span><span style="color:black">DOSCODE:54EB </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:55CF SIZE 00000007 BYTES
</span><span style="color:black">DOSCODE:54EB
DOSCODE:54EB                 </span><span style="color:navy">cmp     al, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:54ED                 </span><span style="color:navy">jb      short </span><span style="color:gray">CTRLOUT
</span><span style="color:black">DOSCODE:54EF                 </span><span style="color:navy">cmp     al, </span><span style="color:green">7Fh
</span><span style="color:black">DOSCODE:54F1                 </span><span style="color:navy">jz      short </span><span style="color:gray">OUTCH
</span><span style="color:black">DOSCODE:54F3                 </span><span style="color:navy">inc     ss:</span>CARPOS
<span style="color:black">DOSCODE:54F8
DOSCODE:54F8 </span><span style="color:gray">OUTCH</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:54F8                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:54F9                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:54FA                 </span><span style="color:navy">inc     ss:</span>CHARCO
<span style="color:black">DOSCODE:54FF                 </span><span style="color:navy">and     ss:</span>CHARCO<span style="color:navy">, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:5505                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OUTSKIP
</span><span style="color:black">DOSCODE:5507                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5508                 </span><span style="color:navy">call    near ptr </span>STATCHK
<span style="color:black">DOSCODE:550B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:550C
DOSCODE:550C </span><span style="color:gray">OUTSKIP</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:550C                 </span><span style="color:navy">call    </span>RAWOUT
<span style="color:black">DOSCODE:550F                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:5510                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5511                 </span><span style="color:navy">test    ss:</span>PFLAG<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:5517                 </span><span style="color:navy">jz      short </span>CON_INPUT_RETN
<span style="color:black">DOSCODE:5519                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:551A                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:551B                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:551C                 </span><span style="color:navy">mov     bx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:551F                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:5522                 </span><span style="color:navy">jb      short </span><span style="color:gray">TRIPOPJ
</span><span style="color:black">DOSCODE:5524                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5527                 </span><span style="color:navy">test    bh, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:552A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">TRIPOPJ
</span><span style="color:black">DOSCODE:552C                 </span><span style="color:navy">test    bl, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:552F                 </span><span style="color:navy">jz      short </span><span style="color:gray">TRIPOPJ
</span><span style="color:black">DOSCODE:5531                 </span><span style="color:navy">mov     bx, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:5534                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:5537                 </span><span style="color:navy">jb      short </span><span style="color:gray">TRIPOPJ
</span><span style="color:black">DOSCODE:5539                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:green">6</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:553D                 </span><span style="color:navy">jz      short </span><span style="color:gray">LISSTRT2J
</span><span style="color:black">DOSCODE:553F                 </span><span style="color:navy">mov     ss:</span>PFLAG<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:5545
DOSCODE:5545 </span><span style="color:gray">TRIPOPJ</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5545                 </span><span style="color:navy">jmp     </span><span style="color:gray">TRIPOP
</span><span style="color:black">DOSCODE:5548 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5548
DOSCODE:5548 </span><span style="color:gray">LISSTRT2J</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5548                 </span><span style="color:navy">jmp     </span><span style="color:gray">LISSTRT2
</span><span style="color:black">DOSCODE:554B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:554B
DOSCODE:554B </span><span style="color:gray">CTRLOUT</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:554B                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0Dh
</span><span style="color:black">DOSCODE:554D                 </span><span style="color:navy">jz      short </span><span style="color:gray">ZERPOS
</span><span style="color:black">DOSCODE:554F                 </span><span style="color:navy">cmp     al, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:5551                 </span><span style="color:navy">jz      short </span><span style="color:gray">BACKPOS
</span><span style="color:black">DOSCODE:5553                 </span><span style="color:navy">cmp     al, </span><span style="color:green">9
</span><span style="color:black">DOSCODE:5555                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OUTCH
</span><span style="color:black">DOSCODE:5557                 </span><span style="color:navy">mov     al, ss:</span>CARPOS
<span style="color:black">DOSCODE:555B                 </span><span style="color:navy">or      al, </span><span style="color:green">0F8h
</span><span style="color:black">DOSCODE:555D                 </span><span style="color:navy">neg     al
</span><span style="color:black">DOSCODE:555D </span>OUTT            endp
<span style="color:black">DOSCODE:555D
DOSCODE:555F
DOSCODE:555F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:555F
DOSCODE:555F
DOSCODE:555F </span>TAB             proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:555F                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:5560                 </span><span style="color:navy">mov     cl, al
</span><span style="color:black">DOSCODE:5562                 </span><span style="color:navy">mov     ch, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:5564                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">POPTAB
</span><span style="color:black">DOSCODE:5566
DOSCODE:5566 </span><span style="color:gray">TABLP</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5566                 </span><span style="color:navy">mov     al, &#039; &#039;
</span><span style="color:black">DOSCODE:5568                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:556B                 </span><span style="color:navy">loop    </span><span style="color:gray">TABLP
</span><span style="color:black">DOSCODE:556D
DOSCODE:556D </span><span style="color:gray">POPTAB</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:556D                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:556E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:556E </span>TAB             endp
<span style="color:black">DOSCODE:556E
DOSCODE:556F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:556F </span><span style="color:gray">; START OF FUNCTION CHUNK FOR OUTT
</span><span style="color:black">DOSCODE:556F
DOSCODE:556F </span><span style="color:gray">ZERPOS</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:556F                 </span><span style="color:navy">mov     ss:</span>CARPOS<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:5575                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OUTCH
</span><span style="color:black">DOSCODE:5575 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR OUTT
</span><span style="color:black">DOSCODE:5577 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5577 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR BUFOUT
</span><span style="color:black">DOSCODE:5577
DOSCODE:5577 </span><span style="color:gray">OUTJ</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5577                 </span><span style="color:navy">jmp     </span>OUTT
<span style="color:black">DOSCODE:5577 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR BUFOUT
</span><span style="color:black">DOSCODE:557A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:557A </span><span style="color:gray">; START OF FUNCTION CHUNK FOR OUTT
</span><span style="color:black">DOSCODE:557A
DOSCODE:557A </span><span style="color:gray">BACKPOS</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:557A                 </span><span style="color:navy">dec     ss:</span>CARPOS
<span style="color:black">DOSCODE:557F                 </span><span style="color:navy">jmp     </span><span style="color:gray">OUTCH
</span><span style="color:black">DOSCODE:557F </span><span style="color:gray">; END OF FUNCTION CHUNK FOR OUTT
</span><span style="color:black">DOSCODE:5582
DOSCODE:5582 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5582
DOSCODE:5582
DOSCODE:5582 </span>BUFOUT          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5582
DOSCODE:5582 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:5577 SIZE 00000003 BYTES
</span><span style="color:black">DOSCODE:5582
DOSCODE:5582                 </span><span style="color:navy">cmp     al, &#039; &#039;
</span><span style="color:black">DOSCODE:5584                 </span><span style="color:navy">jnb     short </span><span style="color:gray">OUTJ
</span><span style="color:black">DOSCODE:5586                 </span><span style="color:navy">cmp     al, </span><span style="color:green">9
</span><span style="color:black">DOSCODE:5588                 </span><span style="color:navy">jz      short </span><span style="color:gray">OUTJ
</span><span style="color:black">DOSCODE:558A                 </span><span style="color:navy">cmp     al, </span><span style="color:green">15h
</span><span style="color:black">DOSCODE:558C                 </span><span style="color:navy">jz      short </span><span style="color:gray">CTRLU
</span><span style="color:black">DOSCODE:558E                 </span><span style="color:navy">cmp     al, </span><span style="color:green">14h
</span><span style="color:black">DOSCODE:5590                 </span><span style="color:navy">jz      short </span><span style="color:gray">CTRLU
</span><span style="color:black">DOSCODE:5592
DOSCODE:5592 </span>NOT_CTRLU<span style="color:navy">:
</span><span style="color:black">DOSCODE:5592                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5593                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">^&#039;
</span><span style="color:black">DOSCODE:5595                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:5598                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5599                 </span><span style="color:navy">or      al, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:559B
DOSCODE:559B </span><span style="color:gray">CTRLU</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:559B                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:559E
DOSCODE:559E </span>BUFOUT_RETN<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:559E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:559E </span>BUFOUT          endp
<span style="color:black">DOSCODE:559E
</span><span style="color:maroon">DOSCODE:559F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:559F
DOSCODE:559F </span>$STD_AUX_INPUT<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:559F                 </span><span style="color:navy">call    near ptr </span>STATCHK
<span style="color:maroon">DOSCODE:55A2                 </span><span style="color:navy">mov     bx, </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:55A5                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:maroon">DOSCODE:55A8                 </span><span style="color:navy">jb      short </span>BUFOUT_RETN
<span style="color:maroon">DOSCODE:55AA                 </span><span style="color:navy">jmp     short </span>TAISTRT
<span style="color:maroon">DOSCODE:55AC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:55AC
DOSCODE:55AC </span>AUXILP<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:55AC                 </span><span style="color:navy">call    </span>SPOOLINT
<span style="color:maroon">DOSCODE:55AF
DOSCODE:55AF </span>TAISTRT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:55AF                 </span><span style="color:navy">mov     ah, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:55B1                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:maroon">DOSCODE:55B4                 </span><span style="color:navy">jz      short </span>AUXILP
<span style="color:maroon">DOSCODE:55B6                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:55B8                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:maroon">DOSCODE:55BB                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:55BC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:55BC
DOSCODE:55BC </span>$STD_AUX_OUTPUT<span style="color:navy">:                        </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:55BC                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:55BD                 </span><span style="color:navy">mov     bx, </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:55C0                 </span><span style="color:navy">jmp     short </span>SENDOUT
<span style="color:maroon">DOSCODE:55C2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:55C2
DOSCODE:55C2 </span>$STD_PRINTER_OUTPUT<span style="color:navy">:                    </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:55C2                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:55C3                 </span><span style="color:navy">mov     bx, </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:55C6
DOSCODE:55C6 </span>SENDOUT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:55C6                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:55C8                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:55C9                 </span><span style="color:navy">call    near ptr </span>STATCHK
<span style="color:maroon">DOSCODE:55CC                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:55CD                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:55CE                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:55CF </span><span style="color:gray">; START OF FUNCTION CHUNK FOR OUTT
</span><span style="color:black">DOSCODE:55CF
DOSCODE:55CF </span><span style="color:gray">LISSTRT2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:55CF                 </span><span style="color:navy">call    </span>RAWOUT2
<span style="color:black">DOSCODE:55D2
DOSCODE:55D2 </span><span style="color:gray">TRIPOP</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:55D2                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:55D3                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:55D4                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:55D5
DOSCODE:55D5 </span>SCIS_RETN<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:55D5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:55D5 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR OUTT
</span><span style="color:maroon">DOSCODE:55D6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:55D6
DOSCODE:55D6 </span>$STD_CON_INPUT_STATUS<span style="color:navy">:                  </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:55D6                 </span><span style="color:navy">call    near ptr </span>STATCHK
<span style="color:maroon">DOSCODE:55D9                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:55DB                 </span><span style="color:navy">jz      short </span>SCIS_RETN
<span style="color:maroon">DOSCODE:55DD                 </span><span style="color:navy">or      al, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:55DF                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:55E0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:55E0
DOSCODE:55E0 </span>$STD_CON_INPUT_FLUSH<span style="color:navy">:                   </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:55E0                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:55E1                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:55E2                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:maroon">DOSCODE:55E4                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:maroon">DOSCODE:55E7                 </span><span style="color:navy">jb      short </span>BADJFNCON
<span style="color:maroon">DOSCODE:55E9                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:55EB                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:maroon">DOSCODE:55EE
DOSCODE:55EE </span>BADJFNCON<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:55EE                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:55EF                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:55F0                 </span><span style="color:navy">mov     ah, al
</span><span style="color:maroon">DOSCODE:55F2                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:55F4                 </span><span style="color:navy">jz      short </span>REDISPJ
<span style="color:maroon">DOSCODE:55F6                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:55F8                 </span><span style="color:navy">jz      short </span>REDISPJ
<span style="color:maroon">DOSCODE:55FA                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:55FC                 </span><span style="color:navy">jz      short </span>REDISPJ
<span style="color:maroon">DOSCODE:55FE                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">8
</span><span style="color:maroon">DOSCODE:5600                 </span><span style="color:navy">jz      short </span>REDISPJ
<span style="color:maroon">DOSCODE:5602                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:maroon">DOSCODE:5604                 </span><span style="color:navy">jz      short </span>REDISPJ
<span style="color:maroon">DOSCODE:5606                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:5608                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:5609 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5609
DOSCODE:5609 </span>REDISPJ<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5609                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:560A                 </span><span style="color:navy">jmp     </span>REDISP
<span style="color:maroon">DOSCODE:560D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:560D
DOSCODE:560D </span>$GET_FCB_POSITION<span style="color:navy">:                      </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:560D                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:maroon">DOSCODE:5610                 </span><span style="color:navy">call    </span>GetExtent
<span style="color:maroon">DOSCODE:5613                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">21h</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:5616                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">23h</span><span style="color:navy">], dl
</span><span style="color:maroon">DOSCODE:5619                 </span><span style="color:navy">cmp     word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], </span><span style="color:green">64
</span><span style="color:maroon">DOSCODE:561D                 </span><span style="color:navy">jnb     short </span>GetFCBBye
<span style="color:maroon">DOSCODE:561F                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">24h</span><span style="color:navy">], dh
</span><span style="color:maroon">DOSCODE:5622
DOSCODE:5622 </span>GetFCBBye<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5622                 </span><span style="color:navy">jmp     </span>NO_OP
<span style="color:maroon">DOSCODE:5625 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5625
DOSCODE:5625 </span>$FCB_DELETE<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5625                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:5628                 </span><span style="color:navy">call    </span>TransFCB
<span style="color:maroon">DOSCODE:562B                 </span><span style="color:navy">jb      short </span>BadPath
<span style="color:maroon">DOSCODE:562D                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:562E                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:562F                 </span><span style="color:navy">call    </span>DOS_DELETE
<span style="color:maroon">DOSCODE:5632                 </span><span style="color:navy">jb      short </span>BadPath
<span style="color:maroon">DOSCODE:5634
DOSCODE:5634 </span>GoodPath<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5634                 </span><span style="color:navy">jmp     short </span>GetFCBBye
<span style="color:maroon">DOSCODE:5636 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5636
DOSCODE:5636 </span>BadPath<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5636                 </span><span style="color:navy">jmp     </span>FCB_RET_ERR
<span style="color:maroon">DOSCODE:5639 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5639
DOSCODE:5639 </span>$GET_FCB_FILE_LENGTH<span style="color:navy">:                   </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5639                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:maroon">DOSCODE:563C                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:563F                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:5640                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:5641                 </span><span style="color:navy">call    </span>TransFCB
<span style="color:maroon">DOSCODE:5644                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:5645                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5646                 </span><span style="color:navy">jb      short </span>BadPath
<span style="color:maroon">DOSCODE:5648                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:5649                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:564A                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:564B                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:564C                 </span><span style="color:navy">call    </span>GET_FILE_INFO
<span style="color:maroon">DOSCODE:564F                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:5650                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5651                 </span><span style="color:navy">jb      short </span>BadPath
<span style="color:maroon">DOSCODE:5653                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:maroon">DOSCODE:5655                 </span><span style="color:navy">mov     ax, di
</span><span style="color:maroon">DOSCODE:5657                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:565A                 </span><span style="color:navy">or      bx, bx
</span><span style="color:maroon">DOSCODE:565C                 </span><span style="color:navy">jnz     short </span>GetSize
<span style="color:maroon">DOSCODE:565E                 </span><span style="color:navy">mov     bx, </span><span style="color:green">128
</span><span style="color:maroon">DOSCODE:5661
DOSCODE:5661 </span>GetSize<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5661                 </span><span style="color:navy">mov     di, ax
</span><span style="color:maroon">DOSCODE:5663                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:maroon">DOSCODE:5665                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:maroon">DOSCODE:5667                 </span><span style="color:navy">div     bx
</span><span style="color:maroon">DOSCODE:5669                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:566A                 </span><span style="color:navy">mov     ax, di
</span><span style="color:maroon">DOSCODE:566C                 </span><span style="color:navy">div     bx
</span><span style="color:maroon">DOSCODE:566E                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:maroon">DOSCODE:5670                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:5671                 </span><span style="color:navy">jcxz    short </span>LengthStore
<span style="color:maroon">DOSCODE:5673                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:5676                 </span><span style="color:navy">adc     dx, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:5679
DOSCODE:5679 </span>LengthStore<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5679                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">21h</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:567C                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">23h</span><span style="color:navy">], dl
</span><span style="color:maroon">DOSCODE:567F                 </span><span style="color:navy">or      dh, dh
</span><span style="color:maroon">DOSCODE:5681                 </span><span style="color:navy">jz      short </span>GoodPath
<span style="color:maroon">DOSCODE:5683                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">24h</span><span style="color:navy">], dh
</span><span style="color:maroon">DOSCODE:5686
DOSCODE:5686 </span>GoodRet<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5686                 </span><span style="color:navy">jmp     short </span>GoodPath
<span style="color:maroon">DOSCODE:5688 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5688
DOSCODE:5688 </span>$FCB_CLOSE<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5688                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:568A                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:maroon">DOSCODE:568D                 </span><span style="color:navy">jz      short </span>NoAttr
<span style="color:maroon">DOSCODE:568F                 </span><span style="color:navy">mov     al, [si-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:5692
DOSCODE:5692 </span>NoAttr<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5692                 </span><span style="color:navy">mov     ss:</span>ATTRIB<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:5696                 </span><span style="color:navy">call    </span>SFTFromFCB
<span style="color:maroon">DOSCODE:5699                 </span><span style="color:navy">jb      short </span>GoodRet
<span style="color:maroon">DOSCODE:569B                 </span><span style="color:navy">mov     al, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:569F                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:56A1                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:56A2                 </span><span style="color:navy">call    </span>CheckShare
<span style="color:maroon">DOSCODE:56A5                 </span><span style="color:navy">jnz     short </span>NoStash
<span style="color:maroon">DOSCODE:56A7                 </span><span style="color:navy">mov     al, ss:</span>ATTRIB
<span style="color:maroon">DOSCODE:56AB                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], al
</span><span style="color:maroon">DOSCODE:56AF
DOSCODE:56AF </span>NoStash<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:56AF                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:56B2                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:56B6                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">16h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:56B9                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:56BD                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:56C0                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:56C4                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">12h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:56C7                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:56CB                 </span><span style="color:navy">or      word ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4000h
</span><span style="color:maroon">DOSCODE:56D1                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:56D2                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:56D3                 </span><span style="color:navy">call    </span>DOS_CLOSE
<span style="color:maroon">DOSCODE:56D6                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:maroon">DOSCODE:56DA                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:56DB                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], cl
</span><span style="color:maroon">DOSCODE:56DF                 </span><span style="color:navy">pushf
</span><span style="color:maroon">DOSCODE:56E0                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:56E4                 </span><span style="color:navy">jnz     short </span>CloseOK
<span style="color:maroon">DOSCODE:56E6                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:56E7                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">M&#039;
</span><span style="color:maroon">DOSCODE:56E9                 </span><span style="color:navy">call    </span>BlastSFT
<span style="color:maroon">DOSCODE:56EC                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:56ED
DOSCODE:56ED </span>CloseOK<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:56ED                 </span><span style="color:navy">popf
</span><span style="color:maroon">DOSCODE:56EE                 </span><span style="color:navy">jnb     short </span>GoodRet
<span style="color:maroon">DOSCODE:56F0                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:56F2                 </span><span style="color:navy">jz      short </span>GoodRet
<span style="color:maroon">DOSCODE:56F4                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:56F6
DOSCODE:56F6 </span>jmp_to_FCB_RET_ERR<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:56F6                 </span><span style="color:navy">jmp     </span>FCB_RET_ERR
<span style="color:maroon">DOSCODE:56F9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:56F9
DOSCODE:56F9 </span>$FCB_RENAME<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:56F9                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:maroon">DOSCODE:56FC                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:56FD                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:maroon">DOSCODE:56FF                 </span><span style="color:navy">add     si, </span><span style="color:green">10h
</span><span style="color:maroon">DOSCODE:5702                 </span><span style="color:navy">mov     di, offset </span>RENBUF
<span style="color:maroon">DOSCODE:5705                 </span><span style="color:navy">push    word ptr [si]
</span><span style="color:maroon">DOSCODE:5707                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:5708                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:5709                 </span><span style="color:navy">mov     [si], al
</span><span style="color:maroon">DOSCODE:570B                 </span><span style="color:navy">mov     dx, si
</span><span style="color:maroon">DOSCODE:570D                 </span><span style="color:navy">call    </span>TransFCB
<span style="color:maroon">DOSCODE:5710                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:5711                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5712                 </span><span style="color:navy">pop     word ptr [si]
</span><span style="color:maroon">DOSCODE:5714                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:5715                 </span><span style="color:navy">jb      short </span>fren90
<span style="color:maroon">DOSCODE:5717                 </span><span style="color:navy">mov     si, ss:</span>WFP_START
<span style="color:maroon">DOSCODE:571C                 </span><span style="color:navy">mov     ss:</span>REN_WFP<span style="color:navy">, si
</span><span style="color:maroon">DOSCODE:5721                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:5724                 </span><span style="color:navy">call    </span>TransFCB
<span style="color:maroon">DOSCODE:5727                 </span><span style="color:navy">jb      short </span>fren90
<span style="color:maroon">DOSCODE:5729                 </span><span style="color:navy">call    </span>DOS_RENAME
<span style="color:maroon">DOSCODE:572C                 </span><span style="color:navy">jb      short </span>fren90
<span style="color:maroon">DOSCODE:572E                 </span><span style="color:navy">jmp     </span>NO_OP
<span style="color:maroon">DOSCODE:5731 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5731
DOSCODE:5731 </span>fren90<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5731                 </span><span style="color:navy">jmp     short </span>jmp_to_FCB_RET_ERR
<span style="color:black">DOSCODE:5733
DOSCODE:5733 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5733
DOSCODE:5733
DOSCODE:5733 </span>SaveFCBInfo     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5733                 </span><span style="color:navy">les     di, ss:</span>THISSFT
<span style="color:black">DOSCODE:5738                 </span><span style="color:navy">call    </span>IsSFTNet
<span style="color:black">DOSCODE:573B                 </span><span style="color:navy">jz      short </span><span style="color:gray">SaveLocal
</span><span style="color:black">DOSCODE:573D                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5741                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">1Ch</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5744                 </span><span style="color:navy">mov     bl, </span><span style="color:#ff8000">80h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:5746                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SaveSFN
</span><span style="color:black">DOSCODE:5748 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5748
DOSCODE:5748 </span><span style="color:gray">SaveLocal</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5748                 </span><span style="color:navy">call    </span>CheckShare
<span style="color:black">DOSCODE:574B                 </span><span style="color:navy">jz      short </span><span style="color:gray">SaveNoShare
</span><span style="color:black">DOSCODE:574D                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SaveShare
</span><span style="color:black">DOSCODE:574F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:574F
DOSCODE:574F </span><span style="color:gray">SaveNoShare</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:574F                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5754                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SaveNoShareDev
</span><span style="color:black">DOSCODE:5756                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:575A                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:575D                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5761                 </span><span style="color:navy">mov     bl, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5765                 </span><span style="color:navy">mov     bh, bl
</span><span style="color:black">DOSCODE:5767                 </span><span style="color:navy">ror     bl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:5769                 </span><span style="color:navy">shl     bh, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:576B                 </span><span style="color:navy">or      bl, bh
</span><span style="color:black">DOSCODE:576D                 </span><span style="color:navy">and     bl, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:5770                 </span><span style="color:navy">or      al, bl
</span><span style="color:black">DOSCODE:5772                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:5775                 </span><span style="color:navy">mov     al, es:[di+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5779                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:577C                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5780                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5783                 </span><span style="color:navy">mov     bl, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5785
DOSCODE:5785 </span><span style="color:gray">SetFCBBits</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5785                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5789                 </span><span style="color:navy">and     al, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:578B                 </span><span style="color:navy">or      al, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:578F                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:5792                 </span><span style="color:navy">or      bl, bl
</span><span style="color:black">DOSCODE:5794                 </span><span style="color:navy">jz      short </span><span style="color:gray">SaveNoSFN
</span><span style="color:black">DOSCODE:5796                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SaveSFN
</span><span style="color:black">DOSCODE:5798 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5798
DOSCODE:5798 </span><span style="color:gray">SaveNoShareDev</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5798                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:579C                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:579F                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">9</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:57A3                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">1Ch</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:57A6                 </span><span style="color:navy">mov     bl, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;
</span><span style="color:black">DOSCODE:57A8                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SetFCBBits
</span><span style="color:black">DOSCODE:57AA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:57AA
DOSCODE:57AA </span><span style="color:gray">SaveShare</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:57AA                 </span><span style="color:navy">call    ss:</span>ShSave
<span style="color:black">DOSCODE:57AF
DOSCODE:57AF </span><span style="color:gray">SaveSFN</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:57AF                 </span><span style="color:navy">lea     ax, [di-</span><span style="color:green">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:57B2                 </span><span style="color:navy">sub     ax, word ptr ss:</span>SFTFCB
<span style="color:black">DOSCODE:57B7                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:57B8                 </span><span style="color:navy">mov     bl, </span><span style="color:green">59
</span><span style="color:black">DOSCODE:57BA                 </span><span style="color:navy">div     bl
</span><span style="color:black">DOSCODE:57BC                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:57BF                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:57C0
DOSCODE:57C0 </span><span style="color:gray">SaveNoSFN</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:57C0                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:57C4                 </span><span style="color:navy">and     al, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:57C6                 </span><span style="color:navy">or      al, bl
</span><span style="color:black">DOSCODE:57C8                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">19h</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:57CB                 </span><span style="color:navy">mov     ax, ss:</span>FCBLRU
<span style="color:black">DOSCODE:57CF                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:57D0                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:57D4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SimpleStuff
</span><span style="color:black">DOSCODE:57D6                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">15h
</span><span style="color:black">DOSCODE:57D9                 </span><span style="color:navy">call    </span>ResetLRU
<span style="color:black">DOSCODE:57DC
DOSCODE:57DC </span><span style="color:gray">SimpleStuff</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:57DC                 </span><span style="color:navy">mov     ss:</span>FCBLRU<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:57E0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:57E0 </span>SaveFCBInfo     endp
<span style="color:black">DOSCODE:57E0
DOSCODE:57E1
DOSCODE:57E1 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:57E1
DOSCODE:57E1
DOSCODE:57E1 </span>ResetLRU        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:57E1                 </span><span style="color:navy">mov     ax, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:57E4                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:57E5                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:57E6                 </span><span style="color:navy">les     di, ss:</span>SFTFCB
<span style="color:black">DOSCODE:57EB                 </span><span style="color:navy">mov     cx, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:57EF                 </span><span style="color:navy">lea     di, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:57F2
DOSCODE:57F2 </span><span style="color:gray">ovScan</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:57F2                 </span><span style="color:navy">sub     es:[bx+di], ax
</span><span style="color:black">DOSCODE:57F5                 </span><span style="color:navy">ja      short </span><span style="color:gray">ovLoop
</span><span style="color:black">DOSCODE:57F7                 </span><span style="color:navy">mov     es:[bx+di], ax
</span><span style="color:black">DOSCODE:57FA
DOSCODE:57FA </span><span style="color:gray">ovLoop</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:57FA                 </span><span style="color:navy">add     di, </span><span style="color:green">59
</span><span style="color:black">DOSCODE:57FD                 </span><span style="color:navy">loop    </span><span style="color:gray">ovScan
</span><span style="color:black">DOSCODE:57FF                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:5800                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:5801                 </span><span style="color:navy">mov     es:[bx+di], ax
</span><span style="color:black">DOSCODE:5804                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5804 </span>ResetLRU        endp
<span style="color:black">DOSCODE:5804
DOSCODE:5805
DOSCODE:5805 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5805
DOSCODE:5805
DOSCODE:5805 </span>LRUFCB          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5805                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:5806                 </span><span style="color:navy">call    </span>save_world
<span style="color:black">DOSCODE:5809                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:580E                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:5810                 </span><span style="color:navy">jnz     short </span><span style="color:gray">lru1
</span><span style="color:black">DOSCODE:5812                 </span><span style="color:navy">mov     di, word ptr </span>LocalSFT
<span style="color:black">DOSCODE:5816                 </span><span style="color:navy">or      di, word ptr </span>LocalSFT<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:581A                 </span><span style="color:navy">jz      short </span><span style="color:gray">lru1
</span><span style="color:black">DOSCODE:581C                 </span><span style="color:navy">les     di, </span>LocalSFT
<span style="color:black">DOSCODE:5820
DOSCODE:5820 </span><span style="color:gray">gotlocalSFT</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5820                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:5824                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:5828                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:5829                 </span><span style="color:navy">jmp     </span><span style="color:gray">LRUDone
</span><span style="color:black">DOSCODE:582C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:582C
DOSCODE:582C </span><span style="color:gray">lru1</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:582C                 </span><span style="color:navy">les     di, </span>SFTFCB
<span style="color:black">DOSCODE:5830                 </span><span style="color:navy">mov     cx, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5834                 </span><span style="color:navy">lea     di, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5837                 </span><span style="color:navy">mov     bx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:583A                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:583C                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:black">DOSCODE:583E                 </span><span style="color:navy">mov     bp, bx
</span><span style="color:black">DOSCODE:5840
DOSCODE:5840 </span><span style="color:gray">findSFT</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5840                 </span><span style="color:navy">or      word ptr es:[di], </span><span style="color:green">0
</span><span style="color:black">DOSCODE:5844                 </span><span style="color:navy">jz      short </span><span style="color:gray">gotSFT
</span><span style="color:black">DOSCODE:5846                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:584A                 </span><span style="color:navy">jz      short </span><span style="color:gray">gotSFT
</span><span style="color:black">DOSCODE:584C                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:5852                 </span><span style="color:navy">jnz     short </span><span style="color:gray">lru5
</span><span style="color:black">DOSCODE:5854                 </span><span style="color:navy">call    </span>CheckShare
<span style="color:black">DOSCODE:5857                 </span><span style="color:navy">jnz     short </span><span style="color:gray">lru5
</span><span style="color:black">DOSCODE:5859
DOSCODE:5859 </span><span style="color:gray">hackpoint</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5859                 </span><span style="color:navy">mov     word ptr </span>LocalSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:585D                 </span><span style="color:navy">mov     word ptr </span>LocalSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:5861                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:5863                 </span><span style="color:navy">jz      short </span><span style="color:gray">gotlocalSFT
</span><span style="color:black">DOSCODE:5865                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:5869                 </span><span style="color:navy">jnb     short </span><span style="color:gray">lru4
</span><span style="color:black">DOSCODE:586B                 </span><span style="color:navy">mov     bx, es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:586F                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:5871
DOSCODE:5871 </span><span style="color:gray">lru4</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5871                 </span><span style="color:navy">add     di, </span><span style="color:green">59
</span><span style="color:black">DOSCODE:5874                 </span><span style="color:navy">loop    </span><span style="color:gray">findSFT
</span><span style="color:black">DOSCODE:5876                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:5878                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:587B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">gotSFT
</span><span style="color:black">DOSCODE:587D                 </span><span style="color:navy">mov     di, bp
</span><span style="color:black">DOSCODE:587F                 </span><span style="color:navy">cmp     bp, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:5882                 </span><span style="color:navy">jnz     short </span><span style="color:gray">gotnetSFT
</span><span style="color:black">DOSCODE:5884                 </span><span style="color:navy">jmp     short </span><span style="color:gray">errorbadSFT
</span><span style="color:black">DOSCODE:5886 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5886
DOSCODE:5886 </span><span style="color:gray">lru5</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5886                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:588A                 </span><span style="color:navy">jnb     short </span><span style="color:gray">lru4
</span><span style="color:black">DOSCODE:588C                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5890                 </span><span style="color:navy">mov     bp, di
</span><span style="color:black">DOSCODE:5892                 </span><span style="color:navy">jmp     short </span><span style="color:gray">lru4
</span><span style="color:black">DOSCODE:5894 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5894
DOSCODE:5894 </span><span style="color:gray">gotSFT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5894                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:5896                 </span><span style="color:navy">jz      short </span><span style="color:gray">hackpoint
</span><span style="color:black">DOSCODE:5898
DOSCODE:5898 </span>notlocaluse<span style="color:navy">:
</span><span style="color:black">DOSCODE:5898                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:589A                 </span><span style="color:navy">cmp     word ptr </span>LocalSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:589E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">notinvalid
</span><span style="color:black">DOSCODE:58A0                 </span><span style="color:navy">cmp     word ptr </span>LocalSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:58A4                 </span><span style="color:navy">jz      short </span><span style="color:gray">zerolocalSFT
</span><span style="color:black">DOSCODE:58A6
DOSCODE:58A6 </span><span style="color:gray">notinvalid</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58A6                 </span><span style="color:navy">jmp     </span><span style="color:gray">gotlocalSFT
</span><span style="color:black">DOSCODE:58A9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:58A9
DOSCODE:58A9 </span><span style="color:gray">zerolocalSFT</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58A9                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:58AB                 </span><span style="color:navy">mov     word ptr </span>LocalSFT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:58AE                 </span><span style="color:navy">mov     word ptr </span>LocalSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:58B1                 </span><span style="color:navy">jmp     </span><span style="color:gray">gotlocalSFT
</span><span style="color:black">DOSCODE:58B4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:58B4
DOSCODE:58B4 </span><span style="color:gray">gotnetSFT</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58B4                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:58B6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">closenet
</span><span style="color:black">DOSCODE:58B8                 </span><span style="color:navy">mov     word ptr </span>LocalSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:58BC                 </span><span style="color:navy">mov     word ptr </span>LocalSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:58C0
DOSCODE:58C0 </span><span style="color:gray">closenet</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58C0                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:58C4                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:58C8
DOSCODE:58C8 </span><span style="color:gray">LRUClose</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58C8                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:58CC                 </span><span style="color:navy">jz      short </span><span style="color:gray">LRUDone
</span><span style="color:black">DOSCODE:58CE                 </span><span style="color:navy">call    </span>DOS_CLOSE
<span style="color:black">DOSCODE:58D1                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LRUClose
</span><span style="color:black">DOSCODE:58D3                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:58D5                 </span><span style="color:navy">jz      short </span><span style="color:gray">LRUClose
</span><span style="color:black">DOSCODE:58D7
DOSCODE:58D7 </span><span style="color:gray">errorbadSFT</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58D7                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:58D8                 </span><span style="color:navy">jmp     short </span><span style="color:gray">LRUDead
</span><span style="color:black">DOSCODE:58DA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:58DA
DOSCODE:58DA </span><span style="color:gray">LRUDone</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58DA                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:58DC                 </span><span style="color:navy">call    </span>BlastSFT
<span style="color:black">DOSCODE:58DF
DOSCODE:58DF </span><span style="color:gray">LRUDead</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58DF                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:58E2                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:58E3                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:58E8                 </span><span style="color:navy">les     di, es:</span>THISSFT
<span style="color:black">DOSCODE:58ED                 </span><span style="color:navy">jb      short </span><span style="color:gray">LruFCB_err
</span><span style="color:black">DOSCODE:58EF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:58F0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:58F0
DOSCODE:58F0 </span><span style="color:gray">LruFCB_err</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:58F0                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">23h </span><span style="color:gray">; &#039;#&#039;
</span><span style="color:black">DOSCODE:58F2                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:58F2 </span>LRUFCB          endp
<span style="color:black">DOSCODE:58F2
DOSCODE:58F3
DOSCODE:58F3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:58F3
DOSCODE:58F3
DOSCODE:58F3 </span>RegenCopyName   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:58F3                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:58F4                 </span><span style="color:navy">call    </span>UCase
<span style="color:black">DOSCODE:58F7                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:58F8                 </span><span style="color:navy">loop    </span>RegenCopyName
<span style="color:black">DOSCODE:58FA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:58FA </span>RegenCopyName   endp
<span style="color:black">DOSCODE:58FA
DOSCODE:58FB
DOSCODE:58FB </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:58FB
DOSCODE:58FB
DOSCODE:58FB </span>FCBRegen        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:58FB                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">19h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:58FE                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5900                 </span><span style="color:navy">jz      short </span><span style="color:gray">RegenNoSharing
</span><span style="color:black">DOSCODE:5902                 </span><span style="color:navy">call    </span>CheckShare
<span style="color:black">DOSCODE:5905                 </span><span style="color:navy">jnz     short </span><span style="color:gray">RegenFail
</span><span style="color:black">DOSCODE:5907                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1100h
</span><span style="color:black">DOSCODE:590A                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - INSTALLATION CHECK
<span style="color:black">DOSCODE:590A                                         </span>; Return: AL = 00h  not installed, OK to install
<span style="color:black">DOSCODE:590A                                         </span>; 01h  not installed, not OK to install
<span style="color:black">DOSCODE:590A                                         </span>; FFh  installed
<span style="color:black">DOSCODE:590C                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:590E                 </span><span style="color:navy">jz      short </span><span style="color:gray">RegenDead
</span><span style="color:black">DOSCODE:5910
DOSCODE:5910 </span><span style="color:gray">RegenFail</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5910                 </span><span style="color:navy">mov     ax, ss:</span>USER_IN_AX
<span style="color:black">DOSCODE:5914                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:5917                 </span><span style="color:navy">jz      short </span><span style="color:gray">RegenDead
</span><span style="color:black">DOSCODE:5919                 </span><span style="color:navy">call    </span>FCBHardErr
<span style="color:black">DOSCODE:591C
DOSCODE:591C </span><span style="color:gray">RegenDead</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:591C                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:591D
DOSCODE:591D </span><span style="color:gray">FCBRegen_retn</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:591D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:591E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:591E
DOSCODE:591E </span><span style="color:gray">RegenNoSharing</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:591E                 </span><span style="color:navy">call    </span>CheckShare
<span style="color:black">DOSCODE:5921                 </span><span style="color:navy">jnz     short </span><span style="color:gray">RegenFail
</span><span style="color:black">DOSCODE:5923                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5924                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5926                 </span><span style="color:navy">call    </span>LRUFCB
<span style="color:black">DOSCODE:5929                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:592A                 </span><span style="color:navy">jb      short </span><span style="color:gray">FCBRegen_retn
</span><span style="color:black">DOSCODE:592C                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">8002h
</span><span style="color:black">DOSCODE:5932                 </span><span style="color:navy">and     al, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:5934                 </span><span style="color:navy">cbw
</span><span style="color:black">DOSCODE:5935                 </span><span style="color:navy">or      ax, </span><span style="color:green">4000h
</span><span style="color:black">DOSCODE:5938                 </span><span style="color:navy">mov     cl, [si+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:593B                 </span><span style="color:navy">mov     ch, cl
</span><span style="color:black">DOSCODE:593D                 </span><span style="color:navy">and     ch, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:5940                 </span><span style="color:navy">or      al, ch
</span><span style="color:black">DOSCODE:5942                 </span><span style="color:navy">and     cl, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:5945                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], cl
</span><span style="color:black">DOSCODE:5949                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:594D                 </span><span style="color:navy">mov     ax, ss:</span>PROC_ID
<span style="color:black">DOSCODE:5951                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5955                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:5956                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:5957                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:5958                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:5959                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:595A                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:595B                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:595E                 </span><span style="color:navy">mov     cx, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:5961                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:5962                 </span><span style="color:navy">call    </span>RegenCopyName
<span style="color:black">DOSCODE:5965                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:5966                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5967                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:596C                 </span><span style="color:navy">call    </span>DEVNAME
<span style="color:black">DOSCODE:596F                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:5970                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:5971                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:5972                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5973                 </span><span style="color:navy">jb      short </span><span style="color:gray">RegenFileNoSharing
</span><span style="color:black">DOSCODE:5975                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], bh
</span><span style="color:black">DOSCODE:5979                 </span><span style="color:navy">mov     byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:597E                 </span><span style="color:navy">lds     si, ss:</span>DEVPT
<span style="color:black">DOSCODE:5983                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:5987                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">9</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:598B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:598C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:598C
DOSCODE:598C </span><span style="color:gray">RegenDeadJ</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:598C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RegenDead
</span><span style="color:black">DOSCODE:598E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:598E
DOSCODE:598E </span><span style="color:gray">RegenFileNoSharing</span><span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:598E                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5992                 </span><span style="color:navy">and     ax, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:5995                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:5996                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:5997                 </span><span style="color:navy">call    </span>FIND_DPB
<span style="color:black">DOSCODE:599A                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:599E                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">9</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:59A2                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:59A3                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:59A4                 </span><span style="color:navy">jb      short </span><span style="color:gray">RegenDeadJ
</span><span style="color:black">DOSCODE:59A6                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:59A9                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:59AD                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:59B0                 </span><span style="color:navy">and     al, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:59B2                 </span><span style="color:navy">mov     ah, al
</span><span style="color:black">DOSCODE:59B4                 </span><span style="color:navy">rol     ah, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:59B6                 </span><span style="color:navy">shr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:59B8                 </span><span style="color:navy">or      al, ah
</span><span style="color:black">DOSCODE:59BA                 </span><span style="color:navy">and     al, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:59BC                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:59C0                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:59C3                 </span><span style="color:navy">and     al, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:59C5                 </span><span style="color:navy">sub     ah, ah
</span><span style="color:black">DOSCODE:59C7                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:59CB                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:59CE                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:59D2                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">35h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:59D6                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:59D9                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:59DD                 </span><span style="color:navy">inc     word ptr es:[di]
</span><span style="color:black">DOSCODE:59E0                 </span><span style="color:navy">lea     si, [si+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:59E3                 </span><span style="color:navy">lea     di, [di+</span><span style="color:#ff8000">20h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:59E6                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:59E9                 </span><span style="color:navy">call    </span>RegenCopyName
<span style="color:black">DOSCODE:59EC                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:59ED                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:59ED </span>FCBRegen        endp
<span style="color:black">DOSCODE:59ED
DOSCODE:59EE
DOSCODE:59EE </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:59EE
DOSCODE:59EE
DOSCODE:59EE </span>BlastSFT        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:59EE                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:59EF                 </span><span style="color:navy">mov     cx, </span><span style="color:green">59
</span><span style="color:black">DOSCODE:59F2                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:59F4                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:59F5                 </span><span style="color:navy">sub     ax, ax
</span><span style="color:black">DOSCODE:59F7                 </span><span style="color:navy">mov     es:[di], ax
</span><span style="color:black">DOSCODE:59FA                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:59FE                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:59FF                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">17h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5A03                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5A03 </span>BlastSFT        endp
<span style="color:black">DOSCODE:5A03
DOSCODE:5A04
DOSCODE:5A04 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5A04
DOSCODE:5A04
DOSCODE:5A04 </span>CheckFCB        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5A04                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:#ff8000">19h</span><span style="color:navy">], </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:5A08                 </span><span style="color:navy">jz      short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A0A                 </span><span style="color:navy">les     di, ss:</span>SFTFCB
<span style="color:black">DOSCODE:5A0F                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:5A13                 </span><span style="color:navy">jb      short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A15                 </span><span style="color:navy">mov     bl, </span><span style="color:green">59
</span><span style="color:black">DOSCODE:5A17                 </span><span style="color:navy">mul     bl
</span><span style="color:black">DOSCODE:5A19                 </span><span style="color:navy">lea     di, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A1C                 </span><span style="color:navy">add     di, ax
</span><span style="color:black">DOSCODE:5A1E                 </span><span style="color:navy">mov     ax, ss:</span>PROC_ID
<span style="color:black">DOSCODE:5A22                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5A26                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A28                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5A2C                 </span><span style="color:navy">jz      short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A2E                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">19h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A31                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5A33                 </span><span style="color:navy">jz      short </span><span style="color:gray">CheckNoShare
</span><span style="color:black">DOSCODE:5A35                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5A36                 </span><span style="color:navy">and     al, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:5A38                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0C0h </span><span style="color:gray">; &#039;L&#039;
</span><span style="color:black">DOSCODE:5A3A                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5A3B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CheckNet
</span><span style="color:black">DOSCODE:5A3D                 </span><span style="color:navy">call    ss:</span>ShChk
<span style="color:black">DOSCODE:5A42                 </span><span style="color:navy">jb      short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A44                 </span><span style="color:navy">jmp     short </span>CheckD
<span style="color:black">DOSCODE:5A46 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5A46
DOSCODE:5A46 </span>CheckFirClus<span style="color:navy">:
</span><span style="color:black">DOSCODE:5A46                 </span><span style="color:navy">cmp     bx, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A4A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A4C
DOSCODE:5A4C </span>CheckD<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5A4C                 </span><span style="color:navy">and     al, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:5A4E                 </span><span style="color:navy">mov     ah, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A52                 </span><span style="color:navy">and     ah, </span><span style="color:green">3Fh
</span><span style="color:black">DOSCODE:5A55                 </span><span style="color:navy">cmp     ah, al
</span><span style="color:black">DOSCODE:5A57                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A59
DOSCODE:5A59 </span>BlastSFT_retn<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5A59                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5A5A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5A5A
DOSCODE:5A5A </span><span style="color:gray">BadSFT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5A5A                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:5A5B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5A5C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5A5C
DOSCODE:5A5C </span><span style="color:gray">CheckNet</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5A5C                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">1Ch</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A5F                 </span><span style="color:navy">cmp     ax, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A63                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A65                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5A66 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5A66
DOSCODE:5A66 </span><span style="color:gray">CheckNoShare</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5A66                 </span><span style="color:navy">test    al, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:5A68                 </span><span style="color:navy">jnz     short $+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:5A6A                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A6D                 </span><span style="color:navy">cmp     bx, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A71                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A73                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">1Ch</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A76                 </span><span style="color:navy">cmp     bx, es:[di+</span><span style="color:#ff8000">9</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A7A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BadSFT
</span><span style="color:black">DOSCODE:5A7C                 </span><span style="color:navy">jmp     short </span>CheckD
<span style="color:black">DOSCODE:5A7C </span>CheckFCB        endp
<span style="color:black">DOSCODE:5A7C
DOSCODE:5A7E
DOSCODE:5A7E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5A7E
DOSCODE:5A7E
DOSCODE:5A7E </span>SFTFromFCB      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5A7E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5A7F                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:5A80                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5A83                 </span><span style="color:navy">call    </span>CheckFCB
<span style="color:black">DOSCODE:5A86                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:5A87                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5A88                 </span><span style="color:navy">mov     word ptr ss:</span>THISSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:5A8D                 </span><span style="color:navy">mov     word ptr ss:</span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:5A92                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Set_SFT
</span><span style="color:black">DOSCODE:5A94                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:5A95                 </span><span style="color:navy">call    </span>save_world
<span style="color:black">DOSCODE:5A98                 </span><span style="color:navy">call    </span>FCBRegen
<span style="color:black">DOSCODE:5A9B                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:5A9E                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:5A9F                 </span><span style="color:navy">mov     ax, ss:</span>EXTERR
<span style="color:black">DOSCODE:5AA3                 </span><span style="color:navy">jb      short </span>BlastSFT_retn
<span style="color:black">DOSCODE:5AA5
DOSCODE:5AA5 </span><span style="color:gray">Set_SFT</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5AA5                 </span><span style="color:navy">les     di, ss:</span>THISSFT
<span style="color:black">DOSCODE:5AAA                 </span><span style="color:navy">push    ss:</span>PROC_ID
<span style="color:black">DOSCODE:5AAF                 </span><span style="color:navy">pop     word ptr es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5AB3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5AB3 </span>SFTFromFCB      endp
<span style="color:black">DOSCODE:5AB3
DOSCODE:5AB4
DOSCODE:5AB4 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5AB4
DOSCODE:5AB4
DOSCODE:5AB4 </span>FCBHardErr      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5AB4                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:5AB9                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">23h </span><span style="color:gray">; &#039;#&#039;
</span><span style="color:black">DOSCODE:5ABC                 </span><span style="color:navy">mov     es:</span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:5AC2                 </span><span style="color:navy">les     bp, es:</span>THISDPB
<span style="color:black">DOSCODE:5AC7                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5ACA                 </span><span style="color:navy">mov     cx, di
</span><span style="color:black">DOSCODE:5ACC                 </span><span style="color:navy">mov     dx, es:[bp+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5AD0                 </span><span style="color:navy">call    </span>HARDERR
<span style="color:black">DOSCODE:5AD3                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:5AD4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5AD4 </span>FCBHardErr      endp
<span style="color:black">DOSCODE:5AD4
DOSCODE:5AD5
DOSCODE:5AD5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5AD5
DOSCODE:5AD5
DOSCODE:5AD5 </span>GetRR           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5AD5                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">21h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5AD8                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">23h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5ADB                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">64
</span><span style="color:black">DOSCODE:5ADE                 </span><span style="color:navy">jb      short </span><span style="color:gray">GetRRBye
</span><span style="color:black">DOSCODE:5AE0                 </span><span style="color:navy">xor     dh, dh
</span><span style="color:black">DOSCODE:5AE2
DOSCODE:5AE2 </span><span style="color:gray">GetRRBye</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5AE2                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5AE2 </span>GetRR           endp
<span style="color:black">DOSCODE:5AE2
DOSCODE:5AE3
DOSCODE:5AE3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5AE3
DOSCODE:5AE3
DOSCODE:5AE3 </span>GetExtent       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5AE3                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">20h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5AE6                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">0Ch</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5AE9                 </span><span style="color:navy">shl     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:5AEB                 </span><span style="color:navy">shr     dx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:5AED                 </span><span style="color:navy">rcr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:5AEF                 </span><span style="color:navy">mov     ah, dl
</span><span style="color:black">DOSCODE:5AF1                 </span><span style="color:navy">mov     dl, dh
</span><span style="color:black">DOSCODE:5AF3                 </span><span style="color:navy">xor     dh, dh
</span><span style="color:black">DOSCODE:5AF5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5AF5 </span>GetExtent       endp
<span style="color:black">DOSCODE:5AF5
DOSCODE:5AF6
DOSCODE:5AF6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5AF6
DOSCODE:5AF6
DOSCODE:5AF6 </span>SetExtent       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5AF6                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5AF7                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:5AF8                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:5AFA                 </span><span style="color:navy">and     al, </span><span style="color:green">7Fh
</span><span style="color:black">DOSCODE:5AFC                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">20h</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:5AFF                 </span><span style="color:navy">and     cl, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5B02                 </span><span style="color:navy">shl     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:5B04                 </span><span style="color:navy">rcl     dx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:5B06                 </span><span style="color:navy">mov     al, ch
</span><span style="color:black">DOSCODE:5B08                 </span><span style="color:navy">mov     ah, dl
</span><span style="color:black">DOSCODE:5B0A                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">0Ch</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5B0D                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:5B0E                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5B0F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5B0F </span>SetExtent       endp
<span style="color:black">DOSCODE:5B0F
DOSCODE:5B10
DOSCODE:5B10 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5B10
DOSCODE:5B10
DOSCODE:5B10 </span>GetExtended     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B10                 </span><span style="color:navy">mov     si, dx
</span><span style="color:black">DOSCODE:5B12                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:5B15                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GetBye
</span><span style="color:black">DOSCODE:5B17                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:5B1A
DOSCODE:5B1A </span><span style="color:gray">GetBye</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B1A                 </span><span style="color:navy">cmp     si, dx
</span><span style="color:black">DOSCODE:5B1C
DOSCODE:5B1C </span>getextd_retn<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B1C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5B1C </span>GetExtended     endp
<span style="color:black">DOSCODE:5B1C
DOSCODE:5B1D
DOSCODE:5B1D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5B1D
DOSCODE:5B1D
DOSCODE:5B1D </span>GetRecSize      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B1D                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5B20                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:5B22                 </span><span style="color:navy">jnz     short </span>getextd_retn
<span style="color:black">DOSCODE:5B24                 </span><span style="color:navy">mov     bx, </span><span style="color:green">128
</span><span style="color:black">DOSCODE:5B27                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:5B2A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5B2A </span>GetRecSize      endp
<span style="color:black">DOSCODE:5B2A
DOSCODE:5B2B
DOSCODE:5B2B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5B2B
DOSCODE:5B2B </span><span style="color:gray">; Attributes: bp-based frame
</span><span style="color:black">DOSCODE:5B2B
DOSCODE:5B2B </span>FCBIO           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B2B
DOSCODE:5B2B </span><span style="color:green">FCBOp           </span><span style="color:navy">= byte ptr </span><span style="color:#008040">-14h
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">cRecRes         </span><span style="color:navy">= word ptr </span><span style="color:#008040">-13h
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">cResult         </span><span style="color:navy">= word ptr </span><span style="color:#008040">-11h
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">cByte           </span><span style="color:navy">= word ptr </span><span style="color:#008040">-0Fh
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">bPosL           </span><span style="color:navy">= word ptr </span><span style="color:#008040">-0Dh
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">bPosH           </span><span style="color:navy">= word ptr </span><span style="color:#008040">-0Bh
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">RecSize         </span><span style="color:navy">= word ptr </span><span style="color:#008040">-9
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">RecPosL         </span><span style="color:navy">= word ptr </span><span style="color:#008040">-7
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">RecPosH         </span><span style="color:navy">= word ptr </span><span style="color:#008040">-5
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">cRec            </span><span style="color:navy">= word ptr </span><span style="color:#008040">-3
</span><span style="color:black">DOSCODE:5B2B </span><span style="color:green">FCBErr          </span><span style="color:navy">= byte ptr </span><span style="color:#008040">-1
</span><span style="color:black">DOSCODE:5B2B
DOSCODE:5B2B                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:5B2C                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:black">DOSCODE:5B2E                 </span><span style="color:navy">sub     sp, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:5B31                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:5B34                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5B38                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:black">DOSCODE:5B3B                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:5B3F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GetPos
</span><span style="color:black">DOSCODE:5B41                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5B44
DOSCODE:5B44 </span><span style="color:gray">GetPos</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B44                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cRec</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:5B47                 </span><span style="color:navy">call    </span>GetExtent
<span style="color:black">DOSCODE:5B4A                 </span><span style="color:navy">call    </span>GetRecSize
<span style="color:black">DOSCODE:5B4D                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">RecSize</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:5B50                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:5B54                 </span><span style="color:navy">jz      short </span><span style="color:gray">GetRec
</span><span style="color:black">DOSCODE:5B56                 </span><span style="color:navy">call    </span>GetRR
<span style="color:black">DOSCODE:5B59
DOSCODE:5B59 </span><span style="color:gray">GetRec</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B59                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">RecPosL</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5B5C                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">RecPosH</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:5B5F                 </span><span style="color:navy">call    </span>SetExtent
<span style="color:black">DOSCODE:5B62                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:green">RecPosH</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5B65                 </span><span style="color:navy">mul     bx
</span><span style="color:black">DOSCODE:5B67                 </span><span style="color:navy">mov     di, ax
</span><span style="color:black">DOSCODE:5B69                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:green">RecPosL</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5B6C                 </span><span style="color:navy">mul     bx
</span><span style="color:black">DOSCODE:5B6E                 </span><span style="color:navy">add     dx, di
</span><span style="color:black">DOSCODE:5B70                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">bPosL</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5B73                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">bPosH</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:5B76                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:green">cRec</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5B79                 </span><span style="color:navy">mul     bx
</span><span style="color:black">DOSCODE:5B7B                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cByte</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5B7E                 </span><span style="color:navy">add     ax, word ptr ss:</span>DMAADD
<span style="color:black">DOSCODE:5B83                 </span><span style="color:navy">adc     dx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5B86                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoOper
</span><span style="color:black">DOSCODE:5B88                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">], </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:5B8C                 </span><span style="color:navy">mov     ax, word ptr ss:</span>DMAADD
<span style="color:black">DOSCODE:5B90                 </span><span style="color:navy">neg     ax
</span><span style="color:black">DOSCODE:5B92                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoDiv
</span><span style="color:black">DOSCODE:5B94                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:5B95
DOSCODE:5B95 </span><span style="color:gray">DoDiv</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5B95                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:5B97                 </span><span style="color:navy">div     bx
</span><span style="color:black">DOSCODE:5B99                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cRec</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5B9C                 </span><span style="color:navy">mul     bx
</span><span style="color:black">DOSCODE:5B9E                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cByte</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5BA1
DOSCODE:5BA1 </span><span style="color:gray">DoOper</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5BA1                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:5BA3                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cResult</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:5BA6                 </span><span style="color:navy">cmp     [bp+</span><span style="color:green">cByte</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:5BA9                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoGetExt
</span><span style="color:black">DOSCODE:5BAB                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:5BAF                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoGetExt
</span><span style="color:black">DOSCODE:5BB1                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SkipOp
</span><span style="color:black">DOSCODE:5BB3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5BB3
DOSCODE:5BB3 </span><span style="color:gray">DoGetExt</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5BB3                 </span><span style="color:navy">call    </span>SFTFromFCB
<span style="color:black">DOSCODE:5BB6                 </span><span style="color:navy">jnb     short </span><span style="color:gray">ContinueOp
</span><span style="color:black">DOSCODE:5BB8
DOSCODE:5BB8 </span><span style="color:gray">FCBDeath</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5BB8                 </span><span style="color:navy">call    </span>FCB_RET_ERR
<span style="color:black">DOSCODE:5BBB                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cRecRes</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5BC0                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5BC4                 </span><span style="color:navy">jmp     </span><span style="color:gray">FCBSave
</span><span style="color:black">DOSCODE:5BC7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5BC7
DOSCODE:5BC7 </span><span style="color:gray">ContinueOp</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5BC7                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5BCA                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5BCE                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">12h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5BD1                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5BD5                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:green">bPosL</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5BD8                 </span><span style="color:navy">mov     dx, [bp+</span><span style="color:green">bPosH</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5BDB                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5BDF                 </span><span style="color:navy">xchg    dx, es:[di+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5BE3                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:5BE4                 </span><span style="color:navy">mov     cx, [bp+</span><span style="color:green">cByte</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5BE7                 </span><span style="color:navy">mov     di, offset </span>DOS_READ
<span style="color:black">DOSCODE:5BEA                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:5BEE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoContext
</span><span style="color:black">DOSCODE:5BF0                 </span><span style="color:navy">mov     di, offset </span>DOS_WRITE
<span style="color:black">DOSCODE:5BF3
DOSCODE:5BF3 </span><span style="color:gray">DoContext</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5BF3                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:5BF4                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:5BF5                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:5BF6                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:5BF7                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5BF8                 </span><span style="color:navy">call    di </span><span style="color:gray">; </span><span style="color:navy">loc_B20C
</span><span style="color:black">DOSCODE:5BFA                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:5BFB                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5BFC                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:5BFD                 </span><span style="color:navy">jb      short </span><span style="color:gray">FCBDeath
</span><span style="color:black">DOSCODE:5BFF                 </span><span style="color:navy">cmp     ss:</span>DISK_FULL<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5C05                 </span><span style="color:navy">jz      short </span><span style="color:gray">NODSKFULL
</span><span style="color:black">DOSCODE:5C07                 </span><span style="color:navy">mov     ss:</span>DISK_FULL<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5C0D                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5C11
DOSCODE:5C11 </span><span style="color:gray">NODSKFULL</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5C11                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cResult</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:5C14                 </span><span style="color:navy">call    </span>SaveFCBInfo
<span style="color:black">DOSCODE:5C17                 </span><span style="color:navy">pop     word ptr es:[di+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C1B                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C1F                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5C22                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C26                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">12h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5C29
DOSCODE:5C29 </span><span style="color:gray">SkipOp</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5C29                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:green">cResult</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C2C                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:5C2E                 </span><span style="color:navy">div     [bp+</span><span style="color:green">RecSize</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C31                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">cRecRes</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5C34                 </span><span style="color:navy">add     [bp+</span><span style="color:green">RecPosL</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5C37                 </span><span style="color:navy">adc     [bp+</span><span style="color:green">RecPosH</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5C3B                 </span><span style="color:navy">cmp     ax, [bp+</span><span style="color:green">cRec</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C3E                 </span><span style="color:navy">jz      short </span><span style="color:gray">TryBlank
</span><span style="color:black">DOSCODE:5C40                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:5C44                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SetEOF
</span><span style="color:black">DOSCODE:5C46                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5C4B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">TryBlank
</span><span style="color:black">DOSCODE:5C4D
DOSCODE:5C4D </span><span style="color:gray">SetEOF</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5C4D                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5C51
DOSCODE:5C51 </span><span style="color:gray">TryBlank</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5C51                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:5C53                 </span><span style="color:navy">jz      short </span><span style="color:gray">SetExt
</span><span style="color:black">DOSCODE:5C55                 </span><span style="color:navy">add     [bp+</span><span style="color:green">RecPosL</span><span style="color:navy">], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5C59                 </span><span style="color:navy">adc     [bp+</span><span style="color:green">RecPosH</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:5C5D                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:5C61                 </span><span style="color:navy">jz      short </span><span style="color:gray">SetExt
</span><span style="color:black">DOSCODE:5C63                 </span><span style="color:navy">inc     [bp+</span><span style="color:green">cRecRes</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C66                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">], </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:5C6A                 </span><span style="color:navy">mov     cx, [bp+</span><span style="color:green">RecSize</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C6D                 </span><span style="color:navy">sub     cx, dx          </span><span style="color:red">; ...
</span><span style="color:black">DOSCODE:5C6F                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:5C71                 </span><span style="color:navy">les     di, ss:</span>DMAADD
<span style="color:black">DOSCODE:5C76                 </span><span style="color:navy">add     di, [bp+</span><span style="color:green">cResult</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C79                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:5C7B
DOSCODE:5C7B </span><span style="color:gray">SetExt</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5C7B                 </span><span style="color:navy">mov     dx, [bp+</span><span style="color:green">RecPosH</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C7E                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:green">RecPosL</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5C81                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:5C85                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoSetExt
</span><span style="color:black">DOSCODE:5C87                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:5C8B                 </span><span style="color:navy">jz      short </span><span style="color:gray">TrySetRR
</span><span style="color:black">DOSCODE:5C8D
DOSCODE:5C8D </span><span style="color:gray">DoSetExt</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5C8D                 </span><span style="color:navy">call    </span>SetExtent
<span style="color:black">DOSCODE:5C90
DOSCODE:5C90 </span><span style="color:gray">TrySetRR</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5C90                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:5C94                 </span><span style="color:navy">jz      short </span><span style="color:gray">TryReturn
</span><span style="color:black">DOSCODE:5C96                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">21h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5C99                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">23h</span><span style="color:navy">], dl
</span><span style="color:black">DOSCODE:5C9C                 </span><span style="color:navy">cmp     word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], </span><span style="color:green">64
</span><span style="color:black">DOSCODE:5CA0                 </span><span style="color:navy">jnb     short </span><span style="color:gray">TryReturn
</span><span style="color:black">DOSCODE:5CA2                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">24h</span><span style="color:navy">], dh
</span><span style="color:black">DOSCODE:5CA5
DOSCODE:5CA5 </span><span style="color:gray">TryReturn</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5CA5                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:5CA9                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FCBSave
</span><span style="color:black">DOSCODE:5CAB                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:5CAC                 </span><span style="color:navy">call    </span>DATE16
<span style="color:black">DOSCODE:5CAF                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5CB0                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5CB3                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">16h</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:5CB6
DOSCODE:5CB6 </span><span style="color:gray">FCBSave</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5CB6                 </span><span style="color:navy">test    [bp+</span><span style="color:green">FCBOp</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:5CBA                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoReturn
</span><span style="color:black">DOSCODE:5CBC                 </span><span style="color:navy">mov     cx, [bp+</span><span style="color:green">cRecRes</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5CBF                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:5CC2                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:5CC5
DOSCODE:5CC5 </span><span style="color:gray">DoReturn</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5CC5                 </span><span style="color:navy">mov     al, [bp+</span><span style="color:green">FCBErr</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5CC8                 </span><span style="color:navy">mov     sp, bp
</span><span style="color:black">DOSCODE:5CCA                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:5CCB                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5CCB </span>FCBIO           endp
<span style="color:black">DOSCODE:5CCB
DOSCODE:5CCC
DOSCODE:5CCC </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5CCC
DOSCODE:5CCC
DOSCODE:5CCC </span>$FCB_OPEN       proc near               <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:5CCC                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:5CCF                 </span><span style="color:navy">mov     cx, offset </span>DOS_OPEN
<span style="color:black">DOSCODE:5CD2
DOSCODE:5CD2 </span>DoAccess<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5CD2                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:5CD3                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:5CD4                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:5CD5                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5CD6                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:black">DOSCODE:5CD9                 </span><span style="color:navy">call    </span>TransFCB
<span style="color:black">DOSCODE:5CDC                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5CDD                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:5CDE                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:5CDF                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5CE0                 </span><span style="color:navy">jnb     short </span><span style="color:gray">FindFCB
</span><span style="color:black">DOSCODE:5CE2
DOSCODE:5CE2 </span><span style="color:gray">FCBOpenErr</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5CE2                 </span><span style="color:navy">jmp     </span>FCB_RET_ERR
<span style="color:black">DOSCODE:5CE5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5CE5
DOSCODE:5CE5 </span><span style="color:gray">FindFCB</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5CE5                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:black">DOSCODE:5CE8                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5CE9                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:5CEB                 </span><span style="color:navy">call    </span>LRUFCB
<span style="color:black">DOSCODE:5CEE                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5CEF                 </span><span style="color:navy">jb      short </span><span style="color:gray">HardMessage
</span><span style="color:black">DOSCODE:5CF1                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:5CF7                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:5CF8                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:5CF9                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:5CFA                 </span><span style="color:navy">mov     si, cx
</span><span style="color:black">DOSCODE:5CFC                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:5CFD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5CFE                 </span><span style="color:navy">call    si
</span><span style="color:black">DOSCODE:5D00                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:5D01                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:5D02                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5D03                 </span><span style="color:navy">les     di, ss:</span>THISSFT
<span style="color:black">DOSCODE:5D08                 </span><span style="color:navy">jnb     short </span><span style="color:gray">FCBOK
</span><span style="color:black">DOSCODE:5D0A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5D0B                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">R&#039;
</span><span style="color:black">DOSCODE:5D0D                 </span><span style="color:navy">call    </span>BlastSFT
<span style="color:black">DOSCODE:5D10                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5D11                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:5D14                 </span><span style="color:navy">jz      short </span><span style="color:gray">HardMessage
</span><span style="color:black">DOSCODE:5D16                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">24h </span><span style="color:gray">; &#039;$&#039;
</span><span style="color:black">DOSCODE:5D19                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DeadFCB
</span><span style="color:black">DOSCODE:5D1B
DOSCODE:5D1B </span><span style="color:gray">HardMessage</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D1B                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5D1C                 </span><span style="color:navy">call    </span>FCBHardErr
<span style="color:black">DOSCODE:5D1F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5D20
DOSCODE:5D20 </span><span style="color:gray">DeadFCB</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D20                 </span><span style="color:navy">jmp     short </span><span style="color:gray">FCBOpenErr
</span><span style="color:black">DOSCODE:5D22 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5D22
DOSCODE:5D22 </span><span style="color:gray">FCBOK</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D22                 </span><span style="color:navy">call    </span>IsSFTNet
<span style="color:black">DOSCODE:5D25                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FCBOK2
</span><span style="color:black">DOSCODE:5D27                 </span><span style="color:navy">call    </span>CheckShare
<span style="color:black">DOSCODE:5D2A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FCBOK2
</span><span style="color:black">DOSCODE:5D2C                 </span><span style="color:navy">mov     word ptr ss:</span>LocalSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:5D31                 </span><span style="color:navy">mov     word ptr ss:</span>LocalSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:5D36
DOSCODE:5D36 </span><span style="color:gray">FCBOK2</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D36                 </span><span style="color:navy">inc     word ptr es:[di]
</span><span style="color:black">DOSCODE:5D39                 </span><span style="color:navy">call    </span>SaveFCBInfo
<span style="color:black">DOSCODE:5D3C                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5D41                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FCBNoDrive
</span><span style="color:black">DOSCODE:5D43                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:black">DOSCODE:5D45                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:black">DOSCODE:5D48                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:5D4A                 </span><span style="color:navy">mov     [si], al
</span><span style="color:black">DOSCODE:5D4C
DOSCODE:5D4C </span><span style="color:gray">FCBNoDrive</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D4C                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:5D51                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5D55                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">16h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5D58                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5D5C                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5D5F                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5D63                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5D66                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5D6A                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">12h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5D6D                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:5D6F                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">0Ch</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5D72                 </span><span style="color:navy">les     di, ss:</span>SFTFCB
<span style="color:black">DOSCODE:5D77                 </span><span style="color:navy">mov     ah, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5D7B
DOSCODE:5D7B </span><span style="color:gray">OpenScan</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D7B                 </span><span style="color:navy">cmp     al, [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:5D7E                 </span><span style="color:navy">jz      short </span><span style="color:gray">SkipCheck
</span><span style="color:black">DOSCODE:5D80                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:5D81                 </span><span style="color:navy">call    </span>CheckFCB
<span style="color:black">DOSCODE:5D84                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:5D85                 </span><span style="color:navy">jnb     short </span><span style="color:gray">OpenFound
</span><span style="color:black">DOSCODE:5D87
DOSCODE:5D87 </span><span style="color:gray">SkipCheck</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D87                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:5D89                 </span><span style="color:navy">cmp     al, ah
</span><span style="color:black">DOSCODE:5D8B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OpenScan
</span><span style="color:black">DOSCODE:5D8D
DOSCODE:5D8D </span><span style="color:gray">OpenDone</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D8D                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:5D8F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5D90 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5D90
DOSCODE:5D90 </span><span style="color:gray">OpenFound</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5D90                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:5D93                 </span><span style="color:navy">inc     word ptr es:[di]
</span><span style="color:black">DOSCODE:5D96                 </span><span style="color:navy">mov     ax, ss:</span>FCBLRU
<span style="color:black">DOSCODE:5D9A                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:5D9E                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:5D9F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:5DA0                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:5DA4                 </span><span style="color:navy">dec     word ptr es:[di]
</span><span style="color:black">DOSCODE:5DA7                 </span><span style="color:navy">call    </span>ShareEnd
<span style="color:black">DOSCODE:5DAA                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">C&#039;
</span><span style="color:black">DOSCODE:5DAC                 </span><span style="color:navy">call    </span>BlastSFT
<span style="color:black">DOSCODE:5DAF                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OpenDone
</span><span style="color:black">DOSCODE:5DAF </span>$FCB_OPEN       endp
<span style="color:black">DOSCODE:5DAF
</span><span style="color:maroon">DOSCODE:5DB1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DB1
DOSCODE:5DB1 </span>$FCB_CREATE<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DB1                 </span><span style="color:navy">mov     cx, offset </span>DOS_CREATE
<span style="color:maroon">DOSCODE:5DB4                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:5DB6                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:maroon">DOSCODE:5DB9                 </span><span style="color:navy">jz      short </span>DoAccessJ
<span style="color:maroon">DOSCODE:5DBB                 </span><span style="color:navy">mov     al, [si-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:5DBE
DOSCODE:5DBE </span>DoAccessJ<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5DBE                 </span><span style="color:navy">jmp     </span>DoAccess
<span style="color:maroon">DOSCODE:5DC1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DC1
DOSCODE:5DC1 </span>$FCB_RANDOM_WRITE_BLOCK<span style="color:navy">:                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DC1                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:maroon">DOSCODE:5DC3                 </span><span style="color:navy">jmp     </span>FCBIO
<span style="color:maroon">DOSCODE:5DC6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DC6
DOSCODE:5DC6 </span>$FCB_RANDOM_READ_BLOCK<span style="color:navy">:                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DC6                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Eh
</span><span style="color:maroon">DOSCODE:5DC8                 </span><span style="color:navy">jmp     </span>FCBIO
<span style="color:maroon">DOSCODE:5DCB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DCB
DOSCODE:5DCB </span>$FCB_SEQ_READ<span style="color:navy">:                          </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DCB                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:5DCD                 </span><span style="color:navy">jmp     </span>FCBIO
<span style="color:maroon">DOSCODE:5DD0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DD0
DOSCODE:5DD0 </span>$FCB_SEQ_WRITE<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DD0                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:5DD2                 </span><span style="color:navy">jmp     </span>FCBIO
<span style="color:maroon">DOSCODE:5DD5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DD5
DOSCODE:5DD5 </span>$FCB_RANDOM_READ<span style="color:navy">:                       </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DD5                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:5DD7                 </span><span style="color:navy">jmp     </span>FCBIO
<span style="color:maroon">DOSCODE:5DDA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DDA
DOSCODE:5DDA </span>$FCB_RANDOM_WRITE<span style="color:navy">:                      </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DDA                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:5DDC                 </span><span style="color:navy">jmp     </span>FCBIO
<span style="color:maroon">DOSCODE:5DDF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5DDF
DOSCODE:5DDF </span>$DIR_SEARCH_FIRST<span style="color:navy">:                      </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5DDF                 </span><span style="color:navy">mov     word ptr ss:</span>THISFCB<span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:5DE4                 </span><span style="color:navy">mov     word ptr ss:</span>THISFCB<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:5DE9                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:5DEB                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:5DEE                 </span><span style="color:navy">jnz     short </span>NORMFCB4
<span style="color:maroon">DOSCODE:5DF0                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:5DF3
DOSCODE:5DF3 </span>NORMFCB4<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5DF3                 </span><span style="color:navy">push    word ptr [si]
</span><span style="color:maroon">DOSCODE:5DF5                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:5DF6                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:5DF7                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:5DFA                 </span><span style="color:navy">call    </span>TransFCB
<span style="color:maroon">DOSCODE:5DFD                 </span><span style="color:navy">jnb     short </span>SearchIt
<span style="color:maroon">DOSCODE:5DFF                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:5E00
DOSCODE:5E00 </span>dsf_err<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5E00                 </span><span style="color:navy">jmp     </span>FCB_RET_ERR
<span style="color:maroon">DOSCODE:5E03 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5E03
DOSCODE:5E03 </span>SearchIt<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5E03                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:5E04                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5E05                 </span><span style="color:navy">push    word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5E09                 </span><span style="color:navy">push    word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5E0D                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5E13                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:5E17                 </span><span style="color:navy">call    </span>GET_FAST_SEARCH
<span style="color:maroon">DOSCODE:5E1A                 </span><span style="color:navy">pop     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5E1E                 </span><span style="color:navy">pop     word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5E22                 </span><span style="color:navy">jnb     short </span>SearchSet
<span style="color:maroon">DOSCODE:5E24                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:5E25                 </span><span style="color:navy">jmp     short </span>dsf_err
<span style="color:maroon">DOSCODE:5E27 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5E27
DOSCODE:5E27 </span>SearchSet<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5E27                 </span><span style="color:navy">mov     si, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5E2A                 </span><span style="color:navy">les     di, </span>THISFCB
<span style="color:maroon">DOSCODE:5E2E                 </span><span style="color:navy">test    </span>EXTFCB<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:5E33                 </span><span style="color:navy">jz      short </span>NORMFCB1
<span style="color:maroon">DOSCODE:5E35                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:5E38
DOSCODE:5E38 </span>NORMFCB1<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5E38                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:5E39                 </span><span style="color:navy">or      bl, bl
</span><span style="color:maroon">DOSCODE:5E3B                 </span><span style="color:navy">jnz     short </span>SearchDrv
<span style="color:maroon">DOSCODE:5E3D                 </span><span style="color:navy">mov     bl, </span>CURDRV
<span style="color:maroon">DOSCODE:5E41                 </span><span style="color:navy">inc     bl
</span><span style="color:maroon">DOSCODE:5E43
DOSCODE:5E43 </span>SearchDrv<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5E43                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:5E44                 </span><span style="color:navy">xchg    al, bl
</span><span style="color:maroon">DOSCODE:5E46                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:5E47                 </span><span style="color:navy">mov     cx, </span><span style="color:green">10
</span><span style="color:maroon">DOSCODE:5E4A                 </span><span style="color:navy">rep movsw
</span><span style="color:maroon">DOSCODE:5E4C                 </span><span style="color:navy">xchg    al, bl
</span><span style="color:maroon">DOSCODE:5E4E                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:5E4F                 </span><span style="color:navy">les     di, </span>DMAADD
<span style="color:maroon">DOSCODE:5E53                 </span><span style="color:navy">test    </span>EXTFCB<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:5E58                 </span><span style="color:navy">jz      short </span>NORMFCB2
<span style="color:maroon">DOSCODE:5E5A                 </span><span style="color:navy">mov     al, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:5E5C                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:5E5D                 </span><span style="color:navy">inc     al
</span><span style="color:maroon">DOSCODE:5E5F                 </span><span style="color:navy">mov     cx, </span><span style="color:green">5
</span><span style="color:maroon">DOSCODE:5E62                 </span><span style="color:navy">rep stosb
</span><span style="color:maroon">DOSCODE:5E64                 </span><span style="color:navy">mov     al, </span>SATTRIB
<span style="color:maroon">DOSCODE:5E67                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:5E68
DOSCODE:5E68 </span>NORMFCB2<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5E68                 </span><span style="color:navy">mov     al, bl
</span><span style="color:maroon">DOSCODE:5E6A                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:5E6B                 </span><span style="color:navy">mov     cx, </span><span style="color:green">16
</span><span style="color:maroon">DOSCODE:5E6E                 </span><span style="color:navy">rep movsw
</span><span style="color:maroon">DOSCODE:5E70                 </span><span style="color:navy">jmp     </span>NO_OP
<span style="color:maroon">DOSCODE:5E73 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5E73
DOSCODE:5E73 </span>$DIR_SEARCH_NEXT<span style="color:navy">:                       </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5E73                 </span><span style="color:navy">mov     word ptr ss:</span>THISFCB<span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:5E78                 </span><span style="color:navy">mov     word ptr ss:</span>THISFCB<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:5E7D                 </span><span style="color:navy">mov     ss:</span>SATTRIB<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:5E83                 </span><span style="color:navy">mov     ss:</span>EXTFCB<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:5E89                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:5E8A                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:5E8B                 </span><span style="color:navy">mov     di, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5E8E                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:5E90                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:5E93                 </span><span style="color:navy">jnz     short </span>NORMFCB6
<span style="color:maroon">DOSCODE:5E95                 </span><span style="color:navy">add     si, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:5E98                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:5E99                 </span><span style="color:navy">mov     ss:</span>SATTRIB<span style="color:navy">, al
</span><span style="color:maroon">DOSCODE:5E9D                 </span><span style="color:navy">dec     ss:</span>EXTFCB
<span style="color:maroon">DOSCODE:5EA2
DOSCODE:5EA2 </span>NORMFCB6<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5EA2                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:5EA3                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:5EA4                 </span><span style="color:navy">mov     al, [si+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:5EA7                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:5EA8                 </span><span style="color:navy">mov     cx, </span><span style="color:green">10
</span><span style="color:maroon">DOSCODE:5EAB                 </span><span style="color:navy">rep movsw
</span><span style="color:maroon">DOSCODE:5EAD                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:5EAE                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5EAF                 </span><span style="color:navy">push    word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5EB3                 </span><span style="color:navy">push    word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5EB7                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5EBD                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:5EC1                 </span><span style="color:navy">call    </span>DOS_SEARCH_NEXT
<span style="color:maroon">DOSCODE:5EC4                 </span><span style="color:navy">pop     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5EC8                 </span><span style="color:navy">pop     word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5ECC                 </span><span style="color:navy">jb      short </span>SearchNoMore
<span style="color:maroon">DOSCODE:5ECE                 </span><span style="color:navy">jmp     </span>SearchSet
<span style="color:maroon">DOSCODE:5ED1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5ED1
DOSCODE:5ED1 </span>SearchNoMore<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5ED1                 </span><span style="color:navy">les     di, </span>THISFCB
<span style="color:maroon">DOSCODE:5ED5                 </span><span style="color:navy">test    </span>EXTFCB<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:5EDA                 </span><span style="color:navy">jz      short </span>NORMFCB8
<span style="color:maroon">DOSCODE:5EDC                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:5EDF
DOSCODE:5EDF </span>NORMFCB8<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5EDF                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:5EE0                 </span><span style="color:navy">mov     es:[di], bl
</span><span style="color:maroon">DOSCODE:5EE3                 </span><span style="color:navy">jmp     </span>FCB_RET_ERR
<span style="color:maroon">DOSCODE:5EE6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5EE6
DOSCODE:5EE6 </span>$FIND_FIRST<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5EE6                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:5EE8                 </span><span style="color:navy">mov     ss:</span>SATTRIB<span style="color:navy">, cl
</span><span style="color:maroon">DOSCODE:5EED                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:5EF0                 </span><span style="color:navy">call    </span>TransPathSet
<span style="color:maroon">DOSCODE:5EF3                 </span><span style="color:navy">jnb     short </span>Find_it
<span style="color:maroon">DOSCODE:5EF5                 </span><span style="color:navy">mov     al, </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:5EF7
DOSCODE:5EF7 </span>FindError<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5EF7                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:5EFA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5EFA
DOSCODE:5EFA </span>Find_it<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5EFA                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:5EFB                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5EFC                 </span><span style="color:navy">push    word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5F00                 </span><span style="color:navy">push    word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5F04                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5F0A                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:5F0E                 </span><span style="color:navy">call    </span>GET_FAST_SEARCH
<span style="color:maroon">DOSCODE:5F11                 </span><span style="color:navy">pop     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5F15                 </span><span style="color:navy">pop     word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5F19                 </span><span style="color:navy">jnb     short </span>FindSet
<span style="color:maroon">DOSCODE:5F1B
DOSCODE:5F1B </span>FindItError<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5F1B                 </span><span style="color:navy">jmp     short </span>FindError
<span style="color:maroon">DOSCODE:5F1D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5F1D
DOSCODE:5F1D </span>FindSet<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5F1D                 </span><span style="color:navy">mov     si, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5F20                 </span><span style="color:navy">les     di, </span>DMAADD
<span style="color:maroon">DOSCODE:5F24                 </span><span style="color:navy">mov     cx, </span><span style="color:green">21
</span><span style="color:maroon">DOSCODE:5F27                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:5F29                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:5F2A                 </span><span style="color:navy">mov     al, [si+</span><span style="color:green">0Bh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:5F2D                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:5F2E                 </span><span style="color:navy">add     si, </span><span style="color:green">16h
</span><span style="color:maroon">DOSCODE:5F31                 </span><span style="color:navy">movsw
</span><span style="color:maroon">DOSCODE:5F32                 </span><span style="color:navy">movsw
</span><span style="color:maroon">DOSCODE:5F33                 </span><span style="color:navy">inc     si
</span><span style="color:maroon">DOSCODE:5F34                 </span><span style="color:navy">inc     si
</span><span style="color:maroon">DOSCODE:5F35                 </span><span style="color:navy">movsw
</span><span style="color:maroon">DOSCODE:5F36                 </span><span style="color:navy">movsw
</span><span style="color:maroon">DOSCODE:5F37                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:5F38                 </span><span style="color:navy">call    </span>PackName
<span style="color:maroon">DOSCODE:5F3B                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:5F3E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5F3E
DOSCODE:5F3E </span>$FIND_NEXT<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5F3E                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:5F3F                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:5F40                 </span><span style="color:navy">mov     di, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5F43                 </span><span style="color:navy">lds     si, ss:</span>DMAADD
<span style="color:maroon">DOSCODE:5F48                 </span><span style="color:navy">mov     cx, </span><span style="color:green">21
</span><span style="color:maroon">DOSCODE:5F4B                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:5F4D                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:5F4E                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5F4F                 </span><span style="color:navy">push    word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5F53                 </span><span style="color:navy">push    word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5F57                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">, offset </span>SEARCHBUF
<span style="color:maroon">DOSCODE:5F5D                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:5F61                 </span><span style="color:navy">call    </span>DOS_SEARCH_NEXT
<span style="color:maroon">DOSCODE:5F64                 </span><span style="color:navy">pop     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5F68                 </span><span style="color:navy">pop     word ptr </span>DMAADD
<span style="color:maroon">DOSCODE:5F6C                 </span><span style="color:navy">jnb     short </span>FindSet
<span style="color:maroon">DOSCODE:5F6E                 </span><span style="color:navy">jmp     short </span>FindItError
<span style="color:black">DOSCODE:5F70
DOSCODE:5F70 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5F70
DOSCODE:5F70
DOSCODE:5F70 </span>PackName        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5F70                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:5F73                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:5F75
DOSCODE:5F75 </span><span style="color:gray">main_kill_tail</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5F75                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], &#039; &#039;
</span><span style="color:black">DOSCODE:5F7A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">find_check_dot
</span><span style="color:black">DOSCODE:5F7C                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:5F7D                 </span><span style="color:navy">inc     cx
</span><span style="color:black">DOSCODE:5F7E                 </span><span style="color:navy">cmp     cx, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:5F81                 </span><span style="color:navy">jb      short </span><span style="color:gray">main_kill_tail
</span><span style="color:black">DOSCODE:5F83
DOSCODE:5F83 </span><span style="color:gray">find_check_dot</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5F83                 </span><span style="color:navy">cmp     word ptr [si], &#039;  &#039;
</span><span style="color:black">DOSCODE:5F87                 </span><span style="color:navy">jnz     short </span><span style="color:gray">got_ext
</span><span style="color:black">DOSCODE:5F89                 </span><span style="color:navy">cmp     byte ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], &#039; &#039;
</span><span style="color:black">DOSCODE:5F8D                 </span><span style="color:navy">jz      short </span><span style="color:gray">find_done
</span><span style="color:black">DOSCODE:5F8F
DOSCODE:5F8F </span><span style="color:gray">got_ext</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5F8F                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">.&#039;
</span><span style="color:black">DOSCODE:5F91                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:5F92                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:5F95                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:5F97
DOSCODE:5F97 </span><span style="color:gray">ext_kill_tail</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5F97                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], &#039; &#039;
</span><span style="color:black">DOSCODE:5F9C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">find_done
</span><span style="color:black">DOSCODE:5F9E                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:5F9F                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ext_kill_tail
</span><span style="color:black">DOSCODE:5FA1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:5FA1
DOSCODE:5FA1 </span><span style="color:gray">find_done</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:5FA1                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:5FA3                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:5FA4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5FA4 </span>PackName        endp
<span style="color:black">DOSCODE:5FA4
DOSCODE:5FA5
DOSCODE:5FA5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:5FA5
DOSCODE:5FA5
DOSCODE:5FA5 </span>GET_FAST_SEARCH proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:5FA5                 </span><span style="color:navy">or      ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">400h
</span><span style="color:black">DOSCODE:5FAC                 </span><span style="color:navy">call    </span>DOS_SEARCH_FIRST
<span style="color:black">DOSCODE:5FAF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:5FAF </span>GET_FAST_SEARCH endp
<span style="color:black">DOSCODE:5FAF
</span><span style="color:maroon">DOSCODE:5FB0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5FB0
DOSCODE:5FB0 </span>$CURRENT_DIR<span style="color:navy">:                           </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:5FB0                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:5FB3                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:5FB5                 </span><span style="color:navy">call    </span>GetVisDrv
<span style="color:maroon">DOSCODE:5FB8                 </span><span style="color:navy">jnb     short </span>CurrentValidate
<span style="color:maroon">DOSCODE:5FBA
DOSCODE:5FBA </span>CurdirErr<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5FBA                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:5FBD                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:5FBE                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:5FC3                 </span><span style="color:navy">mov     al, </span>DrvErr
<span style="color:maroon">DOSCODE:5FC6                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5FC7
DOSCODE:5FC7 </span>curdir_errj<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5FC7                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:5FCA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:5FCA
DOSCODE:5FCA </span>CurrentValidate<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:5FCA                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:5FCB                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:5FCC                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:5FD1                 </span><span style="color:navy">lds     si, </span>THISCDS
<span style="color:maroon">DOSCODE:5FD5                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:maroon">DOSCODE:5FDA                 </span><span style="color:navy">jnz     short $+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:5FDC                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:5FDD                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:5FE2                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:5FE7                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5FE8                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:5FEB                 </span><span style="color:navy">call    </span>ValidateCDS
<span style="color:maroon">DOSCODE:5FEE                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:5FEF                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:5FF0                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:5FF1                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:5FF2                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:5FF3                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:5FF4                 </span><span style="color:navy">jb      short </span>CurdirErr
<span style="color:maroon">DOSCODE:5FF6                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:5FF9                 </span><span style="color:navy">add     si, [si+</span><span style="color:#ff8000">4Fh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:5FFC                 </span><span style="color:navy">cmp     byte ptr [si], &#039;</span><span style="color:green">\&#039;
</span><span style="color:maroon">DOSCODE:5FFF                 </span><span style="color:navy">jnz     short </span>CurrentCopy
<span style="color:maroon">DOSCODE:6001                 </span><span style="color:navy">inc     si
</span><span style="color:maroon">DOSCODE:6002
DOSCODE:6002 </span>CurrentCopy<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6002                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:6003                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:6004                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:6006                 </span><span style="color:navy">jz      short </span>FOK
<span style="color:maroon">DOSCODE:6008                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:600A                 </span><span style="color:navy">jz      short </span>FCHANGE
<span style="color:maroon">DOSCODE:600C                 </span><span style="color:navy">jmp     short </span>FFF
<span style="color:maroon">DOSCODE:600E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:600E
DOSCODE:600E </span>FCPYNEXT<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:600E                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:600F
DOSCODE:600F </span>FFF<span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:600F                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:maroon">DOSCODE:6011                 </span><span style="color:navy">jnz     short </span>FOK
<span style="color:maroon">DOSCODE:6013                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:6014                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:6015                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:6017                 </span><span style="color:navy">jnz     short </span>FOK
<span style="color:maroon">DOSCODE:6019
DOSCODE:6019 </span>FCHANGE<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6019                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:maroon">DOSCODE:601B
DOSCODE:601B </span>FOK<span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:601B                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:601C                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:601E                 </span><span style="color:navy">jnz     short </span>FCPYNEXT
<span style="color:maroon">DOSCODE:6020                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:6021                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:6023                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:6026                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:6029 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6029
DOSCODE:6029 </span>$RMDIR<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:6029                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:602A                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:602B                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:602D                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:6030                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:6031                 </span><span style="color:navy">call    </span>TransPathNoSet
<span style="color:maroon">DOSCODE:6034                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:6035                 </span><span style="color:navy">jnb     short </span>rmlset
<span style="color:maroon">DOSCODE:6037                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:6038                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:6039                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:603B
DOSCODE:603B </span>rmdir_errj<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:603B                 </span><span style="color:navy">jmp     short </span>curdir_errj
<span style="color:maroon">DOSCODE:603D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:603D
DOSCODE:603D </span>rmlset<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:603D                 </span><span style="color:navy">cmp     ss:</span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:6043                 </span><span style="color:navy">jnz     short </span>rmerr
<span style="color:maroon">DOSCODE:6045                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:6046                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:6047                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:6049
DOSCODE:6049 </span>rmloop<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6049                 </span><span style="color:navy">call    </span>GetCDSFromDrv
<span style="color:maroon">DOSCODE:604C                 </span><span style="color:navy">jb      short </span>rmcont
<span style="color:maroon">DOSCODE:604E                 </span><span style="color:navy">call    </span>StrCmp
<span style="color:maroon">DOSCODE:6051                 </span><span style="color:navy">jz      short </span>rmerr
<span style="color:maroon">DOSCODE:6053                 </span><span style="color:navy">inc     al
</span><span style="color:maroon">DOSCODE:6055                 </span><span style="color:navy">jmp     short </span>rmloop
<span style="color:maroon">DOSCODE:6057 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6057
DOSCODE:6057 </span>rmerr<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6057                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:6058                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:6059                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">10h
</span><span style="color:maroon">DOSCODE:605B
DOSCODE:605B </span>rmerrj<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:605B                 </span><span style="color:navy">jmp     short </span>rmdir_errj
<span style="color:maroon">DOSCODE:605D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:605D
DOSCODE:605D </span>rmcont<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:605D                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:605E                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:605F                 </span><span style="color:navy">mov     si, offset </span>DOS_RMDIR
<span style="color:maroon">DOSCODE:6062                 </span><span style="color:navy">jmp     </span>DoDirCall
<span style="color:maroon">DOSCODE:6065 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6065
DOSCODE:6065 </span>$CHDIR<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:6065                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:6068                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:606A                 </span><span style="color:navy">call    </span>TransPath
<span style="color:maroon">DOSCODE:606D                 </span><span style="color:navy">jnb     short </span>ChDirCrack
<span style="color:maroon">DOSCODE:606F
DOSCODE:606F </span>ChDirErrP<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:606F                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:6071
DOSCODE:6071 </span>ChDirErr<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6071                 </span><span style="color:navy">jmp     short </span>rmerrj
<span style="color:maroon">DOSCODE:6073 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6073
DOSCODE:6073 </span>ChDirCrack<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6073                 </span><span style="color:navy">cmp     </span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:6078                 </span><span style="color:navy">jnz     short </span>ChDirErrP
<span style="color:maroon">DOSCODE:607A                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:maroon">DOSCODE:607E                 </span><span style="color:navy">cmp     di, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:6081                 </span><span style="color:navy">jz      short </span>ChDirErrP
<span style="color:maroon">DOSCODE:6083                 </span><span style="color:navy">call    </span>DOS_CHDIR
<span style="color:maroon">DOSCODE:6086                 </span><span style="color:navy">jb      short </span>ChDirErr
<span style="color:maroon">DOSCODE:6088                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:maroon">DOSCODE:608C                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">2000h
</span><span style="color:maroon">DOSCODE:6092                 </span><span style="color:navy">jz      short </span>GotCDS
<span style="color:maroon">DOSCODE:6094                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:6095                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:6096                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:6097                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:609A                 </span><span style="color:navy">mov     di, [si+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:609D                 </span><span style="color:navy">mov     ds, word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:60A0                 </span><span style="color:navy">mov     si, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:60A3                 </span><span style="color:navy">xchg    si, di
</span><span style="color:maroon">DOSCODE:60A5                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:60A7                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:60A8                 </span><span style="color:navy">call    </span>TransPathNoSet
<span style="color:maroon">DOSCODE:60AB                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:60AC                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:maroon">DOSCODE:60B0                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">49h</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:60B6                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:60B7                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:60B8                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:60B9
DOSCODE:60B9 </span>GotCDS<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60B9                 </span><span style="color:navy">call    </span>Check_PathLen
<span style="color:maroon">DOSCODE:60BC                 </span><span style="color:navy">ja      short </span>ChDirErrP
<span style="color:maroon">DOSCODE:60BE                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:maroon">DOSCODE:60C4                 </span><span style="color:navy">jnz     short </span>SkipRecency
<span style="color:maroon">DOSCODE:60C6                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">2000h
</span><span style="color:maroon">DOSCODE:60CC                 </span><span style="color:navy">jz      short </span>setdirclus
<span style="color:maroon">DOSCODE:60CE                 </span><span style="color:navy">mov     cx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:60D1
DOSCODE:60D1 </span>setdirclus<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60D1                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">49h</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:60D5                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:maroon">DOSCODE:60D9
DOSCODE:60D9 </span>SkipRecency<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60D9                 </span><span style="color:navy">call    </span>FStrCpy
<span style="color:maroon">DOSCODE:60DC                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:60DE
DOSCODE:60DE </span>mkdir_ok<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60DE                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:60E1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:60E1
DOSCODE:60E1 </span>$MKDIR<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:60E1                 </span><span style="color:navy">mov     si, offset </span>DOS_MKDIR
<span style="color:maroon">DOSCODE:60E4
DOSCODE:60E4 </span>DoDirCall<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60E4                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:60E7                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:60E8                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:60EA                 </span><span style="color:navy">call    </span>TransPath
<span style="color:maroon">DOSCODE:60ED                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:60EE                 </span><span style="color:navy">jnb     short </span>MkDirCrack
<span style="color:maroon">DOSCODE:60F0
DOSCODE:60F0 </span>MkErrP<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60F0                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:60F2
DOSCODE:60F2 </span>MkErr<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60F2                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:60F5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:60F5
DOSCODE:60F5 </span>MkDirCrack<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:60F5                 </span><span style="color:navy">cmp     ss:</span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:60FB                 </span><span style="color:navy">jnz     short </span>MkErrP
<span style="color:maroon">DOSCODE:60FD                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:60FE                 </span><span style="color:navy">call    </span>Check_PathLen
<span style="color:maroon">DOSCODE:6101                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:6102                 </span><span style="color:navy">jbe     short </span>pathok
<span style="color:maroon">DOSCODE:6104                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:6106                 </span><span style="color:navy">jmp     short </span>MkErr
<span style="color:maroon">DOSCODE:6108 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6108
DOSCODE:6108 </span>pathok<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6108                 </span><span style="color:navy">call    si
</span><span style="color:maroon">DOSCODE:610A                 </span><span style="color:navy">jb      short </span>MkErr
<span style="color:maroon">DOSCODE:610C                 </span><span style="color:navy">jmp     short </span>mkdir_ok
<span style="color:black">DOSCODE:610E
DOSCODE:610E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:610E
DOSCODE:610E
DOSCODE:610E </span>Check_PathLen   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:610E                 </span><span style="color:navy">mov     si, ss:</span>WFP_START
<span style="color:black">DOSCODE:610E </span>Check_PathLen   endp
<span style="color:black">DOSCODE:610E
DOSCODE:6113
DOSCODE:6113 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6113
DOSCODE:6113
DOSCODE:6113 </span>check_PathLen2  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6113                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6114                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6115                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:6116                 </span><span style="color:navy">call    </span>DStrLen
<span style="color:black">DOSCODE:6119                 </span><span style="color:navy">cmp     cx, </span><span style="color:green">67
</span><span style="color:black">DOSCODE:611C                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:611D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:611D </span>check_PathLen2  endp
<span style="color:black">DOSCODE:611D
DOSCODE:611D </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:611E </span>IOCTLJMPTABLE   <span style="color:navy">dw offset </span>ioctl_getset_data <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:6120                 </span><span style="color:navy">dw offset </span>ioctl_getset_data
<span style="color:gray">DOSCODE:6122                 </span><span style="color:navy">dw offset </span>ioctl_control_string
<span style="color:gray">DOSCODE:6124                 </span><span style="color:navy">dw offset </span>ioctl_control_string
<span style="color:gray">DOSCODE:6126                 </span><span style="color:navy">dw offset </span>ioctl_get_dev
<span style="color:gray">DOSCODE:6128                 </span><span style="color:navy">dw offset </span>ioctl_get_dev
<span style="color:gray">DOSCODE:612A                 </span><span style="color:navy">dw offset </span>ioctl_status
<span style="color:gray">DOSCODE:612C                 </span><span style="color:navy">dw offset </span>ioctl_status
<span style="color:gray">DOSCODE:612E                 </span><span style="color:navy">dw offset </span>ioctl_rem_media
<span style="color:gray">DOSCODE:6130                 </span><span style="color:navy">dw offset </span>ioctl_drive_attr
<span style="color:gray">DOSCODE:6132                 </span><span style="color:navy">dw offset </span>ioctl_handle_redir
<span style="color:gray">DOSCODE:6134                 </span><span style="color:navy">dw offset </span>Set_Retry_Parameters
<span style="color:gray">DOSCODE:6136                 </span><span style="color:navy">dw offset </span>GENERICIOCTLHANDLE
<span style="color:gray">DOSCODE:6138                 </span><span style="color:navy">dw offset </span>GENERICIOCTL
<span style="color:gray">DOSCODE:613A                 </span><span style="color:navy">dw offset </span>ioctl_drive_owner
<span style="color:gray">DOSCODE:613C                 </span><span style="color:navy">dw offset </span>ioctl_drive_owner
<span style="color:gray">DOSCODE:613E                 </span><span style="color:navy">dw offset </span>GENERICIOCTLHANDLE ; query_handle_support
<span style="color:gray">DOSCODE:6140                 </span><span style="color:navy">dw offset </span>GENERICIOCTL  ; query_device_support
<span style="color:black">DOSCODE:6142
DOSCODE:6142 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6142
DOSCODE:6142
DOSCODE:6142 </span>$IOCTL          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6142
DOSCODE:6142 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:43FA SIZE 00000013 BYTES
</span><span style="color:black">DOSCODE:6142 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:6265 SIZE 00000090 BYTES
</span><span style="color:black">DOSCODE:6142 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:62FA SIZE 00000074 BYTES
</span><span style="color:black">DOSCODE:6142 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:63B3 SIZE 0000004A BYTES
</span><span style="color:black">DOSCODE:6142
DOSCODE:6142                 </span><span style="color:navy">mov     si, ds
</span><span style="color:black">DOSCODE:6144                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6145                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6146                 </span><span style="color:navy">cmp     al, </span><span style="color:green">11h
</span><span style="color:black">DOSCODE:6148                 </span><span style="color:navy">ja      short </span><span style="color:gray">ioctl_bad_funj2
</span><span style="color:black">DOSCODE:614A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:614B                 </span><span style="color:navy">mov     di, ax
</span><span style="color:black">DOSCODE:614D                 </span><span style="color:navy">and     di, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:6151                 </span><span style="color:navy">shl     di, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6153                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6154                 </span><span style="color:navy">jmp     cs:</span>IOCTLJMPTABLE<span style="color:navy">[di]
</span><span style="color:black">DOSCODE:6159 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6159
DOSCODE:6159 </span><span style="color:gray">ioctl_bad_funj2</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6159                 </span><span style="color:navy">jmp     </span>ioctl_bad_fun
<span style="color:black">DOSCODE:615C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:615C
DOSCODE:615C </span>ioctl_getset_data<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:615C                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:black">DOSCODE:615F                 </span><span style="color:navy">jnb     short </span><span style="color:gray">ioctl_check_permissions
</span><span style="color:black">DOSCODE:6161
DOSCODE:6161 </span>ioctl_bad_handle<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6161                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:6163
DOSCODE:6163 </span><span style="color:gray">ioctl_error</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6163                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:6166 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6166
DOSCODE:6166 </span><span style="color:gray">ioctl_check_permissions</span><span style="color:navy">:                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6166                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6168                 </span><span style="color:navy">mov     al, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:616C                 </span><span style="color:navy">jz      short </span><span style="color:gray">ioctl_read
</span><span style="color:black">DOSCODE:616E                 </span><span style="color:navy">or      dh, dh
</span><span style="color:black">DOSCODE:6170                 </span><span style="color:navy">jz      short </span><span style="color:gray">ioctl_check_device
</span><span style="color:black">DOSCODE:6172                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:6174                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ioctl_error
</span><span style="color:black">DOSCODE:6176 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6176
DOSCODE:6176 </span><span style="color:gray">ioctl_check_device</span><span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6176                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6178                 </span><span style="color:navy">jz      short </span><span style="color:gray">ioctl_bad_funj2
</span><span style="color:black">DOSCODE:617A                 </span><span style="color:navy">or      dl, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:617D                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:6182                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], dl
</span><span style="color:black">DOSCODE:6186
DOSCODE:6186 </span><span style="color:gray">ioctl_ok</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6186                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:6189 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6189
DOSCODE:6189 </span><span style="color:gray">ioctl_read</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6189                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:618E                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:6190                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6192                 </span><span style="color:navy">jz      short </span><span style="color:gray">ioctl_no_high
</span><span style="color:black">DOSCODE:6194                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:6199                 </span><span style="color:navy">les     di, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:619D                 </span><span style="color:navy">mov     ah, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:61A1
DOSCODE:61A1 </span><span style="color:gray">ioctl_no_high</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61A1                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:61A3                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:61A6                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:61A9
DOSCODE:61A9 </span><span style="color:gray">jmp_to_ioctl_ok</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61A9                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ioctl_ok
</span><span style="color:black">DOSCODE:61AB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:61AB
DOSCODE:61AB </span>ioctl_control_string<span style="color:navy">:                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61AB                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:black">DOSCODE:61AE                 </span><span style="color:navy">jb      short </span>ioctl_bad_handle
<span style="color:black">DOSCODE:61B0                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:61B5                 </span><span style="color:navy">jz      short </span><span style="color:gray">ioctl_bad_funj2
</span><span style="color:black">DOSCODE:61B7                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:61BC                 </span><span style="color:navy">les     di, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:61C0                 </span><span style="color:navy">xor     bl, bl
</span><span style="color:black">DOSCODE:61C2                 </span><span style="color:navy">jmp     </span><span style="color:gray">ioctl_do_string
</span><span style="color:black">DOSCODE:61C5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:61C5
DOSCODE:61C5 </span>ioctl_status<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61C5                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:61C7                 </span><span style="color:navy">sub     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:61C9                 </span><span style="color:navy">jz      short </span><span style="color:gray">ioctl_get_status
</span><span style="color:black">DOSCODE:61CB                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:61CD
DOSCODE:61CD </span><span style="color:gray">ioctl_get_status</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61CD                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:61CE                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:61D1                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:61D2                 </span><span style="color:navy">jnb     short </span><span style="color:gray">DO_IOFUNC
</span><span style="color:black">DOSCODE:61D4                 </span><span style="color:navy">jmp     short </span>ioctl_bad_handle
<span style="color:black">DOSCODE:61D6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:61D6
DOSCODE:61D6 </span><span style="color:gray">DO_IOFUNC</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61D6                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:61D9                 </span><span style="color:navy">mov     ah, al
</span><span style="color:black">DOSCODE:61DB                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:61DD                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ioctl_status_ret
</span><span style="color:black">DOSCODE:61DF                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:61E1
DOSCODE:61E1 </span><span style="color:gray">ioctl_status_ret</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61E1                 </span><span style="color:navy">jmp     short </span><span style="color:gray">jmp_to_ioctl_ok
</span><span style="color:black">DOSCODE:61E3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:61E3
DOSCODE:61E3 </span>Set_Retry_Parameters<span style="color:navy">:                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61E3                 </span><span style="color:navy">mov     </span>RetryLoop<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:61E7                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:61E9                 </span><span style="color:navy">jz      short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:61EB                 </span><span style="color:navy">mov     </span>RetryCount<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:61EF                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ioctl_status_ret
</span><span style="color:black">DOSCODE:61F1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:61F1
DOSCODE:61F1 </span>GENERICIOCTLHANDLE<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:61F1                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:black">DOSCODE:61F4                 </span><span style="color:navy">jb      short </span><span style="color:gray">ioctl_bad_handlej
</span><span style="color:black">DOSCODE:61F6                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:61FB                 </span><span style="color:navy">jnz     short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:61FD                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:6202                 </span><span style="color:navy">les     di, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6206                 </span><span style="color:navy">jmp     short </span><span style="color:gray">Do_GenIOCTL
</span><span style="color:black">DOSCODE:6208 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6208
DOSCODE:6208 </span>GENERICIOCTL<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6208                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:620D                 </span><span style="color:navy">cmp     ch, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:6210                 </span><span style="color:navy">jnz     short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:6212                 </span><span style="color:navy">call    </span>Check_If_Net
<span style="color:black">DOSCODE:6215                 </span><span style="color:navy">jnz     short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:6217
DOSCODE:6217 </span><span style="color:gray">Do_GenIOCTL</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6217                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:621C                 </span><span style="color:navy">jz      short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:621E                 </span><span style="color:navy">mov     </span>IOCALL_REQFUNC<span style="color:navy">, </span><span style="color:#ff8000">13h
</span><span style="color:black">DOSCODE:6223                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:6225                 </span><span style="color:navy">jl      short </span><span style="color:gray">SetIOCtlBlock
</span><span style="color:black">DOSCODE:6227                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:622C                 </span><span style="color:navy">jz      short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:622E                 </span><span style="color:navy">mov     </span>IOCALL_REQFUNC<span style="color:navy">, </span><span style="color:#ff8000">19h
</span><span style="color:black">DOSCODE:6233
DOSCODE:6233 </span><span style="color:gray">SetIOCtlBlock</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6233                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:6234                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:6235                 </span><span style="color:navy">mov     </span>IOCALL<span style="color:navy">, </span><span style="color:green">23
</span><span style="color:black">DOSCODE:623A                 </span><span style="color:navy">mov     </span>IOCALL_REQUNIT<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:623E                 </span><span style="color:navy">mov     </span>IOMED<span style="color:navy">, ch
</span><span style="color:black">DOSCODE:6242                 </span><span style="color:navy">mov     byte ptr </span>IOXAD<span style="color:navy">, cl
</span><span style="color:black">DOSCODE:6246                 </span><span style="color:navy">mov     word ptr </span>IOXAD<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, si
</span><span style="color:black">DOSCODE:624A                 </span><span style="color:navy">mov     word ptr </span>IOXAD<span style="color:navy">+</span><span style="color:green">3</span><span style="color:navy">, di
</span><span style="color:black">DOSCODE:624E                 </span><span style="color:navy">mov     </span>IOSCNT<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, dx
</span><span style="color:black">DOSCODE:6252                 </span><span style="color:navy">mov     </span>IOSSEC<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, si
</span><span style="color:black">DOSCODE:6256                 </span><span style="color:navy">mov     bx, offset </span>IOCALL
<span style="color:black">DOSCODE:6259                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:625A                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:625B                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:625C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:625D                 </span><span style="color:navy">jmp     </span><span style="color:gray">ioctl_do_IO
</span><span style="color:black">DOSCODE:6260 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6260
DOSCODE:6260 </span>ioctl_bad_fun<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6260                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:6262                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:6262 </span>$IOCTL          endp
<span style="color:black">DOSCODE:6262
DOSCODE:6265 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6265 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:black">DOSCODE:6265
DOSCODE:6265 </span><span style="color:gray">ioctl_bad_handlej</span><span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6265                 </span><span style="color:navy">jmp     </span>ioctl_bad_handle
<span style="color:black">DOSCODE:6268 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6268
DOSCODE:6268 </span>ioctl_rem_media<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6268                 </span><span style="color:navy">call    </span>Check_If_Net
<span style="color:black">DOSCODE:626B                 </span><span style="color:navy">jnz     short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:626D                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:6272                 </span><span style="color:navy">jz      short </span>ioctl_bad_fun
<span style="color:black">DOSCODE:6274                 </span><span style="color:navy">mov     ss:</span>IOCALL_REQFUNC<span style="color:navy">, </span><span style="color:green">15
</span><span style="color:black">DOSCODE:627A                 </span><span style="color:navy">mov     al, </span><span style="color:green">13
</span><span style="color:black">DOSCODE:627C                 </span><span style="color:navy">mov     ah, bl
</span><span style="color:black">DOSCODE:627E                 </span><span style="color:navy">mov     word ptr ss:</span>IOCALL<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:6282                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:6284                 </span><span style="color:navy">mov     ss:</span>IOCALL_REQSTAT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:6288                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:6289                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:628A                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:628C                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:628D                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:628E                 </span><span style="color:navy">mov     bx, offset </span>IOCALL
<span style="color:black">DOSCODE:6291                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6292                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:6293                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:6296                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:6297                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6298                 </span><span style="color:navy">mov     ax, ss:</span>IOCALL_REQSTAT
<span style="color:black">DOSCODE:629C                 </span><span style="color:navy">and     ax, </span><span style="color:green">200h
</span><span style="color:black">DOSCODE:629F                 </span><span style="color:navy">mov     cl, </span><span style="color:green">9
</span><span style="color:black">DOSCODE:62A1                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:black">DOSCODE:62A3
DOSCODE:62A3 </span>ioctlt_rmed_ok<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62A3                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:62A6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:62A6
DOSCODE:62A6 </span>ioctl_drive_attr<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62A6                 </span><span style="color:navy">mov     al, bl
</span><span style="color:black">DOSCODE:62A8                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:black">DOSCODE:62AB                 </span><span style="color:navy">jb      short </span>ioctl_drv_err
<span style="color:black">DOSCODE:62AD                 </span><span style="color:navy">call    </span>Get_Driver_BL
<span style="color:black">DOSCODE:62B0                 </span><span style="color:navy">jb      short </span>ioctl_drv_err
<span style="color:black">DOSCODE:62B2                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:62B6                 </span><span style="color:navy">mov     bl, al
</span><span style="color:black">DOSCODE:62B8                 </span><span style="color:navy">les     di, ss:</span>THISCDS
<span style="color:black">DOSCODE:62BD                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:62C2                 </span><span style="color:navy">jz      short </span>IOCTLShare
<span style="color:black">DOSCODE:62C4                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">1000h
</span><span style="color:black">DOSCODE:62C7
DOSCODE:62C7 </span>IOCTLShare<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62C7                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:62C8                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:62C9                 </span><span style="color:navy">mov     si, offset </span>OPENBUF
<span style="color:black">DOSCODE:62CC                 </span><span style="color:navy">add     bl, &#039;</span><span style="color:green">A&#039;
</span><span style="color:black">DOSCODE:62CF                 </span><span style="color:navy">mov     [si], bl
</span><span style="color:black">DOSCODE:62D1                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">1</span><span style="color:navy">], &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:62D6                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">300h
</span><span style="color:black">DOSCODE:62D9                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:62DA                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - CHECK DIRECT I/O
<span style="color:black">DOSCODE:62DA                                         </span>; DS:SI -&gt; ASCIZ disk device name (may be full path or only drive
<span style="color:black">DOSCODE:62DA                                         </span>; specifier--must include the colon)
<span style="color:black">DOSCODE:62DA                                         </span>; Return: CF clear if absolute disk access allowed
<span style="color:black">DOSCODE:62DC                 </span><span style="color:navy">jnb     short </span>IOCTLLocal
<span style="color:black">DOSCODE:62DE                 </span><span style="color:navy">or      dx, </span><span style="color:green">200h
</span><span style="color:black">DOSCODE:62E2
DOSCODE:62E2 </span>IOCTLLocal<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62E2                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:62E7                 </span><span style="color:navy">jz      short </span>ioctl_set_DX
<span style="color:black">DOSCODE:62E9                 </span><span style="color:navy">or      dx, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:62ED
DOSCODE:62ED </span>ioctl_set_DX<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62ED                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:62F0                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:62F3
DOSCODE:62F3 </span>ioctl_dattr_ok<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62F3                 </span><span style="color:navy">jmp     short </span>ioctlt_rmed_ok
<span style="color:black">DOSCODE:62F3 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:black">DOSCODE:62F5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:62F5 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR Check_If_Net
</span><span style="color:black">DOSCODE:62F5
DOSCODE:62F5 </span>ioctl_drv_err<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62F5                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Fh
</span><span style="color:black">DOSCODE:62F7
DOSCODE:62F7 </span>ioctl_dattr_errj<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62F7                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:62F7 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR Check_If_Net
</span><span style="color:black">DOSCODE:62FA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:62FA </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:black">DOSCODE:62FA
DOSCODE:62FA </span>ioctl_handle_redir<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:62FA                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:black">DOSCODE:62FD                 </span><span style="color:navy">jnb     short </span>ioctl_got_sft
<span style="color:black">DOSCODE:62FF                 </span><span style="color:navy">jmp     </span>ioctl_bad_handle
<span style="color:black">DOSCODE:6302 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6302
DOSCODE:6302 </span>ioctl_got_sft<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6302                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6306                 </span><span style="color:navy">jmp     short </span>ioctl_set_DX
<span style="color:black">DOSCODE:6308 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6308
DOSCODE:6308 </span>ioctl_bad_funj<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6308                 </span><span style="color:navy">jmp     </span>ioctl_bad_fun
<span style="color:black">DOSCODE:630B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:630B
DOSCODE:630B </span>ioctl_get_dev<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:630B                 </span><span style="color:navy">call    </span>Check_If_Net
<span style="color:black">DOSCODE:630E                 </span><span style="color:navy">jnz     short </span>ioctl_bad_funj
<span style="color:black">DOSCODE:6310
DOSCODE:6310 </span><span style="color:gray">ioctl_do_string</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6310                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:6315                 </span><span style="color:navy">jz      short </span>ioctl_bad_funj
<span style="color:black">DOSCODE:6317                 </span><span style="color:navy">mov     </span>IOCALL_REQFUNC<span style="color:navy">, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:631C                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:631E                 </span><span style="color:navy">jz      short </span><span style="color:gray">ioctl_control_call
</span><span style="color:black">DOSCODE:6320                 </span><span style="color:navy">mov     </span>IOCALL_REQFUNC<span style="color:navy">, </span><span style="color:green">12
</span><span style="color:black">DOSCODE:6325
DOSCODE:6325 </span><span style="color:gray">ioctl_control_call</span><span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6325                 </span><span style="color:navy">mov     al, </span><span style="color:green">22
</span><span style="color:black">DOSCODE:6327                 </span><span style="color:navy">mov     ah, bl
</span><span style="color:black">DOSCODE:6329                 </span><span style="color:navy">mov     word ptr </span>IOCALL<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:632C                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:632E                 </span><span style="color:navy">mov     </span>IOCALL_REQSTAT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:6331                 </span><span style="color:navy">mov     </span>IOMED<span style="color:navy">, al
</span><span style="color:black">DOSCODE:6334                 </span><span style="color:navy">mov     </span>IOSCNT<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:6338                 </span><span style="color:navy">mov     word ptr </span>IOXAD<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:633C                 </span><span style="color:navy">mov     word ptr </span>IOXAD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, si
</span><span style="color:black">DOSCODE:6340                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:6341                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6342                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:6344                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6345                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6346                 </span><span style="color:navy">mov     bx, offset </span>IOCALL
<span style="color:black">DOSCODE:6349
DOSCODE:6349 </span><span style="color:gray">ioctl_do_IO</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6349                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:634C                 </span><span style="color:navy">test    byte ptr ss:</span>IOCALL_REQSTAT<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6352                 </span><span style="color:navy">jnz     short </span>ioctl_string_err
<span style="color:black">DOSCODE:6354                 </span><span style="color:navy">mov     ax, ss:</span>IOSCNT
<span style="color:black">DOSCODE:6358                 </span><span style="color:navy">jmp     short </span>ioctl_dattr_ok
<span style="color:black">DOSCODE:635A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:635A
DOSCODE:635A </span>ioctl_string_err<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:635A                 </span><span style="color:navy">mov     di, ss:</span>IOCALL_REQSTAT
<span style="color:black">DOSCODE:635F                 </span><span style="color:navy">and     di, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:6363                 </span><span style="color:navy">mov     ax, di
</span><span style="color:black">DOSCODE:6365                 </span><span style="color:navy">call    </span>SET_I24_EXTENDED_ERROR
<span style="color:black">DOSCODE:6368                 </span><span style="color:navy">mov     ax, ss:</span>EXTERR
<span style="color:black">DOSCODE:636C                 </span><span style="color:navy">jmp     short </span>ioctl_dattr_errj
<span style="color:black">DOSCODE:636C </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:black">DOSCODE:636E
DOSCODE:636E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:636E
DOSCODE:636E
DOSCODE:636E </span>Get_Driver_BL   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:636E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:636F                 </span><span style="color:navy">mov     al, bl
</span><span style="color:black">DOSCODE:6371                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:black">DOSCODE:6374                 </span><span style="color:navy">jb      short </span><span style="color:gray">ioctl_bad_drv
</span><span style="color:black">DOSCODE:6376                 </span><span style="color:navy">xor     bl, bl
</span><span style="color:black">DOSCODE:6378                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:637D                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:6381                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6386                 </span><span style="color:navy">les     di, es:[di+</span><span style="color:#ff8000">45h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:638A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">got_dev_ptr
</span><span style="color:black">DOSCODE:638C                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6391                 </span><span style="color:navy">mov     bl, es:[di+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6395                 </span><span style="color:navy">les     di, es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6399
DOSCODE:6399 </span><span style="color:gray">got_dev_ptr</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6399                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:639A
DOSCODE:639A </span><span style="color:gray">ioctl_bad_drv</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:639A                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:639B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:639B </span>Get_Driver_BL   endp
<span style="color:black">DOSCODE:639B
DOSCODE:639C
DOSCODE:639C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:639C
DOSCODE:639C
DOSCODE:639C </span>Check_If_Net    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:639C
DOSCODE:639C </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:62F5 SIZE 00000005 BYTES
</span><span style="color:black">DOSCODE:639C
DOSCODE:639C                 </span><span style="color:navy">call    </span>Get_Driver_BL
<span style="color:black">DOSCODE:639F                 </span><span style="color:navy">jb      short </span><span style="color:gray">ioctl_drv_err_pop
</span><span style="color:black">DOSCODE:63A1                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:63A2                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:63A3                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:63A7                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:63AC                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:63AD                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:63AE                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:63AF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:63AF
DOSCODE:63AF </span><span style="color:gray">ioctl_drv_err_pop</span><span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:63AF                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:63B0                 </span><span style="color:navy">jmp     </span>ioctl_drv_err
<span style="color:black">DOSCODE:63B0 </span>Check_If_Net    endp
<span style="color:black">DOSCODE:63B0
DOSCODE:63B3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:63B3 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:black">DOSCODE:63B3
DOSCODE:63B3 </span>ioctl_bad_funj3<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:63B3                 </span><span style="color:navy">jmp     </span>ioctl_bad_fun
<span style="color:black">DOSCODE:63B6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:63B6
DOSCODE:63B6 </span>ioctl_string_errj<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:63B6                 </span><span style="color:navy">jmp     short </span>ioctl_string_err
<span style="color:black">DOSCODE:63B8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:63B8
DOSCODE:63B8 </span>ioctl_drive_owner<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:63B8                 </span><span style="color:navy">call    </span>Check_If_Net
<span style="color:black">DOSCODE:63BB                 </span><span style="color:navy">jnz     short </span>ioctl_bad_funj3
<span style="color:black">DOSCODE:63BD                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:63C2                 </span><span style="color:navy">jz      short </span>ioctl_bad_funj3
<span style="color:black">DOSCODE:63C4                 </span><span style="color:navy">mov     </span>IOCALL_REQFUNC<span style="color:navy">, </span><span style="color:green">23
</span><span style="color:black">DOSCODE:63C9                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Eh
</span><span style="color:black">DOSCODE:63CB                 </span><span style="color:navy">jz      short </span>GetOwner
<span style="color:black">DOSCODE:63CD                 </span><span style="color:navy">mov     </span>IOCALL_REQFUNC<span style="color:navy">, </span><span style="color:green">24
</span><span style="color:black">DOSCODE:63D2
DOSCODE:63D2 </span>GetOwner<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:63D2                 </span><span style="color:navy">mov     al, </span><span style="color:green">13
</span><span style="color:black">DOSCODE:63D4                 </span><span style="color:navy">mov     ah, bl
</span><span style="color:black">DOSCODE:63D6                 </span><span style="color:navy">mov     word ptr </span>IOCALL<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:63D9                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:63DB                 </span><span style="color:navy">mov     </span>IOCALL_REQSTAT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:63DE                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:63DF                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:63E0                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:63E2                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:63E3                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:63E4                 </span><span style="color:navy">mov     bx, offset </span>IOCALL
<span style="color:black">DOSCODE:63E7                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:63E8                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:63E9                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:63EC                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:63ED                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:63EE                 </span><span style="color:navy">test    byte ptr ss:</span>IOCALL_REQSTAT<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:63F4                 </span><span style="color:navy">jnz     short </span>ioctl_string_errj
<span style="color:black">DOSCODE:63F6                 </span><span style="color:navy">mov     al, ss:</span>IOCALL_REQUNIT
<span style="color:black">DOSCODE:63FA                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:63FA </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $IOCTL
</span><span style="color:black">DOSCODE:63FD
DOSCODE:63FD </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:63FD
DOSCODE:63FD
DOSCODE:63FD </span>DOS_DELETE      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:63FD                 </span><span style="color:navy">call    </span>TestNet
<span style="color:black">DOSCODE:6400                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOCAL_DELETE
</span><span style="color:black">DOSCODE:6402                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1113h
</span><span style="color:black">DOSCODE:6405                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - DELETE REMOTE FILE
<span style="color:black">DOSCODE:6405                                         </span>; SS = DS = DOS CS, SDA first filename pointer -&gt; fully-qualified filename in DOS CS
<span style="color:black">DOSCODE:6405                                         </span>; SDA CDS pointer -&gt; current directory structure for drive with file
<span style="color:black">DOSCODE:6405                                         </span>; Return: CF set on error
<span style="color:black">DOSCODE:6407                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6408 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6408
DOSCODE:6408 </span><span style="color:gray">LOCAL_DELETE</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6408                 </span><span style="color:navy">mov     </span>FOUNDDEL<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:640D                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6410                 </span><span style="color:navy">mov     word ptr </span>CREATING<span style="color:navy">, </span><span style="color:green">0E500h
</span><span style="color:black">DOSCODE:6416                 </span><span style="color:navy">mov     si, </span>WFP_START
<span style="color:black">DOSCODE:641A
DOSCODE:641A </span><span style="color:gray">SKPNUL</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:641A                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:641B                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:641D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SKPNUL
</span><span style="color:black">DOSCODE:641F                 </span><span style="color:navy">sub     si, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:6422                 </span><span style="color:navy">cmp     word ptr [si], &#039;</span><span style="color:green">.*&#039;
</span><span style="color:black">DOSCODE:6426                 </span><span style="color:navy">jnz     short </span><span style="color:gray">TEST_QUEST
</span><span style="color:black">DOSCODE:6428                 </span><span style="color:navy">cmp     byte ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], &#039;</span><span style="color:green">*&#039;
</span><span style="color:black">DOSCODE:642C                 </span><span style="color:navy">jz      short </span><span style="color:gray">CHECK_ATTS
</span><span style="color:black">DOSCODE:642E
DOSCODE:642E </span><span style="color:gray">TEST_QUEST</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:642E                 </span><span style="color:navy">sub     si, </span><span style="color:#ff8000">9
</span><span style="color:black">DOSCODE:6431                 </span><span style="color:navy">xchg    di, si
</span><span style="color:black">DOSCODE:6433                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6434                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6435                 </span><span style="color:navy">mov     ax, &#039;</span><span style="color:green">??&#039;
</span><span style="color:black">DOSCODE:6438                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:643B                 </span><span style="color:navy">repe scasw
</span><span style="color:black">DOSCODE:643D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOT_ALL
</span><span style="color:black">DOSCODE:643F                 </span><span style="color:navy">xchg    di, si
</span><span style="color:black">DOSCODE:6441                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:6442                 </span><span style="color:navy">cmp     ax, &#039;</span><span style="color:green">?.&#039;
</span><span style="color:black">DOSCODE:6445                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOT_ALL
</span><span style="color:black">DOSCODE:6447                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:6448                 </span><span style="color:navy">cmp     ax, &#039;</span><span style="color:green">??&#039;
</span><span style="color:black">DOSCODE:644B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOT_ALL
</span><span style="color:black">DOSCODE:644D
DOSCODE:644D </span><span style="color:gray">CHECK_ATTS</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:644D                 </span><span style="color:navy">mov     al, </span>SATTRIB
<span style="color:black">DOSCODE:6450                 </span><span style="color:navy">and     al, </span><span style="color:green">1Fh
</span><span style="color:black">DOSCODE:6452                 </span><span style="color:navy">cmp     al, </span><span style="color:green">1Fh
</span><span style="color:black">DOSCODE:6454                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOT_ALL
</span><span style="color:black">DOSCODE:6456                 </span><span style="color:navy">mov     </span>DELALL<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:645B
DOSCODE:645B </span><span style="color:gray">NOT_ALL</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:645B                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:6460                 </span><span style="color:navy">call    </span>GetPathNoSet
<span style="color:black">DOSCODE:6463                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Del_found
</span><span style="color:black">DOSCODE:6465                 </span><span style="color:navy">jnz     short </span><span style="color:gray">_bad_path
</span><span style="color:black">DOSCODE:6467                 </span><span style="color:navy">or      cl, cl
</span><span style="color:black">DOSCODE:6469                 </span><span style="color:navy">jz      short </span><span style="color:gray">_bad_path
</span><span style="color:black">DOSCODE:646B
DOSCODE:646B </span><span style="color:gray">No_file</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:646B                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:646E
DOSCODE:646E </span><span style="color:gray">ErrorReturn</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:646E                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:646F                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6472                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6473 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6473
DOSCODE:6473 </span><span style="color:gray">_bad_path</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6473                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:6476                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ErrorReturn
</span><span style="color:black">DOSCODE:6478 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6478
DOSCODE:6478 </span><span style="color:gray">Del_found</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6478                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOT_DIR
</span><span style="color:black">DOSCODE:647A                 </span><span style="color:navy">cmp     </span>DELALL<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:647F                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOT_DIR
</span><span style="color:black">DOSCODE:6481
DOSCODE:6481 </span><span style="color:gray">Del_access_err</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6481                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6484                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ErrorReturn
</span><span style="color:black">DOSCODE:6486 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6486
DOSCODE:6486 </span><span style="color:gray">NOT_DIR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6486                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:6488                 </span><span style="color:navy">js      short </span><span style="color:gray">Del_access_err
</span><span style="color:black">DOSCODE:648A
DOSCODE:648A </span><span style="color:gray">DELFILE</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:648A                 </span><span style="color:navy">or      </span>FOUNDDEL<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:648F                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6490                 </span><span style="color:navy">mov     ah, </span>DELALL
<span style="color:black">DOSCODE:6494                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:6498                 </span><span style="color:navy">test    ss:</span>ATTRIB<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:649E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoDelete
</span><span style="color:black">DOSCODE:64A0                 </span><span style="color:navy">test    byte ptr [bx+</span><span style="color:green">0Bh</span><span style="color:navy">], </span><span style="color:green">1
</span><span style="color:black">DOSCODE:64A4                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoDelete
</span><span style="color:black">DOSCODE:64A6                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:64A7                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DELNXT
</span><span style="color:black">DOSCODE:64A9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:64A9
DOSCODE:64A9 </span><span style="color:gray">DoDelete</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:64A9                 </span><span style="color:navy">call    </span>REN_DEL_Check
<span style="color:black">DOSCODE:64AC                 </span><span style="color:navy">jnb     short </span><span style="color:gray">DEL_SHARE_OK
</span><span style="color:black">DOSCODE:64AE                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:64AF                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DELNXT
</span><span style="color:black">DOSCODE:64B1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:64B1
DOSCODE:64B1 </span><span style="color:gray">DEL_SHARE_OK</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:64B1                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:64B5                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty
</span><span style="color:black">DOSCODE:64B7                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:64BA                 </span><span style="color:navy">or      byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:64BE
DOSCODE:64BE </span><span style="color:gray">yesdirty</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:64BE                 </span><span style="color:navy">mov     [bx], ah
</span><span style="color:black">DOSCODE:64C0                 </span><span style="color:navy">mov     bx, [si]
</span><span style="color:black">DOSCODE:64C2                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:64C3                 </span><span style="color:navy">or      </span>FOUNDDEL<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:64C8                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:64CB                 </span><span style="color:navy">jb      short </span><span style="color:gray">DELNXT
</span><span style="color:black">DOSCODE:64CD                 </span><span style="color:navy">cmp     bx, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:64D1                 </span><span style="color:navy">ja      short </span><span style="color:gray">DELNXT
</span><span style="color:black">DOSCODE:64D3                 </span><span style="color:navy">call    </span>RELEASE
<span style="color:black">DOSCODE:64D6                 </span><span style="color:navy">jb      short </span><span style="color:gray">No_fileJ
</span><span style="color:black">DOSCODE:64D8                 </span><span style="color:navy">call    </span>FastOpen_Delete
<span style="color:black">DOSCODE:64DB
DOSCODE:64DB </span><span style="color:gray">DELNXT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:64DB                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:64DF                 </span><span style="color:navy">call    </span>GETENTRY
<span style="color:black">DOSCODE:64E2                 </span><span style="color:navy">jb      short </span><span style="color:gray">No_fileJ
</span><span style="color:black">DOSCODE:64E4                 </span><span style="color:navy">call    </span>NEXTENT
<span style="color:black">DOSCODE:64E7                 </span><span style="color:navy">jnb     short </span><span style="color:gray">DELFILE
</span><span style="color:black">DOSCODE:64E9                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:64ED                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:64F1                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:64F4                 </span><span style="color:navy">jb      short </span><span style="color:gray">No_fileJ
</span><span style="color:black">DOSCODE:64F6                 </span><span style="color:navy">test    </span>FOUNDDEL<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:64FB                 </span><span style="color:navy">jz      short </span><span style="color:gray">DelError
</span><span style="color:black">DOSCODE:64FD                 </span><span style="color:navy">test    </span>ATTRIB<span style="color:navy">, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:6502                 </span><span style="color:navy">jz      short </span><span style="color:gray">No_Set_Flag
</span><span style="color:black">DOSCODE:6504                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6505                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:6506                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:6507                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:650B                 </span><span style="color:navy">mov     ah, es:[di]
</span><span style="color:black">DOSCODE:650E                 </span><span style="color:navy">sub     ah, &#039;</span><span style="color:green">A&#039;
</span><span style="color:black">DOSCODE:6511                 </span><span style="color:navy">mov     </span>VOLCHNG_FLAG<span style="color:navy">, ah
</span><span style="color:black">DOSCODE:6515                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:black">DOSCODE:6517                 </span><span style="color:navy">call    </span>Set_Media_ID
<span style="color:black">DOSCODE:651A                 </span><span style="color:navy">call    </span>FATREAD_CDS
<span style="color:black">DOSCODE:651D                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:651E                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:651F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6520
DOSCODE:6520 </span><span style="color:gray">No_Set_Flag</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6520                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6523                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6524 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6524
DOSCODE:6524 </span><span style="color:gray">DelError</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6524                 </span><span style="color:navy">test    </span>FOUNDDEL<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6529                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Del_access_errJ
</span><span style="color:black">DOSCODE:652B
DOSCODE:652B </span><span style="color:gray">No_fileJ</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:652B                 </span><span style="color:navy">jmp     </span><span style="color:gray">No_file
</span><span style="color:black">DOSCODE:652E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:652E
DOSCODE:652E </span><span style="color:gray">Del_access_errJ</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:652E                 </span><span style="color:navy">jmp     </span><span style="color:gray">Del_access_err
</span><span style="color:black">DOSCODE:652E </span>DOS_DELETE      endp
<span style="color:black">DOSCODE:652E
DOSCODE:6531
DOSCODE:6531 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6531
DOSCODE:6531
DOSCODE:6531 </span>REN_DEL_Check   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6531                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6532                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:6533                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6534                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:6535                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:6536                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6537                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6538                 </span><span style="color:navy">mov     di, ss:</span>WFP_START
<span style="color:black">DOSCODE:653D                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:653F                 </span><span style="color:navy">mov     ds, word ptr ss:</span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6544                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:6546                 </span><span style="color:navy">add     bx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6549                 </span><span style="color:navy">call    </span>StrLen
<span style="color:black">DOSCODE:654C                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:654D                 </span><span style="color:navy">add     di, cx
</span><span style="color:black">DOSCODE:654F                 </span><span style="color:navy">call    </span>SkipBack
<span style="color:black">DOSCODE:6552                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:6553                 </span><span style="color:navy">mov     ss:</span>SAVE_BX<span style="color:navy">, di
</span><span style="color:black">DOSCODE:6558                 </span><span style="color:navy">call    </span>PackName
<span style="color:black">DOSCODE:655B                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:655C                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:655D                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:655E                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:655F                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6560                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6561                 </span><span style="color:navy">call    </span>ShCloseFile
<span style="color:black">DOSCODE:6565                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:6569                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, (offset </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">145h</span><span style="color:navy">) </span>; AUXSTACK-SF_ENTRY.size
<span style="color:black">DOSCODE:6569                                         </span>; RENAMEDMA+(384-59)
<span style="color:black">DOSCODE:656F                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:6571                 </span><span style="color:navy">call    </span>DOOPEN
<span style="color:black">DOSCODE:6574                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6578                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:657E                 </span><span style="color:navy">mov     word ptr es:[di], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:6583                 </span><span style="color:navy">call    </span>ShareEnter
<span style="color:black">DOSCODE:6586                 </span><span style="color:navy">jb      short </span><span style="color:gray">CheckDone
</span><span style="color:black">DOSCODE:6588                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:658C                 </span><span style="color:navy">mov     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6591                 </span><span style="color:navy">call    </span>ShareEnd
<span style="color:black">DOSCODE:6594                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:6595
DOSCODE:6595 </span><span style="color:gray">CheckDone</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6595                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:6599                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:659A                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:659B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:659C                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:659D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:659E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:659E </span>REN_DEL_Check   endp
<span style="color:black">DOSCODE:659E
DOSCODE:659F
DOSCODE:659F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:659F
DOSCODE:659F
DOSCODE:659F </span>FastOpen_Delete proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:659F                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:65A0                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:65A1                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:65A2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:65A3                 </span><span style="color:navy">mov     si, ss:</span>WFP_START
<span style="color:black">DOSCODE:65A8                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:65AA
DOSCODE:65AA </span>fastinvoke<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:65AA                 </span><span style="color:navy">mov     bx, offset </span>FastTable_2
<span style="color:black">DOSCODE:65AD                 </span><span style="color:navy">call    dword ptr [bx]
</span><span style="color:black">DOSCODE:65AF                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:65B0                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:65B1                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:65B2                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:65B3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:65B3 </span>FastOpen_Delete endp
<span style="color:black">DOSCODE:65B3
DOSCODE:65B4
DOSCODE:65B4 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:65B4
DOSCODE:65B4
DOSCODE:65B4 </span>FastOpen_Rename proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:65B4                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:65B5                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:65B6                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:65B7                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:65B8                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:65B9                 </span><span style="color:navy">mov     si, ss:</span>REN_WFP
<span style="color:black">DOSCODE:65BE                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:65C1                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:65C3                 </span><span style="color:navy">mov     bx, offset </span>FastTable_2
<span style="color:black">DOSCODE:65C6                 </span><span style="color:navy">call    dword ptr [bx]
</span><span style="color:black">DOSCODE:65C8                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:65C9                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:65CA                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:65CB                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:65CC                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:65CD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:65CD </span>FastOpen_Rename endp
<span style="color:black">DOSCODE:65CD
DOSCODE:65CE
DOSCODE:65CE </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:65CE
DOSCODE:65CE
DOSCODE:65CE </span>FastOpen_Update proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:65CE                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:65CF                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:65D0                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:65D1                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:65D2                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:65D4                 </span><span style="color:navy">jmp     short </span>fastinvoke
<span style="color:black">DOSCODE:65D4 </span>FastOpen_Update endp
<span style="color:black">DOSCODE:65D4
DOSCODE:65D6
DOSCODE:65D6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:65D6
DOSCODE:65D6
DOSCODE:65D6 </span>Fast_Dispatch   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:65D6                 </span><span style="color:navy">mov     si, offset </span>FastTable_2
<span style="color:black">DOSCODE:65D9                 </span><span style="color:navy">call    dword ptr ss:[si]
</span><span style="color:black">DOSCODE:65DC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:65DC </span>Fast_Dispatch   endp
<span style="color:black">DOSCODE:65DC
DOSCODE:65DD
DOSCODE:65DD </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:65DD
DOSCODE:65DD
DOSCODE:65DD </span>DOS_RENAME      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:65DD                 </span><span style="color:navy">call    </span>TestNet
<span style="color:black">DOSCODE:65E0                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOCAL_RENAME
</span><span style="color:black">DOSCODE:65E2                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1111h
</span><span style="color:black">DOSCODE:65E5                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - RENAME REMOTE FILE
<span style="color:black">DOSCODE:65E5                                         </span>; SS = DS = DOS CS, SDA first filename pointer = offset of fully-qualified old name
<span style="color:black">DOSCODE:65E5                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:black">DOSCODE:65E5                                         </span>; Return: CF set on error
<span style="color:black">DOSCODE:65E7                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:65E8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:65E8
DOSCODE:65E8 </span><span style="color:gray">LOCAL_RENAME</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:65E8                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:65ED                 </span><span style="color:navy">mov     si, </span>WFP_START
<span style="color:black">DOSCODE:65F1                 </span><span style="color:navy">mov     di, </span>REN_WFP
<span style="color:black">DOSCODE:65F5                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:black">DOSCODE:65F7                 </span><span style="color:navy">mov     ah, [di]
</span><span style="color:black">DOSCODE:65F9                 </span><span style="color:navy">or      ax, </span><span style="color:green">2020h
</span><span style="color:black">DOSCODE:65FC                 </span><span style="color:navy">cmp     al, ah
</span><span style="color:black">DOSCODE:65FE                 </span><span style="color:navy">jz      short </span><span style="color:gray">SAMEDRV
</span><span style="color:black">DOSCODE:6600                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">11h
</span><span style="color:black">DOSCODE:6603                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6604                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6605 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6605
DOSCODE:6605 </span><span style="color:gray">SAMEDRV</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6605                 </span><span style="color:navy">push    word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6609                 </span><span style="color:navy">push    word ptr </span>DMAADD
<span style="color:black">DOSCODE:660D                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:6611                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">, offset </span>RENAMEDMA
<span style="color:black">DOSCODE:6617                 </span><span style="color:navy">mov     </span>FOUND_DEV<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:661C                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:661F                 </span><span style="color:navy">call    </span>DOS_SEARCH_FIRST
<span style="color:black">DOSCODE:6622                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Check_Dev
</span><span style="color:black">DOSCODE:6624                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">12h
</span><span style="color:black">DOSCODE:6627                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GOTERR
</span><span style="color:black">DOSCODE:6629                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:662C
DOSCODE:662C </span><span style="color:gray">GOTERR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:662C                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:662D
DOSCODE:662D </span><span style="color:gray">RENAME_POP</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:662D                 </span><span style="color:navy">pop     word ptr </span>DMAADD
<span style="color:black">DOSCODE:6631                 </span><span style="color:navy">pop     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6635                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6638                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6639 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6639
DOSCODE:6639 </span><span style="color:gray">Check_Dev</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6639                 </span><span style="color:navy">mov     ax, </span><span style="color:green">5
</span><span style="color:black">DOSCODE:663C                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:663D                 </span><span style="color:navy">lds     si, </span>DMAADD
<span style="color:black">DOSCODE:6641                 </span><span style="color:navy">add     si, </span><span style="color:green">21
</span><span style="color:black">DOSCODE:6644                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:green">11</span><span style="color:navy">], </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:6648                 </span><span style="color:navy">jz      short </span><span style="color:gray">notdir
</span><span style="color:black">DOSCODE:664A                 </span><span style="color:navy">mov     si, </span>REN_WFP
<span style="color:black">DOSCODE:664E                 </span><span style="color:navy">call    </span>check_PathLen2
<span style="color:black">DOSCODE:6651
DOSCODE:6651 </span><span style="color:gray">notdir</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6651                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6652                 </span><span style="color:navy">ja      short </span><span style="color:gray">GOTERR
</span><span style="color:black">DOSCODE:6654                 </span><span style="color:navy">cmp     </span>FOUND_DEV<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6659                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GOTERR
</span><span style="color:black">DOSCODE:665B                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:665D                 </span><span style="color:navy">add     si, </span><span style="color:green">26
</span><span style="color:black">DOSCODE:6660                 </span><span style="color:navy">call    </span>REN_DEL_Check
<span style="color:black">DOSCODE:6663                 </span><span style="color:navy">jnb     short </span><span style="color:gray">REN_OK1
</span><span style="color:black">DOSCODE:6665                 </span><span style="color:navy">mov     ax, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:6668                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RENAME_POP
</span><span style="color:black">DOSCODE:666A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:666A
DOSCODE:666A </span><span style="color:gray">REN_OK1</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:666A                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:666B                 </span><span style="color:navy">lds     si, </span>DMAADD
<span style="color:black">DOSCODE:666F                 </span><span style="color:navy">add     si, </span><span style="color:green">21
</span><span style="color:black">DOSCODE:6672                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:green">11</span><span style="color:navy">], </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:6676                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOT_DIR1
</span><span style="color:black">DOSCODE:6678                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:6679                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SWAP_SOURCE
</span><span style="color:black">DOSCODE:667B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:667B
DOSCODE:667B </span><span style="color:gray">NOT_DIR1</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:667B                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:667C                 </span><span style="color:navy">call    </span>FastOpen_Delete
<span style="color:black">DOSCODE:667F
DOSCODE:667F </span><span style="color:gray">SWAP_SOURCE</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:667F                 </span><span style="color:navy">mov     ax, </span>WFP_START
<span style="color:black">DOSCODE:6682                 </span><span style="color:navy">mov     si, </span>REN_WFP
<span style="color:black">DOSCODE:6686                 </span><span style="color:navy">mov     </span>WFP_START<span style="color:navy">, si
</span><span style="color:black">DOSCODE:668A                 </span><span style="color:navy">mov     </span>REN_WFP<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:668D                 </span><span style="color:navy">mov     </span>CURR_DIR_END<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6693                 </span><span style="color:navy">mov     word ptr </span>CREATING<span style="color:navy">, </span><span style="color:green">0E5FFh
</span><span style="color:black">DOSCODE:6699                 </span><span style="color:navy">call    </span>GetPathNoSet
<span style="color:black">DOSCODE:669C                 </span><span style="color:navy">jb      short </span><span style="color:gray">NODEST
</span><span style="color:black">DOSCODE:669E                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:66A0                 </span><span style="color:navy">jns     short </span><span style="color:gray">SAVEDEST
</span><span style="color:black">DOSCODE:66A2
DOSCODE:66A2 </span><span style="color:gray">BAD_ACC</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:66A2                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:66A5                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:66A6
DOSCODE:66A6 </span><span style="color:gray">RENAME_CLEAN</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:66A6                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:66A7                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:66A8                 </span><span style="color:navy">mov     al, </span>THISDRV
<span style="color:black">DOSCODE:66AB                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:66AE                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:66AF                 </span><span style="color:navy">cmp     </span>FAILERR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:66B4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BAD_ERR
</span><span style="color:black">DOSCODE:66B6                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:66B7                 </span><span style="color:navy">jmp     </span><span style="color:gray">RENAME_POP
</span><span style="color:black">DOSCODE:66BA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:66BA
DOSCODE:66BA </span><span style="color:gray">BAD_ERR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:66BA                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:66BB                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:66BE                 </span><span style="color:navy">jmp     </span><span style="color:gray">GOTERR
</span><span style="color:black">DOSCODE:66C1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:66C1
DOSCODE:66C1 </span><span style="color:gray">NODEST</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:66C1                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BAD_PATH
</span><span style="color:black">DOSCODE:66C3                 </span><span style="color:navy">cmp     </span>FAILERR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:66C8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BAD_PATH
</span><span style="color:black">DOSCODE:66CA                 </span><span style="color:navy">or      cl, cl
</span><span style="color:black">DOSCODE:66CC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SAVEDEST
</span><span style="color:black">DOSCODE:66CE
DOSCODE:66CE </span><span style="color:gray">BAD_PATH</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:66CE                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:66D1                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:66D2                 </span><span style="color:navy">jmp     </span><span style="color:gray">RENAME_POP
</span><span style="color:black">DOSCODE:66D5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:66D5
DOSCODE:66D5 </span><span style="color:gray">SAVEDEST</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:66D5                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:66D6                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:66D7                 </span><span style="color:navy">mov     di, offset </span>NAME2
<span style="color:black">DOSCODE:66DA                 </span><span style="color:navy">mov     si, offset </span>NAME1
<span style="color:black">DOSCODE:66DD                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:66E0                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:66E2                 </span><span style="color:navy">mov     ax, </span>DIRSTART
<span style="color:black">DOSCODE:66E5                 </span><span style="color:navy">mov     </span>DESTSTART<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:66E8
DOSCODE:66E8 </span><span style="color:gray">BUILDDEST</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:66E8                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:66E9                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:66EA                 </span><span style="color:navy">mov     bx, (offset </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">15h</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:66ED                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:66F0                 </span><span style="color:navy">mov     si, offset </span>NAME2
<span style="color:black">DOSCODE:66F3                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:66F6                 </span><span style="color:navy">call    </span>NEW_RENAME
<span style="color:black">DOSCODE:66F9                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:66FE                 </span><span style="color:navy">mov     </span>CREATING<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:6703                 </span><span style="color:navy">call    </span>DEVNAME
<span style="color:black">DOSCODE:6706                 </span><span style="color:navy">jnb     short </span><span style="color:gray">BAD_ACC
</span><span style="color:black">DOSCODE:6708                 </span><span style="color:navy">mov     bx, </span>DESTSTART
<span style="color:black">DOSCODE:670C                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:6710                 </span><span style="color:navy">call    </span>SETDIRSRCH
<span style="color:black">DOSCODE:6713                 </span><span style="color:navy">jb      short </span><span style="color:gray">BAD_ACC
</span><span style="color:black">DOSCODE:6715                 </span><span style="color:navy">call    </span>SEARCH
<span style="color:black">DOSCODE:6718                 </span><span style="color:navy">jnb     short </span><span style="color:gray">BAD_ACC
</span><span style="color:black">DOSCODE:671A                 </span><span style="color:navy">cmp     </span>FAILERR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:671F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BAD_ACCJ
</span><span style="color:black">DOSCODE:6721                 </span><span style="color:navy">mov     ax, </span>DESTSTART
<span style="color:black">DOSCODE:6724                 </span><span style="color:navy">cmp     ax, word ptr </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:6728                 </span><span style="color:navy">jz      short </span><span style="color:gray">SIMPLE_RENAME
</span><span style="color:black">DOSCODE:672A                 </span><span style="color:navy">mov     al, </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">20h
</span><span style="color:black">DOSCODE:672D                 </span><span style="color:navy">test    al, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:672F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BAD_ACCJ
</span><span style="color:black">DOSCODE:6731                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:6734                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:6738                 </span><span style="color:navy">mov     si, (offset </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">145h</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:673B                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, si
</span><span style="color:black">DOSCODE:673F                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6744                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:6746                 </span><span style="color:navy">call    </span>RENAME_MAKE
<span style="color:black">DOSCODE:6749                 </span><span style="color:navy">jnb     short </span><span style="color:gray">GOT_DEST
</span><span style="color:black">DOSCODE:674B
DOSCODE:674B </span><span style="color:gray">BAD_ACCJ</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:674B                 </span><span style="color:navy">jmp     </span><span style="color:gray">BAD_ACC
</span><span style="color:black">DOSCODE:674E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:674E
DOSCODE:674E </span><span style="color:gray">GOT_DEST</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:674E                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:674F                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6753                 </span><span style="color:navy">call    </span>ShareEnd
<span style="color:black">DOSCODE:6756                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6757                 </span><span style="color:navy">les     di, </span>CURBUF
<span style="color:black">DOSCODE:675B                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:6760                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty
</span><span style="color:black">DOSCODE:6762                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:6765                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:676A
DOSCODE:676A </span><span style="color:gray">yesdirty</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:676A                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:676C                 </span><span style="color:navy">add     di, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:676F                 </span><span style="color:navy">mov     si, (offset </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">20h</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:6772                 </span><span style="color:navy">mov     cx, </span><span style="color:green">21
</span><span style="color:black">DOSCODE:6775                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:6777                 </span><span style="color:navy">call    </span>GET_SOURCE
<span style="color:black">DOSCODE:677A                 </span><span style="color:navy">jb      short </span><span style="color:gray">RENAME_OVER
</span><span style="color:black">DOSCODE:677C                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:677E                 </span><span style="color:navy">mov     es, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6782                 </span><span style="color:navy">mov     al, </span><span style="color:green">0E5h
</span><span style="color:black">DOSCODE:6784                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:6785                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DIRTY_IT
</span><span style="color:black">DOSCODE:6787 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6787
DOSCODE:6787 </span><span style="color:gray">SIMPLE_RENAME</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6787                 </span><span style="color:navy">call    </span>GET_SOURCE
<span style="color:black">DOSCODE:678A                 </span><span style="color:navy">jb      short </span><span style="color:gray">RENAME_OVER
</span><span style="color:black">DOSCODE:678C                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:678E                 </span><span style="color:navy">mov     es, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6792                 </span><span style="color:navy">mov     si, offset </span>NAME1
<span style="color:black">DOSCODE:6795                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:6798                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:679A
DOSCODE:679A </span><span style="color:gray">DIRTY_IT</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:679A                 </span><span style="color:navy">mov     di, word ptr </span>CURBUF
<span style="color:black">DOSCODE:679E                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:67A3                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Yesdirty2
</span><span style="color:black">DOSCODE:67A5                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:67A8                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:67AD
DOSCODE:67AD </span><span style="color:gray">Yesdirty2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:67AD                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:67AE                 </span><span style="color:navy">lds     si, </span>DMAADD
<span style="color:black">DOSCODE:67B2                 </span><span style="color:navy">add     si, </span><span style="color:green">21
</span><span style="color:black">DOSCODE:67B5                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:green">11</span><span style="color:navy">], </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:67B9                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOT_DIR2
</span><span style="color:black">DOSCODE:67BB                 </span><span style="color:navy">call    </span>FastOpen_Rename
<span style="color:black">DOSCODE:67BE                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:67BF                 </span><span style="color:navy">jmp     short </span><span style="color:gray">NOT_DIRTY1
</span><span style="color:black">DOSCODE:67C1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:67C1
DOSCODE:67C1 </span><span style="color:gray">NOT_DIR2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:67C1                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:67C2
DOSCODE:67C2 </span><span style="color:gray">NOT_DIRTY1</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:67C2                 </span><span style="color:navy">mov     si, (offset </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:67C5                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:67C8                 </span><span style="color:navy">mov     </span>CREATING<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:67CD                 </span><span style="color:navy">call    </span>RENAME_NEXT
<span style="color:black">DOSCODE:67D0                 </span><span style="color:navy">jb      short </span><span style="color:gray">RENAME_OVER
</span><span style="color:black">DOSCODE:67D2                 </span><span style="color:navy">lea     si, [bx+</span><span style="color:green">26</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:67D5                 </span><span style="color:navy">call    </span>REN_DEL_Check
<span style="color:black">DOSCODE:67D8                 </span><span style="color:navy">jnb     short </span><span style="color:gray">REN_OK2
</span><span style="color:black">DOSCODE:67DA                 </span><span style="color:navy">mov     ax, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:67DD                 </span><span style="color:navy">jmp     </span><span style="color:gray">RENAME_CLEAN
</span><span style="color:black">DOSCODE:67E0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:67E0
DOSCODE:67E0 </span><span style="color:gray">REN_OK2</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:67E0                 </span><span style="color:navy">mov     al, </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">20h
</span><span style="color:black">DOSCODE:67E3                 </span><span style="color:navy">test    al, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:67E5                 </span><span style="color:navy">jz      short </span><span style="color:gray">Ren_Directory
</span><span style="color:black">DOSCODE:67E7                 </span><span style="color:navy">call    </span>FastOpen_Delete
<span style="color:black">DOSCODE:67EA                 </span><span style="color:navy">jmp     </span><span style="color:gray">BUILDDEST
</span><span style="color:black">DOSCODE:67ED </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:67ED
DOSCODE:67ED </span><span style="color:gray">Ren_Directory</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:67ED                 </span><span style="color:navy">call    </span>FastOpen_Rename
<span style="color:black">DOSCODE:67F0                 </span><span style="color:navy">jmp     </span><span style="color:gray">BUILDDEST
</span><span style="color:black">DOSCODE:67F3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:67F3
DOSCODE:67F3 </span><span style="color:gray">RENAME_OVER</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:67F3                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:67F4                 </span><span style="color:navy">jmp     </span><span style="color:gray">RENAME_CLEAN
</span><span style="color:black">DOSCODE:67F4 </span>DOS_RENAME      endp
<span style="color:black">DOSCODE:67F4
DOSCODE:67F7
DOSCODE:67F7 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:67F7
DOSCODE:67F7
DOSCODE:67F7 </span>GET_SOURCE      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:67F7                 </span><span style="color:navy">mov     bx, word ptr </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:67FB                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:67FF                 </span><span style="color:navy">call    </span>SETDIRSRCH
<span style="color:black">DOSCODE:6802                 </span><span style="color:navy">jb      short </span><span style="color:gray">gs_ret_label
</span><span style="color:black">DOSCODE:6804                 </span><span style="color:navy">call    </span>STARTSRCH
<span style="color:black">DOSCODE:6807                 </span><span style="color:navy">mov     ax, word ptr </span>RENAMEDMA<span style="color:navy">+</span><span style="color:green">0Dh
</span><span style="color:black">DOSCODE:680A                 </span><span style="color:navy">call    </span>GETENT
<span style="color:black">DOSCODE:680D
DOSCODE:680D </span><span style="color:gray">gs_ret_label</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:680D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:680D </span>GET_SOURCE      endp
<span style="color:black">DOSCODE:680D
DOSCODE:680E
DOSCODE:680E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:680E
DOSCODE:680E
DOSCODE:680E </span>NEW_RENAME      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:680E                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:680F                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:6811                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOCHG
</span><span style="color:black">DOSCODE:6813                 </span><span style="color:navy">mov     al, [bx]
</span><span style="color:black">DOSCODE:6815
DOSCODE:6815 </span><span style="color:gray">NOCHG</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6815                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:6816                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:6817                 </span><span style="color:navy">loop    </span>NEW_RENAME
<span style="color:black">DOSCODE:6819                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6819 </span>NEW_RENAME      endp
<span style="color:black">DOSCODE:6819
DOSCODE:681A
DOSCODE:681A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:681A
DOSCODE:681A
DOSCODE:681A </span>GET_FILE_INFO   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:681A                 </span><span style="color:navy">call    </span>TestNet
<span style="color:black">DOSCODE:681D                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOCAL_INFO
</span><span style="color:black">DOSCODE:681F                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">110Fh
</span><span style="color:black">DOSCODE:6822                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - GET REMOTE FILE&#039;S ATTRIBUTES
<span style="color:black">DOSCODE:6822                                         </span>; SS = DOS CS, SDA first filename pointer -&gt; fully-qualified name of file
<span style="color:black">DOSCODE:6822                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:black">DOSCODE:6822                                         </span>; Return: CF set on error, AX = file attributes
<span style="color:black">DOSCODE:6824                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6825 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6825
DOSCODE:6825 </span><span style="color:gray">LOCAL_INFO</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6825                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6828                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:682D                 </span><span style="color:navy">call    </span>Get_FAST_PATH
<span style="color:black">DOSCODE:6830                 </span><span style="color:navy">jnb     short </span><span style="color:gray">info_check_dev
</span><span style="color:black">DOSCODE:6832
DOSCODE:6832 </span>NO_PATH<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6832                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bad_path1
</span><span style="color:black">DOSCODE:6834                 </span><span style="color:navy">or      cl, cl
</span><span style="color:black">DOSCODE:6836                 </span><span style="color:navy">jz      short </span><span style="color:gray">bad_path1
</span><span style="color:black">DOSCODE:6838
DOSCODE:6838 </span><span style="color:gray">info_no_file</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6838                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:683B
DOSCODE:683B </span><span style="color:gray">BadRet</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:683B                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:683C
DOSCODE:683C </span><span style="color:gray">JustRet</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:683C                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:683F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6840 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6840
DOSCODE:6840 </span><span style="color:gray">bad_path1</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6840                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:6843                 </span><span style="color:navy">jmp     short </span><span style="color:gray">BadRet
</span><span style="color:black">DOSCODE:6845 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6845
DOSCODE:6845 </span><span style="color:gray">info_check_dev</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6845                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:6847                 </span><span style="color:navy">js      short </span><span style="color:gray">info_no_file
</span><span style="color:black">DOSCODE:6849                 </span><span style="color:navy">cmp     word ptr </span>CURBUF<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:684E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">not_root
</span><span style="color:black">DOSCODE:6850                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:6852                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:6854                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:6855                 </span><span style="color:navy">jmp     short </span><span style="color:gray">JustRet
</span><span style="color:black">DOSCODE:6857 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6857
DOSCODE:6857 </span><span style="color:gray">not_root</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6857                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6858                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:685C                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:685E                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:6860                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:6862                 </span><span style="color:navy">mov     cx, [si+</span><span style="color:#ff8000">16h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6865                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">18h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6868                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:686A                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:686D                 </span><span style="color:navy">test    al, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:686F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO_SIZE
</span><span style="color:black">DOSCODE:6871                 </span><span style="color:navy">mov     di, [si+</span><span style="color:#ff8000">1Ch</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6874                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">1Eh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6877
DOSCODE:6877 </span><span style="color:gray">NO_SIZE</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6877                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6878                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:6879                 </span><span style="color:navy">jmp     short </span><span style="color:gray">JustRet
</span><span style="color:black">DOSCODE:6879 </span>GET_FILE_INFO   endp
<span style="color:black">DOSCODE:6879
DOSCODE:687B
DOSCODE:687B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:687B
DOSCODE:687B
DOSCODE:687B </span>SET_FILE_ATTRIBUTE proc near            <span style="color:green">; ...
</span><span style="color:black">DOSCODE:687B                 </span><span style="color:navy">test    ax, </span><span style="color:green">0FFD8h
</span><span style="color:black">DOSCODE:687E                 </span><span style="color:navy">jz      short </span><span style="color:gray">set_look
</span><span style="color:black">DOSCODE:6880
DOSCODE:6880 </span><span style="color:gray">_BAD_ACC</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6880                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:6885                 </span><span style="color:navy">mov     byte ptr </span>EXTERR_ACT_CLASS<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:688A                 </span><span style="color:navy">mov     byte ptr </span>EXTERR_ACT_CLASS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:688F                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6892                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6893                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6894 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6894
DOSCODE:6894 </span><span style="color:gray">set_look</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6894                 </span><span style="color:navy">call    </span>TestNet
<span style="color:black">DOSCODE:6897                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOCAL_SET
</span><span style="color:black">DOSCODE:6899                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:689A                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">110Eh
</span><span style="color:black">DOSCODE:689D                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - SET REMOTE FILE&#039;S ATTRIBUTES
<span style="color:black">DOSCODE:689D                                         </span>; SS = DOS CS, SDA first filename pointer -&gt; fully-qualified name of file
<span style="color:black">DOSCODE:689D                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:black">DOSCODE:689D                                         </span>; STACK: WORD new file attributes
<span style="color:black">DOSCODE:689D                                         </span>; Return: CF set on error
<span style="color:black">DOSCODE:689F                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:68A0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:68A1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:68A1
DOSCODE:68A1 </span><span style="color:gray">LOCAL_SET</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:68A1                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:68A4                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:68A5                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:68AA                 </span><span style="color:navy">call    </span>GETPATH
<span style="color:black">DOSCODE:68AD                 </span><span style="color:navy">jnb     short </span><span style="color:gray">set_check_device
</span><span style="color:black">DOSCODE:68AF                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:68B0                 </span><span style="color:navy">jmp     short </span>NO_PATH
<span style="color:black">DOSCODE:68B2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:68B2
DOSCODE:68B2 </span><span style="color:gray">set_check_device</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:68B2                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:68B4                 </span><span style="color:navy">jns     short </span><span style="color:gray">set_check_share
</span><span style="color:black">DOSCODE:68B6                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:68B7                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:68BA                 </span><span style="color:navy">jmp     short </span><span style="color:gray">_BAD_ACC
</span><span style="color:black">DOSCODE:68BC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:68BC
DOSCODE:68BC </span><span style="color:gray">set_check_share</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:68BC                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:68BD                 </span><span style="color:navy">cmp     word ptr </span>CURBUF<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:68C2                 </span><span style="color:navy">jz      short </span><span style="color:gray">cannot_set_root
</span><span style="color:black">DOSCODE:68C4                 </span><span style="color:navy">call    </span>REN_DEL_Check
<span style="color:black">DOSCODE:68C7                 </span><span style="color:navy">jnb     short </span><span style="color:gray">set_do
</span><span style="color:black">DOSCODE:68C9                 </span><span style="color:navy">mov     ax, </span><span style="color:green">32
</span><span style="color:black">DOSCODE:68CC                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OK_BYE
</span><span style="color:black">DOSCODE:68CE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:68CE
DOSCODE:68CE </span><span style="color:gray">cannot_set_root</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:68CE                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:68D1                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:68D2                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OK_BYE
</span><span style="color:black">DOSCODE:68D4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:68D4
DOSCODE:68D4 </span><span style="color:gray">set_do</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:68D4                 </span><span style="color:navy">les     di, </span>CURBUF
<span style="color:black">DOSCODE:68D8                 </span><span style="color:navy">and     byte ptr es:[bx+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], </span><span style="color:green">0D8h
</span><span style="color:black">DOSCODE:68DD                 </span><span style="color:navy">or      es:[bx+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:68E1                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:68E6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty3
</span><span style="color:black">DOSCODE:68E8                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:68EB                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:68F0
DOSCODE:68F0 </span><span style="color:gray">yesdirty3</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:68F0                 </span><span style="color:navy">mov     al, </span>THISDRV
<span style="color:black">DOSCODE:68F3                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:68F4                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:68F5                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:68F7                 </span><span style="color:navy">mov     dl, al
</span><span style="color:black">DOSCODE:68F9                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:68FB                 </span><span style="color:navy">call    </span>FastOpen_Update
<span style="color:black">DOSCODE:68FE                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:68FF                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:6900                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:6903                 </span><span style="color:navy">jnb     short </span><span style="color:gray">OK_BYE
</span><span style="color:black">DOSCODE:6905                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6908
DOSCODE:6908 </span><span style="color:gray">OK_BYE</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6908                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:690B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:690B </span>SET_FILE_ATTRIBUTE endp
<span style="color:black">DOSCODE:690B
DOSCODE:690C
DOSCODE:690C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:690C
DOSCODE:690C
DOSCODE:690C </span>Get_FAST_PATH   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:690C                 </span><span style="color:navy">or      ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6912                 </span><span style="color:navy">call    </span>GETPATH
<span style="color:black">DOSCODE:6915                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:6916                 </span><span style="color:navy">and     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:691C                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:691D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:691D </span>Get_FAST_PATH   endp
<span style="color:black">DOSCODE:691D
DOSCODE:691E
DOSCODE:691E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:691E
DOSCODE:691E
DOSCODE:691E </span>DOS_DUP         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:691E                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:6923                 </span><span style="color:navy">les     di, es:</span>THISSFT
<span style="color:black">DOSCODE:6928
DOSCODE:6928 </span>DOS_Dup_Direct<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6928                 </span><span style="color:navy">call    </span>IsSFTNet
<span style="color:black">DOSCODE:692B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DO_INC
</span><span style="color:black">DOSCODE:692D                 </span><span style="color:navy">call    </span>DEV_OPEN_SFT
<span style="color:black">DOSCODE:6930
DOSCODE:6930 </span><span style="color:gray">DO_INC</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6930                 </span><span style="color:navy">inc     word ptr es:[di]
</span><span style="color:black">DOSCODE:6933                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6933 </span>DOS_DUP         endp
<span style="color:black">DOSCODE:6933
</span><span style="color:maroon">DOSCODE:6934 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6934
DOSCODE:6934 </span>DOS_CREATE<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:6934                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:6936
DOSCODE:6936 </span>Create_inter<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6936                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:maroon">DOSCODE:6938                 </span><span style="color:navy">jnz     short </span>AttErr
<span style="color:maroon">DOSCODE:693A                 </span><span style="color:navy">test    al, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:693C                 </span><span style="color:navy">jz      short </span>NoReset
<span style="color:maroon">DOSCODE:693E                 </span><span style="color:navy">or      </span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:maroon">DOSCODE:6944                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">8
</span><span style="color:maroon">DOSCODE:6946
DOSCODE:6946 </span>NoReset<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6946                 </span><span style="color:navy">or      al, </span><span style="color:green">20h
</span><span style="color:maroon">DOSCODE:6948                 </span><span style="color:navy">test    al, </span><span style="color:green">50h
</span><span style="color:maroon">DOSCODE:694A                 </span><span style="color:navy">jz      short </span>ATT_OK
<span style="color:maroon">DOSCODE:694C
DOSCODE:694C </span>AttErr<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:694C                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:694F                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:6954                 </span><span style="color:navy">jmp     short </span>SET_MKND_ERR
<span style="color:maroon">DOSCODE:6956 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6956
DOSCODE:6956 </span>ATT_OK<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6956                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:maroon">DOSCODE:695A                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:695B                 </span><span style="color:navy">les     si, </span>THISCDS
<span style="color:maroon">DOSCODE:695F                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:6962                 </span><span style="color:navy">jnz     short </span>TEST_RE_NET
<span style="color:maroon">DOSCODE:6964                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:6965                 </span><span style="color:navy">test    </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:696A                 </span><span style="color:navy">jz      short </span>NOEXTOP
<span style="color:maroon">DOSCODE:696C
DOSCODE:696C </span>IFS_extopen<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:696C                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:696D                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">112Eh
</span><span style="color:maroon">DOSCODE:6970                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - DOS 4 IFSFUNC.EXE - ???
<span style="color:maroon">DOSCODE:6970                                         </span>; SS = DS = DOS CS, STACK: WORD ???   low byte = ???
<span style="color:maroon">DOSCODE:6970                                         </span>; Return: CF set on error
<span style="color:maroon">DOSCODE:6970                                         </span>; CF clear if successful
<span style="color:maroon">DOSCODE:6972                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:6973                 </span><span style="color:navy">mov     </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:6978                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:6979 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6979
DOSCODE:6979 </span>NOEXTOP<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6979                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:697A                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1118h
</span><span style="color:maroon">DOSCODE:697D                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - CREATE/TRUNCATE FILE
<span style="color:maroon">DOSCODE:697D                                         </span>; ES:DI -&gt; uninitialized SFT, SS = DOS CS
<span style="color:maroon">DOSCODE:697D                                         </span>; SDA first filename pointer -&gt; fully-qualified name of file
<span style="color:maroon">DOSCODE:697D                                         </span>; STACK: WORD file creation mode???
<span style="color:maroon">DOSCODE:697F                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:6980                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:6981 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6981
DOSCODE:6981 </span>TEST_RE_NET<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6981                 </span><span style="color:navy">test    word ptr es:[si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:maroon">DOSCODE:6987                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:6988                 </span><span style="color:navy">jz      short </span>LOCAL_CREATE
<span style="color:maroon">DOSCODE:698A                 </span><span style="color:navy">call    </span>Set_EXT_mode
<span style="color:maroon">DOSCODE:698D                 </span><span style="color:navy">jb      short </span>dochk
<span style="color:maroon">DOSCODE:698F                 </span><span style="color:navy">or      word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:6994
DOSCODE:6994 </span>dochk<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6994                 </span><span style="color:navy">test    </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:6999                 </span><span style="color:navy">jnz     short </span>IFS_extopen
<span style="color:maroon">DOSCODE:699B                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:699C                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1117h
</span><span style="color:maroon">DOSCODE:699F                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - CREATE/TRUNCATE REMOTE FILE
<span style="color:maroon">DOSCODE:699F                                         </span>; ES:DI -&gt; uninitialized SFT, SS = DOS CS
<span style="color:maroon">DOSCODE:699F                                         </span>; SDA first filename pointer -&gt; fully-qualified name of file to open
<span style="color:maroon">DOSCODE:699F                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:maroon">DOSCODE:699F                                         </span>; Return: CF set on error
<span style="color:maroon">DOSCODE:69A1                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:69A2                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:69A3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:69A3
DOSCODE:69A3 </span>LOCAL_CREATE<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:69A3                 </span><span style="color:navy">call    </span>Set_EXT_mode
<span style="color:maroon">DOSCODE:69A6                 </span><span style="color:navy">jb      short </span>setdone
<span style="color:maroon">DOSCODE:69A8                 </span><span style="color:navy">or      word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:69AD
DOSCODE:69AD </span>setdone<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:69AD                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:69B0                 </span><span style="color:navy">call    </span>MakeNode
<span style="color:maroon">DOSCODE:69B3                 </span><span style="color:navy">jnb     short </span>Create_ok
<span style="color:maroon">DOSCODE:69B5                 </span><span style="color:navy">mov     </span>VOLCHNG_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:69BA                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:69BD
DOSCODE:69BD </span>SET_MKND_ERR<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:69BD                 </span><span style="color:navy">mov     bx, offset </span>CRTERRTAB
<span style="color:maroon">DOSCODE:69C0                 </span><span style="color:navy">xlat    byte ptr cs:[bx]
</span><span style="color:maroon">DOSCODE:69C2                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:69C3                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:69C3 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:69C4 </span>CRTERRTAB       <span style="color:navy">db </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">52h</span><span style="color:navy">, </span><span style="color:#008040">50h</span><span style="color:navy">, </span><span style="color:#008040">3</span><span style="color:navy">, </span><span style="color:#008040">5</span><span style="color:navy">, </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">2 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:69CC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:69CC
DOSCODE:69CC </span>Create_ok<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:69CC                 </span><span style="color:navy">call    </span>FastOpen_Delete
<span style="color:maroon">DOSCODE:69CF                 </span><span style="color:navy">mov     al, </span>SATTRIB
<span style="color:maroon">DOSCODE:69D2                 </span><span style="color:navy">test    al, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:69D4                 </span><span style="color:navy">jz      short </span>NoVolLabel
<span style="color:maroon">DOSCODE:69D6                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:maroon">DOSCODE:69DA                 </span><span style="color:navy">mov     ah, es:[di]
</span><span style="color:maroon">DOSCODE:69DD                 </span><span style="color:navy">sub     ah, &#039;</span><span style="color:green">A&#039;
</span><span style="color:maroon">DOSCODE:69E0                 </span><span style="color:navy">mov     </span>VOLCHNG_FLAG<span style="color:navy">, ah
</span><span style="color:maroon">DOSCODE:69E4                 </span><span style="color:navy">mov     bh, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:69E6                 </span><span style="color:navy">call    </span>Set_Media_ID
<span style="color:maroon">DOSCODE:69E9                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:69EC                 </span><span style="color:navy">call    </span>FATREAD_CDS
<span style="color:maroon">DOSCODE:69EF                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:69F2
DOSCODE:69F2 </span>NoVolLabel<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:69F2                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:69F5                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:maroon">DOSCODE:69F9                 </span><span style="color:navy">call    </span>ShSU
<span style="color:maroon">DOSCODE:69FD                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:6A00                 </span><span style="color:navy">jmp     </span>SET_SFT_MODE
<span style="color:maroon">DOSCODE:6A03 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6A03
DOSCODE:6A03 </span>DOS_Create_New<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:6A03                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:6A05                 </span><span style="color:navy">jmp     </span>Create_inter
<span style="color:black">DOSCODE:6A08
DOSCODE:6A08 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6A08
DOSCODE:6A08
DOSCODE:6A08 </span>Set_Media_ID    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A08                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6A09                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:6A0A                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:6A0B                 </span><span style="color:navy">inc     ah
</span><span style="color:black">DOSCODE:6A0D                 </span><span style="color:navy">mov     bl, ah
</span><span style="color:black">DOSCODE:6A0F                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:6A11                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">866h
</span><span style="color:black">DOSCODE:6A14                 </span><span style="color:navy">mov     dx, offset </span>FAKE_STACK_2F
<span style="color:black">DOSCODE:6A17                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:6A18                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:6A19                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:black">DOSCODE:6A1B                 </span><span style="color:navy">call    </span>$IOCTL
<span style="color:black">DOSCODE:6A1E                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:6A1F                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6A20                 </span><span style="color:navy">jb      short </span><span style="color:gray">geterr
</span><span style="color:black">DOSCODE:6A22                 </span><span style="color:navy">or      bh, bh
</span><span style="color:black">DOSCODE:6A24                 </span><span style="color:navy">jz      short </span><span style="color:gray">NoName
</span><span style="color:black">DOSCODE:6A26                 </span><span style="color:navy">mov     si, offset </span>NAME1
<span style="color:black">DOSCODE:6A29                 </span><span style="color:navy">jmp     short </span><span style="color:gray">doset
</span><span style="color:black">DOSCODE:6A2B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6A2B
DOSCODE:6A2B </span><span style="color:gray">NoName</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A2B                 </span><span style="color:navy">mov     si, offset </span>NO_NAME_ID <span style="color:gray">; &quot;NO NAME    &quot;
</span><span style="color:black">DOSCODE:6A2E
DOSCODE:6A2E </span><span style="color:gray">doset</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A2E                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:6A30                 </span><span style="color:navy">add     di, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:6A33                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6A34                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6A35                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6A36                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6A37                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:6A3A                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:6A3C                 </span><span style="color:navy">mov     cx, </span><span style="color:green">846h
</span><span style="color:black">DOSCODE:6A3F                 </span><span style="color:navy">mov     al, </span><span style="color:green">0Dh
</span><span style="color:black">DOSCODE:6A41                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:black">DOSCODE:6A43                 </span><span style="color:navy">call    </span>$IOCTL
<span style="color:black">DOSCODE:6A46
DOSCODE:6A46 </span><span style="color:gray">geterr</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A46                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6A47                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6A48                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:6A49                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6A4A                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6A4B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6A4B </span>Set_Media_ID    endp
<span style="color:black">DOSCODE:6A4B
DOSCODE:6A4C
DOSCODE:6A4C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6A4C
DOSCODE:6A4C
DOSCODE:6A4C </span>Set_EXT_mode    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A4C                 </span><span style="color:navy">test    ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6A52                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOTEX
</span><span style="color:black">DOSCODE:6A54                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6A55                 </span><span style="color:navy">mov     ax, ss:</span>SAVE_BX
<span style="color:black">DOSCODE:6A59                 </span><span style="color:navy">or      es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6A5D                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6A5E                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6A5F
DOSCODE:6A5F </span><span style="color:gray">NOTEX</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A5F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6A5F </span>Set_EXT_mode    endp
<span style="color:black">DOSCODE:6A5F
DOSCODE:6A60
DOSCODE:6A60 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6A60
DOSCODE:6A60
DOSCODE:6A60 </span>DOS_OPEN        proc near               <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:6A60                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6A65                 </span><span style="color:navy">call    </span>Check_Access_AX
<span style="color:black">DOSCODE:6A68                 </span><span style="color:navy">jb      short </span>do_ret_label
<span style="color:black">DOSCODE:6A6A                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6A6E                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:6A70                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:6A74                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:6A75                 </span><span style="color:navy">les     si, </span>THISCDS
<span style="color:black">DOSCODE:6A79                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6A7C                 </span><span style="color:navy">jnz     short </span>TEST_RE_NET1
<span style="color:black">DOSCODE:6A7E                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6A7F                 </span><span style="color:navy">test    </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6A84                 </span><span style="color:navy">jz      short </span>_NOEXTOP
<span style="color:black">DOSCODE:6A86
DOSCODE:6A86 </span>_IFS_extopen<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A86                 </span><span style="color:navy">mov     al, byte ptr </span>SAVE_BX
<span style="color:black">DOSCODE:6A89                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6A8A                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">112Eh
</span><span style="color:black">DOSCODE:6A8D                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - DOS 4 IFSFUNC.EXE - ???
<span style="color:black">DOSCODE:6A8D                                         </span>; SS = DS = DOS CS, STACK: WORD ???   low byte = ???
<span style="color:black">DOSCODE:6A8D                                         </span>; Return: CF set on error
<span style="color:black">DOSCODE:6A8D                                         </span>; CF clear if successful
<span style="color:black">DOSCODE:6A8F                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6A90                 </span><span style="color:navy">mov     </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6A95
DOSCODE:6A95 </span>do_ret_label<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A95                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6A96 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6A96
DOSCODE:6A96 </span>_NOEXTOP<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6A96                 </span><span style="color:navy">test    </span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6A9B                 </span><span style="color:navy">jz      short </span>not_exec_open
<span style="color:black">DOSCODE:6A9D                 </span><span style="color:navy">test    byte ptr </span>DOS34_FLAG<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:6AA2                 </span><span style="color:navy">jz      short </span>not_exec_open
<span style="color:black">DOSCODE:6AA4                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">23h </span><span style="color:gray">; &#039;#&#039;
</span><span style="color:black">DOSCODE:6AA6
DOSCODE:6AA6 </span>not_exec_open<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6AA6                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6AA7                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1116h
</span><span style="color:black">DOSCODE:6AAA                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - OPEN EXISTING REMOTE FILE
<span style="color:black">DOSCODE:6AAA                                         </span>; ES:DI -&gt; uninitialized SFT, SS = DOS CS
<span style="color:black">DOSCODE:6AAA                                         </span>; SDA first filename pointer -&gt; fully-qualified name of file to open
<span style="color:black">DOSCODE:6AAA                                         </span>; STACK: WORD file open mode
<span style="color:black">DOSCODE:6AAA                                         </span>; Return: CF set on error
<span style="color:black">DOSCODE:6AAC                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6AAD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6AAE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6AAE
DOSCODE:6AAE </span>TEST_RE_NET1<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6AAE                 </span><span style="color:navy">test    word ptr es:[si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6AB4                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6AB5                 </span><span style="color:navy">jz      short </span>LOCAL_OPEN
<span style="color:black">DOSCODE:6AB7                 </span><span style="color:navy">test    </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6ABC                 </span><span style="color:navy">jnz     short </span>_IFS_extopen
<span style="color:black">DOSCODE:6ABE                 </span><span style="color:navy">jmp     short </span>_NOEXTOP
<span style="color:black">DOSCODE:6AC0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6AC0
DOSCODE:6AC0 </span>LOCAL_OPEN<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6AC0                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6AC3                 </span><span style="color:navy">or      </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">5
</span><span style="color:black">DOSCODE:6AC8                 </span><span style="color:navy">call    </span>GETPATH
<span style="color:black">DOSCODE:6ACB                 </span><span style="color:navy">jnb     short </span>Open_found
<span style="color:black">DOSCODE:6ACD                 </span><span style="color:navy">jnz     short </span>bad_path2
<span style="color:black">DOSCODE:6ACF                 </span><span style="color:navy">or      cl, cl
</span><span style="color:black">DOSCODE:6AD1                 </span><span style="color:navy">jz      short </span>bad_path2
<span style="color:black">DOSCODE:6AD3
DOSCODE:6AD3 </span>OpenFNF<span style="color:navy">:
</span><span style="color:black">DOSCODE:6AD3                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6AD6
DOSCODE:6AD6 </span>OpenBadRet<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6AD6                 </span><span style="color:navy">and     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6ADC                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6ADD                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6AE0                 </span><span style="color:navy">jmp     </span>Clear_FastOpen
<span style="color:black">DOSCODE:6AE3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6AE3
DOSCODE:6AE3 </span>bad_path2<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6AE3                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:6AE6                 </span><span style="color:navy">jmp     short </span>OpenBadRet
<span style="color:black">DOSCODE:6AE8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6AE8
DOSCODE:6AE8 </span>Open_Bad_Access<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6AE8                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6AEB                 </span><span style="color:navy">jmp     short </span>OpenBadRet
<span style="color:black">DOSCODE:6AED </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6AED
DOSCODE:6AED </span>Open_found<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6AED                 </span><span style="color:navy">jz      short </span>Open_Bad_Access
<span style="color:black">DOSCODE:6AEF                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:6AF1                 </span><span style="color:navy">js      short </span>open_ok
<span style="color:black">DOSCODE:6AF3                 </span><span style="color:navy">mov     es, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6AF7                 </span><span style="color:navy">mov     al, es:[bx+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6AFB                 </span><span style="color:navy">test    al, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:6AFD                 </span><span style="color:navy">jnz     short </span>Open_Bad_Access
<span style="color:black">DOSCODE:6AFF                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6B01                 </span><span style="color:navy">jz      short </span>open_ok
<span style="color:black">DOSCODE:6B03                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6B04                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:6B05                 </span><span style="color:navy">lds     si, </span>THISSFT
<span style="color:black">DOSCODE:6B09                 </span><span style="color:navy">mov     cx, [si+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6B0C                 </span><span style="color:navy">test    cx, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6B10                 </span><span style="color:navy">jnz     short </span>ResetAccess
<span style="color:black">DOSCODE:6B12                 </span><span style="color:navy">mov     dl, cl
</span><span style="color:black">DOSCODE:6B14                 </span><span style="color:navy">and     dl, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:6B17                 </span><span style="color:navy">cmp     dl, </span><span style="color:#ff8000">70h </span><span style="color:gray">; &#039;p&#039;
</span><span style="color:black">DOSCODE:6B1A                 </span><span style="color:navy">jnz     short </span>NormalOpen
<span style="color:black">DOSCODE:6B1C
DOSCODE:6B1C </span>ResetAccess<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B1C                 </span><span style="color:navy">and     cx, </span><span style="color:green">0FFF0h
</span><span style="color:black">DOSCODE:6B1F                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:6B22                 </span><span style="color:navy">jmp     short </span>FillSFT
<span style="color:black">DOSCODE:6B24 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6B24
DOSCODE:6B24 </span>NormalOpen<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B24                 </span><span style="color:navy">and     cl, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:6B27                 </span><span style="color:navy">cmp     cl, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6B2A                 </span><span style="color:navy">jz      short </span>FillSFT
<span style="color:black">DOSCODE:6B2C                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:6B2D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6B2E                 </span><span style="color:navy">jmp     short </span>Open_Bad_Access
<span style="color:black">DOSCODE:6B30 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6B30
DOSCODE:6B30 </span>FillSFT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B30                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:6B31                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6B32
DOSCODE:6B32 </span>open_ok<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B32                 </span><span style="color:navy">call    </span>DOOPEN
<span style="color:black">DOSCODE:6B35                 </span><span style="color:navy">and     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6B3B                 </span><span style="color:navy">call    </span>DO_SHARE_CHECK
<span style="color:black">DOSCODE:6B3E                 </span><span style="color:navy">jnb     short </span>SHARE_OK
<span style="color:black">DOSCODE:6B40                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6B43                 </span><span style="color:navy">jmp     short </span>Clear_FastOpen
<span style="color:black">DOSCODE:6B45 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6B45
DOSCODE:6B45 </span>SHARE_OK<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B45                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:6B48                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6B4C                 </span><span style="color:navy">call    </span>ShSU
<span style="color:black">DOSCODE:6B50                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6B53
DOSCODE:6B53 </span>SET_SFT_MODE<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B53                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6B57                 </span><span style="color:navy">call    </span>DEV_OPEN_SFT
<span style="color:black">DOSCODE:6B5A                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6B60                 </span><span style="color:navy">jz      short </span>Clear_FastOpen
<span style="color:black">DOSCODE:6B62                 </span><span style="color:navy">mov     ax, </span>CurrentPDB
<span style="color:black">DOSCODE:6B65                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6B69
DOSCODE:6B69 </span>Clear_FastOpen<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B69                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6B69 </span>DOS_OPEN        endp
<span style="color:black">DOSCODE:6B69
DOSCODE:6B6A
DOSCODE:6B6A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6B6A
DOSCODE:6B6A
DOSCODE:6B6A </span>SHARE_ERROR     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B6A                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6B70                 </span><span style="color:navy">jnz     short </span><span style="color:gray">_HARD_ERR
</span><span style="color:black">DOSCODE:6B72                 </span><span style="color:navy">mov     cl, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6B76                 </span><span style="color:navy">and     cl, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:6B79                 </span><span style="color:navy">cmp     cl, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6B7C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">_NO_HARD_ERR
</span><span style="color:black">DOSCODE:6B7E
DOSCODE:6B7E </span><span style="color:gray">_HARD_ERR</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B7E                 </span><span style="color:navy">call    </span>SHARE_VIOLATION
<span style="color:black">DOSCODE:6B81                 </span><span style="color:navy">jnb     short </span>Clear_FastOpen
<span style="color:black">DOSCODE:6B83
DOSCODE:6B83 </span><span style="color:gray">_NO_HARD_ERR</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B83                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:black">DOSCODE:6B86                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6B87                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6B87 </span>SHARE_ERROR     endp
<span style="color:black">DOSCODE:6B87
DOSCODE:6B88
DOSCODE:6B88 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6B88
DOSCODE:6B88
DOSCODE:6B88 </span>DO_SHARE_CHECK  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B88                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6B8B
DOSCODE:6B8B </span><span style="color:gray">OPN_RETRY</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B8B                 </span><span style="color:navy">mov     cx, </span>RetryCount
<span style="color:black">DOSCODE:6B8F
DOSCODE:6B8F </span><span style="color:gray">OpenShareRetry</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6B8F                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:6B90                 </span><span style="color:navy">call    </span>SHARE_CHECK
<span style="color:black">DOSCODE:6B93                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:6B94                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Share_Ok2
</span><span style="color:black">DOSCODE:6B96                 </span><span style="color:navy">call    </span>Idle
<span style="color:black">DOSCODE:6B99                 </span><span style="color:navy">loop    </span><span style="color:gray">OpenShareRetry
</span><span style="color:black">DOSCODE:6B9B                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6B9F                 </span><span style="color:navy">call    </span>SHARE_ERROR
<span style="color:black">DOSCODE:6BA2                 </span><span style="color:navy">jnb     short </span><span style="color:gray">OPN_RETRY
</span><span style="color:black">DOSCODE:6BA4
DOSCODE:6BA4 </span><span style="color:gray">Share_Ok2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6BA4                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6BA7                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6BA7 </span>DO_SHARE_CHECK  endp
<span style="color:black">DOSCODE:6BA7
DOSCODE:6BA8
DOSCODE:6BA8 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6BA8
DOSCODE:6BA8
DOSCODE:6BA8 </span>Check_Access_AX proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6BA8                 </span><span style="color:navy">mov     </span>OPEN_ACCESS<span style="color:navy">, al
</span><span style="color:black">DOSCODE:6BAB                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:6BAC                 </span><span style="color:navy">mov     bl, al
</span><span style="color:black">DOSCODE:6BAE                 </span><span style="color:navy">and     bl, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:6BB1                 </span><span style="color:navy">cmp     </span>FSHARING<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:6BB6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CheckShareMode
</span><span style="color:black">DOSCODE:6BB8                 </span><span style="color:navy">cmp     bl, </span><span style="color:#ff8000">70h </span><span style="color:gray">; &#039;p&#039;
</span><span style="color:black">DOSCODE:6BBB                 </span><span style="color:navy">jz      short </span><span style="color:gray">CheckAccessMode
</span><span style="color:black">DOSCODE:6BBD
DOSCODE:6BBD </span><span style="color:gray">CheckShareMode</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6BBD                 </span><span style="color:navy">cmp     bl, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;
</span><span style="color:black">DOSCODE:6BC0                 </span><span style="color:navy">ja      short </span><span style="color:gray">Make_Bad_Access
</span><span style="color:black">DOSCODE:6BC2
DOSCODE:6BC2 </span><span style="color:gray">CheckAccessMode</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6BC2                 </span><span style="color:navy">mov     bl, al
</span><span style="color:black">DOSCODE:6BC4                 </span><span style="color:navy">and     bl, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:6BC7                 </span><span style="color:navy">cmp     bl, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6BCA                 </span><span style="color:navy">ja      short </span><span style="color:gray">Make_Bad_Access
</span><span style="color:black">DOSCODE:6BCC                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6BCD                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:6BCE                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6BCF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6BCF
DOSCODE:6BCF </span><span style="color:gray">Make_Bad_Access</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6BCF                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">0Ch
</span><span style="color:black">DOSCODE:6BD2                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6BD3                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6BD4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6BD4 </span>Check_Access_AX endp
<span style="color:black">DOSCODE:6BD4
DOSCODE:6BD5
DOSCODE:6BD5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6BD5
DOSCODE:6BD5
DOSCODE:6BD5 </span>DISK_INFO       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6BD5                 </span><span style="color:navy">call    </span>TestNet
<span style="color:black">DOSCODE:6BD8                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOCAL_DSK_INFO
</span><span style="color:black">DOSCODE:6BDA                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">110Ch
</span><span style="color:black">DOSCODE:6BDD                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - GET DISK SPACE
<span style="color:black">DOSCODE:6BDD                                         </span>; ES:DI -&gt; current directory
<span style="color:black">DOSCODE:6BDD                                         </span>; Return: AL = sectors per cluster, BX = total clusters
<span style="color:black">DOSCODE:6BDD                                         </span>; CX = bytes per sector, DX = number of available clusters
<span style="color:black">DOSCODE:6BDF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6BE0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6BE0
DOSCODE:6BE0 </span><span style="color:gray">LOCAL_DSK_INFO</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6BE0                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6BE5                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6BE8                 </span><span style="color:navy">call    </span>FATREAD_CDS
<span style="color:black">DOSCODE:6BEB                 </span><span style="color:navy">jb      short </span><span style="color:gray">CRIT_LEAVE
</span><span style="color:black">DOSCODE:6BED                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6BF0                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:6BF3                 </span><span style="color:navy">jb      short </span><span style="color:gray">CRIT_LEAVE
</span><span style="color:black">DOSCODE:6BF5                 </span><span style="color:navy">lds     si, </span>CURBUF
<span style="color:black">DOSCODE:6BF9                 </span><span style="color:navy">mov     ah, [si+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6BFC                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6BFD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6BFE                 </span><span style="color:navy">mov     cx, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6C02                 </span><span style="color:navy">mov     dx, es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6C06                 </span><span style="color:navy">cmp     dx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6C09                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoScan
</span><span style="color:black">DOSCODE:6C0B                 </span><span style="color:navy">cmp     dx, cx
</span><span style="color:black">DOSCODE:6C0D                 </span><span style="color:navy">jb      short </span><span style="color:gray">GotVal
</span><span style="color:black">DOSCODE:6C0F
DOSCODE:6C0F </span><span style="color:gray">DoScan</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C0F                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:6C11                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:6C12
DOSCODE:6C12 </span><span style="color:gray">SCANFREE</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C12                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:6C15                 </span><span style="color:navy">jb      short </span><span style="color:gray">CRIT_LEAVE
</span><span style="color:black">DOSCODE:6C17                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOTFREECLUS
</span><span style="color:black">DOSCODE:6C19                 </span><span style="color:navy">inc     dx
</span><span style="color:black">DOSCODE:6C1A
DOSCODE:6C1A </span><span style="color:gray">NOTFREECLUS</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C1A                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:6C1B                 </span><span style="color:navy">loop    </span><span style="color:gray">SCANFREE
</span><span style="color:black">DOSCODE:6C1D                 </span><span style="color:navy">dec     bx
</span><span style="color:black">DOSCODE:6C1E
DOSCODE:6C1E </span><span style="color:gray">ReturnVals</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C1E                 </span><span style="color:navy">dec     bx
</span><span style="color:black">DOSCODE:6C1F                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6C23                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:6C25                 </span><span style="color:navy">mov     cx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6C29                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:6C2D                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:6C2E
DOSCODE:6C2E </span><span style="color:gray">CRIT_LEAVE</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C2E                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6C31                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6C32 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6C32
DOSCODE:6C32 </span><span style="color:gray">GotVal</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C32                 </span><span style="color:navy">mov     bx, cx
</span><span style="color:black">DOSCODE:6C34                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ReturnVals
</span><span style="color:black">DOSCODE:6C34 </span>DISK_INFO       endp
<span style="color:black">DOSCODE:6C34
DOSCODE:6C36
DOSCODE:6C36 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6C36
DOSCODE:6C36
DOSCODE:6C36 </span>DOS_SEARCH_FIRST proc near              <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C36
DOSCODE:6C36 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:6C8B SIZE 0000001F BYTES
</span><span style="color:black">DOSCODE:6C36
DOSCODE:6C36                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:6C3A                 </span><span style="color:navy">cmp     di, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6C3D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">TEST_RE_NET2
</span><span style="color:black">DOSCODE:6C3F                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1119h
</span><span style="color:black">DOSCODE:6C42                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - ???
<span style="color:black">DOSCODE:6C44                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6C45 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6C45
DOSCODE:6C45 </span><span style="color:gray">TEST_RE_NET2</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C45                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6C4B                 </span><span style="color:navy">jz      short </span><span style="color:gray">LOCAL_SEARCH_FIRST
</span><span style="color:black">DOSCODE:6C4D                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">111Bh
</span><span style="color:black">DOSCODE:6C50                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - FINDFIRST
<span style="color:black">DOSCODE:6C50                                         </span>; SS = DS = DOS CS, [DTA] = uninitialized 21-byte findfirst search data
<span style="color:black">DOSCODE:6C50                                         </span>; SDA first filename pointer -&gt; fully-qualified search template
<span style="color:black">DOSCODE:6C50                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:black">DOSCODE:6C50                                         </span>; Return: CF set on error
<span style="color:black">DOSCODE:6C52                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6C53 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6C53
DOSCODE:6C53 </span><span style="color:gray">LOCAL_SEARCH_FIRST</span><span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C53                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6C56                 </span><span style="color:navy">test    </span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">400h
</span><span style="color:black">DOSCODE:6C5C                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOFN
</span><span style="color:black">DOSCODE:6C5E                 </span><span style="color:navy">or      </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:6C63
DOSCODE:6C63 </span><span style="color:gray">NOFN</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C63                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:6C68                 </span><span style="color:navy">call    </span>CHECK_QUESTION
<span style="color:black">DOSCODE:6C6B                 </span><span style="color:navy">jnb     short </span><span style="color:gray">norm_GETPATH
</span><span style="color:black">DOSCODE:6C6D                 </span><span style="color:navy">and     </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6C72
DOSCODE:6C72 </span><span style="color:gray">norm_GETPATH</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C72                 </span><span style="color:navy">call    </span>GETPATH
<span style="color:black">DOSCODE:6C75                 </span><span style="color:navy">jnb     short </span><span style="color:gray">find_check_dev
</span><span style="color:black">DOSCODE:6C77                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bad_path3
</span><span style="color:black">DOSCODE:6C79                 </span><span style="color:navy">or      cl, cl
</span><span style="color:black">DOSCODE:6C7B                 </span><span style="color:navy">jz      short </span><span style="color:gray">bad_path3
</span><span style="color:black">DOSCODE:6C7B </span>DOS_SEARCH_FIRST endp
<span style="color:black">DOSCODE:6C7B
DOSCODE:6C7D </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DOS_SEARCH_NEXT
</span><span style="color:black">DOSCODE:6C7D
DOSCODE:6C7D </span><span style="color:gray">find_no_more</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C7D                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">12h
</span><span style="color:black">DOSCODE:6C80
DOSCODE:6C80 </span>BadBye<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C80                 </span><span style="color:navy">and     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6C86                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6C87                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6C8A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6C8A </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DOS_SEARCH_NEXT
</span><span style="color:black">DOSCODE:6C8B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6C8B </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DOS_SEARCH_FIRST
</span><span style="color:black">DOSCODE:6C8B
DOSCODE:6C8B </span><span style="color:gray">bad_path3</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C8B                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:6C8E                 </span><span style="color:navy">jmp     short </span>BadBye
<span style="color:black">DOSCODE:6C90 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6C90
DOSCODE:6C90 </span><span style="color:gray">find_check_dev</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C90                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:6C92                 </span><span style="color:navy">jns     short </span><span style="color:gray">found_entry
</span><span style="color:black">DOSCODE:6C94                 </span><span style="color:navy">mov     </span>LASTENT<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6C9A                 </span><span style="color:navy">inc     </span>FOUND_DEV
<span style="color:black">DOSCODE:6C9E
DOSCODE:6C9E </span><span style="color:gray">found_entry</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6C9E                 </span><span style="color:navy">les     di, </span>DMAADD
<span style="color:black">DOSCODE:6CA2                 </span><span style="color:navy">mov     si, </span>WFP_START
<span style="color:black">DOSCODE:6CA6                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:6CA7                 </span><span style="color:navy">sub     al, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;
</span><span style="color:black">DOSCODE:6CA9                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:6CA9 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DOS_SEARCH_FIRST
</span><span style="color:black">DOSCODE:6CAA </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DOS_SEARCH_NEXT
</span><span style="color:black">DOSCODE:6CAA
DOSCODE:6CAA </span><span style="color:gray">found_it</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6CAA                 </span><span style="color:navy">les     di, </span>DMAADD
<span style="color:black">DOSCODE:6CAE                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:6CAF                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6CB0                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:6CB5                 </span><span style="color:navy">jz      short </span><span style="color:gray">notfast
</span><span style="color:black">DOSCODE:6CB7                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:6CB9                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6CBD                 </span><span style="color:navy">jmp     short </span><span style="color:gray">movmov
</span><span style="color:black">DOSCODE:6CBF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6CBF
DOSCODE:6CBF </span><span style="color:gray">notfast</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6CBF                 </span><span style="color:navy">mov     si, offset </span>NAME1
<span style="color:black">DOSCODE:6CC2
DOSCODE:6CC2 </span><span style="color:gray">movmov</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6CC2                 </span><span style="color:navy">movsb
</span><span style="color:black">DOSCODE:6CC3                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6CC8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOTKANJB
</span><span style="color:black">DOSCODE:6CCA                 </span><span style="color:navy">mov     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:6CCF
DOSCODE:6CCF </span><span style="color:gray">NOTKANJB</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6CCF                 </span><span style="color:navy">mov     cx, </span><span style="color:green">10
</span><span style="color:black">DOSCODE:6CD2                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:6CD4                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6CD5                 </span><span style="color:navy">mov     al, </span>ATTRIB
<span style="color:black">DOSCODE:6CD8                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:6CD9                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6CDA                 </span><span style="color:navy">mov     ax, </span>LASTENT
<span style="color:black">DOSCODE:6CDD                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:6CDE                 </span><span style="color:navy">mov     ax, </span>DIRSTART
<span style="color:black">DOSCODE:6CE1                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:6CE2                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:6CE5                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6CE6                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:6CE8                 </span><span style="color:navy">js      short </span><span style="color:gray">DOSREL
</span><span style="color:black">DOSCODE:6CEA                 </span><span style="color:navy">cmp     word ptr </span>CURBUF<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6CEF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OKSTORE
</span><span style="color:black">DOSCODE:6CF1                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:6CF6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OKSTORE
</span><span style="color:black">DOSCODE:6CF8                 </span><span style="color:navy">mov     word ptr es:[di-</span><span style="color:green">8</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6CFE                 </span><span style="color:navy">jmp     </span><span style="color:gray">find_no_more
</span><span style="color:black">DOSCODE:6D01 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6D01
DOSCODE:6D01 </span><span style="color:gray">OKSTORE</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D01                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:6D05
DOSCODE:6D05 </span><span style="color:gray">DOSREL</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D05                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:6D07                 </span><span style="color:navy">mov     cx, </span><span style="color:green">32
</span><span style="color:black">DOSCODE:6D0A                 </span><span style="color:navy">mov     ax, di
</span><span style="color:black">DOSCODE:6D0C                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:6D0E                 </span><span style="color:navy">mov     di, ax
</span><span style="color:black">DOSCODE:6D10                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6D14                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO05
</span><span style="color:black">DOSCODE:6D16                 </span><span style="color:navy">mov     byte ptr es:[di], </span><span style="color:green">0E5h
</span><span style="color:black">DOSCODE:6D1A
DOSCODE:6D1A </span><span style="color:gray">NO05</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D1A                 </span><span style="color:navy">and     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6D20                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6D21                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6D22                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:6D23                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6D26                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6D26 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DOS_SEARCH_NEXT
</span><span style="color:black">DOSCODE:6D27
DOSCODE:6D27 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6D27
DOSCODE:6D27
DOSCODE:6D27 </span>DOS_SEARCH_NEXT proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D27
DOSCODE:6D27 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:6C7D SIZE 0000000E BYTES
</span><span style="color:black">DOSCODE:6D27 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:6CAA SIZE 0000007D BYTES
</span><span style="color:black">DOSCODE:6D27
DOSCODE:6D27                 </span><span style="color:navy">les     di, </span>DMAADD
<span style="color:black">DOSCODE:6D2B                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:6D2E                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:6D30                 </span><span style="color:navy">jz      short </span><span style="color:gray">LOCAL_SEARCH_NEXT
</span><span style="color:black">DOSCODE:6D32                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">111Ch
</span><span style="color:black">DOSCODE:6D35                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - FINDNEXT
<span style="color:black">DOSCODE:6D35                                         </span>; SS = DS = DOS CS, [DTA] = 21-byte findfirst search data
<span style="color:black">DOSCODE:6D35                                         </span>; Return: CF set on error, AX = DOS error code
<span style="color:black">DOSCODE:6D35                                         </span>; CF clear if successful
<span style="color:black">DOSCODE:6D37                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6D38 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6D38
DOSCODE:6D38 </span><span style="color:gray">LOCAL_SEARCH_NEXT</span><span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D38                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6D3D                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6D40                 </span><span style="color:navy">mov     word ptr </span>THISCDS<span style="color:navy">, offset </span>DUMMYCDS
<span style="color:black">DOSCODE:6D46                 </span><span style="color:navy">mov     word ptr </span>THISCDS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:6D4A                 </span><span style="color:navy">add     al, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;
</span><span style="color:black">DOSCODE:6D4C                 </span><span style="color:navy">call    </span>InitCDS
<span style="color:black">DOSCODE:6D4F                 </span><span style="color:navy">jb      short </span><span style="color:gray">No_files
</span><span style="color:black">DOSCODE:6D51                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:6D55                 </span><span style="color:navy">les     bp, es:[di+</span><span style="color:#ff8000">45h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6D59                 </span><span style="color:navy">call    </span>GOTDPB
<span style="color:black">DOSCODE:6D5C                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6D60                 </span><span style="color:navy">mov     </span>THISDRV<span style="color:navy">, al
</span><span style="color:black">DOSCODE:6D63                 </span><span style="color:navy">mov     word ptr </span>CREATING<span style="color:navy">, </span><span style="color:green">0E500h
</span><span style="color:black">DOSCODE:6D69                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:6D6E                 </span><span style="color:navy">lds     si, </span>DMAADD
<span style="color:black">DOSCODE:6D72                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:6D73
DOSCODE:6D73 </span>RENAME_NEXT<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D73                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6D74                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6D75                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:6D78                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:6D7B                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:6D7D                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:6D7E                 </span><span style="color:navy">mov     ss:</span>ATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:6D82                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:6D83                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:6D85                 </span><span style="color:navy">jns     short </span><span style="color:gray">cont_load
</span><span style="color:black">DOSCODE:6D87
DOSCODE:6D87 </span><span style="color:gray">No_files</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D87                 </span><span style="color:navy">jmp     </span><span style="color:gray">find_no_more
</span><span style="color:black">DOSCODE:6D8A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6D8A
DOSCODE:6D8A </span><span style="color:gray">cont_load</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D8A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6D8B                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:6D8C                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:black">DOSCODE:6D8E                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6D8F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6D90                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:6D94                 </span><span style="color:navy">call    </span>SETDIRSRCH
<span style="color:black">DOSCODE:6D97                 </span><span style="color:navy">jnb     short </span><span style="color:gray">SEARCH_GOON
</span><span style="color:black">DOSCODE:6D99                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6D9A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">No_files
</span><span style="color:black">DOSCODE:6D9C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6D9C
DOSCODE:6D9C </span><span style="color:gray">SEARCH_GOON</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6D9C                 </span><span style="color:navy">call    </span>STARTSRCH
<span style="color:black">DOSCODE:6D9F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6DA0                 </span><span style="color:navy">call    </span>GETENT
<span style="color:black">DOSCODE:6DA3                 </span><span style="color:navy">jb      short </span><span style="color:gray">No_files
</span><span style="color:black">DOSCODE:6DA5                 </span><span style="color:navy">call    </span>NEXTENT
<span style="color:black">DOSCODE:6DA8                 </span><span style="color:navy">jb      short </span><span style="color:gray">No_files
</span><span style="color:black">DOSCODE:6DAA                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:6DAC                 </span><span style="color:navy">jmp     </span><span style="color:gray">found_it
</span><span style="color:black">DOSCODE:6DAC </span>DOS_SEARCH_NEXT endp
<span style="color:black">DOSCODE:6DAC
DOSCODE:6DAF
DOSCODE:6DAF </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6DAF
DOSCODE:6DAF
DOSCODE:6DAF </span>CHECK_QUESTION  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6DAF                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6DB0                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6DB1                 </span><span style="color:navy">mov     si, ss:</span>WFP_START
<span style="color:black">DOSCODE:6DB6
DOSCODE:6DB6 </span><span style="color:gray">getnext</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6DB6                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:6DB7                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:6DB9                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_Question
</span><span style="color:black">DOSCODE:6DBB                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:6DBD                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getnext
</span><span style="color:black">DOSCODE:6DBF                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6DC0
DOSCODE:6DC0 </span><span style="color:gray">NO_Question</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6DC0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6DC0 </span>CHECK_QUESTION  endp
<span style="color:black">DOSCODE:6DC0
DOSCODE:6DC1
DOSCODE:6DC1 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6DC1
DOSCODE:6DC1
DOSCODE:6DC1 </span>DOS_ABORT       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6DC1                 </span><span style="color:navy">mov     es, ss:</span>CurrentPDB
<span style="color:black">DOSCODE:6DC6                 </span><span style="color:navy">mov     cx, </span>word ptr es:32h ; [ES:PDB.JFN_Length]
<span style="color:black">DOSCODE:6DCB
DOSCODE:6DCB </span><span style="color:gray">reset_free_jfn</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6DCB                 </span><span style="color:navy">mov     bx, cx
</span><span style="color:black">DOSCODE:6DCD                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:6DCE                 </span><span style="color:navy">dec     bx
</span><span style="color:black">DOSCODE:6DCF                 </span><span style="color:navy">call    </span>$CLOSE
<span style="color:black">DOSCODE:6DD2                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:6DD3                 </span><span style="color:navy">loop    </span><span style="color:gray">reset_free_jfn
</span><span style="color:black">DOSCODE:6DD5                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6DD6                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6DD7                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">111Dh
</span><span style="color:black">DOSCODE:6DDA                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - CLOSE ALL REMOTE FILES FOR PROCESS
<span style="color:black">DOSCODE:6DDA                                         </span>; DS???, SS = DOS CS
<span style="color:black">DOSCODE:6DDC                 </span><span style="color:navy">call    </span>MFTCloseP
<span style="color:black">DOSCODE:6DE0                 </span><span style="color:navy">les     di, ss:</span>SFTFCB
<span style="color:black">DOSCODE:6DE5                 </span><span style="color:navy">mov     cx, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6DE9                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">FCBScanDone
</span><span style="color:black">DOSCODE:6DEB                 </span><span style="color:navy">lea     di, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6DEE                 </span><span style="color:navy">mov     ax, ss:</span>PROC_ID
<span style="color:black">DOSCODE:6DF2
DOSCODE:6DF2 </span><span style="color:gray">FCBTest</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6DF2                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6DF6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FCBNext
</span><span style="color:black">DOSCODE:6DF8                 </span><span style="color:navy">mov     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6DFD
DOSCODE:6DFD </span><span style="color:gray">FCBNext</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6DFD                 </span><span style="color:navy">add     di, </span><span style="color:green">59
</span><span style="color:black">DOSCODE:6E00                 </span><span style="color:navy">loop    </span><span style="color:gray">FCBTest
</span><span style="color:black">DOSCODE:6E02
DOSCODE:6E02 </span><span style="color:gray">FCBScanDone</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E02                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:6E04
DOSCODE:6E04 </span><span style="color:gray">Scan</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E04                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:6E05                 </span><span style="color:navy">call    </span>SFFromSFN
<span style="color:black">DOSCODE:6E08                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6E09                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Scan1
</span><span style="color:black">DOSCODE:6E0B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6E0C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6E0C
DOSCODE:6E0C </span><span style="color:gray">Scan1</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E0C                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6E10                 </span><span style="color:navy">jnz     short </span><span style="color:gray">scan_next
</span><span style="color:black">DOSCODE:6E12                 </span><span style="color:navy">mov     ax, ss:</span>PROC_ID
<span style="color:black">DOSCODE:6E16                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6E1A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">scan_next
</span><span style="color:black">DOSCODE:6E1C                 </span><span style="color:navy">mov     ax, ss:</span>USER_ID
<span style="color:black">DOSCODE:6E20                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">2Fh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6E24                 </span><span style="color:navy">jnz     short </span><span style="color:gray">scan_next
</span><span style="color:black">DOSCODE:6E26                 </span><span style="color:navy">mov     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6E2B
DOSCODE:6E2B </span><span style="color:gray">scan_next</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E2B                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:6E2C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">Scan
</span><span style="color:black">DOSCODE:6E2C </span>DOS_ABORT       endp
<span style="color:black">DOSCODE:6E2C
DOSCODE:6E2E
DOSCODE:6E2E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6E2E
DOSCODE:6E2E
DOSCODE:6E2E </span>DOS_CLOSE       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E2E                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6E32                 </span><span style="color:navy">mov     bx, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6E36                 </span><span style="color:navy">test    bx, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6E3A                 </span><span style="color:navy">jz      short </span><span style="color:gray">LocalClose
</span><span style="color:black">DOSCODE:6E3C                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1106h
</span><span style="color:black">DOSCODE:6E3F                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - CLOSE REMOTE FILE
<span style="color:black">DOSCODE:6E3F                                         </span>; ES:DI -&gt; SFT
<span style="color:black">DOSCODE:6E3F                                         </span>; SFT DPB field -&gt; DPB of drive containing file
<span style="color:black">DOSCODE:6E3F                                         </span>; Return: CF set on error, AX = DOS error code
<span style="color:black">DOSCODE:6E3F                                         </span>; CF clear if successful
<span style="color:black">DOSCODE:6E41                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6E42 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6E42
DOSCODE:6E42 </span><span style="color:gray">LocalClose</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E42                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6E45                 </span><span style="color:navy">call    </span>SetSFTTimes
<span style="color:black">DOSCODE:6E48                 </span><span style="color:navy">call    </span>FREE_SFT
<span style="color:black">DOSCODE:6E4B                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6E4C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6E4D                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6E4E                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:6E4F                 </span><span style="color:navy">call    </span>ShareEnd
<span style="color:black">DOSCODE:6E52                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6E53                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6E54
DOSCODE:6E54 </span>CloseEntry<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E54                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6E55                 </span><span style="color:navy">test    bx, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:6E59                 </span><span style="color:navy">jz      short </span><span style="color:gray">rdir
</span><span style="color:black">DOSCODE:6E5B                 </span><span style="color:navy">jmp     </span><span style="color:gray">FREE_SFT_OK
</span><span style="color:black">DOSCODE:6E5E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6E5E
DOSCODE:6E5E </span><span style="color:gray">rdir</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E5E                 </span><span style="color:navy">call    </span>DirFromSFT
<span style="color:black">DOSCODE:6E61                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6E63                 </span><span style="color:navy">jnb     short </span><span style="color:gray">clook
</span><span style="color:black">DOSCODE:6E65                 </span><span style="color:navy">jmp     </span><span style="color:gray">CloseFinish
</span><span style="color:black">DOSCODE:6E68 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6E68
DOSCODE:6E68 </span><span style="color:gray">clook</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E68                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:6E69                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:6E6A                 </span><span style="color:navy">lea     si, [si+</span><span style="color:#ff8000">20h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6E6D                 </span><span style="color:navy">call    </span>XCHGP
<span style="color:black">DOSCODE:6E70                 </span><span style="color:navy">call    </span>MetaCompare
<span style="color:black">DOSCODE:6E73                 </span><span style="color:navy">call    </span>XCHGP
<span style="color:black">DOSCODE:6E76                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:6E77                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:6E78                 </span><span style="color:navy">jz      short </span><span style="color:gray">CLOSE_GO
</span><span style="color:black">DOSCODE:6E7A                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:6E7C                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6E7D                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6E7E                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6E7F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6E80                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6E81                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6E83                 </span><span style="color:navy">jmp     </span><span style="color:gray">CloseFinish
</span><span style="color:black">DOSCODE:6E86 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6E86
DOSCODE:6E86 </span><span style="color:gray">CLOSE_GO</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E86                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6E8B                 </span><span style="color:navy">jz      short </span><span style="color:gray">nofcb
</span><span style="color:black">DOSCODE:6E8D                 </span><span style="color:navy">mov     ch, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6E91                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6E94                 </span><span style="color:navy">mov     ss:</span>ATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:6E98                 </span><span style="color:navy">jmp     short </span><span style="color:gray">setattr
</span><span style="color:black">DOSCODE:6E9A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6E9A
DOSCODE:6E9A </span><span style="color:gray">nofcb</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6E9A                 </span><span style="color:navy">mov     al, [si+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6E9D                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:6EA1
DOSCODE:6EA1 </span><span style="color:gray">setattr</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6EA1                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:6EA6                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EAA                 </span><span style="color:navy">mov     ss:</span>OLD_FIRSTCLUS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:6EAE                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EB1                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6EB5                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EB8                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">1Ch</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6EBC                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EBF                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">1Eh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6EC3                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EC6                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">18h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6ECA                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6ECD                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">16h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6ED1                 </span><span style="color:navy">test    byte ptr es:[bx+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:6ED6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty4
</span><span style="color:black">DOSCODE:6ED8                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:6EDB                 </span><span style="color:navy">or      byte ptr es:[bx+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:6EE0
DOSCODE:6EE0 </span><span style="color:gray">yesdirty4</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6EE0                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:6EE1                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:6EE2                 </span><span style="color:navy">mov     cx, [si+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EE5                 </span><span style="color:navy">mov     al, ss:</span>THISDRV
<span style="color:black">DOSCODE:6EE9                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:6EEA                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:6EEC                 </span><span style="color:navy">mov     dl, al
</span><span style="color:black">DOSCODE:6EEE                 </span><span style="color:navy">or      cx, cx
</span><span style="color:black">DOSCODE:6EF0                 </span><span style="color:navy">jnz     short </span><span style="color:gray">do_update2
</span><span style="color:black">DOSCODE:6EF2                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:6EF4                 </span><span style="color:navy">mov     di, [si+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EF7                 </span><span style="color:navy">mov     cx, [si+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EFA                 </span><span style="color:navy">mov     dh, [si+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6EFD                 </span><span style="color:navy">jmp     short </span><span style="color:gray">do_update
</span><span style="color:black">DOSCODE:6EFF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6EFF
DOSCODE:6EFF </span><span style="color:gray">do_update2</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6EFF                 </span><span style="color:navy">cmp     cx, ss:</span>OLD_FIRSTCLUS
<span style="color:black">DOSCODE:6F04                 </span><span style="color:navy">jz      short </span><span style="color:gray">do_update
</span><span style="color:black">DOSCODE:6F06                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6F08                 </span><span style="color:navy">mov     cx, ss:</span>OLD_FIRSTCLUS
<span style="color:black">DOSCODE:6F0D
DOSCODE:6F0D </span><span style="color:gray">do_update</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F0D                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:6F0E                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6F0F                 </span><span style="color:navy">call    </span>FastOpen_Update
<span style="color:black">DOSCODE:6F12                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:6F13                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:6F16                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:6F17                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6F18                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6F1A                 </span><span style="color:navy">jb      short </span><span style="color:gray">CloseFinish
</span><span style="color:black">DOSCODE:6F1C
DOSCODE:6F1C </span><span style="color:gray">FREE_SFT_OK</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F1C                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:6F1D
DOSCODE:6F1D </span><span style="color:gray">CloseFinish</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F1D                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:6F1E                 </span><span style="color:navy">call    </span>DEV_CLOSE_SFT
<span style="color:black">DOSCODE:6F21                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:6F22                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:6F23                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:6F24                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:6F25                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NoFree
</span><span style="color:black">DOSCODE:6F27                 </span><span style="color:navy">mov     es:[di], cx
</span><span style="color:black">DOSCODE:6F2A
DOSCODE:6F2A </span><span style="color:gray">NoFree</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F2A                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6F2D                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:6F2E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6F2E </span>DOS_CLOSE       endp
<span style="color:black">DOSCODE:6F2E
DOSCODE:6F2F
DOSCODE:6F2F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6F2F
DOSCODE:6F2F
DOSCODE:6F2F </span>FREE_SFT        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F2F                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:6F30                 </span><span style="color:navy">mov     ax, es:[di]
</span><span style="color:black">DOSCODE:6F33                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:6F34                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SetCount
</span><span style="color:black">DOSCODE:6F36                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:6F37
DOSCODE:6F37 </span><span style="color:gray">SetCount</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F37                 </span><span style="color:navy">xchg    ax, es:[di]
</span><span style="color:black">DOSCODE:6F3A                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:6F3B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6F3B </span>FREE_SFT        endp
<span style="color:black">DOSCODE:6F3B
DOSCODE:6F3C
DOSCODE:6F3C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6F3C
DOSCODE:6F3C
DOSCODE:6F3C </span>DirFromSFT      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F3C                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:6F41                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:6F42                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:6F43                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6F47                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:6F4B                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6F4F                 </span><span style="color:navy">push    </span>HIGH_SECTOR
<span style="color:black">DOSCODE:6F53                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:6F54                 </span><span style="color:navy">call    </span>FATREAD_SFT
<span style="color:black">DOSCODE:6F57                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:6F58                 </span><span style="color:navy">pop     </span>HIGH_SECTOR
<span style="color:black">DOSCODE:6F5C                 </span><span style="color:navy">jb      short </span><span style="color:gray">PopDone
</span><span style="color:black">DOSCODE:6F5E                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:6F60                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:6F65                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:black">DOSCODE:6F68                 </span><span style="color:navy">jb      short </span><span style="color:gray">PopDone
</span><span style="color:black">DOSCODE:6F6A                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:6F6B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:6F6C                 </span><span style="color:navy">les     di, ss:</span>CURBUF
<span style="color:black">DOSCODE:6F71                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:6F76                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:6F78                 </span><span style="color:navy">lea     di, [di+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6F7B                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:black">DOSCODE:6F7D                 </span><span style="color:navy">mul     byte ptr [si+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6F80                 </span><span style="color:navy">add     di, ax
</span><span style="color:black">DOSCODE:6F82                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6F83 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6F83
DOSCODE:6F83 </span><span style="color:gray">PopDone</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F83                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:6F84                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:6F85
DOSCODE:6F85 </span>PopDone_retn<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F85                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6F85 </span>DirFromSFT      endp
<span style="color:black">DOSCODE:6F85
DOSCODE:6F86
DOSCODE:6F86 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6F86
DOSCODE:6F86
DOSCODE:6F86 </span>DOS_COMMIT      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6F86                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:6F8A                 </span><span style="color:navy">mov     bx, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:6F8E                 </span><span style="color:navy">test    bx, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:6F92                 </span><span style="color:navy">jnz     short </span>PopDone_retn
<span style="color:black">DOSCODE:6F94                 </span><span style="color:navy">test    bx, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:6F98                 </span><span style="color:navy">jz      short </span><span style="color:gray">LOCAL_COMMIT
</span><span style="color:black">DOSCODE:6F9A                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1107h
</span><span style="color:black">DOSCODE:6F9D                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - COMMIT REMOTE FILE
<span style="color:black">DOSCODE:6F9D                                         </span>; ES:DI -&gt; SFT
<span style="color:black">DOSCODE:6F9D                                         </span>; SFT DPB field -&gt; DPB of drive containing file
<span style="color:black">DOSCODE:6F9D                                         </span>; Return: CF set on error, AX = DOS error code
<span style="color:black">DOSCODE:6F9D                                         </span>; CF clear if successful
<span style="color:black">DOSCODE:6F9F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6FA0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6FA0
DOSCODE:6FA0 </span><span style="color:gray">LOCAL_COMMIT</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6FA0                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6FA3                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:6FA6                 </span><span style="color:navy">call    </span>SetSFTTimes
<span style="color:black">DOSCODE:6FA9                 </span><span style="color:navy">mov     ax, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:6FAC                 </span><span style="color:navy">call    </span>CloseEntry
<span style="color:black">DOSCODE:6FAF                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:6FB0                 </span><span style="color:navy">call    </span>DEV_OPEN_SFT
<span style="color:black">DOSCODE:6FB3                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:6FB4                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6FB7
DOSCODE:6FB7 </span>localcommit_retn<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6FB7                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6FB7 </span>DOS_COMMIT      endp
<span style="color:black">DOSCODE:6FB7
DOSCODE:6FB8
DOSCODE:6FB8 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:6FB8
DOSCODE:6FB8
DOSCODE:6FB8 </span>SetSFTTimes     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:6FB8                 </span><span style="color:navy">test    bx, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:6FBC                 </span><span style="color:navy">jnz     short </span>localcommit_retn
<span style="color:black">DOSCODE:6FBE                 </span><span style="color:navy">test    bx, </span><span style="color:green">4000h
</span><span style="color:black">DOSCODE:6FC2                 </span><span style="color:navy">jnz     short </span>localcommit_retn
<span style="color:black">DOSCODE:6FC4                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:6FC5                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:6FC6                 </span><span style="color:navy">call    </span>DATE16
<span style="color:black">DOSCODE:6FC9                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:6FCD                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:6FD1                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:6FD3                 </span><span style="color:navy">call    </span>ShSU
<span style="color:black">DOSCODE:6FD7                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:6FD8                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:6FD9                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6FD9 </span>SetSFTTimes     endp
<span style="color:black">DOSCODE:6FD9
</span><span style="color:maroon">DOSCODE:6FDA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6FDA
DOSCODE:6FDA </span>DOS_MKDIR<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:6FDA                 </span><span style="color:navy">call    </span>TestNet
<span style="color:maroon">DOSCODE:6FDD                 </span><span style="color:navy">jnb     short </span>LOCAL_MKDIR
<span style="color:maroon">DOSCODE:6FDF                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1103h
</span><span style="color:maroon">DOSCODE:6FE2                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - MAKE REMOTE DIRECTORY
<span style="color:maroon">DOSCODE:6FE2                                         </span>; SS = DOS CS
<span style="color:maroon">DOSCODE:6FE2                                         </span>; SDA first filename pointer -&gt; fully-qualified directory name
<span style="color:maroon">DOSCODE:6FE2                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:maroon">DOSCODE:6FE2                                         </span>; Return: CF set on error, AX = DOS error code
<span style="color:maroon">DOSCODE:6FE2                                         </span>; CF clear if successful
<span style="color:maroon">DOSCODE:6FE4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6FE5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:6FE5 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DOS_CHDIR
</span><span style="color:black">DOSCODE:6FE5
DOSCODE:6FE5 </span>NODEACCERRJ<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6FE5                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:6FE8
DOSCODE:6FE8 </span>_BadRet<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:6FE8                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:6FE9                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:6FEC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:6FEC </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DOS_CHDIR
</span><span style="color:maroon">DOSCODE:6FED </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6FED
DOSCODE:6FED </span>PATHNFJ<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6FED                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:6FF0                 </span><span style="color:navy">jmp     </span>SET_MKND_ERR
<span style="color:maroon">DOSCODE:6FF3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:6FF3
DOSCODE:6FF3 </span>LOCAL_MKDIR<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:6FF3                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:6FF6                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ss
</span><span style="color:maroon">DOSCODE:6FFA                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, offset </span>RENBUF
<span style="color:maroon">DOSCODE:7000                 </span><span style="color:navy">mov     word ptr </span>RENBUF<span style="color:navy">+</span><span style="color:green">33h</span><span style="color:navy">, </span><span style="color:#ff8000">0 </span>; [RENBUF+SF_ENTRY.sf_MFT]
<span style="color:maroon">DOSCODE:7006                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">10h
</span><span style="color:maroon">DOSCODE:7008                 </span><span style="color:navy">call    </span>MakeNode
<span style="color:maroon">DOSCODE:700B                 </span><span style="color:navy">jb      short </span>PATHNFJ
<span style="color:maroon">DOSCODE:700D                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:7010                 </span><span style="color:navy">jz      short </span>NODEACCERRJ
<span style="color:maroon">DOSCODE:7012                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:maroon">DOSCODE:7016                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:maroon">DOSCODE:701A                 </span><span style="color:navy">sub     si, di
</span><span style="color:maroon">DOSCODE:701C                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:701D                 </span><span style="color:navy">push    word ptr [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:7020                 </span><span style="color:navy">push    word ptr [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:7023                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:7024                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:7025                 </span><span style="color:navy">push    </span>DIRSTART
<span style="color:maroon">DOSCODE:7029                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:702B                 </span><span style="color:navy">mov     </span>DIRSTART<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:702E                 </span><span style="color:navy">call    </span>NEWDIR
<span style="color:maroon">DOSCODE:7031                 </span><span style="color:navy">jb      short </span>NODEEXISTSPOPDEL
<span style="color:maroon">DOSCODE:7033                 </span><span style="color:navy">call    </span>GETENT
<span style="color:maroon">DOSCODE:7036                 </span><span style="color:navy">jb      short </span>NODEEXISTSPOPDEL
<span style="color:maroon">DOSCODE:7038                 </span><span style="color:navy">les     di, </span>CURBUF
<span style="color:maroon">DOSCODE:703C                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:maroon">DOSCODE:7041                 </span><span style="color:navy">jnz     short </span>yesdirty5
<span style="color:maroon">DOSCODE:7043                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:maroon">DOSCODE:7046                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:maroon">DOSCODE:704B
DOSCODE:704B </span>yesdirty5<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:704B                 </span><span style="color:navy">add     di, </span><span style="color:green">20
</span><span style="color:maroon">DOSCODE:704E                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">202Eh
</span><span style="color:maroon">DOSCODE:7051                 </span><span style="color:navy">mov     dx, </span>DIRSTART
<span style="color:maroon">DOSCODE:7055                 </span><span style="color:navy">call    </span>SETDOTENT
<span style="color:maroon">DOSCODE:7058                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2E2Eh
</span><span style="color:maroon">DOSCODE:705B                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:705C                 </span><span style="color:navy">call    </span>SETDOTENT
<span style="color:maroon">DOSCODE:705F                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:maroon">DOSCODE:7063                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:maroon">DOSCODE:7068                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:7069                 </span><span style="color:navy">pop     </span>HIGH_SECTOR
<span style="color:maroon">DOSCODE:706D                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:706F                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:maroon">DOSCODE:7072                 </span><span style="color:navy">jb      short </span>NODEEXISTSP
<span style="color:maroon">DOSCODE:7074                 </span><span style="color:navy">mov     dx, </span>DIRSTART
<span style="color:maroon">DOSCODE:7078                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:maroon">DOSCODE:707C                 </span><span style="color:navy">or      byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:7080                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:7081                 </span><span style="color:navy">add     si, di
</span><span style="color:maroon">DOSCODE:7083                 </span><span style="color:navy">mov     [si], dx
</span><span style="color:maroon">DOSCODE:7085                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:maroon">DOSCODE:7087                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:708A                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:708D
DOSCODE:708D </span>DIRUP<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:708D                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:maroon">DOSCODE:7091                 </span><span style="color:navy">jnz     short </span>yesdirty6
<span style="color:maroon">DOSCODE:7093                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:maroon">DOSCODE:7096                 </span><span style="color:navy">or      byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:maroon">DOSCODE:709A
DOSCODE:709A </span>yesdirty6<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:709A                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:709B                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:709C                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:70A0                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:maroon">DOSCODE:70A3                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:70A6                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:70A9                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:70AA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:70AA
DOSCODE:70AA </span>NODEEXISTSPOPDEL<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:70AA                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:70AB                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:70AC                 </span><span style="color:navy">pop     </span>HIGH_SECTOR
<span style="color:maroon">DOSCODE:70B0                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:maroon">DOSCODE:70B4                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:maroon">DOSCODE:70B9                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:70BB                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:maroon">DOSCODE:70BE                 </span><span style="color:navy">jb      short </span>NODEEXISTSP
<span style="color:maroon">DOSCODE:70C0                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:maroon">DOSCODE:70C4                 </span><span style="color:navy">or      byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:70C8                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:70C9                 </span><span style="color:navy">add     si, di
</span><span style="color:maroon">DOSCODE:70CB                 </span><span style="color:navy">sub     si, </span><span style="color:#ff8000">1Ah
</span><span style="color:maroon">DOSCODE:70CE                 </span><span style="color:navy">mov     byte ptr [si], </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:maroon">DOSCODE:70D1                 </span><span style="color:navy">call    </span>DIRUP
<span style="color:maroon">DOSCODE:70D4
DOSCODE:70D4 </span>NODEEXISTS<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:70D4                 </span><span style="color:navy">jmp     </span>NODEACCERRJ
<span style="color:maroon">DOSCODE:70D7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:70D7
DOSCODE:70D7 </span>NODEEXISTSP<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:70D7                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:70D8                 </span><span style="color:navy">jmp     short </span>NODEEXISTS
<span style="color:black">DOSCODE:70DA
DOSCODE:70DA </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:70DA
DOSCODE:70DA
DOSCODE:70DA </span>DOS_CHDIR       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:70DA
DOSCODE:70DA </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:6FE5 SIZE 00000008 BYTES
</span><span style="color:black">DOSCODE:70DA </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:714E SIZE 00000095 BYTES
</span><span style="color:black">DOSCODE:70DA
DOSCODE:70DA                 </span><span style="color:navy">call    </span>TestNet
<span style="color:black">DOSCODE:70DD                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOCAL_CHDIR
</span><span style="color:black">DOSCODE:70DF                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1105h
</span><span style="color:black">DOSCODE:70E2                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - CHDIR
<span style="color:black">DOSCODE:70E2                                         </span>; SS = DOS CS
<span style="color:black">DOSCODE:70E2                                         </span>; SDA first filename pointer -&gt; fully-qualified directory name
<span style="color:black">DOSCODE:70E2                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:black">DOSCODE:70E2                                         </span>; Return: CF set on error, AX = DOS error code
<span style="color:black">DOSCODE:70E2                                         </span>; CF clear if successful
<span style="color:black">DOSCODE:70E4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:70E5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:70E5
DOSCODE:70E5 </span><span style="color:gray">LOCAL_CHDIR</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:70E5                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:70E8                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">2000h
</span><span style="color:black">DOSCODE:70EE                 </span><span style="color:navy">jz      short </span><span style="color:gray">nojoin
</span><span style="color:black">DOSCODE:70F0                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">49h</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:70F6
DOSCODE:70F6 </span><span style="color:gray">nojoin</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:70F6                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:70FB                 </span><span style="color:navy">mov     </span>SATTRIB<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:7100                 </span><span style="color:navy">or      </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7105                 </span><span style="color:navy">call    </span>GETPATH
<span style="color:black">DOSCODE:7108                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:7109                 </span><span style="color:navy">and     </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:710E                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:710F                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:7112                 </span><span style="color:navy">jb      short </span><span style="color:gray">ChDirDone
</span><span style="color:black">DOSCODE:7114                 </span><span style="color:navy">jnz     short </span>NOTDIRPATH
<span style="color:black">DOSCODE:7116                 </span><span style="color:navy">mov     cx, </span>DIRSTART
<span style="color:black">DOSCODE:711A                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:711B
DOSCODE:711B </span><span style="color:gray">ChDirDone</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:711B                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:711E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:711E </span>DOS_CHDIR       endp
<span style="color:black">DOSCODE:711E
DOSCODE:711F
DOSCODE:711F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:711F
DOSCODE:711F
DOSCODE:711F </span>DOS_RMDIR       proc near               <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:711F                 </span><span style="color:navy">call    </span>TestNet
<span style="color:black">DOSCODE:7122                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOCAL_RMDIR
</span><span style="color:black">DOSCODE:7124                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1101h
</span><span style="color:black">DOSCODE:7127                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - REMOVE REMOTE DIRECTORY
<span style="color:black">DOSCODE:7127                                         </span>; SS = DOS CS
<span style="color:black">DOSCODE:7127                                         </span>; SDA first filename pointer -&gt; fully-qualified directory name
<span style="color:black">DOSCODE:7127                                         </span>; SDA CDS pointer -&gt; current directory
<span style="color:black">DOSCODE:7127                                         </span>; Return: CF set on error, AX = DOS error code
<span style="color:black">DOSCODE:7127                                         </span>; CF clear if successful
<span style="color:black">DOSCODE:7129                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:712A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:712A
DOSCODE:712A </span><span style="color:gray">LOCAL_RMDIR</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:712A                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:712D                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7132                 </span><span style="color:navy">mov     </span>SATTRIB<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:7137                 </span><span style="color:navy">call    </span>GETPATH
<span style="color:black">DOSCODE:713A                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOPATH
</span><span style="color:black">DOSCODE:713C                 </span><span style="color:navy">jnz     short </span>NOTDIRPATH
<span style="color:black">DOSCODE:713E                 </span><span style="color:navy">mov     di, </span>DIRSTART
<span style="color:black">DOSCODE:7142                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:7144                 </span><span style="color:navy">jnz     short </span>rmdir_get_buf
<span style="color:black">DOSCODE:7146                 </span><span style="color:navy">jmp     short </span>NOTDIRPATH
<span style="color:black">DOSCODE:7148 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7148
DOSCODE:7148 </span><span style="color:gray">NOPATH</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7148                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:714B                 </span><span style="color:navy">jmp     </span>_BadRet
<span style="color:black">DOSCODE:714B </span>DOS_RMDIR       endp
<span style="color:black">DOSCODE:714B
DOSCODE:714E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:714E </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DOS_CHDIR
</span><span style="color:black">DOSCODE:714E
DOSCODE:714E </span><span style="color:gray">NOTDIRPATHPOP</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:714E                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:714F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:7150
DOSCODE:7150 </span><span style="color:gray">NOTDIRPATHPOP2</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7150                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:7151
DOSCODE:7151 </span>NOTDIRPATH<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7151                 </span><span style="color:navy">jmp     </span>NODEACCERRJ
<span style="color:black">DOSCODE:7154 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7154
DOSCODE:7154 </span>rmdir_get_buf<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7154                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:7158                 </span><span style="color:navy">sub     bx, di
</span><span style="color:black">DOSCODE:715A                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:715B                 </span><span style="color:navy">push    word ptr [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:715E                 </span><span style="color:navy">push    word ptr [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7161                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7162                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7163                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7164                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7165                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:7168                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:716A                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:716D                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:716F                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:7171                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:7172                 </span><span style="color:navy">call    </span>STARTSRCH
<span style="color:black">DOSCODE:7175                 </span><span style="color:navy">call    </span>GETENTRY
<span style="color:black">DOSCODE:7178                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOTDIRPATHPOP
</span><span style="color:black">DOSCODE:717A                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:717E                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:7180                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:7181                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">202Eh
</span><span style="color:black">DOSCODE:7184                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOTDIRPATHPOP
</span><span style="color:black">DOSCODE:7186                 </span><span style="color:navy">add     si, </span><span style="color:green">30
</span><span style="color:black">DOSCODE:7189                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:718A                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">2E2Eh
</span><span style="color:black">DOSCODE:718D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOTDIRPATHPOP
</span><span style="color:black">DOSCODE:718F                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7190                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7191                 </span><span style="color:navy">mov     </span>LASTENT<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:7197                 </span><span style="color:navy">call    </span>GETENTRY
<span style="color:black">DOSCODE:719A                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOTDIRPATHPOP
</span><span style="color:black">DOSCODE:719C                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:71A1                 </span><span style="color:navy">call    </span>SRCH
<span style="color:black">DOSCODE:71A4                 </span><span style="color:navy">jnb     short </span><span style="color:gray">NOTDIRPATHPOP
</span><span style="color:black">DOSCODE:71A6                 </span><span style="color:navy">cmp     </span>FAILERR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:71AB                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOTDIRPATHPOP
</span><span style="color:black">DOSCODE:71AD                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:71B1                 </span><span style="color:navy">mov     bx, </span>DIRSTART
<span style="color:black">DOSCODE:71B5                 </span><span style="color:navy">call    </span>RELEASE
<span style="color:black">DOSCODE:71B8                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOTDIRPATHPOP
</span><span style="color:black">DOSCODE:71BA                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:71BB                 </span><span style="color:navy">pop     </span>HIGH_SECTOR
<span style="color:black">DOSCODE:71BF                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:71C4                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:71C6                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:black">DOSCODE:71C9                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOTDIRPATHPOP2
</span><span style="color:black">DOSCODE:71CB                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:71CF                 </span><span style="color:navy">or      byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:71D3                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:71D4                 </span><span style="color:navy">add     bx, di
</span><span style="color:black">DOSCODE:71D6                 </span><span style="color:navy">mov     byte ptr [bx], </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:71D9                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:71DA                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:71DB                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:71DC                 </span><span style="color:navy">call    </span>FastOpen_Delete
<span style="color:black">DOSCODE:71DF                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:71E0                 </span><span style="color:navy">jmp     </span>DIRUP
<span style="color:black">DOSCODE:71E0 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DOS_CHDIR
</span><span style="color:black">DOSCODE:71E3
DOSCODE:71E3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:71E3
DOSCODE:71E3
DOSCODE:71E3 </span>SWAPBACK        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:71E3                 </span><span style="color:navy">mov     </span>CONSWAP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:71E8                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:71E8 </span>SWAPBACK        endp
<span style="color:black">DOSCODE:71E8
DOSCODE:71E9
DOSCODE:71E9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:71E9
DOSCODE:71E9
DOSCODE:71E9 </span>SWAPCON         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:71E9                 </span><span style="color:navy">mov     </span>CONSWAP<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:71EE                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:71EF                 </span><span style="color:navy">mov     ax, word ptr </span>THISSFT
<span style="color:black">DOSCODE:71F2                 </span><span style="color:navy">mov     word ptr </span>CONSFT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:71F5                 </span><span style="color:navy">mov     ax, word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:71F8                 </span><span style="color:navy">mov     word ptr </span>CONSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:71FB                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:71FC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:71FC </span>SWAPCON         endp
<span style="color:black">DOSCODE:71FC
DOSCODE:71FD
DOSCODE:71FD </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:71FD
DOSCODE:71FD
DOSCODE:71FD </span>DOS_READ        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:71FD                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7201                 </span><span style="color:navy">mov     al, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7205                 </span><span style="color:navy">and     al, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:7207                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7209                 </span><span style="color:navy">jnz     short </span><span style="color:gray">READ_NO_MODE
</span><span style="color:black">DOSCODE:720B                 </span><span style="color:navy">jmp     </span>SET_ACC_ERR
<span style="color:black">DOSCODE:720E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:720E
DOSCODE:720E </span><span style="color:gray">READ_NO_MODE</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:720E                 </span><span style="color:navy">call    </span>SETUP
<span style="color:black">DOSCODE:7211                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">NoIORet
</span><span style="color:black">DOSCODE:7213                 </span><span style="color:navy">call    </span>IsSFTNet
<span style="color:black">DOSCODE:7216                 </span><span style="color:navy">jz      short </span><span style="color:gray">LOCAL_READ
</span><span style="color:black">DOSCODE:7218                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1108h
</span><span style="color:black">DOSCODE:721B                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - READ FROM REMOTE FILE
<span style="color:black">DOSCODE:721B                                         </span>; ES:DI -&gt; SFT
<span style="color:black">DOSCODE:721B                                         </span>; SFT DPB field -&gt; DPB of drive containing file
<span style="color:black">DOSCODE:721B                                         </span>; CX = number of bytes, SS = DOS CS, SDA DTA field -&gt; user buffer
<span style="color:black">DOSCODE:721B                                         </span>; Return: CF set on error, CX = bytes read
<span style="color:black">DOSCODE:721D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:721E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:721E
DOSCODE:721E </span><span style="color:gray">NoIORet</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:721E                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:721F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7220 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7220
DOSCODE:7220 </span><span style="color:gray">LOCAL_READ</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7220                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:7225                 </span><span style="color:navy">jnz     short </span><span style="color:gray">READDEV
</span><span style="color:black">DOSCODE:7227                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:722C                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:722F                 </span><span style="color:navy">call    </span>DISKREAD
<span style="color:black">DOSCODE:7232
DOSCODE:7232 </span>critexit<span style="color:navy">:
</span><span style="color:black">DOSCODE:7232                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:7235                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7236 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7236
DOSCODE:7236 </span><span style="color:gray">READDEV</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7236                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:723B                 </span><span style="color:navy">mov     bl, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:723F                 </span><span style="color:navy">les     di, </span>DMAADD
<span style="color:black">DOSCODE:7243                 </span><span style="color:navy">test    bl, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:7246                 </span><span style="color:navy">jz      short </span><span style="color:gray">ENDRDDEVJ3
</span><span style="color:black">DOSCODE:7248                 </span><span style="color:navy">test    bl, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:724B                 </span><span style="color:navy">jz      short </span><span style="color:gray">TESTRAW
</span><span style="color:black">DOSCODE:724D                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:724F
DOSCODE:724F </span><span style="color:gray">ENDRDDEVJ3</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:724F                 </span><span style="color:navy">jmp     </span><span style="color:gray">ENDRDDEVJ2
</span><span style="color:black">DOSCODE:7252 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7252
DOSCODE:7252 </span><span style="color:gray">TESTRAW</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7252                 </span><span style="color:navy">test    bl, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:7255                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DVRDRAW
</span><span style="color:black">DOSCODE:7257                 </span><span style="color:navy">test    bl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:725A                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOTRDCON
</span><span style="color:black">DOSCODE:725C                 </span><span style="color:navy">jmp     </span><span style="color:gray">READCON
</span><span style="color:black">DOSCODE:725F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:725F
DOSCODE:725F </span><span style="color:gray">DVRDRAW</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:725F                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:7260                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7261                 </span><span style="color:navy">test    ss:</span>IsWin386<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7267                 </span><span style="color:navy">jz      short </span><span style="color:gray">ReadRawRetry
</span><span style="color:black">DOSCODE:7269                 </span><span style="color:navy">test    bl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:726C                 </span><span style="color:navy">jz      short </span><span style="color:gray">ReadRawRetry
</span><span style="color:black">DOSCODE:726E                 </span><span style="color:navy">jmp     </span><span style="color:gray">do_polling
</span><span style="color:black">DOSCODE:7271 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7271
DOSCODE:7271 </span><span style="color:gray">ReadRawRetry</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7271                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:7273                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:7275                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:7277                 </span><span style="color:navy">call    </span>SETREAD
<span style="color:black">DOSCODE:727A                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:727B                 </span><span style="color:navy">lds     si, ss:</span>THISSFT
<span style="color:black">DOSCODE:7280                 </span><span style="color:navy">call    </span>DEVIOCALL
<span style="color:black">DOSCODE:7283                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:7285                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">86h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:7287                 </span><span style="color:navy">mov     di, ss:</span>DEVCALL_REQSTAT
<span style="color:black">DOSCODE:728C                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:728E                 </span><span style="color:navy">jns     short </span><span style="color:gray">CRDROK
</span><span style="color:black">DOSCODE:7290                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:7293                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:7295                 </span><span style="color:navy">add     di, word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:729A                 </span><span style="color:navy">sub     cx, word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:729F                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:72A1                 </span><span style="color:navy">jz      short </span><span style="color:gray">CRDROK
</span><span style="color:black">DOSCODE:72A3                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:72A5                 </span><span style="color:navy">jz      short </span>CRDFERR
<span style="color:black">DOSCODE:72A7                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:72A8                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ReadRawRetry
</span><span style="color:black">DOSCODE:72AA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:72AA
DOSCODE:72AA </span>CRDFERR<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:72AA                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:72AB
DOSCODE:72AB </span><span style="color:gray">DEVIOFERR</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:72AB                 </span><span style="color:navy">les     di, ss:</span>THISSFT
<span style="color:black">DOSCODE:72B0                 </span><span style="color:navy">jmp     </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:72B3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:72B3
DOSCODE:72B3 </span><span style="color:gray">CRDROK</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:72B3                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:72B4                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:72B6                 </span><span style="color:navy">add     di, word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:72BB                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ENDRDDEVJ3
</span><span style="color:black">DOSCODE:72BD </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:72BD
DOSCODE:72BD </span><span style="color:gray">NOTRDCON</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:72BD                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:72BF                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:72C1                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:72C3                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:72C5                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:72C7                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:72C8                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:72CB                 </span><span style="color:navy">call    </span>SETREAD
<span style="color:black">DOSCODE:72CE                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:72CF                 </span><span style="color:navy">lds     si, ss:</span>THISSFT
<span style="color:black">DOSCODE:72D4                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:72D7
DOSCODE:72D7 </span><span style="color:gray">DVRDLP</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:72D7                 </span><span style="color:navy">call    </span>DSKSTATCHK
<span style="color:black">DOSCODE:72DA                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:72DD                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:72DE                 </span><span style="color:navy">mov     ah, </span><span style="color:green">86h
</span><span style="color:black">DOSCODE:72E0                 </span><span style="color:navy">mov     di, ss:</span>DEVCALL_REQSTAT
<span style="color:black">DOSCODE:72E5                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:72E7                 </span><span style="color:navy">jns     short </span><span style="color:gray">CRDOK
</span><span style="color:black">DOSCODE:72E9                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:72EC                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:72ED                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBPB<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:72F4                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:72F6                 </span><span style="color:navy">jz      short </span><span style="color:gray">DVRDLP
</span><span style="color:black">DOSCODE:72F8                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:72FA                 </span><span style="color:navy">jz      short </span><span style="color:gray">DEVIOFERR
</span><span style="color:black">DOSCODE:72FC                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:72FE                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DVRDIGN
</span><span style="color:black">DOSCODE:7300 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7300
DOSCODE:7300 </span><span style="color:gray">CRDOK</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7300                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:7301                 </span><span style="color:navy">cmp     word ptr ss:</span>CALLBPB<span style="color:navy">, </span><span style="color:#ff8000">1 </span>; [SS:CALLSCNT]
<span style="color:black">DOSCODE:7307                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ENDRDDEVJ2
</span><span style="color:black">DOSCODE:7309                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:730A                 </span><span style="color:navy">mov     ds, word ptr ss:</span>CALLBR<span style="color:navy">+</span><span style="color:green">2 </span>; [SS:CALLXAD+2]
<span style="color:black">DOSCODE:730F                 </span><span style="color:navy">mov     al, [di]
</span><span style="color:black">DOSCODE:7311                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7312
DOSCODE:7312 </span><span style="color:gray">DVRDIGN</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7312                 </span><span style="color:navy">inc     word ptr ss:</span>CALLBR ; [SS:CALLXAD]
<span style="color:black">DOSCODE:7317                 </span><span style="color:navy">mov     ss:</span>DEVCALL_REQSTAT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:731E                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:731F                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:7321                 </span><span style="color:navy">jz      short </span><span style="color:gray">ENDRDDEVJ2
</span><span style="color:black">DOSCODE:7323                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:7325                 </span><span style="color:navy">loopne  </span><span style="color:gray">DVRDLP
</span><span style="color:black">DOSCODE:7327                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:7328
DOSCODE:7328 </span><span style="color:gray">ENDRDDEVJ2</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7328                 </span><span style="color:navy">jmp     </span><span style="color:gray">ENDRDDEV
</span><span style="color:black">DOSCODE:732B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:732B
DOSCODE:732B </span><span style="color:gray">do_polling</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:732B                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:732D                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:732F                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:7331                 </span><span style="color:navy">call    </span>SETREAD
<span style="color:black">DOSCODE:7334
DOSCODE:7334 </span><span style="color:gray">do_io</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7334                 </span><span style="color:navy">mov     byte ptr es:[bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:7339                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:733A                 </span><span style="color:navy">lds     si, ss:</span>THISSFT
<span style="color:black">DOSCODE:733F                 </span><span style="color:navy">call    </span>DEVIOCALL
<span style="color:black">DOSCODE:7342                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7343                 </span><span style="color:navy">test    word ptr es:[bx+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:7349                 </span><span style="color:navy">jz      short </span><span style="color:gray">check_busy
</span><span style="color:black">DOSCODE:734B                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:734C                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:734E                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:7351                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:7353                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:7355                 </span><span style="color:navy">jz      short </span><span style="color:gray">pop_done_read
</span><span style="color:black">DOSCODE:7357                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:7359                 </span><span style="color:navy">jz      short </span><span style="color:gray">devrderr
</span><span style="color:black">DOSCODE:735B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:735C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">do_io
</span><span style="color:black">DOSCODE:735E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:735E
DOSCODE:735E </span><span style="color:gray">check_busy</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:735E                 </span><span style="color:navy">test    word ptr es:[bx+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">200h
</span><span style="color:black">DOSCODE:7364                 </span><span style="color:navy">jnz     short </span><span style="color:gray">no_char
</span><span style="color:black">DOSCODE:7366                 </span><span style="color:navy">mov     byte ptr es:[bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:736B                 </span><span style="color:navy">mov     word ptr es:[bx+</span><span style="color:#ff8000">12h</span><span style="color:navy">], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7371                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:7372                 </span><span style="color:navy">lds     si, ss:</span>THISSFT
<span style="color:black">DOSCODE:7377                 </span><span style="color:navy">call    </span>DEVIOCALL
<span style="color:black">DOSCODE:737A                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:737C                 </span><span style="color:navy">mov     ah, </span><span style="color:green">86h
</span><span style="color:black">DOSCODE:737E                 </span><span style="color:navy">mov     di, es:[bx+</span><span style="color:#ff8000">3</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7382                 </span><span style="color:navy">test    di, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:7386                 </span><span style="color:navy">jz      short </span><span style="color:gray">next_char
</span><span style="color:black">DOSCODE:7388                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:738B                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:738D                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:738F                 </span><span style="color:navy">jz      short </span><span style="color:gray">pop_done_read
</span><span style="color:black">DOSCODE:7391                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:7393                 </span><span style="color:navy">jz      short </span><span style="color:gray">devrderr
</span><span style="color:black">DOSCODE:7395                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7396                 </span><span style="color:navy">jmp     short </span><span style="color:gray">do_io
</span><span style="color:black">DOSCODE:7398 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7398
DOSCODE:7398 </span><span style="color:gray">next_char</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7398                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7399                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:739B                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:739C                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">done_read
</span><span style="color:black">DOSCODE:739E                 </span><span style="color:navy">inc     word ptr es:[bx+</span><span style="color:green">14</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:73A2                 </span><span style="color:navy">jmp     short </span><span style="color:gray">do_io
</span><span style="color:black">DOSCODE:73A4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:73A4
DOSCODE:73A4 </span><span style="color:gray">devrderr</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73A4                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:73A5                 </span><span style="color:navy">les     di, ss:</span>THISSFT
<span style="color:black">DOSCODE:73AA                 </span><span style="color:navy">jmp     </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:73AD </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:73AD
DOSCODE:73AD </span><span style="color:gray">no_char</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73AD                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:73AE                 </span><span style="color:navy">mov     ah, </span><span style="color:green">84h
</span><span style="color:black">DOSCODE:73B0                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - KEYBOARD BUSY LOOP
<span style="color:black">DOSCODE:73B2                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:73B3                 </span><span style="color:navy">jmp     </span><span style="color:gray">do_io
</span><span style="color:black">DOSCODE:73B6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:73B6
DOSCODE:73B6 </span><span style="color:gray">pop_done_read</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73B6                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:73B7
DOSCODE:73B7 </span><span style="color:gray">done_read</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73B7                 </span><span style="color:navy">add     di, word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:73BC                 </span><span style="color:navy">jmp     </span><span style="color:gray">ENDRDDEVJ3
</span><span style="color:black">DOSCODE:73BF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:73BF
DOSCODE:73BF </span><span style="color:gray">TRANBUF</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73BF                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:73C0                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:73C1                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:73C3                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NORMCH
</span><span style="color:black">DOSCODE:73C5                 </span><span style="color:navy">mov     byte ptr [si], </span><span style="color:#ff8000">0Ah
</span><span style="color:black">DOSCODE:73C8
DOSCODE:73C8 </span><span style="color:gray">NORMCH</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73C8                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:black">DOSCODE:73CA                 </span><span style="color:navy">loopne  </span><span style="color:gray">TRANBUF
</span><span style="color:black">DOSCODE:73CC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ENDRDCON
</span><span style="color:black">DOSCODE:73CE                 </span><span style="color:navy">xor     si, si
</span><span style="color:black">DOSCODE:73D0                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:73D3                 </span><span style="color:navy">or      al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:73D5
DOSCODE:73D5 </span><span style="color:gray">ENDRDCON</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73D5                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:73D6                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:73D7                 </span><span style="color:navy">call    </span>SWAPBACK
<span style="color:black">DOSCODE:73DA                 </span><span style="color:navy">mov     </span>CONTPOS<span style="color:navy">, si
</span><span style="color:black">DOSCODE:73DE
DOSCODE:73DE </span><span style="color:gray">ENDRDDEV</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73DE                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:73DF                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:73E0                 </span><span style="color:navy">mov     </span>NEXTADD<span style="color:navy">, di
</span><span style="color:black">DOSCODE:73E4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SETSFTC
</span><span style="color:black">DOSCODE:73E6                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:73EA                 </span><span style="color:navy">and     byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">0BFh
</span><span style="color:black">DOSCODE:73EF
DOSCODE:73EF </span><span style="color:gray">SETSFTC</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73EF                 </span><span style="color:navy">call    </span>SETSFT
<span style="color:black">DOSCODE:73F2                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:73F3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:73F3
DOSCODE:73F3 </span><span style="color:gray">READCON</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:73F3                 </span><span style="color:navy">call    </span>SWAPCON
<span style="color:black">DOSCODE:73F6                 </span><span style="color:navy">mov     si, </span>CONTPOS
<span style="color:black">DOSCODE:73FA                 </span><span style="color:navy">or      si, si
</span><span style="color:black">DOSCODE:73FC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">TRANBUF
</span><span style="color:black">DOSCODE:73FE                 </span><span style="color:navy">cmp     </span>CONBUF<span style="color:navy">, </span><span style="color:green">128
</span><span style="color:black">DOSCODE:7403                 </span><span style="color:navy">jz      short </span><span style="color:gray">GETBUF
</span><span style="color:black">DOSCODE:7405                 </span><span style="color:navy">mov     word ptr </span>CONBUF<span style="color:navy">, </span><span style="color:green">0FF80h
</span><span style="color:black">DOSCODE:740B
DOSCODE:740B </span><span style="color:gray">GETBUF</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:740B                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:740C                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:740D                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:740E                 </span><span style="color:navy">mov     dx, offset </span>CONBUF
<span style="color:black">DOSCODE:7411                 </span><span style="color:navy">call    </span>$STD_CON_STRING_INPUT
<span style="color:black">DOSCODE:7414                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:7415                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7416                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7417                 </span><span style="color:navy">mov     si, (offset </span>CONBUF<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:741A                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:741D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">TRANBUF
</span><span style="color:black">DOSCODE:741F                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:7421                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:7422                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:7423                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:black">DOSCODE:7425                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:7428                 </span><span style="color:navy">xor     si, si
</span><span style="color:black">DOSCODE:742A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ENDRDCON
</span><span style="color:black">DOSCODE:742A </span>DOS_READ        endp
<span style="color:black">DOSCODE:742A
DOSCODE:742C
DOSCODE:742C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:742C
DOSCODE:742C
DOSCODE:742C </span>DOS_WRITE       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:742C                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7430                 </span><span style="color:navy">mov     al, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7434                 </span><span style="color:navy">and     al, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:7436                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7438                 </span><span style="color:navy">jnz     short </span>Check_FCB_RO
<span style="color:black">DOSCODE:743A
DOSCODE:743A </span>BadMode<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:743A                 </span><span style="color:navy">jmp     </span>SET_ACC_ERR
<span style="color:black">DOSCODE:743D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:743D
DOSCODE:743D </span>Check_FCB_RO<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:743D                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:7442                 </span><span style="color:navy">jz      short </span>WRITE_NO_MODE
<span style="color:black">DOSCODE:7444                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7449                 </span><span style="color:navy">jnz     short </span>BadMode
<span style="color:black">DOSCODE:744B
DOSCODE:744B </span>WRITE_NO_MODE<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:744B                 </span><span style="color:navy">call    </span>SETUP
<span style="color:black">DOSCODE:744E                 </span><span style="color:navy">call    </span>IsSFTNet
<span style="color:black">DOSCODE:7451                 </span><span style="color:navy">jz      short </span>LOCAL_WRITE
<span style="color:black">DOSCODE:7453                 </span><span style="color:navy">mov     ax, </span><span style="color:green">1109h
</span><span style="color:black">DOSCODE:7456                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - WRITE TO REMOTE FILE
<span style="color:black">DOSCODE:7456                                         </span>; ES:DI -&gt; SFT
<span style="color:black">DOSCODE:7456                                         </span>; SFT DPB field -&gt; DPB of drive containing file
<span style="color:black">DOSCODE:7456                                         </span>; CX = number of bytes, SS = DOS CS, SDA DTA field -&gt; user buffer
<span style="color:black">DOSCODE:7456                                         </span>; Return: CF set on error, CX = bytes written
<span style="color:black">DOSCODE:7458                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7459 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7459
DOSCODE:7459 </span>LOCAL_WRITE<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7459                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:745E                 </span><span style="color:navy">jnz     short </span>WRTDEV
<span style="color:black">DOSCODE:7460                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:7465                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:7468                 </span><span style="color:navy">call    </span>DISKWRITE
<span style="color:black">DOSCODE:746B                 </span><span style="color:navy">jb      short </span>nocommit
<span style="color:black">DOSCODE:746D                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7471                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:7476                 </span><span style="color:navy">jz      short </span>nocommit
<span style="color:black">DOSCODE:7478                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7479                 </span><span style="color:navy">call    </span>DOS_COMMIT
<span style="color:black">DOSCODE:747C                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:747D
DOSCODE:747D </span>nocommit<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:747D                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:7480                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7481 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7481
DOSCODE:7481 </span>DVWRTRAW<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7481                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:7483                 </span><span style="color:navy">call    </span>SETWRITE
<span style="color:black">DOSCODE:7486                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:7487                 </span><span style="color:navy">lds     si, ss:</span>THISSFT
<span style="color:black">DOSCODE:748C                 </span><span style="color:navy">call    </span>DEVIOCALL
<span style="color:black">DOSCODE:748F                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:7491                 </span><span style="color:navy">mov     ah, </span><span style="color:green">87h
</span><span style="color:black">DOSCODE:7493                 </span><span style="color:navy">mov     di, ss:</span>DEVCALL_REQSTAT
<span style="color:black">DOSCODE:7498                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:749A                 </span><span style="color:navy">jns     short </span>CWRTROK
<span style="color:black">DOSCODE:749C                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:749F                 </span><span style="color:navy">sub     cx, word ptr ss:</span>CALLBPB ; [ss:CALLSCNT]
<span style="color:black">DOSCODE:74A4                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:black">DOSCODE:74A6                 </span><span style="color:navy">add     bx, word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:74AB                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:74AD                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:74AF                 </span><span style="color:navy">jz      short </span>CWRTROK
<span style="color:black">DOSCODE:74B1                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:74B3                 </span><span style="color:navy">jz      short </span>CWRFERR
<span style="color:black">DOSCODE:74B5                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:74B6                 </span><span style="color:navy">jmp     short </span>DVWRTRAW
<span style="color:black">DOSCODE:74B8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:74B8
DOSCODE:74B8 </span>CWRFERR<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:74B8                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:74B9                 </span><span style="color:navy">jmp     </span>CRDFERR
<span style="color:black">DOSCODE:74BC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:74BC
DOSCODE:74BC </span>CWRTROK<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:74BC                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:74BD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:74BE                 </span><span style="color:navy">mov     ax, word ptr </span>CALLBPB
<span style="color:black">DOSCODE:74C1
DOSCODE:74C1 </span>ENDWRDEV<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:74C1                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:74C5                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:74C7                 </span><span style="color:navy">call    </span>ADDREC
<span style="color:black">DOSCODE:74CA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:74CB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:74CB
DOSCODE:74CB </span>WRTNUL<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:74CB                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:74CD
DOSCODE:74CD </span>WRTCOOKJ<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:74CD                 </span><span style="color:navy">jmp     </span>WRTCOOKDONE
<span style="color:black">DOSCODE:74D0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:74D0
DOSCODE:74D0 </span>WRTDEV<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:74D0                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:74D5                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:74DA                 </span><span style="color:navy">mov     bl, es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:74DE                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:74E0                 </span><span style="color:navy">jcxz    short </span>ENDWRDEV
<span style="color:black">DOSCODE:74E2                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:74E3                 </span><span style="color:navy">mov     al, bl
</span><span style="color:black">DOSCODE:74E5                 </span><span style="color:navy">lds     bx, </span>DMAADD
<span style="color:black">DOSCODE:74E9                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:74EB                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:74ED                 </span><span style="color:navy">test    al, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:74EF                 </span><span style="color:navy">jz      short </span>TEST_DEV_CON
<span style="color:black">DOSCODE:74F1                 </span><span style="color:navy">jmp     short </span>DVWRTRAW
<span style="color:black">DOSCODE:74F3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:74F3
DOSCODE:74F3 </span>TEST_DEV_CON<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:74F3                 </span><span style="color:navy">test    al, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:74F5                 </span><span style="color:navy">jnz     short </span>WRITECON
<span style="color:black">DOSCODE:74F7                 </span><span style="color:navy">test    al, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:74F9                 </span><span style="color:navy">jnz     short </span>WRTNUL
<span style="color:black">DOSCODE:74FB                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:74FD                 </span><span style="color:navy">cmp     byte ptr [bx], </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:7500                 </span><span style="color:navy">jz      short </span>WRTCOOKJ
<span style="color:black">DOSCODE:7502                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7503                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7506                 </span><span style="color:navy">call    </span>SETWRITE
<span style="color:black">DOSCODE:7509                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:750A                 </span><span style="color:navy">lds     si, ss:</span>THISSFT
<span style="color:black">DOSCODE:750F                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7512
DOSCODE:7512 </span>DVWRTLP<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7512                 </span><span style="color:navy">call    </span>DSKSTATCHK
<span style="color:black">DOSCODE:7515                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:7518                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:7519                 </span><span style="color:navy">mov     ah, </span><span style="color:green">87h
</span><span style="color:black">DOSCODE:751B                 </span><span style="color:navy">mov     di, ss:</span>DEVCALL_REQSTAT
<span style="color:black">DOSCODE:7520                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:7522                 </span><span style="color:navy">jns     short </span>CWROK
<span style="color:black">DOSCODE:7524                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:7527                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:7528                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBPB<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:752F                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7531                 </span><span style="color:navy">jz      short </span>DVWRTLP
<span style="color:black">DOSCODE:7533                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:7535                 </span><span style="color:navy">jz      short </span>DVWRTIGN
<span style="color:black">DOSCODE:7537                 </span><span style="color:navy">jmp     </span>CRDFERR
<span style="color:black">DOSCODE:753A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:753A
DOSCODE:753A </span>CWROK<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:753A                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:753B                 </span><span style="color:navy">cmp     word ptr ss:</span>CALLBPB<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7541                 </span><span style="color:navy">jz      short </span>WRTCOOKDONE
<span style="color:black">DOSCODE:7543
DOSCODE:7543 </span>DVWRTIGN<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7543                 </span><span style="color:navy">inc     dx
</span><span style="color:black">DOSCODE:7544                 </span><span style="color:navy">inc     word ptr ss:</span>CALLBR
<span style="color:black">DOSCODE:7549                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:754A                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:754B                 </span><span style="color:navy">mov     ds, word ptr ss:</span>CALLBR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7550                 </span><span style="color:navy">cmp     byte ptr [di], </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:7553                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7554                 </span><span style="color:navy">jz      short </span>WRTCOOKDONE
<span style="color:black">DOSCODE:7556                 </span><span style="color:navy">mov     ss:</span>DEVCALL_REQSTAT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:755D                 </span><span style="color:navy">loop    </span>DVWRTLP
<span style="color:black">DOSCODE:755F
DOSCODE:755F </span>WRTCOOKDONE<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:755F                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:7561                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7562                 </span><span style="color:navy">jmp     </span>ENDWRDEV
<span style="color:black">DOSCODE:7565 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7565
DOSCODE:7565 </span>WRITECON<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7565                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:7566                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7567                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7568                 </span><span style="color:navy">call    </span>SWAPCON
<span style="color:black">DOSCODE:756B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:756C                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:756E                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:756F
DOSCODE:756F </span>WRCONLP<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:756F                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:7570                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:7572                 </span><span style="color:navy">jz      short </span>CONEOF
<span style="color:black">DOSCODE:7574                 </span><span style="color:navy">call    </span>OUTT
<span style="color:black">DOSCODE:7577                 </span><span style="color:navy">loop    </span>WRCONLP
<span style="color:black">DOSCODE:7579
DOSCODE:7579 </span>CONEOF<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7579                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:757A                 </span><span style="color:navy">sub     ax, cx
</span><span style="color:black">DOSCODE:757C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:757D                 </span><span style="color:navy">call    </span>SWAPBACK
<span style="color:black">DOSCODE:7580                 </span><span style="color:navy">jmp     </span>ENDWRDEV
<span style="color:black">DOSCODE:7580 </span>DOS_WRITE       endp
<span style="color:black">DOSCODE:7580
DOSCODE:7583
DOSCODE:7583 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7583
DOSCODE:7583
DOSCODE:7583 </span>GET_IO_SFT      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7583                 </span><span style="color:navy">cmp     ss:</span>CONSWAP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7589                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GetRedir
</span><span style="color:black">DOSCODE:758B
DOSCODE:758B </span><span style="color:gray">GetNormal</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:758B                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:758C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:758D                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:758E                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:758F                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:black">DOSCODE:7592                 </span><span style="color:navy">jb      short </span><span style="color:gray">RET44P
</span><span style="color:black">DOSCODE:7594                 </span><span style="color:navy">mov     si, es
</span><span style="color:black">DOSCODE:7596                 </span><span style="color:navy">mov     ds, si
</span><span style="color:black">DOSCODE:7598                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:759A
DOSCODE:759A </span><span style="color:gray">RET44P</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:759A                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:759B                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:759C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:759D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:759D
DOSCODE:759D </span><span style="color:gray">GetRedir</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:759D                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:75A0                 </span><span style="color:navy">ja      short </span><span style="color:gray">GetNormal
</span><span style="color:black">DOSCODE:75A2                 </span><span style="color:navy">lds     si, ss:</span>CONSFT
<span style="color:black">DOSCODE:75A7                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:75A8
DOSCODE:75A8 </span>get_io_sft_retn<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:75A8                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:75A8 </span>GET_IO_SFT      endp
<span style="color:black">DOSCODE:75A8
DOSCODE:75A9
DOSCODE:75A9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:75A9
DOSCODE:75A9
DOSCODE:75A9 </span>DIRREAD         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:75A9                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:75AB                 </span><span style="color:navy">cmp     </span>DIRSTART<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:75B0                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SubDir
</span><span style="color:black">DOSCODE:75B2                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:75B3                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DoRead
</span><span style="color:black">DOSCODE:75B5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:75B5
DOSCODE:75B5 </span><span style="color:gray">SubDir</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:75B5                 </span><span style="color:navy">mov     dl, al
</span><span style="color:black">DOSCODE:75B7                 </span><span style="color:navy">and     dl, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:75BB                 </span><span style="color:navy">mov     cl, es:[bp+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:75BF                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:black">DOSCODE:75C1
DOSCODE:75C1 </span><span style="color:gray">DoRead</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:75C1                 </span><span style="color:navy">mov     </span>SECCLUSPOS<span style="color:navy">, dl
</span><span style="color:black">DOSCODE:75C5                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:75C7                 </span><span style="color:navy">mov     ah, dl
</span><span style="color:black">DOSCODE:75C9                 </span><span style="color:navy">mov     dx, </span>DIRSEC<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:75CD                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:75D1                 </span><span style="color:navy">mov     dx, </span>DIRSEC
<span style="color:black">DOSCODE:75D5                 </span><span style="color:navy">add     dl, ah
</span><span style="color:black">DOSCODE:75D7                 </span><span style="color:navy">adc     dh, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:75DA                 </span><span style="color:navy">adc     </span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:75DF                 </span><span style="color:navy">mov     bx, </span>CLUSNUM
<span style="color:black">DOSCODE:75E3                 </span><span style="color:navy">mov     </span>NXTCLUSNUM<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:75E7                 </span><span style="color:navy">jcxz    short </span>FIRSTCLUSTER
<span style="color:black">DOSCODE:75E9
DOSCODE:75E9 </span><span style="color:gray">SKPCLLP</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:75E9                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:75EC                 </span><span style="color:navy">jb      short </span>get_io_sft_retn
<span style="color:black">DOSCODE:75EE                 </span><span style="color:navy">xchg    bx, di
</span><span style="color:black">DOSCODE:75F0                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:75F3                 </span><span style="color:navy">jnb     short </span><span style="color:gray">HAVESKIPPED
</span><span style="color:black">DOSCODE:75F5                 </span><span style="color:navy">loop    </span><span style="color:gray">SKPCLLP
</span><span style="color:black">DOSCODE:75F7
DOSCODE:75F7 </span><span style="color:gray">HAVESKIPPED</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:75F7                 </span><span style="color:navy">mov     </span>NXTCLUSNUM<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:75FB                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:75FD                 </span><span style="color:navy">mov     bl, ah
</span><span style="color:black">DOSCODE:75FF                 </span><span style="color:navy">call    </span>FIGREC
<span style="color:black">DOSCODE:7602
DOSCODE:7602 </span>FIRSTCLUSTER<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7602                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:7607                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:7609                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:black">DOSCODE:760C                 </span><span style="color:navy">jb      short </span>get_io_sft_retn
<span style="color:black">DOSCODE:760E
DOSCODE:760E </span>SET_BUF_AS_DIR<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:760E                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:760F                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:7610                 </span><span style="color:navy">lds     si, </span>CURBUF
<span style="color:black">DOSCODE:7614                 </span><span style="color:navy">or      byte ptr [si+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:7618                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:7619                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:761A
DOSCODE:761A </span>dirread_retn<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:761A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:761A </span>DIRREAD         endp
<span style="color:black">DOSCODE:761A
DOSCODE:761B
DOSCODE:761B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:761B
DOSCODE:761B
DOSCODE:761B </span>FATSECRD        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:761B
DOSCODE:761B </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7660 SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:761B
DOSCODE:761B                 </span><span style="color:navy">mov     ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:7621                 </span><span style="color:navy">mov     di, cx
</span><span style="color:black">DOSCODE:7623                 </span><span style="color:navy">mov     cl, es:[bp+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7627                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:762B                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:762D                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:762E
DOSCODE:762E </span><span style="color:gray">NXTFAT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:762E                 </span><span style="color:navy">mov     ss:</span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7635                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7636                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:7637                 </span><span style="color:navy">mov     cx, di
</span><span style="color:black">DOSCODE:7639                 </span><span style="color:navy">call    </span>DSKREAD
<span style="color:black">DOSCODE:763C                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:763D                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:763E                 </span><span style="color:navy">jz      short </span><span style="color:gray">RET41P
</span><span style="color:black">DOSCODE:7640                 </span><span style="color:navy">add     dx, ax
</span><span style="color:black">DOSCODE:7642                 </span><span style="color:navy">loop    </span><span style="color:gray">NXTFAT
</span><span style="color:black">DOSCODE:7644                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:7645                 </span><span style="color:navy">mov     cx, di
</span><span style="color:black">DOSCODE:7645 </span>FATSECRD        endp
<span style="color:black">DOSCODE:7645
DOSCODE:7647
DOSCODE:7647 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7647
DOSCODE:7647
DOSCODE:7647 </span>DREAD           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7647                 </span><span style="color:navy">call    </span>DSKREAD
<span style="color:black">DOSCODE:764A                 </span><span style="color:navy">jz      short </span>dirread_retn
<span style="color:black">DOSCODE:764C                 </span><span style="color:navy">mov     ss:</span>READOP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7652                 </span><span style="color:navy">call    </span>HARDERRRW
<span style="color:black">DOSCODE:7655                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7657                 </span><span style="color:navy">jz      short </span>DREAD
<span style="color:black">DOSCODE:7659                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:765B                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:765C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO_CAR
</span><span style="color:black">DOSCODE:765E                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:765F
DOSCODE:765F </span><span style="color:gray">NO_CAR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:765F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:765F </span>DREAD           endp
<span style="color:black">DOSCODE:765F
DOSCODE:7660 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7660 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR FATSECRD
</span><span style="color:black">DOSCODE:7660
DOSCODE:7660 </span><span style="color:gray">RET41P</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7660                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:7661                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7661 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR FATSECRD
</span><span style="color:black">DOSCODE:7662
DOSCODE:7662 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7662
DOSCODE:7662
DOSCODE:7662 </span>CHECK_WRITE_LOCK proc near              <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7662                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:7667                 </span><span style="color:navy">jz      short </span><span style="color:gray">write_cont
</span><span style="color:black">DOSCODE:7669                 </span><span style="color:navy">call    </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:766C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:766D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:766D
DOSCODE:766D </span><span style="color:gray">write_cont</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:766D                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:766E                 </span><span style="color:navy">or      cx, cx
</span><span style="color:black">DOSCODE:7670                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Not_Truncate
</span><span style="color:black">DOSCODE:7672                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:7673
DOSCODE:7673 </span><span style="color:gray">Not_Truncate</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7673                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">80h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:7675                 </span><span style="color:navy">call    </span>LOCK_CHECK
<span style="color:black">DOSCODE:7678                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7679                 </span><span style="color:navy">jnb     short </span><span style="color:gray">WRITE_OK
</span><span style="color:black">DOSCODE:767B                 </span><span style="color:navy">call    </span>WRITE_LOCK_VIOLATION
<span style="color:black">DOSCODE:767E                 </span><span style="color:navy">jnb     short </span><span style="color:gray">write_cont
</span><span style="color:black">DOSCODE:7680
DOSCODE:7680 </span><span style="color:gray">WRITE_OK</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7680                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7680 </span>CHECK_WRITE_LOCK endp
<span style="color:black">DOSCODE:7680
DOSCODE:7681
DOSCODE:7681 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7681
DOSCODE:7681
DOSCODE:7681 </span>CHECK_READ_LOCK proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7681                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:7686                 </span><span style="color:navy">jz      short </span><span style="color:gray">do_retry
</span><span style="color:black">DOSCODE:7688                 </span><span style="color:navy">call    </span>SET_ACC_ERR
<span style="color:black">DOSCODE:768B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:768C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:768C
DOSCODE:768C </span><span style="color:gray">do_retry</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:768C                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:768E                 </span><span style="color:navy">call    </span>LOCK_CHECK
<span style="color:black">DOSCODE:7691                 </span><span style="color:navy">jnb     short </span><span style="color:gray">READLOCK_OK
</span><span style="color:black">DOSCODE:7693                 </span><span style="color:navy">call    </span>READ_LOCK_VIOLATION
<span style="color:black">DOSCODE:7696                 </span><span style="color:navy">jnb     short </span><span style="color:gray">do_retry
</span><span style="color:black">DOSCODE:7698
DOSCODE:7698 </span><span style="color:gray">READLOCK_OK</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7698                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7698 </span>CHECK_READ_LOCK endp
<span style="color:black">DOSCODE:7698
DOSCODE:7699
DOSCODE:7699 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7699
DOSCODE:7699
DOSCODE:7699 </span>DSKREAD         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7699                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:769A                 </span><span style="color:navy">mov     ah, es:[bp+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:769E                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:76A2                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:76A3                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:76A4                 </span><span style="color:navy">call    </span>SETREAD
<span style="color:black">DOSCODE:76A7                 </span><span style="color:navy">jmp     short </span>DODSKOP
<span style="color:black">DOSCODE:76A7 </span>DSKREAD         endp
<span style="color:black">DOSCODE:76A7
DOSCODE:76A9
DOSCODE:76A9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:76A9
DOSCODE:76A9
DOSCODE:76A9 </span>DWRITE          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:76A9                 </span><span style="color:navy">call    </span>DSKWRITE
<span style="color:black">DOSCODE:76AC                 </span><span style="color:navy">jz      short </span><span style="color:gray">dw_ret_label
</span><span style="color:black">DOSCODE:76AE                 </span><span style="color:navy">mov     ss:</span>READOP<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:76B4                 </span><span style="color:navy">call    </span>HARDERRRW
<span style="color:black">DOSCODE:76B7                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:76B9                 </span><span style="color:navy">jz      short </span>DWRITE
<span style="color:black">DOSCODE:76BB                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:76BD                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:76BE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">dw_ret_label
</span><span style="color:black">DOSCODE:76C0                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:76C1
DOSCODE:76C1 </span><span style="color:gray">dw_ret_label</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:76C1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:76C1 </span>DWRITE          endp
<span style="color:black">DOSCODE:76C1
DOSCODE:76C2
DOSCODE:76C2 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:76C2
DOSCODE:76C2
DOSCODE:76C2 </span>DSKWRITE        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:76C2                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:76C3                 </span><span style="color:navy">mov     ah, es:[bp+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:76C7                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:76CB                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:76CC                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:76CD                 </span><span style="color:navy">call    </span>SETWRITE
<span style="color:black">DOSCODE:76D0
DOSCODE:76D0 </span>DODSKOP<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:76D0                 </span><span style="color:navy">mov     cx, ds
</span><span style="color:black">DOSCODE:76D2                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:76D3                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:76D4                 </span><span style="color:navy">lds     si, ds:[bp+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:76D8                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:76DB                 </span><span style="color:navy">mov     ds, cx
</span><span style="color:black">DOSCODE:76DD                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:76DE                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:76DF                 </span><span style="color:navy">mov     cx, word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:76E4                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:76E5                 </span><span style="color:navy">sub     cx, di
</span><span style="color:black">DOSCODE:76E7                 </span><span style="color:navy">neg     cx
</span><span style="color:black">DOSCODE:76E9                 </span><span style="color:navy">mov     ax, ss:</span>DEVCALL_REQSTAT
<span style="color:black">DOSCODE:76ED                 </span><span style="color:navy">test    ax, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:76F0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:76F0 </span>DSKWRITE        endp
<span style="color:black">DOSCODE:76F0
DOSCODE:76F1
DOSCODE:76F1 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:76F1
DOSCODE:76F1
DOSCODE:76F1 </span>HARDERRRW       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:76F1                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0Fh
</span><span style="color:black">DOSCODE:76F3                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DO_ERR
</span><span style="color:black">DOSCODE:76F5                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:76F6                 </span><span style="color:navy">mov     ax, word ptr ss:</span>CALLVIDRW
<span style="color:black">DOSCODE:76FA                 </span><span style="color:navy">mov     word ptr ss:</span>EXTERRPT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:76FE                 </span><span style="color:navy">mov     ax, word ptr ss:</span>CALLVIDRW<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7702                 </span><span style="color:navy">mov     word ptr ss:</span>EXTERRPT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7706                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:7707
DOSCODE:7707 </span><span style="color:gray">DO_ERR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7707                 </span><span style="color:navy">call    </span>HARDERR
<span style="color:black">DOSCODE:770A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:770A </span>HARDERRRW       endp
<span style="color:black">DOSCODE:770A
DOSCODE:770B
DOSCODE:770B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:770B
DOSCODE:770B
DOSCODE:770B </span>SETUP           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:770B                 </span><span style="color:navy">lds     si, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:770F                 </span><span style="color:navy">mov     word ptr ss:</span>THISDPB<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:7714                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7715                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7716                 </span><span style="color:navy">mov     word ptr </span>THISDPB<span style="color:navy">, si
</span><span style="color:black">DOSCODE:771A                 </span><span style="color:navy">mov     bx, word ptr </span>DMAADD
<span style="color:black">DOSCODE:771E                 </span><span style="color:navy">mov     </span>NEXTADD<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:7722                 </span><span style="color:navy">mov     </span>TRANS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7727                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:772B                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:772F                 </span><span style="color:navy">mov     </span>BYTPOS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7733                 </span><span style="color:navy">mov     </span>BYTPOS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7736                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">8080h
</span><span style="color:black">DOSCODE:773C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOSETSTUFF
</span><span style="color:black">DOSCODE:773E                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:773F                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:7743                 </span><span style="color:navy">mov     bl, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7747                 </span><span style="color:navy">mov     </span>THISDRV<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:774B                 </span><span style="color:navy">mov     bx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:774F                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7750                 </span><span style="color:navy">call    </span>DIV32
<span style="color:black">DOSCODE:7753                 </span><span style="color:navy">mov     </span>BYTSECPOS<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7757                 </span><span style="color:navy">mov     </span>SECPOS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:775A                 </span><span style="color:navy">mov     </span>SECPOS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, cx
</span><span style="color:black">DOSCODE:775E                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:7760                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:black">DOSCODE:7762                 </span><span style="color:navy">and     bl, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7766                 </span><span style="color:navy">mov     </span>SECCLUSPOS<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:776A                 </span><span style="color:navy">call    </span>SHR32
<span style="color:black">DOSCODE:776D                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:776E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">EOFERR
</span><span style="color:black">DOSCODE:7770                 </span><span style="color:navy">cmp     ax, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7774                 </span><span style="color:navy">ja      short </span><span style="color:gray">EOFERR
</span><span style="color:black">DOSCODE:7776                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7779                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:777A
DOSCODE:777A </span><span style="color:gray">NOSETSTUFF</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:777A                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:black">DOSCODE:777C                 </span><span style="color:navy">add     ax, word ptr </span>DMAADD
<span style="color:black">DOSCODE:7780                 </span><span style="color:navy">jnb     short </span><span style="color:gray">setup_OK
</span><span style="color:black">DOSCODE:7782                 </span><span style="color:navy">mov     ax, word ptr </span>DMAADD
<span style="color:black">DOSCODE:7785                 </span><span style="color:navy">neg     ax
</span><span style="color:black">DOSCODE:7787                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NoDec
</span><span style="color:black">DOSCODE:7789                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:778A
DOSCODE:778A </span><span style="color:gray">NoDec</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:778A                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:778C                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">NOROOM
</span><span style="color:black">DOSCODE:778E
DOSCODE:778E </span><span style="color:gray">setup_OK</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:778E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:778F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:778F
DOSCODE:778F </span><span style="color:gray">EOFERR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:778F                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7790                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:7792
DOSCODE:7792 </span><span style="color:gray">NOROOM</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7792                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7793                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7794                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7794 </span>SETUP           endp
<span style="color:black">DOSCODE:7794
DOSCODE:7795
DOSCODE:7795 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7795
DOSCODE:7795
DOSCODE:7795 </span>BREAKDOWN       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7795                 </span><span style="color:navy">mov     ax, </span>BYTSECPOS
<span style="color:black">DOSCODE:7798                 </span><span style="color:navy">mov     bx, cx
</span><span style="color:black">DOSCODE:779A                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:779C                 </span><span style="color:navy">jz      short </span><span style="color:gray">SAVFIR
</span><span style="color:black">DOSCODE:779E                 </span><span style="color:navy">sub     ax, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:77A2                 </span><span style="color:navy">neg     ax
</span><span style="color:black">DOSCODE:77A4                 </span><span style="color:navy">sub     bx, ax
</span><span style="color:black">DOSCODE:77A6                 </span><span style="color:navy">jnb     short </span><span style="color:gray">SAVFIR
</span><span style="color:black">DOSCODE:77A8                 </span><span style="color:navy">add     ax, bx
</span><span style="color:black">DOSCODE:77AA                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:77AC
DOSCODE:77AC </span><span style="color:gray">SAVFIR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:77AC                 </span><span style="color:navy">mov     </span>BYTCNT1<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:77AF                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:77B1                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:77B3                 </span><span style="color:navy">div     word ptr es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:77B7                 </span><span style="color:navy">mov     </span>SECCNT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:77BA                 </span><span style="color:navy">mov     </span>BYTCNT2<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:77BE
DOSCODE:77BE </span>_RET45<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:77BE                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:77BE </span>BREAKDOWN       endp
<span style="color:black">DOSCODE:77BE
DOSCODE:77BF
DOSCODE:77BF </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:77BF
DOSCODE:77BF
DOSCODE:77BF </span>READ_LOCK_VIOLATION proc near           <span style="color:green">; ...
</span><span style="color:black">DOSCODE:77BF                 </span><span style="color:navy">mov     </span>READOP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:77C4
DOSCODE:77C4 </span>ERR_ON_CHECK<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:77C4                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:77C9                 </span><span style="color:navy">jnz     short </span><span style="color:gray">HARD_ERR
</span><span style="color:black">DOSCODE:77CB                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:77CC                 </span><span style="color:navy">mov     cl, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:77D0                 </span><span style="color:navy">and     cl, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:77D3                 </span><span style="color:navy">cmp     cl, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:77D6                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:77D7                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO_HARD_ERR
</span><span style="color:black">DOSCODE:77D9
DOSCODE:77D9 </span><span style="color:gray">HARD_ERR</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:77D9                 </span><span style="color:navy">call    </span>LOCK_VIOLATION
<span style="color:black">DOSCODE:77DC                 </span><span style="color:navy">jnb     short </span>_RET45
<span style="color:black">DOSCODE:77DE
DOSCODE:77DE </span><span style="color:gray">NO_HARD_ERR</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:77DE                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:77E0                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">21h </span><span style="color:gray">; &#039;!&#039;
</span><span style="color:black">DOSCODE:77E3                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:77E4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:77E4 </span>READ_LOCK_VIOLATION endp
<span style="color:black">DOSCODE:77E4
DOSCODE:77E5
DOSCODE:77E5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:77E5
DOSCODE:77E5
DOSCODE:77E5 </span>WRITE_LOCK_VIOLATION proc near          <span style="color:green">; ...
</span><span style="color:black">DOSCODE:77E5                 </span><span style="color:navy">mov     </span>READOP<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:77EA                 </span><span style="color:navy">jmp     short </span>ERR_ON_CHECK
<span style="color:black">DOSCODE:77EA </span>WRITE_LOCK_VIOLATION endp
<span style="color:black">DOSCODE:77EA
DOSCODE:77EC
DOSCODE:77EC </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:77EC
DOSCODE:77EC
DOSCODE:77EC </span>DISKREAD        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:77EC
DOSCODE:77EC </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7829 SIZE 00000005 BYTES
</span><span style="color:black">DOSCODE:77EC </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7837 SIZE 0000008B BYTES
</span><span style="color:black">DOSCODE:77EC </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7A4E SIZE 0000000B BYTES
</span><span style="color:black">DOSCODE:77EC
DOSCODE:77EC                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:77F0                 </span><span style="color:navy">mov     bx, es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:77F4                 </span><span style="color:navy">sub     ax, </span>BYTPOS
<span style="color:black">DOSCODE:77F8                 </span><span style="color:navy">sbb     bx, </span>BYTPOS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:77FC                 </span><span style="color:navy">jb      short </span><span style="color:gray">RDERR
</span><span style="color:black">DOSCODE:77FE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ENUF
</span><span style="color:black">DOSCODE:7800                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:7802                 </span><span style="color:navy">jz      short </span><span style="color:gray">RDERR
</span><span style="color:black">DOSCODE:7804                 </span><span style="color:navy">cmp     ax, cx
</span><span style="color:black">DOSCODE:7806                 </span><span style="color:navy">jnb     short </span><span style="color:gray">ENUF
</span><span style="color:black">DOSCODE:7808                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:780A
DOSCODE:780A </span><span style="color:gray">ENUF</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:780A                 </span><span style="color:navy">call    </span>CHECK_READ_LOCK
<span style="color:black">DOSCODE:780D                 </span><span style="color:navy">jnb     short </span><span style="color:gray">_READ_OK
</span><span style="color:black">DOSCODE:780F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7810 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7810
DOSCODE:7810 </span><span style="color:gray">_READ_OK</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7810                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:7814                 </span><span style="color:navy">call    </span>BREAKDOWN
<span style="color:black">DOSCODE:7817                 </span><span style="color:navy">mov     cx, </span>CLUSNUM
<span style="color:black">DOSCODE:781B                 </span><span style="color:navy">call    </span>FNDCLUS
<span style="color:black">DOSCODE:781E                 </span><span style="color:navy">jb      short </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:7820                 </span><span style="color:navy">or      cx, cx
</span><span style="color:black">DOSCODE:7822                 </span><span style="color:navy">jz      short </span><span style="color:gray">SKIPERR
</span><span style="color:black">DOSCODE:7824
DOSCODE:7824 </span><span style="color:gray">RDERR</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7824                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0Eh
</span><span style="color:black">DOSCODE:7826                 </span><span style="color:navy">jmp     </span><span style="color:gray">WRTERR22
</span><span style="color:black">DOSCODE:7826 </span>DISKREAD        endp
<span style="color:black">DOSCODE:7826
DOSCODE:7829 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7829 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DISKREAD
</span><span style="color:black">DOSCODE:7829
DOSCODE:7829 </span><span style="color:gray">SETSFTJ2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7829                 </span><span style="color:navy">jmp     </span>SETSFT
<span style="color:black">DOSCODE:782C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:782C
DOSCODE:782C </span><span style="color:gray">CANOT_READ</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:782C                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:782D                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:782D </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DISKREAD
</span><span style="color:black">DOSCODE:782E
DOSCODE:782E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:782E
DOSCODE:782E
DOSCODE:782E </span>SET_ACC_ERR_DS  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:782E                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:782F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:782F </span>SET_ACC_ERR_DS  endp
<span style="color:black">DOSCODE:782F
DOSCODE:7830
DOSCODE:7830 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7830
DOSCODE:7830
DOSCODE:7830 </span>SET_ACC_ERR     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7830                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:7832                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:7835                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7836                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7836 </span>SET_ACC_ERR     endp
<span style="color:black">DOSCODE:7836
DOSCODE:7837 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7837 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DISKREAD
</span><span style="color:black">DOSCODE:7837
DOSCODE:7837 </span><span style="color:gray">SKIPERR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7837                 </span><span style="color:navy">mov     </span>LASTPOS<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:783B                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:783F                 </span><span style="color:navy">cmp     </span>BYTCNT1<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7844                 </span><span style="color:navy">jz      short </span><span style="color:gray">RDMID
</span><span style="color:black">DOSCODE:7846                 </span><span style="color:navy">call    </span>BUFRD
<span style="color:black">DOSCODE:7849                 </span><span style="color:navy">jb      short </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:784B
DOSCODE:784B </span><span style="color:gray">RDMID</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:784B                 </span><span style="color:navy">cmp     </span>SECCNT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7850                 </span><span style="color:navy">jz      short </span><span style="color:gray">RDLAST
</span><span style="color:black">DOSCODE:7852                 </span><span style="color:navy">call    </span>NEXTSEC
<span style="color:black">DOSCODE:7855                 </span><span style="color:navy">jb      short </span><span style="color:gray">SETSFTJ2
</span><span style="color:black">DOSCODE:7857                 </span><span style="color:navy">mov     </span>TRANS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:785C                 </span><span style="color:navy">mov     dl, </span>SECCLUSPOS
<span style="color:black">DOSCODE:7860                 </span><span style="color:navy">mov     cx, </span>SECCNT
<span style="color:black">DOSCODE:7864                 </span><span style="color:navy">mov     bx, </span>CLUSNUM
<span style="color:black">DOSCODE:7868
DOSCODE:7868 </span><span style="color:gray">RDLP</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7868                 </span><span style="color:navy">call    </span>OPTIMIZE
<span style="color:black">DOSCODE:786B                 </span><span style="color:navy">jb      short </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:786D                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:786E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:786F                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:7870                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">38h </span><span style="color:gray">; &#039;8&#039;
</span><span style="color:black">DOSCODE:7875                 </span><span style="color:navy">mov     ds, word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7879                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:787A                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:787B                 </span><span style="color:navy">call    </span>SET_RQ_SC_PARMS
<span style="color:black">DOSCODE:787E                 </span><span style="color:navy">call    </span>DREAD
<span style="color:black">DOSCODE:7881                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7882                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:7883                 </span><span style="color:navy">pop     ss:</span>TEMP_VAR
<span style="color:black">DOSCODE:7888                 </span><span style="color:navy">jb      short </span><span style="color:gray">CANOT_READ
</span><span style="color:black">DOSCODE:788A                 </span><span style="color:navy">mov     ss:</span>TEMP_VAR2<span style="color:navy">, ds
</span><span style="color:black">DOSCODE:788F                 </span><span style="color:navy">call    </span>DskRdBufScan
<span style="color:black">DOSCODE:7892                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7893                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7894                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7895                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7896                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">RDLAST
</span><span style="color:black">DOSCODE:7898                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:789B                 </span><span style="color:navy">jnb     short </span>SETSFT
<span style="color:black">DOSCODE:789D                 </span><span style="color:navy">mov     dl, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:789F                 </span><span style="color:navy">inc     </span>LASTPOS
<span style="color:black">DOSCODE:78A3                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RDLP
</span><span style="color:black">DOSCODE:78A5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:78A5
DOSCODE:78A5 </span><span style="color:gray">RDLAST</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:78A5                 </span><span style="color:navy">mov     ax, </span>BYTCNT2
<span style="color:black">DOSCODE:78A8                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:78AA                 </span><span style="color:navy">jz      short </span>SETSFT
<span style="color:black">DOSCODE:78AC                 </span><span style="color:navy">mov     </span>BYTCNT1<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:78AF                 </span><span style="color:navy">call    </span>NEXTSEC
<span style="color:black">DOSCODE:78B2                 </span><span style="color:navy">jb      short </span>SETSFT
<span style="color:black">DOSCODE:78B4                 </span><span style="color:navy">mov     </span>BYTSECPOS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:78BA                 </span><span style="color:navy">call    </span>BUFRD
<span style="color:black">DOSCODE:78BD                 </span><span style="color:navy">jnb     short </span>SETSFT
<span style="color:black">DOSCODE:78BF                 </span><span style="color:navy">jmp     </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:78BF </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DISKREAD
</span><span style="color:black">DOSCODE:78C2
DOSCODE:78C2 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:78C2
DOSCODE:78C2
DOSCODE:78C2 </span>SETSFT          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:78C2                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:78C6
DOSCODE:78C6 </span>SETCLUS<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:78C6                 </span><span style="color:navy">mov     cx, </span>NEXTADD
<span style="color:black">DOSCODE:78CA                 </span><span style="color:navy">sub     cx, word ptr </span>DMAADD
<span style="color:black">DOSCODE:78CE                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:78D3                 </span><span style="color:navy">jnz     short </span>ADDREC
<span style="color:black">DOSCODE:78D5                 </span><span style="color:navy">mov     ax, </span>CLUSNUM
<span style="color:black">DOSCODE:78D8                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">35h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:78DC                 </span><span style="color:navy">mov     ax, </span>LASTPOS
<span style="color:black">DOSCODE:78DF                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">19h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:78DF </span>SETSFT          endp
<span style="color:black">DOSCODE:78DF
DOSCODE:78E3
DOSCODE:78E3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:78E3
DOSCODE:78E3
DOSCODE:78E3 </span>ADDREC          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:78E3                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">RET28
</span><span style="color:black">DOSCODE:78E5                 </span><span style="color:navy">add     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:78E9                 </span><span style="color:navy">adc     word ptr es:[di+</span><span style="color:#ff8000">17h</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:78EE
DOSCODE:78EE </span><span style="color:gray">RET28</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:78EE                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:78EF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:78EF </span>ADDREC          endp
<span style="color:black">DOSCODE:78EF
DOSCODE:78F0
DOSCODE:78F0 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:78F0
DOSCODE:78F0
DOSCODE:78F0 </span>DskRdBufScan    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:78F0                 </span><span style="color:navy">cmp     ss:</span>DirtyBufferCount<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:78F6                 </span><span style="color:navy">jz      short </span><span style="color:gray">bufx
</span><span style="color:black">DOSCODE:78F8                 </span><span style="color:navy">mov     bx, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:78FD                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:78FF                 </span><span style="color:navy">add     cx, dx
</span><span style="color:black">DOSCODE:7901                 </span><span style="color:navy">adc     si, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7904                 </span><span style="color:navy">call    </span>GETCURHEAD
<span style="color:black">DOSCODE:7907                 </span><span style="color:navy">mov     ax, [di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:790A                 </span><span style="color:navy">mov     ss:</span>FIRST_BUFF_ADDR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:790E                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7912
DOSCODE:7912 </span><span style="color:gray">bufq</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7912                 </span><span style="color:navy">cmp     al, [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7915                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq1
</span><span style="color:black">DOSCODE:7917                 </span><span style="color:navy">cmp     bx, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:791A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq01
</span><span style="color:black">DOSCODE:791C                 </span><span style="color:navy">cmp     dx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:791F
DOSCODE:791F </span><span style="color:gray">bufq01</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:791F                 </span><span style="color:navy">ja      short </span><span style="color:gray">bufq1
</span><span style="color:black">DOSCODE:7921                 </span><span style="color:navy">cmp     si, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7924                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq02
</span><span style="color:black">DOSCODE:7926                 </span><span style="color:navy">cmp     cx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7929
DOSCODE:7929 </span><span style="color:gray">bufq02</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7929                 </span><span style="color:navy">ja      short </span><span style="color:gray">bufq2
</span><span style="color:black">DOSCODE:792B
DOSCODE:792B </span><span style="color:gray">bufq1</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:792B                 </span><span style="color:navy">cmp     di, ss:</span>FIRST_BUFF_ADDR
<span style="color:black">DOSCODE:7930                 </span><span style="color:navy">mov     di, [di]
</span><span style="color:black">DOSCODE:7932                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq
</span><span style="color:black">DOSCODE:7934
DOSCODE:7934 </span><span style="color:gray">bufx</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7934                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7935 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7935
DOSCODE:7935 </span><span style="color:gray">bufq2</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7935                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:7936                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:793A                 </span><span style="color:navy">jz      short </span><span style="color:gray">bufq3
</span><span style="color:black">DOSCODE:793C                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:793D                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:793E                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:793F                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:7940                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:7941                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:7943                 </span><span style="color:navy">sub     ax, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7946                 </span><span style="color:navy">neg     ax
</span><span style="color:black">DOSCODE:7948                 </span><span style="color:navy">lea     si, [di+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:794B                 </span><span style="color:navy">mov     cx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:794F                 </span><span style="color:navy">mul     cx
</span><span style="color:black">DOSCODE:7951                 </span><span style="color:navy">mov     di, ss:</span>TEMP_VAR
<span style="color:black">DOSCODE:7956                 </span><span style="color:navy">add     di, ax
</span><span style="color:black">DOSCODE:7958                 </span><span style="color:navy">mov     es, ss:</span>TEMP_VAR2
<span style="color:black">DOSCODE:795D                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:795F                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:7961                 </span><span style="color:navy">adc     cx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7964                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:7966                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7967                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:7968                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:7969                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:796A                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:796B
DOSCODE:796B </span><span style="color:gray">bufq3</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:796B                 </span><span style="color:navy">mov     ax, di
</span><span style="color:black">DOSCODE:796D                 </span><span style="color:navy">call    </span>SCANPLACE
<span style="color:black">DOSCODE:7970                 </span><span style="color:navy">cmp     ax, ss:</span>FIRST_BUFF_ADDR
<span style="color:black">DOSCODE:7975                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:7976                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq
</span><span style="color:black">DOSCODE:7978                 </span><span style="color:navy">jmp     short </span><span style="color:gray">bufx
</span><span style="color:black">DOSCODE:7978 </span>DskRdBufScan    endp
<span style="color:black">DOSCODE:7978
DOSCODE:797A
DOSCODE:797A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:797A
DOSCODE:797A
DOSCODE:797A </span>DISKWRITE       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:797A
DOSCODE:797A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7A40 SIZE 0000000E BYTES
</span><span style="color:black">DOSCODE:797A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7A59 SIZE 0000016E BYTES
</span><span style="color:black">DOSCODE:797A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7BCB SIZE 00000043 BYTES
</span><span style="color:black">DOSCODE:797A
DOSCODE:797A                 </span><span style="color:navy">call    </span>CHECK_WRITE_LOCK
<span style="color:black">DOSCODE:797D                 </span><span style="color:navy">jnb     short </span><span style="color:gray">_WRITE_OK
</span><span style="color:black">DOSCODE:797F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7980 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7980
DOSCODE:7980 </span><span style="color:gray">WRTEOFJ</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7980                 </span><span style="color:navy">jmp     </span><span style="color:gray">WRTEOF
</span><span style="color:black">DOSCODE:7983 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7983
DOSCODE:7983 </span><span style="color:gray">_WRITE_OK</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7983                 </span><span style="color:navy">and     word ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">0BFBFh
</span><span style="color:black">DOSCODE:7989                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:798D                 </span><span style="color:navy">mov     </span>TEMP_VAR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7990                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7994                 </span><span style="color:navy">mov     </span>TEMP_VAR2<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7997                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:799B                 </span><span style="color:navy">call    </span>BREAKDOWN
<span style="color:black">DOSCODE:799E                 </span><span style="color:navy">mov     ax, </span>BYTPOS
<span style="color:black">DOSCODE:79A1                 </span><span style="color:navy">mov     dx, </span>BYTPOS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:79A5                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">WRTEOFJ
</span><span style="color:black">DOSCODE:79A7                 </span><span style="color:navy">add     ax, cx
</span><span style="color:black">DOSCODE:79A9                 </span><span style="color:navy">adc     dx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:79AC                 </span><span style="color:navy">mov     bx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:79B0                 </span><span style="color:navy">call    </span>DIV32
<span style="color:black">DOSCODE:79B3                 </span><span style="color:navy">mov     si, ax
</span><span style="color:black">DOSCODE:79B5                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:79B9                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:79BB                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:79BC                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:79BE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CALCLUS
</span><span style="color:black">DOSCODE:79C0                 </span><span style="color:navy">sub     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:79C3                 </span><span style="color:navy">sbb     dx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:79C6
DOSCODE:79C6 </span><span style="color:gray">CALCLUS</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:79C6                 </span><span style="color:navy">call    </span>SHR32
<span style="color:black">DOSCODE:79C9                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:79CA                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:79CB                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:79CC                 </span><span style="color:navy">mov     dx, </span>TEMP_VAR2
<span style="color:black">DOSCODE:79D0                 </span><span style="color:navy">mov     ax, </span>TEMP_VAR
<span style="color:black">DOSCODE:79D3                 </span><span style="color:navy">call    </span>DIV32
<span style="color:black">DOSCODE:79D6                 </span><span style="color:navy">mov     </span>TEMP_VAR2<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:79DA                 </span><span style="color:navy">mov     </span>VALSEC<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, cx
</span><span style="color:black">DOSCODE:79DE                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:79E0                 </span><span style="color:navy">mov     bx, si
</span><span style="color:black">DOSCODE:79E2                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:79E4                 </span><span style="color:navy">jz      short </span><span style="color:gray">NORND
</span><span style="color:black">DOSCODE:79E6                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:79E9                 </span><span style="color:navy">adc     </span>VALSEC<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:79EE
DOSCODE:79EE </span><span style="color:gray">NORND</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:79EE                 </span><span style="color:navy">mov     </span>VALSEC<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:79F1                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:79F3                 </span><span style="color:navy">mov     </span>GROWCNT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:79F6                 </span><span style="color:navy">mov     </span>GROWCNT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:79F9                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:79FA                 </span><span style="color:navy">mov     di, </span>HIGH_SECTOR
<span style="color:black">DOSCODE:79FE                 </span><span style="color:navy">cmp     di, </span>TEMP_VAR2
<span style="color:black">DOSCODE:7A02                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOGROW
</span><span style="color:black">DOSCODE:7A04                 </span><span style="color:navy">jz      short </span><span style="color:gray">lowsec
</span><span style="color:black">DOSCODE:7A06                 </span><span style="color:navy">sub     bx, cx
</span><span style="color:black">DOSCODE:7A08                 </span><span style="color:navy">sbb     di, </span>TEMP_VAR2
<span style="color:black">DOSCODE:7A0C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">yesgrow
</span><span style="color:black">DOSCODE:7A0E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7A0E
DOSCODE:7A0E </span><span style="color:gray">lowsec</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A0E                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7A11                 </span><span style="color:navy">sub     bx, cx
</span><span style="color:black">DOSCODE:7A13                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOGROW
</span><span style="color:black">DOSCODE:7A15                 </span><span style="color:navy">jz      short </span><span style="color:gray">TESTTAIL
</span><span style="color:black">DOSCODE:7A17
DOSCODE:7A17 </span><span style="color:gray">yesgrow</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A17                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:black">DOSCODE:7A19                 </span><span style="color:navy">xchg    ax, bx
</span><span style="color:black">DOSCODE:7A1A                 </span><span style="color:navy">mul     word ptr es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7A1E                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7A22                 </span><span style="color:navy">mov     </span>TEMP_VAR2<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7A25                 </span><span style="color:navy">mov     ax, di
</span><span style="color:black">DOSCODE:7A27                 </span><span style="color:navy">mul     word ptr es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7A2B                 </span><span style="color:navy">add     ax, </span>HIGH_SECTOR
<span style="color:black">DOSCODE:7A2F                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:7A31                 </span><span style="color:navy">mov     ax, </span>TEMP_VAR2
<span style="color:black">DOSCODE:7A34                 </span><span style="color:navy">sub     ax, cx
</span><span style="color:black">DOSCODE:7A36                 </span><span style="color:navy">sbb     dx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7A39                 </span><span style="color:navy">add     ax, bx
</span><span style="color:black">DOSCODE:7A3B                 </span><span style="color:navy">adc     dx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7A3E                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SETGRW
</span><span style="color:black">DOSCODE:7A3E </span>DISKWRITE       endp
<span style="color:black">DOSCODE:7A3E
DOSCODE:7A40 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7A40 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DISKWRITE
</span><span style="color:black">DOSCODE:7A40
DOSCODE:7A40 </span><span style="color:gray">HAVSTART</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A40                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:7A42                 </span><span style="color:navy">call    </span>SKPCLP
<span style="color:black">DOSCODE:7A45                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">DOWRTJ
</span><span style="color:black">DOSCODE:7A47                 </span><span style="color:navy">call    </span>ALLOCATE
<span style="color:black">DOSCODE:7A4A                 </span><span style="color:navy">jnb     short </span><span style="color:gray">DOWRTJ
</span><span style="color:black">DOSCODE:7A4C
DOSCODE:7A4C </span><span style="color:gray">WRTERR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A4C                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0Fh
</span><span style="color:black">DOSCODE:7A4C </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DISKWRITE
</span><span style="color:black">DOSCODE:7A4E </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DISKREAD
</span><span style="color:black">DOSCODE:7A4E
DOSCODE:7A4E </span><span style="color:gray">WRTERR22</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A4E                 </span><span style="color:navy">mov     al, </span>THISDRV
<span style="color:black">DOSCODE:7A51                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:7A53                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7A57                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7A58                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7A58 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DISKREAD
</span><span style="color:black">DOSCODE:7A59 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7A59 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DISKWRITE
</span><span style="color:black">DOSCODE:7A59
DOSCODE:7A59 </span><span style="color:gray">DOWRTJ</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A59                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DOWRT
</span><span style="color:black">DOSCODE:7A5B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7A5B
DOSCODE:7A5B </span><span style="color:gray">ACC_ERRWJ</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A5B                 </span><span style="color:navy">jmp     </span><span style="color:gray">SET_ACC_ERRW
</span><span style="color:black">DOSCODE:7A5E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7A5E
DOSCODE:7A5E </span><span style="color:gray">TESTTAIL</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A5E                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:black">DOSCODE:7A60                 </span><span style="color:navy">jbe     short </span><span style="color:gray">NOGROW
</span><span style="color:black">DOSCODE:7A62                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:7A64
DOSCODE:7A64 </span><span style="color:gray">SETGRW</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A64                 </span><span style="color:navy">mov     </span>GROWCNT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7A67                 </span><span style="color:navy">mov     </span>GROWCNT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7A6B
DOSCODE:7A6B </span><span style="color:gray">NOGROW</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A6B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:7A6C                 </span><span style="color:navy">mov     cx, </span>CLUSNUM
<span style="color:black">DOSCODE:7A70                 </span><span style="color:navy">call    </span>FNDCLUS
<span style="color:black">DOSCODE:7A73                 </span><span style="color:navy">jb      short </span><span style="color:gray">ACC_ERRWJ
</span><span style="color:black">DOSCODE:7A75                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:7A79                 </span><span style="color:navy">mov     </span>LASTPOS<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7A7D                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:black">DOSCODE:7A7F                 </span><span style="color:navy">jz      short </span><span style="color:gray">DOWRT
</span><span style="color:black">DOSCODE:7A81                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">HAVSTART
</span><span style="color:black">DOSCODE:7A83                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7A84                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:7A86                 </span><span style="color:navy">call    </span>ALLOCATE
<span style="color:black">DOSCODE:7A89                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7A8A                 </span><span style="color:navy">jb      short </span><span style="color:gray">WRTERR
</span><span style="color:black">DOSCODE:7A8C                 </span><span style="color:navy">mov     dx, </span>LASTPOS
<span style="color:black">DOSCODE:7A90                 </span><span style="color:navy">inc     dx
</span><span style="color:black">DOSCODE:7A91                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:7A92                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOSKIP
</span><span style="color:black">DOSCODE:7A94                 </span><span style="color:navy">call    </span>SKPCLP
<span style="color:black">DOSCODE:7A97                 </span><span style="color:navy">jb      short </span><span style="color:gray">ACC_ERRWJ
</span><span style="color:black">DOSCODE:7A99
DOSCODE:7A99 </span><span style="color:gray">NOSKIP</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7A99                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:7A9D                 </span><span style="color:navy">mov     </span>LASTPOS<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7AA1
DOSCODE:7AA1 </span><span style="color:gray">DOWRT</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7AA1                 </span><span style="color:navy">cmp     </span>BYTCNT1<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7AA6                 </span><span style="color:navy">jz      short </span><span style="color:gray">WRTMID
</span><span style="color:black">DOSCODE:7AA8                 </span><span style="color:navy">mov     bx, </span>CLUSNUM
<span style="color:black">DOSCODE:7AAC                 </span><span style="color:navy">call    </span>BUFWRT
<span style="color:black">DOSCODE:7AAF                 </span><span style="color:navy">jb      short </span><span style="color:gray">ACC_ERRWJ
</span><span style="color:black">DOSCODE:7AB1
DOSCODE:7AB1 </span><span style="color:gray">WRTMID</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7AB1                 </span><span style="color:navy">mov     ax, </span>SECCNT
<span style="color:black">DOSCODE:7AB4                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:7AB6                 </span><span style="color:navy">jz      short </span><span style="color:gray">WRTLAST
</span><span style="color:black">DOSCODE:7AB8                 </span><span style="color:navy">add     </span>SECPOS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7ABC                 </span><span style="color:navy">adc     </span>SECPOS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7AC1                 </span><span style="color:navy">call    </span>NEXTSEC
<span style="color:black">DOSCODE:7AC4                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRW
</span><span style="color:black">DOSCODE:7AC6                 </span><span style="color:navy">mov     </span>TRANS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7ACB                 </span><span style="color:navy">mov     dl, </span>SECCLUSPOS
<span style="color:black">DOSCODE:7ACF                 </span><span style="color:navy">mov     bx, </span>CLUSNUM
<span style="color:black">DOSCODE:7AD3                 </span><span style="color:navy">mov     cx, </span>SECCNT
<span style="color:black">DOSCODE:7AD7
DOSCODE:7AD7 </span><span style="color:gray">WRTLP</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7AD7                 </span><span style="color:navy">call    </span>OPTIMIZE
<span style="color:black">DOSCODE:7ADA                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRW
</span><span style="color:black">DOSCODE:7ADC                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:7ADD                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:7ADE                 </span><span style="color:navy">call    </span>DskWrtBufPurge
<span style="color:black">DOSCODE:7AE1                 </span><span style="color:navy">mov     ds, word ptr ss:</span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7AE6                 </span><span style="color:navy">mov     ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">38h </span><span style="color:gray">; &#039;8&#039;
</span><span style="color:black">DOSCODE:7AEC
DOSCODE:7AEC </span><span style="color:gray">DWRITE_LUP</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7AEC                 </span><span style="color:navy">call    </span>DSKWRITE
<span style="color:black">DOSCODE:7AEF                 </span><span style="color:navy">jz      short </span><span style="color:gray">DWRITE_OKAY
</span><span style="color:black">DOSCODE:7AF1                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">27h </span><span style="color:gray">; &#039;&#039;&#039;
</span><span style="color:black">DOSCODE:7AF3                 </span><span style="color:navy">jz      short </span><span style="color:gray">DWRITE_DISK_FULL
</span><span style="color:black">DOSCODE:7AF5                 </span><span style="color:navy">mov     ss:</span>READOP<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7AFB                 </span><span style="color:navy">call    </span>HARDERRRW
<span style="color:black">DOSCODE:7AFE                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7B00                 </span><span style="color:navy">jz      short </span><span style="color:gray">DWRITE_LUP
</span><span style="color:black">DOSCODE:7B02                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:7B04                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7B05                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DWRITE_OKAY
</span><span style="color:black">DOSCODE:7B07                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7B08
DOSCODE:7B08 </span><span style="color:gray">DWRITE_OKAY</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B08                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7B09                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7B0A                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7B0B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7B0C                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRW
</span><span style="color:black">DOSCODE:7B0E                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">WRTLAST
</span><span style="color:black">DOSCODE:7B10                 </span><span style="color:navy">mov     dl, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7B12                 </span><span style="color:navy">inc     </span>LASTPOS
<span style="color:black">DOSCODE:7B16                 </span><span style="color:navy">jmp     short </span><span style="color:gray">WRTLP
</span><span style="color:black">DOSCODE:7B18 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7B18
DOSCODE:7B18 </span><span style="color:gray">DWRITE_DISK_FULL</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B18                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7B19                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7B1A                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7B1B                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7B1C                 </span><span style="color:navy">mov     </span>DISK_FULL<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7B21                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7B22                 </span><span style="color:navy">jmp     </span><span style="color:gray">WRTERR
</span><span style="color:black">DOSCODE:7B25 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7B25
DOSCODE:7B25 </span><span style="color:gray">SET_ACC_ERRW</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B25                 </span><span style="color:navy">jmp     </span>SET_ACC_ERR_DS
<span style="color:black">DOSCODE:7B28 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7B28
DOSCODE:7B28 </span><span style="color:gray">WRTLAST</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B28                 </span><span style="color:navy">mov     ax, </span>BYTCNT2
<span style="color:black">DOSCODE:7B2B                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:7B2D                 </span><span style="color:navy">jz      short </span><span style="color:gray">FINWRT
</span><span style="color:black">DOSCODE:7B2F                 </span><span style="color:navy">mov     </span>BYTCNT1<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7B32                 </span><span style="color:navy">call    </span>NEXTSEC
<span style="color:black">DOSCODE:7B35                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRW
</span><span style="color:black">DOSCODE:7B37                 </span><span style="color:navy">mov     </span>BYTSECPOS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7B3D                 </span><span style="color:navy">call    </span>BUFWRT
<span style="color:black">DOSCODE:7B40                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRW
</span><span style="color:black">DOSCODE:7B42
DOSCODE:7B42 </span><span style="color:gray">FINWRT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B42                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7B46                 </span><span style="color:navy">mov     ax, </span>GROWCNT
<span style="color:black">DOSCODE:7B49                 </span><span style="color:navy">mov     cx, </span>GROWCNT<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7B4D                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:7B4F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">UPDATE_size
</span><span style="color:black">DOSCODE:7B51                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">SAMSIZ
</span><span style="color:black">DOSCODE:7B53
DOSCODE:7B53 </span><span style="color:gray">UPDATE_size</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B53                 </span><span style="color:navy">add     es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:7B57                 </span><span style="color:navy">adc     es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:7B5B                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7B5E                 </span><span style="color:navy">call    </span>ShSU
<span style="color:black">DOSCODE:7B62
DOSCODE:7B62 </span><span style="color:gray">SAMSIZ</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B62                 </span><span style="color:navy">jmp     </span>SETCLUS
<span style="color:black">DOSCODE:7B65 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7B65
DOSCODE:7B65 </span><span style="color:gray">WRTEOF</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B65                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:7B67                 </span><span style="color:navy">or      cx, dx
</span><span style="color:black">DOSCODE:7B69                 </span><span style="color:navy">jz      short </span><span style="color:gray">KILLFIL
</span><span style="color:black">DOSCODE:7B6B                 </span><span style="color:navy">sub     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7B6E                 </span><span style="color:navy">sbb     dx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7B71                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:7B72                 </span><span style="color:navy">mov     bx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7B76                 </span><span style="color:navy">call    </span>DIV32
<span style="color:black">DOSCODE:7B79                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7B7A                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:7B7C                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:7B80                 </span><span style="color:navy">call    </span>SHR32
<span style="color:black">DOSCODE:7B83                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:7B85                 </span><span style="color:navy">call    </span>FNDCLUS
<span style="color:black">DOSCODE:7B88
DOSCODE:7B88 </span><span style="color:gray">SET_ACC_ERRWJ2</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B88                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRW
</span><span style="color:black">DOSCODE:7B8A                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">RELFILE
</span><span style="color:black">DOSCODE:7B8C                 </span><span style="color:navy">call    </span>ALLOCATE
<span style="color:black">DOSCODE:7B8F                 </span><span style="color:navy">jb      short </span><span style="color:gray">WRTERRJ
</span><span style="color:black">DOSCODE:7B91
DOSCODE:7B91 </span><span style="color:gray">UPDATE</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7B91                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7B95                 </span><span style="color:navy">mov     ax, </span>BYTPOS
<span style="color:black">DOSCODE:7B98                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:7B9C                 </span><span style="color:navy">mov     ax, </span>BYTPOS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7B9F                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:7BA3                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:7BA6                 </span><span style="color:navy">call    </span>ShSU
<span style="color:black">DOSCODE:7BAA                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:7BAC                 </span><span style="color:navy">jmp     </span>ADDREC
<span style="color:black">DOSCODE:7BAF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7BAF
DOSCODE:7BAF </span><span style="color:gray">WRTERRJ</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7BAF                 </span><span style="color:navy">jmp     </span><span style="color:gray">WRTERR
</span><span style="color:black">DOSCODE:7BB2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7BB2
DOSCODE:7BB2 </span><span style="color:gray">RELFILE</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7BB2                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:7BB3                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7BB7                 </span><span style="color:navy">cmp     dx, es:[di+</span><span style="color:#ff8000">19h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7BBB                 </span><span style="color:navy">jnb     short </span><span style="color:gray">SKIPRESET
</span><span style="color:black">DOSCODE:7BBD                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">19h</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7BC3                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7BC3 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DISKWRITE
</span><span style="color:maroon">DOSCODE:7BC7                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">35h</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:7BCB </span><span style="color:gray">; START OF FUNCTION CHUNK FOR DISKWRITE
</span><span style="color:black">DOSCODE:7BCB
DOSCODE:7BCB </span><span style="color:gray">SKIPRESET</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7BCB                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7BCC                 </span><span style="color:navy">mov     dx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:7BCF                 </span><span style="color:navy">call    </span>RELBLKS
<span style="color:black">DOSCODE:7BD2
DOSCODE:7BD2 </span><span style="color:gray">SET_ACC_ERRWJJ</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7BD2                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRWJ2
</span><span style="color:black">DOSCODE:7BD4                 </span><span style="color:navy">jmp     short </span><span style="color:gray">UPDATE
</span><span style="color:black">DOSCODE:7BD6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7BD6
DOSCODE:7BD6 </span><span style="color:gray">KILLFIL</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7BD6                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:7BD8                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:7BD9                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:7BDD                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">19h</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:7BE1                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">35h</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:7BE5                 </span><span style="color:navy">xchg    bx, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7BE9                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7BEA                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:7BEC                 </span><span style="color:navy">jz      short </span><span style="color:gray">UPDATEJ
</span><span style="color:black">DOSCODE:7BEE                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:7BEF                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:7BF0                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:7BF1                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7BF2                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:7BF3                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:7BF7                 </span><span style="color:navy">mov     dl, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7BFB                 </span><span style="color:navy">mov     cx, bx
</span><span style="color:black">DOSCODE:7BFD                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:7BFF                 </span><span style="color:navy">call    </span>FastOpen_Update
<span style="color:black">DOSCODE:7C02                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:7C03                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7C04                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:7C05                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:7C06                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7C07                 </span><span style="color:navy">call    </span>RELEASE
<span style="color:black">DOSCODE:7C0A                 </span><span style="color:navy">jb      short </span><span style="color:gray">SET_ACC_ERRWJJ
</span><span style="color:black">DOSCODE:7C0C
DOSCODE:7C0C </span><span style="color:gray">UPDATEJ</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C0C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">UPDATE
</span><span style="color:black">DOSCODE:7C0C </span><span style="color:gray">; END OF FUNCTION CHUNK FOR DISKWRITE
</span><span style="color:black">DOSCODE:7C0E
DOSCODE:7C0E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7C0E
DOSCODE:7C0E
DOSCODE:7C0E </span>DskWrtBufPurge  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C0E                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:7C0F                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7C10                 </span><span style="color:navy">mov     bx, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:7C15                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:7C17                 </span><span style="color:navy">add     cx, dx
</span><span style="color:black">DOSCODE:7C19                 </span><span style="color:navy">adc     si, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7C1C                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7C20                 </span><span style="color:navy">cmp     ss:</span>SC_CACHE_COUNT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7C26                 </span><span style="color:navy">jz      short </span><span style="color:gray">nosc
</span><span style="color:black">DOSCODE:7C28                 </span><span style="color:navy">cmp     al, ss:</span>CurSC_DRIVE
<span style="color:black">DOSCODE:7C2D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">nosc
</span><span style="color:black">DOSCODE:7C2F                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:7C30                 </span><span style="color:navy">mov     ax, ss:</span>CurSC_SECTOR
<span style="color:black">DOSCODE:7C34                 </span><span style="color:navy">mov     di, ss:</span>CurSC_SECTOR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7C39                 </span><span style="color:navy">cmp     si, di
</span><span style="color:black">DOSCODE:7C3B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">sc01
</span><span style="color:black">DOSCODE:7C3D                 </span><span style="color:navy">cmp     cx, ax
</span><span style="color:black">DOSCODE:7C3F
DOSCODE:7C3F </span><span style="color:gray">sc01</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C3F                 </span><span style="color:navy">jbe     short </span><span style="color:gray">sc5
</span><span style="color:black">DOSCODE:7C41                 </span><span style="color:navy">add     ax, ss:</span>SC_CACHE_COUNT
<span style="color:black">DOSCODE:7C46                 </span><span style="color:navy">adc     di, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7C49                 </span><span style="color:navy">cmp     bx, di
</span><span style="color:black">DOSCODE:7C4B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">sc02
</span><span style="color:black">DOSCODE:7C4D                 </span><span style="color:navy">cmp     dx, ax
</span><span style="color:black">DOSCODE:7C4F
DOSCODE:7C4F </span><span style="color:gray">sc02</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C4F                 </span><span style="color:navy">jnb     short </span><span style="color:gray">sc5
</span><span style="color:black">DOSCODE:7C51                 </span><span style="color:navy">mov     ss:</span>SC_STATUS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7C58
DOSCODE:7C58 </span><span style="color:gray">sc5</span><span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C58                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:7C59
DOSCODE:7C59 </span><span style="color:gray">nosc</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C59                 </span><span style="color:navy">call    </span>GETCURHEAD
<span style="color:black">DOSCODE:7C5C
DOSCODE:7C5C </span><span style="color:gray">_bufq</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C5C                 </span><span style="color:navy">cmp     al, [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7C5F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq5
</span><span style="color:black">DOSCODE:7C61                 </span><span style="color:navy">cmp     bx, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7C64                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq04
</span><span style="color:black">DOSCODE:7C66                 </span><span style="color:navy">cmp     dx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7C69
DOSCODE:7C69 </span><span style="color:gray">bufq04</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C69                 </span><span style="color:navy">ja      short </span><span style="color:gray">bufq5
</span><span style="color:black">DOSCODE:7C6B                 </span><span style="color:navy">cmp     si, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7C6E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bufq05
</span><span style="color:black">DOSCODE:7C70                 </span><span style="color:navy">cmp     cx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7C73
DOSCODE:7C73 </span><span style="color:gray">bufq05</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C73                 </span><span style="color:navy">jbe     short </span><span style="color:gray">bufq5
</span><span style="color:black">DOSCODE:7C75                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:7C79                 </span><span style="color:navy">jz      short </span><span style="color:gray">bufq4
</span><span style="color:black">DOSCODE:7C7B                 </span><span style="color:navy">call    </span>DEC_DIRTY_COUNT
<span style="color:black">DOSCODE:7C7E
DOSCODE:7C7E </span><span style="color:gray">bufq4</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C7E                 </span><span style="color:navy">mov     word ptr [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:#ff8000">20FFh
</span><span style="color:black">DOSCODE:7C83                 </span><span style="color:navy">call    </span>SCANPLACE
<span style="color:black">DOSCODE:7C86                 </span><span style="color:navy">jmp     short </span><span style="color:gray">bufq6
</span><span style="color:black">DOSCODE:7C88 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7C88
DOSCODE:7C88 </span><span style="color:gray">bufq5</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C88                 </span><span style="color:navy">mov     di, [di]
</span><span style="color:black">DOSCODE:7C8A
DOSCODE:7C8A </span><span style="color:gray">bufq6</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C8A                 </span><span style="color:navy">cmp     di, ss:</span>FIRST_BUFF_ADDR
<span style="color:black">DOSCODE:7C8F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">_bufq
</span><span style="color:black">DOSCODE:7C91                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7C92                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7C93                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7C93 </span>DskWrtBufPurge  endp
<span style="color:black">DOSCODE:7C93
DOSCODE:7C94
DOSCODE:7C94 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7C94
DOSCODE:7C94
DOSCODE:7C94 </span>DIV32           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7C94                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">512
</span><span style="color:black">DOSCODE:7C98                 </span><span style="color:navy">jnz     short </span><span style="color:gray">div5
</span><span style="color:black">DOSCODE:7C9A                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:black">DOSCODE:7C9C                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:7C9E                 </span><span style="color:navy">and     dx, </span><span style="color:green">511
</span><span style="color:black">DOSCODE:7CA2                 </span><span style="color:navy">mov     al, ah
</span><span style="color:black">DOSCODE:7CA4                 </span><span style="color:navy">mov     ah, cl
</span><span style="color:black">DOSCODE:7CA6                 </span><span style="color:navy">mov     cl, ch
</span><span style="color:black">DOSCODE:7CA8                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:7CAA                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7CAC                 </span><span style="color:navy">rcr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7CAE                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7CAF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7CAF
DOSCODE:7CAF </span><span style="color:gray">div5</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CAF                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:7CB1                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:7CB3                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:7CB5                 </span><span style="color:navy">div     bx
</span><span style="color:black">DOSCODE:7CB7                 </span><span style="color:navy">xchg    ax, cx
</span><span style="color:black">DOSCODE:7CB8                 </span><span style="color:navy">div     bx
</span><span style="color:black">DOSCODE:7CBA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7CBA </span>DIV32           endp
<span style="color:black">DOSCODE:7CBA
DOSCODE:7CBB
DOSCODE:7CBB </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7CBB
DOSCODE:7CBB
DOSCODE:7CBB </span>SHR32           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CBB                 </span><span style="color:navy">mov     cl, es:[bp+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7CBF                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:7CC1                 </span><span style="color:navy">jcxz    short </span><span style="color:gray">norota
</span><span style="color:black">DOSCODE:7CC3
DOSCODE:7CC3 </span><span style="color:gray">rotashft2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CC3                 </span><span style="color:navy">shr     dx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7CC5                 </span><span style="color:navy">rcr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7CC7                 </span><span style="color:navy">loop    </span><span style="color:gray">rotashft2
</span><span style="color:black">DOSCODE:7CC9
DOSCODE:7CC9 </span><span style="color:gray">norota</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CC9                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7CC9 </span>SHR32           endp
<span style="color:black">DOSCODE:7CC9
DOSCODE:7CCA
DOSCODE:7CCA </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7CCA
DOSCODE:7CCA
DOSCODE:7CCA </span>SEARCH          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CCA                 </span><span style="color:navy">call    </span>STARTSRCH
<span style="color:black">DOSCODE:7CCD                 </span><span style="color:navy">mov     al, </span>ATTRIB
<span style="color:black">DOSCODE:7CD0                 </span><span style="color:navy">and     al, </span><span style="color:green">9Eh
</span><span style="color:black">DOSCODE:7CD2                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:7CD4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOTVOLSRCH
</span><span style="color:black">DOSCODE:7CD6                 </span><span style="color:navy">call    </span>SETROOTSRCH
<span style="color:black">DOSCODE:7CD9
DOSCODE:7CD9 </span><span style="color:gray">NOTVOLSRCH</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CD9                 </span><span style="color:navy">call    </span>GETENTRY
<span style="color:black">DOSCODE:7CDC                 </span><span style="color:navy">jnb     short </span>SRCH
<span style="color:black">DOSCODE:7CDE                 </span><span style="color:navy">jmp     </span><span style="color:gray">SETESRET
</span><span style="color:black">DOSCODE:7CE1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7CE1
DOSCODE:7CE1 </span>SRCH<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CE1                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:7CE2                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:7CE6                 </span><span style="color:navy">mov     ah, [bx]
</span><span style="color:black">DOSCODE:7CE8                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:7CEA                 </span><span style="color:navy">jz      short </span><span style="color:gray">FREE
</span><span style="color:black">DOSCODE:7CEC                 </span><span style="color:navy">cmp     ah, ss:</span>DELALL
<span style="color:black">DOSCODE:7CF1                 </span><span style="color:navy">jz      short </span><span style="color:gray">FREE
</span><span style="color:black">DOSCODE:7CF3                 </span><span style="color:navy">test    byte ptr [bx+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:7CF7                 </span><span style="color:navy">jz      short </span><span style="color:gray">CHKFNAM
</span><span style="color:black">DOSCODE:7CF9                 </span><span style="color:navy">inc     ss:</span>VOLID
<span style="color:black">DOSCODE:7CFE
DOSCODE:7CFE </span><span style="color:gray">CHKFNAM</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7CFE                 </span><span style="color:navy">mov     si, ss
</span><span style="color:black">DOSCODE:7D00                 </span><span style="color:navy">mov     es, si
</span><span style="color:black">DOSCODE:7D02                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:7D04                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:7D07                 </span><span style="color:navy">cmp     ss:</span>NAME1<span style="color:navy">, </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:7D0D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO_E5
</span><span style="color:black">DOSCODE:7D0F                 </span><span style="color:navy">mov     ss:</span>NAME1<span style="color:navy">, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:7D15
DOSCODE:7D15 </span><span style="color:gray">NO_E5</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D15                 </span><span style="color:navy">call    </span>MetaCompare
<span style="color:black">DOSCODE:7D18                 </span><span style="color:navy">jz      short </span><span style="color:gray">FOUND
</span><span style="color:black">DOSCODE:7D1A                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7D1B
DOSCODE:7D1B </span>NEXTENT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D1B                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:7D1F                 </span><span style="color:navy">call    </span>NEXTENTRY
<span style="color:black">DOSCODE:7D22                 </span><span style="color:navy">jnb     short </span>SRCH
<span style="color:black">DOSCODE:7D24                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SETESRET
</span><span style="color:black">DOSCODE:7D26 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7D26
DOSCODE:7D26 </span><span style="color:gray">FREE</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D26                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7D27                 </span><span style="color:navy">mov     cx, </span>LASTENT
<span style="color:black">DOSCODE:7D2B                 </span><span style="color:navy">cmp     cx, </span>ENTFREE
<span style="color:black">DOSCODE:7D2F                 </span><span style="color:navy">jnb     short </span><span style="color:gray">TSTALL
</span><span style="color:black">DOSCODE:7D31                 </span><span style="color:navy">mov     </span>ENTFREE<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:7D35
DOSCODE:7D35 </span><span style="color:gray">TSTALL</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D35                 </span><span style="color:navy">cmp     ah, </span>DELALL
<span style="color:black">DOSCODE:7D39
DOSCODE:7D39 </span><span style="color:gray">NEXTENTJ</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D39                 </span><span style="color:navy">jz      short </span>NEXTENT
<span style="color:black">DOSCODE:7D3B                 </span><span style="color:navy">mov     </span>ENTLAST<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:7D3F                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7D40                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SETESRET
</span><span style="color:black">DOSCODE:7D42 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7D42
DOSCODE:7D42 </span><span style="color:gray">FOUND</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D42                 </span><span style="color:navy">mov     ch, [si]
</span><span style="color:black">DOSCODE:7D44                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7D45                 </span><span style="color:navy">mov     ah, </span>ATTRIB
<span style="color:black">DOSCODE:7D49                 </span><span style="color:navy">and     ah, </span><span style="color:green">9Eh
</span><span style="color:black">DOSCODE:7D4C                 </span><span style="color:navy">lea     si, [si+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7D4F                 </span><span style="color:navy">test    ch, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:7D52                 </span><span style="color:navy">jz      short </span><span style="color:gray">check_one_volume_id
</span><span style="color:black">DOSCODE:7D54                 </span><span style="color:navy">test    ah, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:7D57                 </span><span style="color:navy">jz      short </span><span style="color:gray">NEXTENTJ
</span><span style="color:black">DOSCODE:7D59                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:7D5B                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RETFF
</span><span style="color:black">DOSCODE:7D5D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7D5D
DOSCODE:7D5D </span><span style="color:gray">check_one_volume_id</span><span style="color:navy">:                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D5D                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:7D60                 </span><span style="color:navy">jz      short </span><span style="color:gray">NEXTENTJ
</span><span style="color:black">DOSCODE:7D62                 </span><span style="color:navy">call    </span>MatchAttributes
<span style="color:black">DOSCODE:7D65                 </span><span style="color:navy">jz      short </span><span style="color:gray">RETFF
</span><span style="color:black">DOSCODE:7D67                 </span><span style="color:navy">test    </span>CREATING<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:7D6C                 </span><span style="color:navy">jz      short </span><span style="color:gray">NEXTENTJ
</span><span style="color:black">DOSCODE:7D6E
DOSCODE:7D6E </span><span style="color:gray">RETFF</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D6E                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:7D72                 </span><span style="color:navy">mov     ah, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7D76
DOSCODE:7D76 </span><span style="color:gray">SETESRET</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D76                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7D77                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7D78                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7D78 </span>SEARCH          endp
<span style="color:black">DOSCODE:7D78
DOSCODE:7D79
DOSCODE:7D79 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7D79
DOSCODE:7D79
DOSCODE:7D79 </span>MetaCompare     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D79                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:7D7C
DOSCODE:7D7C </span><span style="color:gray">WILDCRD</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D7C                 </span><span style="color:navy">repe cmpsb
</span><span style="color:black">DOSCODE:7D7E                 </span><span style="color:navy">jz      short </span><span style="color:gray">MetaRet
</span><span style="color:black">DOSCODE:7D80                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:7D85                 </span><span style="color:navy">jz      short </span><span style="color:gray">WILDCRD
</span><span style="color:black">DOSCODE:7D87
DOSCODE:7D87 </span><span style="color:gray">MetaRet</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D87                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7D87 </span>MetaCompare     endp
<span style="color:black">DOSCODE:7D87
DOSCODE:7D88
DOSCODE:7D88 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7D88
DOSCODE:7D88
DOSCODE:7D88 </span>NEXTENTRY       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7D88                 </span><span style="color:navy">mov     ax, </span>LASTENT
<span style="color:black">DOSCODE:7D8B                 </span><span style="color:navy">cmp     ax, </span>ENTLAST
<span style="color:black">DOSCODE:7D8F                 </span><span style="color:navy">jz      short </span><span style="color:gray">NONE
</span><span style="color:black">DOSCODE:7D91                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:7D92                 </span><span style="color:navy">lea     bx, [bx+</span><span style="color:green">32</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7D95                 </span><span style="color:navy">cmp     bx, dx
</span><span style="color:black">DOSCODE:7D97                 </span><span style="color:navy">jnz     short </span><span style="color:gray">HAVIT
</span><span style="color:black">DOSCODE:7D99                 </span><span style="color:navy">mov     bl, </span>SECCLUSPOS
<span style="color:black">DOSCODE:7D9D                 </span><span style="color:navy">inc     bl
</span><span style="color:black">DOSCODE:7D9F                 </span><span style="color:navy">cmp     bl, </span>CLUSFAC
<span style="color:black">DOSCODE:7DA3                 </span><span style="color:navy">jb      short </span><span style="color:gray">SAMECLUS
</span><span style="color:black">DOSCODE:7DA5                 </span><span style="color:navy">mov     bx, </span>NXTCLUSNUM
<span style="color:black">DOSCODE:7DA9                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:7DAC                 </span><span style="color:navy">jnb     short </span><span style="color:gray">NONE
</span><span style="color:black">DOSCODE:7DAE                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:7DB1                 </span><span style="color:navy">jb      short </span><span style="color:gray">NONE
</span><span style="color:black">DOSCODE:7DB3                 </span><span style="color:navy">jmp     short </span>GETENT
<span style="color:black">DOSCODE:7DB5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7DB5
DOSCODE:7DB5 </span><span style="color:gray">NONE</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7DB5                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7DB6                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7DB7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7DB7
DOSCODE:7DB7 </span><span style="color:gray">HAVIT</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7DB7                 </span><span style="color:navy">mov     </span>LASTENT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7DBA                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7DBB
DOSCODE:7DBB </span>nextentry_retn<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7DBB                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7DBC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7DBC
DOSCODE:7DBC </span><span style="color:gray">SAMECLUS</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7DBC                 </span><span style="color:navy">mov     </span>SECCLUSPOS<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:7DC0                 </span><span style="color:navy">mov     </span>LASTENT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7DC3                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:7DC4                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:7DC8                 </span><span style="color:navy">mov     dx, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7DCB                 </span><span style="color:navy">mov     ss:</span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7DD0                 </span><span style="color:navy">mov     dx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7DD3                 </span><span style="color:navy">add     dx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7DD6                 </span><span style="color:navy">adc     ss:</span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7DDC                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:7DDD                 </span><span style="color:navy">call    </span>FIRSTCLUSTER
<span style="color:black">DOSCODE:7DE0                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:7DE2                 </span><span style="color:navy">jmp     short </span>SETENTRY
<span style="color:black">DOSCODE:7DE2 </span>NEXTENTRY       endp
<span style="color:black">DOSCODE:7DE2
DOSCODE:7DE4
DOSCODE:7DE4 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7DE4
DOSCODE:7DE4
DOSCODE:7DE4 </span>GETENTRY        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7DE4                 </span><span style="color:navy">mov     ax, </span>LASTENT
<span style="color:black">DOSCODE:7DE7
DOSCODE:7DE7 </span>GETENT<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7DE7                 </span><span style="color:navy">mov     </span>LASTENT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7DEA                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:7DEC                 </span><span style="color:navy">rol     ax, cl
</span><span style="color:black">DOSCODE:7DEE                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:7DF0                 </span><span style="color:navy">and     ax, </span><span style="color:green">0FFE0h
</span><span style="color:black">DOSCODE:7DF3                 </span><span style="color:navy">and     dx, </span><span style="color:green">1Fh
</span><span style="color:black">DOSCODE:7DF6                 </span><span style="color:navy">mov     bx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7DFA                 </span><span style="color:navy">and     bl, </span><span style="color:green">0E0h        </span>; 255-31
<span style="color:black">DOSCODE:7DFD                 </span><span style="color:navy">div     bx
</span><span style="color:black">DOSCODE:7DFF                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:black">DOSCODE:7E01                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:7E02                 </span><span style="color:navy">call    </span>DIRREAD
<span style="color:black">DOSCODE:7E05                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7E06                 </span><span style="color:navy">jb      short </span>nextentry_retn
<span style="color:black">DOSCODE:7E08
DOSCODE:7E08 </span>SETENTRY<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7E08                 </span><span style="color:navy">mov     dx, word ptr </span>CURBUF
<span style="color:black">DOSCODE:7E0C                 </span><span style="color:navy">add     dx, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:7E0F                 </span><span style="color:navy">add     bx, dx
</span><span style="color:black">DOSCODE:7E11                 </span><span style="color:navy">add     dx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7E15                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7E16                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7E16 </span>GETENTRY        endp
<span style="color:black">DOSCODE:7E16
DOSCODE:7E17
DOSCODE:7E17 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7E17
DOSCODE:7E17
DOSCODE:7E17 </span>SETDIRSRCH      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7E17                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:7E19                 </span><span style="color:navy">jz      short </span>SETROOTSRCH
<span style="color:black">DOSCODE:7E1B                 </span><span style="color:navy">mov     </span>DIRSTART<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:7E1F                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7E23                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:7E25                 </span><span style="color:navy">mov     </span>CLUSFAC<span style="color:navy">, al
</span><span style="color:black">DOSCODE:7E28                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:7E29                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:7E2E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">UNP_OK
</span><span style="color:black">DOSCODE:7E30                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:7E33                 </span><span style="color:navy">jnb     short </span><span style="color:gray">UNP_OK
</span><span style="color:black">DOSCODE:7E35                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:7E36                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7E37 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7E37
DOSCODE:7E37 </span><span style="color:gray">UNP_OK</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7E37                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, di
</span><span style="color:black">DOSCODE:7E3B                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:black">DOSCODE:7E3D                 </span><span style="color:navy">xor     bl, bl
</span><span style="color:black">DOSCODE:7E3F                 </span><span style="color:navy">mov     </span>SECCLUSPOS<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:7E43                 </span><span style="color:navy">call    </span>FIGREC
<span style="color:black">DOSCODE:7E46                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:7E47                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:7E48                 </span><span style="color:navy">mov     dx, </span>HIGH_SECTOR
<span style="color:black">DOSCODE:7E4C                 </span><span style="color:navy">mov     </span>DIRSEC<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7E50                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:7E51                 </span><span style="color:navy">mov     </span>DIRSEC<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7E55                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7E56                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7E56 </span>SETDIRSRCH      endp
<span style="color:black">DOSCODE:7E56
DOSCODE:7E57
DOSCODE:7E57 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7E57
DOSCODE:7E57
DOSCODE:7E57 </span>SETROOTSRCH     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7E57                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:7E59                 </span><span style="color:navy">mov     </span>DIRSTART<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7E5C                 </span><span style="color:navy">mov     </span>SECCLUSPOS<span style="color:navy">, al
</span><span style="color:black">DOSCODE:7E5F                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:7E60                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:7E63                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7E67                 </span><span style="color:navy">mov     dx, es:[bp+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7E6B                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:black">DOSCODE:7E6D                 </span><span style="color:navy">mov     </span>CLUSFAC<span style="color:navy">, al
</span><span style="color:black">DOSCODE:7E70                 </span><span style="color:navy">mov     </span>DIRSEC<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:7E74                 </span><span style="color:navy">mov     </span>DIRSEC<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7E7A                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7E7B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7E7B </span>SETROOTSRCH     endp
<span style="color:black">DOSCODE:7E7B
DOSCODE:7E7C
DOSCODE:7E7C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7E7C
DOSCODE:7E7C
DOSCODE:7E7C </span>GETPATH         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7E7C
DOSCODE:7E7C </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:7F82 SIZE 000001A5 BYTES
</span><span style="color:black">DOSCODE:7E7C
DOSCODE:7E7C                 </span><span style="color:navy">mov     word ptr </span>CREATING<span style="color:navy">, </span><span style="color:green">0E500h
</span><span style="color:black">DOSCODE:7E82
DOSCODE:7E82 </span>GetPathNoSet<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7E82                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:7E87                 </span><span style="color:navy">mov     word ptr </span>CURBUF<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:7E8D                 </span><span style="color:navy">mov     di, </span>WFP_START
<span style="color:black">DOSCODE:7E91                 </span><span style="color:navy">cmp     word ptr [di+</span><span style="color:#ff8000">1</span><span style="color:navy">], &#039;</span><span style="color:green">\:&#039;
</span><span style="color:black">DOSCODE:7E96                 </span><span style="color:navy">jz      short </span><span style="color:gray">CrackIt
</span><span style="color:black">DOSCODE:7E98                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:7E9B                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:7E9D                 </span><span style="color:navy">call    </span>CHKDEV
<span style="color:black">DOSCODE:7EA0                 </span><span style="color:navy">jb      short </span><span style="color:gray">InternalError
</span><span style="color:black">DOSCODE:7EA2
DOSCODE:7EA2 </span><span style="color:gray">Build_devJ</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7EA2                 </span><span style="color:navy">mov     al, </span>SATTRIB
<span style="color:black">DOSCODE:7EA5                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:7EA8                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7EAD                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:7EAE                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7EAF                 </span><span style="color:navy">mov     si, offset </span>NAME1
<span style="color:black">DOSCODE:7EB2                 </span><span style="color:navy">mov     di, </span>WFP_START
<span style="color:black">DOSCODE:7EB6                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:7EB8                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:7EBB
DOSCODE:7EBB </span><span style="color:gray">MoveLoop</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7EBB                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:7EBC                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:7EBD                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:black">DOSCODE:7EBF                 </span><span style="color:navy">jz      short </span><span style="color:gray">NoSave
</span><span style="color:black">DOSCODE:7EC1                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:7EC3
DOSCODE:7EC3 </span><span style="color:gray">NoSave</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7EC3                 </span><span style="color:navy">loop    </span><span style="color:gray">MoveLoop
</span><span style="color:black">DOSCODE:7EC5                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:7EC7                 </span><span style="color:navy">mov     byte ptr [di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7ECA                 </span><span style="color:navy">call    </span>Build_device_ent
<span style="color:black">DOSCODE:7ECD                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:7ECF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7ED0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7ED0
DOSCODE:7ED0 </span><span style="color:gray">InternalError</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7ED0                 </span><span style="color:navy">jmp     short </span><span style="color:gray">InternalError
</span><span style="color:black">DOSCODE:7ED2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7ED2
DOSCODE:7ED2 </span><span style="color:gray">CrackIt</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7ED2                 </span><span style="color:navy">mov     si, </span>CURR_DIR_END
<span style="color:black">DOSCODE:7ED6                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:7ED9                 </span><span style="color:navy">jnz     short </span><span style="color:gray">LOOK_SING
</span><span style="color:black">DOSCODE:7EDB                 </span><span style="color:navy">lea     si, [di+</span><span style="color:#ff8000">3</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7EDE
DOSCODE:7EDE </span><span style="color:gray">LOOK_SING</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7EDE                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:7EE3                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:7EE7                 </span><span style="color:navy">mov     ax, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:7EEA                 </span><span style="color:navy">mov     bx, es:[di+</span><span style="color:green">73</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7EEE                 </span><span style="color:navy">mov     si, </span>CURR_DIR_END
<span style="color:black">DOSCODE:7EF2                 </span><span style="color:navy">cmp     si, ax
</span><span style="color:black">DOSCODE:7EF4                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_CURR_D
</span><span style="color:black">DOSCODE:7EF6                 </span><span style="color:navy">cmp     bx, ax
</span><span style="color:black">DOSCODE:7EF8                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_CURR_D
</span><span style="color:black">DOSCODE:7EFA                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7EFF                 </span><span style="color:navy">jz      short </span><span style="color:gray">GOT_SEARCH_CLUSTER
</span><span style="color:black">DOSCODE:7F01                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:7F02                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:7F03                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:7F04                 </span><span style="color:navy">push    word ptr [si-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7F07                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:7F08                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:7F09                 </span><span style="color:navy">mov     byte ptr [si-</span><span style="color:green">1</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7F0D                 </span><span style="color:navy">mov     si, </span>WFP_START
<span style="color:black">DOSCODE:7F11                 </span><span style="color:navy">mov     bx, offset </span>FastOpenTable
<span style="color:black">DOSCODE:7F14                 </span><span style="color:navy">mov     di, offset </span>Dir_Info_Buff
<span style="color:black">DOSCODE:7F17                 </span><span style="color:navy">mov     cx, offset </span>FastOpen_Ext_Info
<span style="color:black">DOSCODE:7F1A                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:7F1C                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:7F1D                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7F1E                 </span><span style="color:navy">call    dword ptr [bx+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7F21                 </span><span style="color:navy">jb      short </span><span style="color:gray">GO_Chk_end1
</span><span style="color:black">DOSCODE:7F23                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7F26                 </span><span style="color:navy">jz      short </span><span style="color:gray">GO_Chk_end
</span><span style="color:black">DOSCODE:7F28                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7F29                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GO_Chk_end
</span><span style="color:black">DOSCODE:7F2B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7F2B
DOSCODE:7F2B </span><span style="color:gray">GO_Chk_end1</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F2B                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:7F2C
DOSCODE:7F2C </span><span style="color:gray">GO_Chk_end</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F2C                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:7F2D                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:7F2E                 </span><span style="color:navy">pop     word ptr [si-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7F31                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:7F32                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:7F33                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7F34                 </span><span style="color:navy">jnb     short </span><span style="color:gray">GOT_SEARCH_CLUSTER
</span><span style="color:black">DOSCODE:7F36
DOSCODE:7F36 </span><span style="color:gray">NO_CURR_D</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F36                 </span><span style="color:navy">mov     si, </span>WFP_START
<span style="color:black">DOSCODE:7F3A                 </span><span style="color:navy">lea     si, [si+</span><span style="color:#ff8000">3</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:7F3D                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:7F41                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ROOTPATH
</span><span style="color:black">DOSCODE:7F43 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7F43
DOSCODE:7F43 </span><span style="color:gray">GOT_SEARCH_CLUSTER</span><span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F43                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:7F47                 </span><span style="color:navy">call    </span>SETDIRSRCH
<span style="color:black">DOSCODE:7F4A                 </span><span style="color:navy">jb      short </span><span style="color:gray">SETFERR
</span><span style="color:black">DOSCODE:7F4C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">FINDPATH
</span><span style="color:black">DOSCODE:7F4E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7F4E
DOSCODE:7F4E </span><span style="color:gray">SETFERR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F4E                 </span><span style="color:navy">xor     cl, cl
</span><span style="color:black">DOSCODE:7F50                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7F51                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7F51 </span>GETPATH         endp
<span style="color:black">DOSCODE:7F51
DOSCODE:7F52
DOSCODE:7F52 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:7F52
DOSCODE:7F52
DOSCODE:7F52 </span>CHKDEV          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F52                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:7F54                 </span><span style="color:navy">mov     di, ss
</span><span style="color:black">DOSCODE:7F56                 </span><span style="color:navy">mov     es, di
</span><span style="color:black">DOSCODE:7F58                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:7F5B                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">9
</span><span style="color:black">DOSCODE:7F5E
DOSCODE:7F5E </span><span style="color:gray">TESTLOOP</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F5E                 </span><span style="color:navy">call    </span>GETLET
<span style="color:black">DOSCODE:7F61                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">2Eh </span><span style="color:gray">; &#039;.&#039;
</span><span style="color:black">DOSCODE:7F63                 </span><span style="color:navy">jz      short </span><span style="color:gray">TESTDEVICE
</span><span style="color:black">DOSCODE:7F65                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:7F68                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOTDEV
</span><span style="color:black">DOSCODE:7F6A                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:7F6C                 </span><span style="color:navy">jz      short </span><span style="color:gray">TESTDEVICE
</span><span style="color:black">DOSCODE:7F6E                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:7F6F                 </span><span style="color:navy">loop    </span><span style="color:gray">TESTLOOP
</span><span style="color:black">DOSCODE:7F71
DOSCODE:7F71 </span><span style="color:gray">NOTDEV</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F71                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:7F72                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7F73 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7F73
DOSCODE:7F73 </span><span style="color:gray">TESTDEVICE</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F73                 </span><span style="color:navy">add     cx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:7F76                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:black">DOSCODE:7F78                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:7F7A                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:black">DOSCODE:7F7C                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:7F7E                 </span><span style="color:navy">call    </span>DEVNAME
<span style="color:black">DOSCODE:7F81                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7F81 </span>CHKDEV          endp
<span style="color:black">DOSCODE:7F81
DOSCODE:7F82 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7F82 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR GETPATH
</span><span style="color:black">DOSCODE:7F82
DOSCODE:7F82 </span><span style="color:gray">ROOTPATH</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F82                 </span><span style="color:navy">call    </span>SETROOTSRCH
<span style="color:black">DOSCODE:7F85                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:7F88                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FINDPATH
</span><span style="color:black">DOSCODE:7F8A                 </span><span style="color:navy">mov     al, </span>SATTRIB
<span style="color:black">DOSCODE:7F8D                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:7F90                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:7F92                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:7F93 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7F93
DOSCODE:7F93 </span><span style="color:gray">FINDPATH</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7F93                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:7F94                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:7F95                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:7F97                 </span><span style="color:navy">mov     cx, </span>DIRSTART
<span style="color:black">DOSCODE:7F9B                 </span><span style="color:navy">cmp     </span>CURR_DIR_END<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:7FA0                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOIDS
</span><span style="color:black">DOSCODE:7FA2                 </span><span style="color:navy">cmp     di, </span>CURR_DIR_END
<span style="color:black">DOSCODE:7FA6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOIDS
</span><span style="color:black">DOSCODE:7FA8                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:7FAC                 </span><span style="color:navy">mov     es:[di+</span><span style="color:green">73</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:7FB0
DOSCODE:7FB0 </span><span style="color:gray">NOIDS</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7FB0                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:black">DOSCODE:7FB2                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:7FB4                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:7FB7                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2020h
</span><span style="color:black">DOSCODE:7FBA                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:7FBB                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:7FBC                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:7FBD                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:7FBE                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:7FBF                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:7FC0                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:7FC3                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:7FC5
DOSCODE:7FC5 </span><span style="color:gray">GetNam</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7FC5                 </span><span style="color:navy">inc     cl
</span><span style="color:black">DOSCODE:7FC7                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:7FC8                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">.&#039;
</span><span style="color:black">DOSCODE:7FCA                 </span><span style="color:navy">jz      short </span><span style="color:gray">_SetExt
</span><span style="color:black">DOSCODE:7FCC                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:7FCE                 </span><span style="color:navy">jz      short </span><span style="color:gray">_GetDone
</span><span style="color:black">DOSCODE:7FD0                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:7FD2                 </span><span style="color:navy">jz      short </span><span style="color:gray">_GetDone
</span><span style="color:black">DOSCODE:7FD4                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:7FD6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">StoNam
</span><span style="color:black">DOSCODE:7FD8                 </span><span style="color:navy">or      ah, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7FDB
DOSCODE:7FDB </span><span style="color:gray">StoNam</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7FDB                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:7FDC                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GetNam
</span><span style="color:black">DOSCODE:7FDE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7FDE
DOSCODE:7FDE </span><span style="color:gray">_SetExt</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7FDE                 </span><span style="color:navy">mov     di, (offset </span>NAME1<span style="color:navy">+</span><span style="color:green">8</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:7FE1
DOSCODE:7FE1 </span><span style="color:gray">GetExt</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7FE1                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:7FE2                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:7FE4                 </span><span style="color:navy">jz      short </span><span style="color:gray">_GetDone
</span><span style="color:black">DOSCODE:7FE6                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:7FE8                 </span><span style="color:navy">jz      short </span><span style="color:gray">_GetDone
</span><span style="color:black">DOSCODE:7FEA                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:7FEC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">StoExt
</span><span style="color:black">DOSCODE:7FEE                 </span><span style="color:navy">or      ah, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:7FF1
DOSCODE:7FF1 </span><span style="color:gray">StoExt</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7FF1                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:7FF2                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GetExt
</span><span style="color:black">DOSCODE:7FF4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:7FF4
DOSCODE:7FF4 </span><span style="color:gray">_GetDone</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:7FF4                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:7FF5                 </span><span style="color:navy">mov     cl, ah
</span><span style="color:black">DOSCODE:7FF7                 </span><span style="color:navy">or      cl, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:7FFA                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:7FFB                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:7FFC                 </span><span style="color:navy">cmp     si, di
</span><span style="color:black">DOSCODE:7FFE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">check_device
</span><span style="color:black">DOSCODE:8000                 </span><span style="color:navy">jmp     </span><span style="color:gray">_BADPATH
</span><span style="color:black">DOSCODE:8003 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8003
DOSCODE:8003 </span><span style="color:gray">check_device</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8003                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:8004                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:black">DOSCODE:8006                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:8008                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOT_LAST
</span><span style="color:black">DOSCODE:800A                 </span><span style="color:navy">mov     bh, </span>SATTRIB
<span style="color:black">DOSCODE:800E                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, bh
</span><span style="color:black">DOSCODE:8012
DOSCODE:8012 </span><span style="color:gray">NOT_LAST</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8012                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8013                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8014                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8015                 </span><span style="color:navy">call    </span>DEVNAME
<span style="color:black">DOSCODE:8018                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8019                 </span><span style="color:navy">jb      short </span><span style="color:gray">FindFile
</span><span style="color:black">DOSCODE:801B                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:801D                 </span><span style="color:navy">jz      short </span><span style="color:gray">GO_BDEV
</span><span style="color:black">DOSCODE:801F                 </span><span style="color:navy">jmp     </span><span style="color:gray">FILEINPATH
</span><span style="color:black">DOSCODE:8022 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8022
DOSCODE:8022 </span><span style="color:gray">GO_BDEV</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8022                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8023                 </span><span style="color:navy">jmp     </span><span style="color:gray">Build_devJ
</span><span style="color:black">DOSCODE:8026 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8026
DOSCODE:8026 </span><span style="color:gray">FindFile</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8026                 </span><span style="color:navy">cmp     </span>NAME1<span style="color:navy">, </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:802B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOE5
</span><span style="color:black">DOSCODE:802D                 </span><span style="color:navy">mov     </span>NAME1<span style="color:navy">, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:8032
DOSCODE:8032 </span><span style="color:gray">NOE5</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8032                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8033                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8034                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8035                 </span><span style="color:navy">call    </span>LookupPath
<span style="color:black">DOSCODE:8038                 </span><span style="color:navy">jnb     short </span><span style="color:gray">DIR_FOUND
</span><span style="color:black">DOSCODE:803A                 </span><span style="color:navy">call    </span>SEARCH
<span style="color:black">DOSCODE:803D
DOSCODE:803D </span><span style="color:gray">DIR_FOUND</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:803D                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:803E                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:803F                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8040                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LOAD_BUF
</span><span style="color:black">DOSCODE:8042                 </span><span style="color:navy">jmp     </span><span style="color:gray">BADPATHPOP
</span><span style="color:black">DOSCODE:8045 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8045
DOSCODE:8045 </span><span style="color:gray">LOAD_BUF</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8045                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:8049                 </span><span style="color:navy">test    byte ptr [bx+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:804D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GO_NEXT
</span><span style="color:black">DOSCODE:804F                 </span><span style="color:navy">jmp     </span><span style="color:gray">FILEINPATH
</span><span style="color:black">DOSCODE:8052 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8052
DOSCODE:8052 </span><span style="color:gray">GO_NEXT</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8052                 </span><span style="color:navy">cmp     ss:</span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8058                 </span><span style="color:navy">jz      short </span><span style="color:gray">SetDir
</span><span style="color:black">DOSCODE:805A                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:805C                 </span><span style="color:navy">mov     cx, ds
</span><span style="color:black">DOSCODE:805E                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:805F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8060                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8061                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8066                 </span><span style="color:navy">jz      short </span><span style="color:gray">_nofast
</span><span style="color:black">DOSCODE:8068                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:806D                 </span><span style="color:navy">jz      short </span><span style="color:gray">_nofast
</span><span style="color:black">DOSCODE:806F                 </span><span style="color:navy">mov     di, </span>Next_Element_Start
<span style="color:black">DOSCODE:8073
DOSCODE:8073 </span><span style="color:gray">_nofast</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8073                 </span><span style="color:navy">cmp     byte ptr [di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8076                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NEXT_ONE
</span><span style="color:black">DOSCODE:8078                 </span><span style="color:navy">jmp     </span><span style="color:gray">_SETRET
</span><span style="color:black">DOSCODE:807B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:807B
DOSCODE:807B </span><span style="color:gray">NEXT_ONE</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:807B                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:807C                 </span><span style="color:navy">mov     di, dx
</span><span style="color:black">DOSCODE:807E                 </span><span style="color:navy">mov     ds, cx
</span><span style="color:black">DOSCODE:8080
DOSCODE:8080 </span><span style="color:gray">SetDir</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8080                 </span><span style="color:navy">mov     dx, [si]
</span><span style="color:black">DOSCODE:8082                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:8083                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8084                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8085                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:808A                 </span><span style="color:navy">jz      short </span><span style="color:gray">DO_NORMAL
</span><span style="color:black">DOSCODE:808C                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:black">DOSCODE:808E                 </span><span style="color:navy">mov     di, </span>CLUSNUM
<span style="color:black">DOSCODE:8092                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8093                 </span><span style="color:navy">call    </span>SETDIRSRCH
<span style="color:black">DOSCODE:8096                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8097                 </span><span style="color:navy">add     sp, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:809A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">FAST_OPEN_SKIP
</span><span style="color:black">DOSCODE:809C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:809C
DOSCODE:809C </span><span style="color:gray">DO_NORMAL</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:809C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:809D                 </span><span style="color:navy">sub     bx, di
</span><span style="color:black">DOSCODE:809F                 </span><span style="color:navy">sub     si, di
</span><span style="color:black">DOSCODE:80A1                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:80A2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:80A3                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:80A4                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:80A5                 </span><span style="color:navy">push    word ptr [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:80A8                 </span><span style="color:navy">push    word ptr [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:80AB                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:black">DOSCODE:80AD                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:80AE                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:80AF                 </span><span style="color:navy">call    </span>SETDIRSRCH
<span style="color:black">DOSCODE:80B2                 </span><span style="color:navy">pop     </span>HIGH_SECTOR
<span style="color:black">DOSCODE:80B6                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:80B7                 </span><span style="color:navy">jb      short </span><span style="color:gray">SKIP_GETB
</span><span style="color:black">DOSCODE:80B9                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:80BE                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:80C0                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:black">DOSCODE:80C3
DOSCODE:80C3 </span><span style="color:gray">SKIP_GETB</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:80C3                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:80C4                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:80C5                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:80C6                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:80C7                 </span><span style="color:navy">jnb     short </span><span style="color:gray">SET_THE_BUF
</span><span style="color:black">DOSCODE:80C9                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:80CA                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:80CC                 </span><span style="color:navy">jmp     short </span><span style="color:gray">_BADPATH
</span><span style="color:black">DOSCODE:80CE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:80CE
DOSCODE:80CE </span><span style="color:gray">SET_THE_BUF</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:80CE                 </span><span style="color:navy">call    </span>SET_BUF_AS_DIR
<span style="color:black">DOSCODE:80D1                 </span><span style="color:navy">mov     di, word ptr </span>CURBUF
<span style="color:black">DOSCODE:80D5                 </span><span style="color:navy">add     si, di
</span><span style="color:black">DOSCODE:80D7                 </span><span style="color:navy">add     bx, di
</span><span style="color:black">DOSCODE:80D9
DOSCODE:80D9 </span><span style="color:gray">FAST_OPEN_SKIP</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:80D9                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:80DA                 </span><span style="color:navy">call    </span>InsertPath
<span style="color:black">DOSCODE:80DD                 </span><span style="color:navy">mov     al, [di]
</span><span style="color:black">DOSCODE:80DF                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:80E1                 </span><span style="color:navy">jz      short </span><span style="color:gray">_SETRET
</span><span style="color:black">DOSCODE:80E3                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:80E4                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:80E6                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:80E9                 </span><span style="color:navy">jnz     short </span><span style="color:gray">find_bad_name
</span><span style="color:black">DOSCODE:80EB                 </span><span style="color:navy">jmp     </span><span style="color:gray">FINDPATH
</span><span style="color:black">DOSCODE:80EE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:80EE
DOSCODE:80EE </span><span style="color:gray">find_bad_name</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:80EE                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:80EF
DOSCODE:80EF </span><span style="color:gray">_BADPATH</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:80EF                 </span><span style="color:navy">xor     cl, cl
</span><span style="color:black">DOSCODE:80F1                 </span><span style="color:navy">jmp     short </span><span style="color:gray">BADPRET
</span><span style="color:black">DOSCODE:80F3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:80F3
DOSCODE:80F3 </span><span style="color:gray">FILEINPATH</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:80F3                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:80F4                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:80F5                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:80F6                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:80FB                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_FAST
</span><span style="color:black">DOSCODE:80FD                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:8102                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_FAST
</span><span style="color:black">DOSCODE:8104                 </span><span style="color:navy">mov     di, </span>Next_Element_Start
<span style="color:black">DOSCODE:8108
DOSCODE:8108 </span><span style="color:gray">NO_FAST</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8108                 </span><span style="color:navy">mov     al, [di]
</span><span style="color:black">DOSCODE:810A                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:810C                 </span><span style="color:navy">jz      short </span><span style="color:gray">INCRET
</span><span style="color:black">DOSCODE:810E                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:8110                 </span><span style="color:navy">jmp     short </span><span style="color:gray">BADPRET
</span><span style="color:black">DOSCODE:8112 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8112
DOSCODE:8112 </span><span style="color:gray">INCRET</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8112                 </span><span style="color:navy">call    </span>InsertPath
<span style="color:black">DOSCODE:8115                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:8117
DOSCODE:8117 </span><span style="color:gray">_SETRET</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8117                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8118 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8118
DOSCODE:8118 </span><span style="color:gray">BADPATHPOP</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8118                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8119                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:black">DOSCODE:811B                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:811D                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:811F
DOSCODE:811F </span><span style="color:gray">BADPRET</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:811F                 </span><span style="color:navy">mov     al, </span>SATTRIB
<span style="color:black">DOSCODE:8122                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:8125                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8126                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8126 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR GETPATH
</span><span style="color:black">DOSCODE:8127
DOSCODE:8127 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8127
DOSCODE:8127
DOSCODE:8127 </span>STARTSRCH       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8127                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:812B                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:812D                 </span><span style="color:navy">mov     </span>LASTENT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8130                 </span><span style="color:navy">mov     </span>VOLID<span style="color:navy">, al
</span><span style="color:black">DOSCODE:8133                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:8134                 </span><span style="color:navy">mov     </span>ENTFREE<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8137                 </span><span style="color:navy">mov     </span>ENTLAST<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:813A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:813A </span>STARTSRCH       endp
<span style="color:black">DOSCODE:813A
DOSCODE:813B
DOSCODE:813B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:813B
DOSCODE:813B
DOSCODE:813B </span>MatchAttributes proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:813B                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:813C                 </span><span style="color:navy">mov     al, ss:</span>ATTRIB
<span style="color:black">DOSCODE:8140                 </span><span style="color:navy">not     al
</span><span style="color:black">DOSCODE:8142                 </span><span style="color:navy">and     al, ch
</span><span style="color:black">DOSCODE:8144                 </span><span style="color:navy">and     al, </span><span style="color:green">16h
</span><span style="color:black">DOSCODE:8146                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8147                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8147 </span>MatchAttributes endp
<span style="color:black">DOSCODE:8147
DOSCODE:8148
DOSCODE:8148 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8148
DOSCODE:8148
DOSCODE:8148 </span>DEVNAME         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8148                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:8149                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:814A                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:814B                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:814C                 </span><span style="color:navy">push    word ptr </span>NAME1
<span style="color:black">DOSCODE:8150                 </span><span style="color:navy">cmp     </span>NAME1<span style="color:navy">, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:8155                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOKTR
</span><span style="color:black">DOSCODE:8157                 </span><span style="color:navy">mov     </span>NAME1<span style="color:navy">, </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:815C
DOSCODE:815C </span><span style="color:gray">NOKTR</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:815C                 </span><span style="color:navy">test    </span>ATTRIB<span style="color:navy">, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:8161                 </span><span style="color:navy">jnz     short </span><span style="color:gray">RET31
</span><span style="color:black">DOSCODE:8163                 </span><span style="color:navy">mov     si, offset </span>NULDEV
<span style="color:black">DOSCODE:8166
DOSCODE:8166 </span><span style="color:gray">LOOKIO</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8166                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:816B                 </span><span style="color:navy">jz      short </span><span style="color:gray">SKIPDEV
</span><span style="color:black">DOSCODE:816D                 </span><span style="color:navy">mov     ax, si
</span><span style="color:black">DOSCODE:816F                 </span><span style="color:navy">add     si, </span><span style="color:green">10
</span><span style="color:black">DOSCODE:8172                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:8175                 </span><span style="color:navy">mov     cx, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:8178                 </span><span style="color:navy">repe cmpsw
</span><span style="color:black">DOSCODE:817A                 </span><span style="color:navy">mov     si, ax
</span><span style="color:black">DOSCODE:817C                 </span><span style="color:navy">jz      short </span><span style="color:gray">IOCHK
</span><span style="color:black">DOSCODE:817E
DOSCODE:817E </span><span style="color:gray">SKIPDEV</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:817E                 </span><span style="color:navy">lds     si, [si]
</span><span style="color:black">DOSCODE:8180                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8183                 </span><span style="color:navy">jnz     short </span><span style="color:gray">LOOKIO
</span><span style="color:black">DOSCODE:8185
DOSCODE:8185 </span><span style="color:gray">RET31</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8185                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8186
DOSCODE:8186 </span><span style="color:gray">RETNV</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8186                 </span><span style="color:navy">mov     cx, ss
</span><span style="color:black">DOSCODE:8188                 </span><span style="color:navy">mov     ds, cx
</span><span style="color:black">DOSCODE:818A                 </span><span style="color:navy">pop     word ptr </span>NAME1
<span style="color:black">DOSCODE:818E                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:818F                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8190                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8191                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8192                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8193 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8193
DOSCODE:8193 </span><span style="color:gray">IOCHK</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8193                 </span><span style="color:navy">mov     word ptr ss:</span>DEVPT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:8198                 </span><span style="color:navy">mov     bh, [si+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:819B                 </span><span style="color:navy">or      bh, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:819E                 </span><span style="color:navy">and     bh, </span><span style="color:green">0DFh
</span><span style="color:black">DOSCODE:81A1                 </span><span style="color:navy">mov     word ptr ss:</span>DEVPT<span style="color:navy">, si
</span><span style="color:black">DOSCODE:81A6                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RETNV
</span><span style="color:black">DOSCODE:81A6 </span>DEVNAME         endp
<span style="color:black">DOSCODE:81A6
DOSCODE:81A8
DOSCODE:81A8 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:81A8
DOSCODE:81A8
DOSCODE:81A8 </span>Build_device_ent proc near              <span style="color:green">; ...
</span><span style="color:black">DOSCODE:81A8                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">2020h
</span><span style="color:black">DOSCODE:81AB                 </span><span style="color:navy">mov     di, (offset </span>NAME1<span style="color:navy">+</span><span style="color:green">8</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:81AE                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:81AF                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:81B0                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;
</span><span style="color:black">DOSCODE:81B2                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:81B3                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:81B5                 </span><span style="color:navy">mov     cx, </span><span style="color:green">10
</span><span style="color:black">DOSCODE:81B8                 </span><span style="color:navy">rep stosw
</span><span style="color:black">DOSCODE:81BA                 </span><span style="color:navy">call    </span>DATE16
<span style="color:black">DOSCODE:81BD                 </span><span style="color:navy">mov     di, (offset </span>NAME2<span style="color:navy">+</span><span style="color:green">0Ah</span><span style="color:navy">)
</span><span style="color:black">DOSCODE:81C0                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:81C1                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:81C2                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:81C3                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:81C4                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:81C6                 </span><span style="color:navy">mov     ax, word ptr </span>DEVPT
<span style="color:black">DOSCODE:81C9                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:81CA                 </span><span style="color:navy">mov     ax, word ptr </span>DEVPT<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:81CD                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:81CE                 </span><span style="color:navy">mov     ah, bh
</span><span style="color:black">DOSCODE:81D0                 </span><span style="color:navy">mov     bx, offset </span>NAME1
<span style="color:black">DOSCODE:81D3                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:81D5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:81D5 </span>Build_device_ent endp
<span style="color:black">DOSCODE:81D5
DOSCODE:81D6
DOSCODE:81D6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:81D6
DOSCODE:81D6 </span><span style="color:gray">; Attributes: bp-based frame
</span><span style="color:black">DOSCODE:81D6
DOSCODE:81D6 </span>ValidateCDS     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:81D6
DOSCODE:81D6 </span><span style="color:green">SaveCDS         </span><span style="color:navy">= dword ptr </span><span style="color:#008040">-6
</span><span style="color:black">DOSCODE:81D6 </span><span style="color:green">Temp            </span><span style="color:navy">= word ptr </span><span style="color:#008040">-2
</span><span style="color:black">DOSCODE:81D6
DOSCODE:81D6                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:81D7                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:black">DOSCODE:81D9                 </span><span style="color:navy">sub     sp, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:81DC                 </span><span style="color:navy">mov     [bp+</span><span style="color:green">Temp</span><span style="color:navy">], di
</span><span style="color:black">DOSCODE:81DF                 </span><span style="color:navy">lds     si, ss:</span>THISCDS
<span style="color:black">DOSCODE:81E4                 </span><span style="color:navy">mov     word ptr [bp+</span><span style="color:green">SaveCDS</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:81E7                 </span><span style="color:navy">mov     word ptr [bp+</span><span style="color:green">SaveCDS</span><span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:81EA                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:81ED                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:81F2                 </span><span style="color:navy">jz      short </span><span style="color:gray">_DoSplice
</span><span style="color:black">DOSCODE:81F4                 </span><span style="color:navy">jmp     </span><span style="color:gray">FatFail
</span><span style="color:black">DOSCODE:81F7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:81F7
DOSCODE:81F7 </span><span style="color:gray">_DoSplice</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:81F7                 </span><span style="color:navy">xor     dl, dl
</span><span style="color:black">DOSCODE:81F9                 </span><span style="color:navy">xchg    dl, ss:</span>NoSetDir
<span style="color:black">DOSCODE:81FE                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:81FF                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8200                 </span><span style="color:navy">call    </span>FStrCpy
<span style="color:black">DOSCODE:8203                 </span><span style="color:navy">mov     si, [bp+</span><span style="color:green">Temp</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8206                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8207                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8208                 </span><span style="color:navy">call    </span>Splice
<span style="color:black">DOSCODE:820B                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:820C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:820D                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, dl
</span><span style="color:black">DOSCODE:8211                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:8215                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:8216                 </span><span style="color:navy">call    </span>FATREAD_CDS
<span style="color:black">DOSCODE:8219                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:821A                 </span><span style="color:navy">jb      short </span><span style="color:gray">FatFail
</span><span style="color:black">DOSCODE:821C                 </span><span style="color:navy">lds     si, </span>THISCDS
<span style="color:black">DOSCODE:8220                 </span><span style="color:navy">cmp     word ptr [si+</span><span style="color:#ff8000">49h</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8224                 </span><span style="color:navy">jnz     short </span><span style="color:gray">RestoreCDS
</span><span style="color:black">DOSCODE:8226                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8227                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8228                 </span><span style="color:navy">push    ss:</span>WFP_START
<span style="color:black">DOSCODE:822D                 </span><span style="color:navy">cmp     si, word ptr [bp+</span><span style="color:green">SaveCDS</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8230                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoChdir
</span><span style="color:black">DOSCODE:8232                 </span><span style="color:navy">mov     di, [bp+</span><span style="color:green">Temp</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8235                 </span><span style="color:navy">mov     ss:</span>WFP_START<span style="color:navy">, di
</span><span style="color:black">DOSCODE:823A                 </span><span style="color:navy">call    </span>FStrCpy
<span style="color:black">DOSCODE:823D
DOSCODE:823D </span><span style="color:gray">DoChdir</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:823D                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:823E                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:823F                 </span><span style="color:navy">push    word ptr </span>SATTRIB
<span style="color:black">DOSCODE:8243                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:8244                 </span><span style="color:navy">call    </span>DOS_CHDIR
<span style="color:black">DOSCODE:8247                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:8248                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8249                 </span><span style="color:navy">pop     </span>WFP_START
<span style="color:black">DOSCODE:824D                 </span><span style="color:navy">mov     </span>SATTRIB<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:8251                 </span><span style="color:navy">lds     si, [bp+</span><span style="color:green">SaveCDS</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8254                 </span><span style="color:navy">jnb     short </span><span style="color:gray">SetCluster
</span><span style="color:black">DOSCODE:8256                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">, si
</span><span style="color:black">DOSCODE:825B                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:8260                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:8262                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">3</span><span style="color:navy">], cl
</span><span style="color:black">DOSCODE:8265
DOSCODE:8265 </span><span style="color:gray">SetCluster</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8265                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">49h</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:826A                 </span><span style="color:navy">lds     si, ss:</span>THISCDS
<span style="color:black">DOSCODE:826F                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">2000h
</span><span style="color:black">DOSCODE:8274                 </span><span style="color:navy">jz      short </span><span style="color:gray">_setdirclus
</span><span style="color:black">DOSCODE:8276                 </span><span style="color:navy">mov     cx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8279
DOSCODE:8279 </span><span style="color:gray">_setdirclus</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8279                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">49h</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:827C
DOSCODE:827C </span><span style="color:gray">RestoreCDS</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:827C                 </span><span style="color:navy">les     di, [bp+</span><span style="color:green">SaveCDS</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:827F                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">, di
</span><span style="color:black">DOSCODE:8284                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:8289                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:828A
DOSCODE:828A </span><span style="color:gray">FatFail</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:828A                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:828D                 </span><span style="color:navy">les     di, [bp+</span><span style="color:green">SaveCDS</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8290                 </span><span style="color:navy">mov     sp, bp
</span><span style="color:black">DOSCODE:8292                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:8293                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8293 </span>ValidateCDS     endp
<span style="color:black">DOSCODE:8293
DOSCODE:8294
DOSCODE:8294 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8294
DOSCODE:8294
DOSCODE:8294 </span>CheckThisDevice proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8294                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8295                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:8296                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:8298                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:black">DOSCODE:829A                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:829D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ParseDev
</span><span style="color:black">DOSCODE:829F                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:82A0                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:82A1                 </span><span style="color:navy">or      ax, </span><span style="color:green">2020h
</span><span style="color:black">DOSCODE:82A4                 </span><span style="color:navy">cmp     ax, &#039;</span><span style="color:green">ed&#039;
</span><span style="color:black">DOSCODE:82A7                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NotDevice
</span><span style="color:black">DOSCODE:82A9                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:82AA                 </span><span style="color:navy">or      al, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:82AC                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">v&#039;
</span><span style="color:black">DOSCODE:82AE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NotDevice
</span><span style="color:black">DOSCODE:82B0                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:82B1                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:82B4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NotDevice
</span><span style="color:black">DOSCODE:82B6
DOSCODE:82B6 </span><span style="color:gray">ParseDev</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:82B6                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:82B7                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:82B8                 </span><span style="color:navy">call    </span>NameTrans
<span style="color:black">DOSCODE:82BB                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:82BE                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:82BF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SkipSearch
</span><span style="color:black">DOSCODE:82C1                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:82C2                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:82C3                 </span><span style="color:navy">mov     al, </span>SATTRIB
<span style="color:black">DOSCODE:82C6                 </span><span style="color:navy">mov     </span>ATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:82C9                 </span><span style="color:navy">call    </span>DEVNAME
<span style="color:black">DOSCODE:82CC
DOSCODE:82CC </span><span style="color:gray">SkipSearch</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:82CC                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:82CD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:82CE
DOSCODE:82CE </span><span style="color:gray">CheckReturn</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:82CE                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:82CF                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Check_Done
</span><span style="color:black">DOSCODE:82D1                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:82D3
DOSCODE:82D3 </span><span style="color:gray">Check_Done</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:82D3                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:82D4                 </span><span style="color:navy">cmc
</span><span style="color:black">DOSCODE:82D5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:82D6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:82D6
DOSCODE:82D6 </span><span style="color:gray">NotDevice</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:82D6                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:82D7                 </span><span style="color:navy">jmp     short </span><span style="color:gray">CheckReturn
</span><span style="color:black">DOSCODE:82D7 </span>CheckThisDevice endp
<span style="color:black">DOSCODE:82D7
DOSCODE:82D9
DOSCODE:82D9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:82D9
DOSCODE:82D9
DOSCODE:82D9 </span>LookupPath      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:82D9                 </span><span style="color:navy">test    ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:82DF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FASTINST
</span><span style="color:black">DOSCODE:82E1
DOSCODE:82E1 </span><span style="color:gray">NOLOOK</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:82E1                 </span><span style="color:navy">jmp     </span><span style="color:gray">NOLOOKUP
</span><span style="color:black">DOSCODE:82E4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:82E4
DOSCODE:82E4 </span><span style="color:gray">FASTINST</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:82E4                 </span><span style="color:navy">test    ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:82EA                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOLOOK
</span><span style="color:black">DOSCODE:82EC                 </span><span style="color:navy">mov     bx, offset </span>FastOpenTable
<span style="color:black">DOSCODE:82EF                 </span><span style="color:navy">mov     si, ss:</span>WFP_START
<span style="color:black">DOSCODE:82F4                 </span><span style="color:navy">mov     di, offset </span>Dir_Info_Buff
<span style="color:black">DOSCODE:82F7                 </span><span style="color:navy">mov     cx, offset </span>FastOpen_Ext_Info
<span style="color:black">DOSCODE:82FA                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:82FC                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:82FD                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:82FE                 </span><span style="color:navy">call    dword ptr [bx+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8301                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOTFOUND
</span><span style="color:black">DOSCODE:8303                 </span><span style="color:navy">lea     bx, [si-</span><span style="color:green">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8306                 </span><span style="color:navy">cmp     bx, ss:</span>WFP_START
<span style="color:black">DOSCODE:830B                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOTFOUND
</span><span style="color:black">DOSCODE:830D                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8310                 </span><span style="color:navy">jnz     short </span><span style="color:gray">parfnd
</span><span style="color:black">DOSCODE:8312                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8313                 </span><span style="color:navy">mov     cl, ss:</span>ATTRIB
<span style="color:black">DOSCODE:8318                 </span><span style="color:navy">mov     ch, ss:</span>SATTRIB
<span style="color:black">DOSCODE:831D                 </span><span style="color:navy">mov     ss:</span>ATTRIB<span style="color:navy">, ch
</span><span style="color:black">DOSCODE:8322                 </span><span style="color:navy">mov     ch, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8326                 </span><span style="color:navy">call    </span>MatchAttributes
<span style="color:black">DOSCODE:8329                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:832A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOLOOKUP
</span><span style="color:black">DOSCODE:832C
DOSCODE:832C </span><span style="color:gray">parfnd</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:832C                 </span><span style="color:navy">mov     ss:</span>Next_Element_Start<span style="color:navy">, si
</span><span style="color:black">DOSCODE:8331                 </span><span style="color:navy">mov     bx, cx
</span><span style="color:black">DOSCODE:8333                 </span><span style="color:navy">mov     ax, [bx+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8336                 </span><span style="color:navy">mov     ss:</span>LASTENT<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:833A                 </span><span style="color:navy">mov     ax, [bx+</span><span style="color:#ff8000">9</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:833D                 </span><span style="color:navy">mov     ss:</span>DIRSTART<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8341                 </span><span style="color:navy">mov     ax, [bx+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8344                 </span><span style="color:navy">mov     ss:</span>CLUSNUM<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8348                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8349                 </span><span style="color:navy">les     bx, ss:</span>THISDPB
<span style="color:black">DOSCODE:834E                 </span><span style="color:navy">mov     ah, es:[bx]
</span><span style="color:black">DOSCODE:8351                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8352                 </span><span style="color:navy">mov     word ptr ss:</span>CURBUF<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:8359                 </span><span style="color:navy">mov     word ptr ss:</span>CURBUF<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:835E                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:8360                 </span><span style="color:navy">lea     si, [di+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8363                 </span><span style="color:navy">or      ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">12h
</span><span style="color:black">DOSCODE:8369                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:836A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:836A
DOSCODE:836A </span><span style="color:gray">NOTFOUND</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:836A                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:836D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Partial_Success
</span><span style="color:black">DOSCODE:836F                 </span><span style="color:navy">mov     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8375
DOSCODE:8375 </span><span style="color:gray">Partial_Success</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8375                 </span><span style="color:navy">and     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">0FBh
</span><span style="color:black">DOSCODE:837B
DOSCODE:837B </span><span style="color:gray">NOLOOKUP</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:837B                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:837C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:837C </span>LookupPath      endp
<span style="color:black">DOSCODE:837C
DOSCODE:837D
DOSCODE:837D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:837D
DOSCODE:837D
DOSCODE:837D </span>InsertPath      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:837D                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:837E                 </span><span style="color:navy">test    ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8384                 </span><span style="color:navy">jz      short </span><span style="color:gray">GET_NEXT_ELEMENT
</span><span style="color:black">DOSCODE:8386                 </span><span style="color:navy">test    ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:838C                 </span><span style="color:navy">jz      short </span><span style="color:gray">INSERT_DIR_INFO
</span><span style="color:black">DOSCODE:838E                 </span><span style="color:navy">and     ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">0FDh
</span><span style="color:black">DOSCODE:8394                 </span><span style="color:navy">mov     di, ss:</span>Next_Element_Start
<span style="color:black">DOSCODE:8399                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GET_NEXT2
</span><span style="color:black">DOSCODE:839B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:839B
DOSCODE:839B </span><span style="color:gray">INSERT_DIR_INFO</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:839B                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:839C                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:839D                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:839E                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:839F                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:83A0                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:83A1                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:83A2                 </span><span style="color:navy">lds     di, ss:</span>CURBUF
<span style="color:black">DOSCODE:83A7                 </span><span style="color:navy">mov     si, offset </span>FastOpen_Ext_Info
<span style="color:black">DOSCODE:83AA                 </span><span style="color:navy">mov     ax, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:83AD                 </span><span style="color:navy">mov     ss:[si+</span><span style="color:#ff8000">1</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:83B1                 </span><span style="color:navy">mov     ax, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:83B4                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:83B5                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:83B6                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">3</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:83B9                 </span><span style="color:navy">mov     ax, </span>CLUSNUM
<span style="color:black">DOSCODE:83BC                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">5</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:83BF                 </span><span style="color:navy">mov     ax, </span>LASTENT
<span style="color:black">DOSCODE:83C2                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">7</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:83C5                 </span><span style="color:navy">mov     ax, </span>DIRSTART
<span style="color:black">DOSCODE:83C8                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">9</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:83CB                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:83CD                 </span><span style="color:navy">add     di, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:83D0                 </span><span style="color:navy">sub     ax, di
</span><span style="color:black">DOSCODE:83D2                 </span><span style="color:navy">mov     cl, </span><span style="color:green">32
</span><span style="color:black">DOSCODE:83D4                 </span><span style="color:navy">div     cl
</span><span style="color:black">DOSCODE:83D6                 </span><span style="color:navy">mov     [si], al
</span><span style="color:black">DOSCODE:83D8                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:83D9                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:83DA                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:83DE                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:83E0                 </span><span style="color:navy">cmp     word ptr [di+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:83E4                 </span><span style="color:navy">jz      short </span><span style="color:gray">SKIP_INSERT
</span><span style="color:black">DOSCODE:83E6                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:83E7                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:83E8                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:83EA                 </span><span style="color:navy">mov     si, offset </span>FastOpenTable
<span style="color:black">DOSCODE:83ED                 </span><span style="color:navy">call    dword ptr es:[si+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:83F1                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:83F2
DOSCODE:83F2 </span><span style="color:gray">SKIP_INSERT</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:83F2                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:83F3                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:83F4                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:83F5                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:83F6                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:83F7                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:83F8                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:83F9
DOSCODE:83F9 </span><span style="color:gray">GET_NEXT2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:83F9                 </span><span style="color:navy">or      ss:</span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:83FF
DOSCODE:83FF </span><span style="color:gray">GET_NEXT_ELEMENT</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:83FF                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:8400                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8400 </span>InsertPath      endp
<span style="color:black">DOSCODE:8400
DOSCODE:8400 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:8401 </span>LenTab          <span style="color:navy">db </span><span style="color:#008040">22</span><span style="color:navy">, </span><span style="color:#008040">14</span><span style="color:navy">, </span><span style="color:#008040">22</span><span style="color:navy">, </span><span style="color:#008040">13</span><span style="color:navy">, </span><span style="color:#008040">15</span><span style="color:navy">, </span><span style="color:#008040">14 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:8407 </span>CmdTab          <span style="color:navy">db </span><span style="color:#008040">86h</span><span style="color:navy">, </span><span style="color:#008040">4               </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:8409                 </span><span style="color:navy">db </span><span style="color:#008040">86h</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:gray">DOSCODE:840B                 </span><span style="color:navy">db </span><span style="color:#008040">87h</span><span style="color:navy">, </span><span style="color:#008040">8
</span><span style="color:gray">DOSCODE:840D                 </span><span style="color:navy">db </span><span style="color:#008040">87h</span><span style="color:navy">, </span><span style="color:#008040">0Ah
</span><span style="color:gray">DOSCODE:840F                 </span><span style="color:navy">db </span><span style="color:#008040">86h</span><span style="color:navy">, </span><span style="color:#008040">7
</span><span style="color:gray">DOSCODE:8411                 </span><span style="color:navy">db </span><span style="color:#008040">86h</span><span style="color:navy">, </span><span style="color:#008040">5
</span><span style="color:black">DOSCODE:8413
DOSCODE:8413 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8413
DOSCODE:8413
DOSCODE:8413 </span>IOFUNC          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8413                 </span><span style="color:navy">mov     word ptr ss:</span>IOXAD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ss
</span><span style="color:black">DOSCODE:8418                 </span><span style="color:navy">mov     word ptr ss:</span>IOXAD<span style="color:navy">, offset </span>DEVIOBUF
<span style="color:black">DOSCODE:841F                 </span><span style="color:navy">mov     ss:</span>IOSCNT<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8426                 </span><span style="color:navy">mov     ss:</span>DEVIOBUF<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:842A                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:842E                 </span><span style="color:navy">jz      short </span><span style="color:gray">IOTO22
</span><span style="color:black">DOSCODE:8430                 </span><span style="color:navy">jmp     </span><span style="color:gray">IOTOFILE
</span><span style="color:black">DOSCODE:8433 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8433
DOSCODE:8433 </span><span style="color:gray">IOTO22</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8433                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:8437                 </span><span style="color:navy">jnz     short </span><span style="color:gray">IOTO33
</span><span style="color:black">DOSCODE:8439                 </span><span style="color:navy">jmp     </span><span style="color:gray">IOTOFILE
</span><span style="color:black">DOSCODE:843C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:843C
DOSCODE:843C </span><span style="color:gray">IOTO33</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:843C                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:843D                 </span><span style="color:navy">call    </span>save_world
<span style="color:black">DOSCODE:8440                 </span><span style="color:navy">mov     dx, ds
</span><span style="color:black">DOSCODE:8442                 </span><span style="color:navy">mov     bx, ss
</span><span style="color:black">DOSCODE:8444                 </span><span style="color:navy">mov     ds, bx
</span><span style="color:black">DOSCODE:8446                 </span><span style="color:navy">mov     es, bx
</span><span style="color:black">DOSCODE:8448                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:844A                 </span><span style="color:navy">cmp     ah, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:844D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">_no_sys_wait
</span><span style="color:black">DOSCODE:844F                 </span><span style="color:navy">or      bx, </span><span style="color:green">400h
</span><span style="color:black">DOSCODE:8453
DOSCODE:8453 </span><span style="color:gray">_no_sys_wait</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8453                 </span><span style="color:navy">mov     </span>IOCALL_REQSTAT<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:8457                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:8459                 </span><span style="color:navy">mov     </span>IOMED<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:845D                 </span><span style="color:navy">mov     bl, ah
</span><span style="color:black">DOSCODE:845F                 </span><span style="color:navy">mov     ah, cs:</span>LenTab<span style="color:navy">[bx]
</span><span style="color:black">DOSCODE:8464                 </span><span style="color:navy">shl     bx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8466                 </span><span style="color:navy">mov     cx, word ptr cs:</span>CmdTab<span style="color:navy">[bx]
</span><span style="color:black">DOSCODE:846B                 </span><span style="color:navy">mov     bx, offset </span>IOCALL
<span style="color:black">DOSCODE:846E                 </span><span style="color:navy">mov     </span>IOCALL<span style="color:navy">, ah
</span><span style="color:black">DOSCODE:8472                 </span><span style="color:navy">mov     </span>IOCALL_REQFUNC<span style="color:navy">, ch
</span><span style="color:black">DOSCODE:8476                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:black">DOSCODE:8478                 </span><span style="color:navy">call    </span>DEVIOCALL
<span style="color:black">DOSCODE:847B                 </span><span style="color:navy">mov     di, ss:</span>IOCALL_REQSTAT
<span style="color:black">DOSCODE:8480                 </span><span style="color:navy">and     di, di
</span><span style="color:black">DOSCODE:8482                 </span><span style="color:navy">js      short </span><span style="color:gray">DevErr
</span><span style="color:black">DOSCODE:8484
DOSCODE:8484 </span><span style="color:gray">OKDevIO</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8484                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:black">DOSCODE:8486                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:8488                 </span><span style="color:navy">cmp     ch, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:848B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DNODRD
</span><span style="color:black">DOSCODE:848D                 </span><span style="color:navy">mov     al, </span>IOMED
<span style="color:black">DOSCODE:8490                 </span><span style="color:navy">mov     byte ptr </span>DEVIOBUF<span style="color:navy">, al
</span><span style="color:black">DOSCODE:8493
DOSCODE:8493 </span><span style="color:gray">DNODRD</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8493                 </span><span style="color:navy">mov     ah, byte ptr </span>IOCALL_REQSTAT<span style="color:navy">+</span><span style="color:green">1
</span><span style="color:black">DOSCODE:8497                 </span><span style="color:navy">not     ah
</span><span style="color:black">DOSCODE:8499                 </span><span style="color:navy">and     ah, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:849C
DOSCODE:849C </span>QuickReturn<span style="color:navy">:
</span><span style="color:black">DOSCODE:849C                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:849F                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:84A0                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:84A1                 </span><span style="color:navy">mov     al, ss:</span>IoStatFail
<span style="color:black">DOSCODE:84A5                 </span><span style="color:navy">cbw
</span><span style="color:black">DOSCODE:84A6                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:84A9                 </span><span style="color:navy">jnz     short </span><span style="color:gray">not_fail_ret
</span><span style="color:black">DOSCODE:84AB                 </span><span style="color:navy">inc     ss:</span>IoStatFail
<span style="color:black">DOSCODE:84B0                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:84B1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:84B2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:84B2
DOSCODE:84B2 </span><span style="color:gray">not_fail_ret</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84B2                 </span><span style="color:navy">mov     ax, ss:</span>DEVIOBUF
<span style="color:black">DOSCODE:84B6                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:84B7                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:84B8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:84B8
DOSCODE:84B8 </span><span style="color:gray">DevErr</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84B8                 </span><span style="color:navy">mov     ah, cl
</span><span style="color:black">DOSCODE:84BA                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:84BD                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:84BF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO_RETRY
</span><span style="color:black">DOSCODE:84C1                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:84C4                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:84C5                 </span><span style="color:navy">jmp     </span>IOFUNC
<span style="color:black">DOSCODE:84C8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:84C8
DOSCODE:84C8 </span><span style="color:gray">NO_RETRY</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84C8                 </span><span style="color:navy">and     byte ptr ss:</span>IOCALL_REQSTAT<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">0FDh
</span><span style="color:black">DOSCODE:84CE                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:84D0                 </span><span style="color:navy">jnz     short </span><span style="color:gray">not_fail
</span><span style="color:black">DOSCODE:84D2                 </span><span style="color:navy">dec     ss:</span>IoStatFail
<span style="color:black">DOSCODE:84D7
DOSCODE:84D7 </span><span style="color:gray">not_fail</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84D7                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OKDevIO
</span><span style="color:black">DOSCODE:84D9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:84D9
DOSCODE:84D9 </span><span style="color:gray">IOTOFILE</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84D9                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:84DB                 </span><span style="color:navy">jz      short </span>IOIN
<span style="color:black">DOSCODE:84DD                 </span><span style="color:navy">dec     ah
</span><span style="color:black">DOSCODE:84DF                 </span><span style="color:navy">jz      short </span><span style="color:gray">IOIST
</span><span style="color:black">DOSCODE:84E1                 </span><span style="color:navy">dec     ah
</span><span style="color:black">DOSCODE:84E3                 </span><span style="color:navy">jz      short </span><span style="color:gray">IOUT
</span><span style="color:black">DOSCODE:84E5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:84E6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:84E6
DOSCODE:84E6 </span><span style="color:gray">IOIST</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84E6                 </span><span style="color:navy">push    word ptr [si+</span><span style="color:#ff8000">15h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:84E9                 </span><span style="color:navy">push    word ptr [si+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:84EC                 </span><span style="color:navy">call    </span>IOIN
<span style="color:black">DOSCODE:84EF                 </span><span style="color:navy">pop     word ptr [si+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:84F2                 </span><span style="color:navy">pop     word ptr [si+</span><span style="color:#ff8000">15h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:84F5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:84F6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:84F6
DOSCODE:84F6 </span><span style="color:gray">IOUT</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84F6                 </span><span style="color:navy">call    </span>SETXADDR
<span style="color:black">DOSCODE:84F9                 </span><span style="color:navy">call    </span>DOS_WRITE
<span style="color:black">DOSCODE:84FC                 </span><span style="color:navy">call    </span>RESTXADDR
<span style="color:black">DOSCODE:84FF
DOSCODE:84FF </span>IOUT_retn<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:84FF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:84FF </span>IOFUNC          endp
<span style="color:black">DOSCODE:84FF
DOSCODE:8500
DOSCODE:8500 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8500
DOSCODE:8500
DOSCODE:8500 </span>IOIN            proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8500                 </span><span style="color:navy">call    </span>SETXADDR
<span style="color:black">DOSCODE:8503                 </span><span style="color:navy">or      ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:8509                 </span><span style="color:navy">call    </span>DOS_READ
<span style="color:black">DOSCODE:850C                 </span><span style="color:navy">and     ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">0FFBFh
</span><span style="color:black">DOSCODE:8512                 </span><span style="color:navy">or      cx, cx
</span><span style="color:black">DOSCODE:8514                 </span><span style="color:navy">call    </span>RESTXADDR
<span style="color:black">DOSCODE:8517                 </span><span style="color:navy">mov     al, byte ptr ss:</span>DEVIOBUF
<span style="color:black">DOSCODE:851B                 </span><span style="color:navy">jnz     short </span>IOUT_retn
<span style="color:black">DOSCODE:851D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:851F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:851F </span>IOIN            endp
<span style="color:black">DOSCODE:851F
DOSCODE:8520
DOSCODE:8520 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8520
DOSCODE:8520
DOSCODE:8520 </span>SETXADDR        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8520                 </span><span style="color:navy">pop     word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:8525                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8526                 </span><span style="color:navy">call    </span>save_world
<span style="color:black">DOSCODE:8529                 </span><span style="color:navy">push    word ptr ss:</span>DMAADD
<span style="color:black">DOSCODE:852E                 </span><span style="color:navy">push    word ptr ss:</span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8533                 </span><span style="color:navy">mov     word ptr ss:</span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:8538                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8539                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:853A                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, si
</span><span style="color:black">DOSCODE:853E                 </span><span style="color:navy">mov     cx, word ptr </span>IOXAD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8542                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, cx
</span><span style="color:black">DOSCODE:8546                 </span><span style="color:navy">mov     cx, word ptr </span>IOXAD
<span style="color:black">DOSCODE:854A                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:854E                 </span><span style="color:navy">mov     cx, </span>IOSCNT
<span style="color:black">DOSCODE:8552                 </span><span style="color:navy">jmp     short </span>RESTRET
<span style="color:black">DOSCODE:8552 </span>SETXADDR        endp
<span style="color:black">DOSCODE:8552
DOSCODE:8554
DOSCODE:8554 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8554
DOSCODE:8554
DOSCODE:8554 </span>RESTXADDR       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8554                 </span><span style="color:navy">pop     word ptr </span>CALLBPB
<span style="color:black">DOSCODE:8558                 </span><span style="color:navy">pop     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:855C                 </span><span style="color:navy">pop     word ptr </span>DMAADD
<span style="color:black">DOSCODE:8560                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:8563                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8564
DOSCODE:8564 </span>RESTRET<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8564                 </span><span style="color:navy">jmp     word ptr ss:</span>CALLBPB
<span style="color:black">DOSCODE:8564 </span>RESTXADDR       endp
<span style="color:black">DOSCODE:8564
DOSCODE:8569
DOSCODE:8569 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8569
DOSCODE:8569
DOSCODE:8569 </span>DEV_OPEN_SFT    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8569                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:856A                 </span><span style="color:navy">call    </span>save_world
<span style="color:black">DOSCODE:856D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Dh
</span><span style="color:black">DOSCODE:856F                 </span><span style="color:navy">jmp     short </span>DO_OPCLS
<span style="color:black">DOSCODE:856F </span>DEV_OPEN_SFT    endp
<span style="color:black">DOSCODE:856F
DOSCODE:8571
DOSCODE:8571 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8571
DOSCODE:8571
DOSCODE:8571 </span>DEV_CLOSE_SFT   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8571                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8572                 </span><span style="color:navy">call    </span>save_world
<span style="color:black">DOSCODE:8575                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Eh
</span><span style="color:black">DOSCODE:8577
DOSCODE:8577 </span>DO_OPCLS<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8577                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:857C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OPCLS_DONE
</span><span style="color:black">DOSCODE:857E                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:8580                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:8585                 </span><span style="color:navy">les     di, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8589                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GOT_DEV_ADDR
</span><span style="color:black">DOSCODE:858B                 </span><span style="color:navy">cmp     ss:</span>fShare<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8591                 </span><span style="color:navy">jbe     short </span><span style="color:gray">OPCLS_DONE
</span><span style="color:black">DOSCODE:8593                 </span><span style="color:navy">mov     ah, es:[di+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8597                 </span><span style="color:navy">mov     cl, es:[di]
</span><span style="color:black">DOSCODE:859A                 </span><span style="color:navy">les     di, es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:859E
DOSCODE:859E </span><span style="color:gray">GOT_DEV_ADDR</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:859E                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:85A3                 </span><span style="color:navy">jz      short </span><span style="color:gray">OPCLS_DONE
</span><span style="color:black">DOSCODE:85A5                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:85A6                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:85A7                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:85A9
DOSCODE:85A9 </span><span style="color:gray">OPCLS_RETRY</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:85A9                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:85AA                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:85AB                 </span><span style="color:navy">mov     di, offset </span>DEVCALL
<span style="color:black">DOSCODE:85AE                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:85B0                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:85B1                 </span><span style="color:navy">mov     al, </span><span style="color:green">13
</span><span style="color:black">DOSCODE:85B3                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:85B4                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:85B5                 </span><span style="color:navy">xchg    ah, al
</span><span style="color:black">DOSCODE:85B7                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:85B8                 </span><span style="color:navy">xchg    ah, al
</span><span style="color:black">DOSCODE:85BA                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:85BB                 </span><span style="color:navy">mov     word ptr es:[di], </span><span style="color:green">0
</span><span style="color:black">DOSCODE:85C0                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:85C1                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:85C4                 </span><span style="color:navy">mov     di, es:[bx+</span><span style="color:green">3</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:85C8                 </span><span style="color:navy">and     di, di
</span><span style="color:black">DOSCODE:85CA                 </span><span style="color:navy">jns     short </span><span style="color:gray">OPCLS_DONEP
</span><span style="color:black">DOSCODE:85CC                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:green">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:85D0                 </span><span style="color:navy">jz      short </span><span style="color:gray">BLKDEV
</span><span style="color:black">DOSCODE:85D2                 </span><span style="color:navy">mov     ah, </span><span style="color:green">86h
</span><span style="color:black">DOSCODE:85D4                 </span><span style="color:navy">jmp     short </span><span style="color:gray">HRDERR
</span><span style="color:black">DOSCODE:85D6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:85D6
DOSCODE:85D6 </span><span style="color:gray">BLKDEV</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:85D6                 </span><span style="color:navy">mov     al, cl
</span><span style="color:black">DOSCODE:85D8                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:85DA
DOSCODE:85DA </span><span style="color:gray">HRDERR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:85DA                 </span><span style="color:navy">call    </span>CHARHARD
<span style="color:black">DOSCODE:85DD                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:85DF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OPCLS_DONEP
</span><span style="color:black">DOSCODE:85E1                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:85E2                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OPCLS_RETRY
</span><span style="color:black">DOSCODE:85E4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:85E4
DOSCODE:85E4 </span><span style="color:gray">OPCLS_DONEP</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:85E4                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:85E5
DOSCODE:85E5 </span><span style="color:gray">OPCLS_DONE</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:85E5                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:85E8                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:85E9                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:85E9 </span>DEV_CLOSE_SFT   endp
<span style="color:black">DOSCODE:85E9
DOSCODE:85EA
DOSCODE:85EA </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:85EA
DOSCODE:85EA
DOSCODE:85EA </span>DEVIOCALL       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:85EA                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:85EA </span>DEVIOCALL       endp
<span style="color:black">DOSCODE:85EA
DOSCODE:85ED
DOSCODE:85ED </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:85ED
DOSCODE:85ED
DOSCODE:85ED </span>DEVIOCALL2      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:85ED                 </span><span style="color:navy">call    </span>ECritDevice
<span style="color:black">DOSCODE:85F0                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:85F4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">chardev2
</span><span style="color:black">DOSCODE:85F6                 </span><span style="color:navy">cmp     byte ptr es:[bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:85FB                 </span><span style="color:navy">jz      short </span><span style="color:gray">chkext
</span><span style="color:black">DOSCODE:85FD                 </span><span style="color:navy">cmp     byte ptr es:[bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:8602                 </span><span style="color:navy">jz      short </span><span style="color:gray">chkext
</span><span style="color:black">DOSCODE:8604                 </span><span style="color:navy">cmp     byte ptr es:[bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:#ff8000">9
</span><span style="color:black">DOSCODE:8609                 </span><span style="color:navy">jnz     short </span><span style="color:gray">chardev2
</span><span style="color:black">DOSCODE:860B
DOSCODE:860B </span><span style="color:gray">chkext</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:860B                 </span><span style="color:navy">call    </span>RW_SC
<span style="color:black">DOSCODE:860E                 </span><span style="color:navy">jb      short </span><span style="color:gray">dev_exit
</span><span style="color:black">DOSCODE:8610                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:8614                 </span><span style="color:navy">jz      short </span><span style="color:gray">chksector
</span><span style="color:black">DOSCODE:8616                 </span><span style="color:navy">add     byte ptr es:[bx], </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:861A                 </span><span style="color:navy">mov     ax, word ptr ss:</span>CALLBPB<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:861E                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBPB<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8625                 </span><span style="color:navy">mov     word ptr ss:</span>CALLNEWSC<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8629                 </span><span style="color:navy">mov     ax, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:862D                 </span><span style="color:navy">mov     word ptr ss:</span>CALLNEWSC<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8631                 </span><span style="color:navy">jmp     short </span><span style="color:gray">chardev2
</span><span style="color:black">DOSCODE:8633 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8633
DOSCODE:8633 </span><span style="color:gray">chksector</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8633                 </span><span style="color:navy">cmp     ss:</span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8639                 </span><span style="color:navy">jz      short </span><span style="color:gray">chardev2
</span><span style="color:black">DOSCODE:863B                 </span><span style="color:navy">mov     word ptr es:[bx+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">8107h
</span><span style="color:black">DOSCODE:8641                 </span><span style="color:navy">jmp     short </span><span style="color:gray">dev_exit
</span><span style="color:black">DOSCODE:8643 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8643
DOSCODE:8643 </span><span style="color:gray">chardev2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8643                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8646                 </span><span style="color:navy">mov     word ptr ss:</span>CALLDEVAD<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:864A                 </span><span style="color:navy">mov     word ptr ss:</span>CALLDEVAD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:864F                 </span><span style="color:navy">call    ss:</span>CALLDEVAD
<span style="color:black">DOSCODE:8654                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8657                 </span><span style="color:navy">mov     word ptr ss:</span>CALLDEVAD<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:865B                 </span><span style="color:navy">call    ss:</span>CALLDEVAD
<span style="color:black">DOSCODE:8660                 </span><span style="color:navy">call    </span>VIRREAD
<span style="color:black">DOSCODE:8663                 </span><span style="color:navy">jb      short </span><span style="color:gray">chardev2
</span><span style="color:black">DOSCODE:8665
DOSCODE:8665 </span><span style="color:gray">dev_exit</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8665                 </span><span style="color:navy">call    </span>LCritDevice
<span style="color:black">DOSCODE:8668                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8668 </span>DEVIOCALL2      endp
<span style="color:black">DOSCODE:8668
DOSCODE:8669
DOSCODE:8669 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8669
DOSCODE:8669
DOSCODE:8669 </span>SETREAD         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8669                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:866A                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:866B                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:866C                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:866E
DOSCODE:866E </span>SETCALLHEAD<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:866E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:8670                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8671                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8672                 </span><span style="color:navy">mov     di, offset </span>DEVCALL
<span style="color:black">DOSCODE:8675                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8676                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8677                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8678                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8679                 </span><span style="color:navy">mov     al, cl
</span><span style="color:black">DOSCODE:867B                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:867C                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:867E                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:867F                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:8682                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8683                 </span><span style="color:navy">xchg    ah, al
</span><span style="color:black">DOSCODE:8685                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8686                 </span><span style="color:navy">xchg    al, ah
</span><span style="color:black">DOSCODE:8688                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8689                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:868B                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:868C                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:868E                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:868F                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8690                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8691                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8692                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:8693                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8694                 </span><span style="color:navy">xchg    ax, cx
</span><span style="color:black">DOSCODE:8695                 </span><span style="color:navy">xchg    dx, cx
</span><span style="color:black">DOSCODE:8697                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8698                 </span><span style="color:navy">mov     bx, offset </span>DEVCALL
<span style="color:black">DOSCODE:869B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:869B </span>SETREAD         endp
<span style="color:black">DOSCODE:869B
DOSCODE:869C
DOSCODE:869C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:869C
DOSCODE:869C
DOSCODE:869C </span>SETWRITE        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:869C                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:869D                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:869E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:869F                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:86A1                 </span><span style="color:navy">add     cl, ss:</span>VERFLG
<span style="color:black">DOSCODE:86A6                 </span><span style="color:navy">jmp     short </span>SETCALLHEAD
<span style="color:black">DOSCODE:86A6 </span>SETWRITE        endp
<span style="color:black">DOSCODE:86A6
DOSCODE:86A8
DOSCODE:86A8 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:86A8
DOSCODE:86A8
DOSCODE:86A8 </span>RW_SC           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:86A8                 </span><span style="color:navy">cmp     ss:</span>SC_CACHE_COUNT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:86AE                 </span><span style="color:navy">jz      short </span><span style="color:gray">scexit4
</span><span style="color:black">DOSCODE:86B0                 </span><span style="color:navy">cmp     word ptr ss:</span>CALLBPB<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:86B6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">scexit4
</span><span style="color:black">DOSCODE:86B8                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:86B9                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:86BA                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:86BB                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:86BC                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:86BD                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:86BE                 </span><span style="color:navy">mov     dx, word ptr ss:</span>CALLBPB<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:86C3                 </span><span style="color:navy">cmp     ss:</span>DEVCALL_REQFUNC<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:86C9                 </span><span style="color:navy">jz      short </span><span style="color:gray">doread
</span><span style="color:black">DOSCODE:86CB                 </span><span style="color:navy">call    </span>INVALIDATE_SC
<span style="color:black">DOSCODE:86CE                 </span><span style="color:navy">jmp     </span><span style="color:gray">scexit2
</span><span style="color:black">DOSCODE:86D1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:86D1
DOSCODE:86D1 </span><span style="color:gray">scexit4</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:86D1                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:86D2                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:86D3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:86D3
DOSCODE:86D3 </span><span style="color:gray">doread</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:86D3                 </span><span style="color:navy">call    </span>SC2BUF
<span style="color:black">DOSCODE:86D6                 </span><span style="color:navy">jb      short </span><span style="color:gray">readSC
</span><span style="color:black">DOSCODE:86D8                 </span><span style="color:navy">mov     ss:</span>DEVCALL_REQSTAT<span style="color:navy">, </span><span style="color:#ff8000">100h
</span><span style="color:black">DOSCODE:86DF                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:86E0                 </span><span style="color:navy">jmp     short </span><span style="color:gray">saveseq
</span><span style="color:black">DOSCODE:86E2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:86E2
DOSCODE:86E2 </span><span style="color:gray">readSC</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:86E2                 </span><span style="color:navy">mov     ax, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:86E6                 </span><span style="color:navy">mov     cx, word ptr ss:</span>CALLBPB<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:86EB                 </span><span style="color:navy">sub     cx, ss:</span>SEQ_SECTOR
<span style="color:black">DOSCODE:86F0                 </span><span style="color:navy">sbb     ax, ss:</span>SEQ_SECTOR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:86F5                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:86F8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">saveseq2
</span><span style="color:black">DOSCODE:86FA
DOSCODE:86FA </span>chklow<span style="color:navy">:
</span><span style="color:black">DOSCODE:86FA                 </span><span style="color:navy">cmp     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:86FD                 </span><span style="color:navy">ja      short </span><span style="color:gray">saveseq2
</span><span style="color:black">DOSCODE:86FF                 </span><span style="color:navy">mov     ss:</span>SC_STATUS<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8706                 </span><span style="color:navy">mov     ax, ss:</span>SC_CACHE_COUNT
<span style="color:black">DOSCODE:870A                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBPB<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:870E
DOSCODE:870E </span>readsr<span style="color:navy">:
</span><span style="color:black">DOSCODE:870E                 </span><span style="color:navy">mov     ax, word ptr ss:</span>CALLBR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8712                 </span><span style="color:navy">mov     ss:</span>TEMP_VAR2<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8716                 </span><span style="color:navy">mov     ax, word ptr ss:</span>CALLBR
<span style="color:black">DOSCODE:871A                 </span><span style="color:navy">mov     ss:</span>TEMP_VAR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:871E                 </span><span style="color:navy">mov     ax, word ptr ss:</span>SC_CACHE_PTR
<span style="color:black">DOSCODE:8722                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8726                 </span><span style="color:navy">mov     ax, word ptr ss:</span>SC_CACHE_PTR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:872A                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBR<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:872E                 </span><span style="color:navy">mov     ss:</span>SC_FLAG<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8734                 </span><span style="color:navy">mov     al, ss:</span>SC_DRIVE
<span style="color:black">DOSCODE:8738                 </span><span style="color:navy">mov     ss:</span>CurSC_DRIVE<span style="color:navy">, al
</span><span style="color:black">DOSCODE:873C                 </span><span style="color:navy">mov     ax, word ptr ss:</span>CALLBPB<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8740                 </span><span style="color:navy">mov     ss:</span>CurSC_SECTOR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8744                 </span><span style="color:navy">mov     ax, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:8748                 </span><span style="color:navy">mov     ss:</span>CurSC_SECTOR<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:874C
DOSCODE:874C </span><span style="color:gray">saveseq2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:874C                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:874D
DOSCODE:874D </span><span style="color:gray">saveseq</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:874D                 </span><span style="color:navy">mov     ax, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:8751                 </span><span style="color:navy">mov     ss:</span>SEQ_SECTOR<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8755                 </span><span style="color:navy">mov     ax, word ptr ss:</span>CALLBPB<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8759                 </span><span style="color:navy">mov     ss:</span>SEQ_SECTOR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:875D                 </span><span style="color:navy">jmp     short </span><span style="color:gray">scexit
</span><span style="color:black">DOSCODE:875F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:875F
DOSCODE:875F </span><span style="color:gray">scexit2</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:875F                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8760
DOSCODE:8760 </span><span style="color:gray">scexit</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8760                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8761                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8762                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8763                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8764                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:8765                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8766                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8766 </span>RW_SC           endp
<span style="color:black">DOSCODE:8766
DOSCODE:8767
DOSCODE:8767 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8767
DOSCODE:8767
DOSCODE:8767 </span>IN_SC           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8767                 </span><span style="color:navy">mov     al, ss:</span>SC_DRIVE
<span style="color:black">DOSCODE:876B                 </span><span style="color:navy">cmp     al, ss:</span>CurSC_DRIVE
<span style="color:black">DOSCODE:8770                 </span><span style="color:navy">jnz     short </span><span style="color:gray">outrange2
</span><span style="color:black">DOSCODE:8772                 </span><span style="color:navy">mov     ax, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:8776                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:black">DOSCODE:8778                 </span><span style="color:navy">sub     cx, ss:</span>CurSC_SECTOR
<span style="color:black">DOSCODE:877D                 </span><span style="color:navy">sbb     ax, ss:</span>CurSC_SECTOR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8782                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:8785                 </span><span style="color:navy">jnz     short </span><span style="color:gray">outrange2
</span><span style="color:black">DOSCODE:8787                 </span><span style="color:navy">cmp     cx, ss:</span>SC_CACHE_COUNT
<span style="color:black">DOSCODE:878C                 </span><span style="color:navy">jnb     short </span><span style="color:gray">outrange2
</span><span style="color:black">DOSCODE:878E                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:878F                 </span><span style="color:navy">jmp     short </span><span style="color:gray">inexit
</span><span style="color:black">DOSCODE:8791 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8791
DOSCODE:8791 </span><span style="color:gray">outrange2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8791                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8792
DOSCODE:8792 </span><span style="color:gray">inexit</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8792                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8792 </span>IN_SC           endp
<span style="color:black">DOSCODE:8792
DOSCODE:8793
DOSCODE:8793 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8793
DOSCODE:8793
DOSCODE:8793 </span>INVALIDATE_SC   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8793                 </span><span style="color:navy">call    </span>IN_SC
<span style="color:black">DOSCODE:8796                 </span><span style="color:navy">jb      short </span><span style="color:gray">outrange
</span><span style="color:black">DOSCODE:8798                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:879B                 </span><span style="color:navy">shl     ax, cl
</span><span style="color:black">DOSCODE:879D                 </span><span style="color:navy">not     ax
</span><span style="color:black">DOSCODE:879F                 </span><span style="color:navy">and     ss:</span>SC_STATUS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:87A4
DOSCODE:87A4 </span><span style="color:gray">outrange</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:87A4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:87A4 </span>INVALIDATE_SC   endp
<span style="color:black">DOSCODE:87A4
DOSCODE:87A5
DOSCODE:87A5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:87A5
DOSCODE:87A5
DOSCODE:87A5 </span>VIRREAD         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:87A5                 </span><span style="color:navy">cmp     ss:</span>SC_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:87AB                 </span><span style="color:navy">jz      short </span><span style="color:gray">sc2end
</span><span style="color:black">DOSCODE:87AD                 </span><span style="color:navy">mov     ax, ss:</span>TEMP_VAR2
<span style="color:black">DOSCODE:87B1                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBR<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:87B5                 </span><span style="color:navy">mov     ax, ss:</span>TEMP_VAR
<span style="color:black">DOSCODE:87B9                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:87BD                 </span><span style="color:navy">mov     ss:</span>SC_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:87C3                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBPB<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:87CA                 </span><span style="color:navy">test    byte ptr ss:</span>DEVCALL_REQSTAT<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:87D0                 </span><span style="color:navy">jnz     short </span><span style="color:gray">scerror
</span><span style="color:black">DOSCODE:87D2                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:87D3                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:87D4                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:87D5                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:87D6                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:87D7                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:87D8                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:87DA                 </span><span style="color:navy">call    </span>SC2BUF2
<span style="color:black">DOSCODE:87DD                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:87DE                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:87DF                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:87E0                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:87E1                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:87E2                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:87E3                 </span><span style="color:navy">jmp     short </span><span style="color:gray">sc2end
</span><span style="color:black">DOSCODE:87E5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:87E5
DOSCODE:87E5 </span><span style="color:gray">scerror</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:87E5                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBPB<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:87EC                 </span><span style="color:navy">mov     ss:</span>SC_STATUS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:87F3                 </span><span style="color:navy">mov     ss:</span>CurSC_DRIVE<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:87F9                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:87FA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:87FB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:87FB
DOSCODE:87FB </span><span style="color:gray">sc2end</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:87FB                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:87FC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:87FC </span>VIRREAD         endp
<span style="color:black">DOSCODE:87FC
DOSCODE:87FD
DOSCODE:87FD </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:87FD
DOSCODE:87FD
DOSCODE:87FD </span>SC2BUF          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:87FD                 </span><span style="color:navy">call    </span>IN_SC
<span style="color:black">DOSCODE:8800                 </span><span style="color:navy">jb      short </span><span style="color:gray">noSC
</span><span style="color:black">DOSCODE:8802                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8805                 </span><span style="color:navy">shl     ax, cl
</span><span style="color:black">DOSCODE:8807                 </span><span style="color:navy">test    ss:</span>SC_STATUS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:880C                 </span><span style="color:navy">jz      short </span><span style="color:gray">noSC
</span><span style="color:black">DOSCODE:880E
DOSCODE:880E </span>SC2BUF2<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:880E                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:black">DOSCODE:8810                 </span><span style="color:navy">mul     ss:</span>SC_SECTOR_SIZE
<span style="color:black">DOSCODE:8815                 </span><span style="color:navy">add     ax, word ptr ss:</span>SC_CACHE_PTR
<span style="color:black">DOSCODE:881A                 </span><span style="color:navy">adc     dx, word ptr ss:</span>SC_CACHE_PTR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:881F                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:black">DOSCODE:8821                 </span><span style="color:navy">mov     si, ax
</span><span style="color:black">DOSCODE:8823                 </span><span style="color:navy">mov     es, word ptr ss:</span>CALLBR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8828                 </span><span style="color:navy">mov     di, word ptr ss:</span>CALLBR
<span style="color:black">DOSCODE:882D                 </span><span style="color:navy">mov     cx, ss:</span>SC_SECTOR_SIZE
<span style="color:black">DOSCODE:8832                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8834
DOSCODE:8834 </span>MOVWORDS<span style="color:navy">:
</span><span style="color:black">DOSCODE:8834                 </span><span style="color:navy">cmp     ss:</span>DDMOVE<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:883A                 </span><span style="color:navy">jz      short </span><span style="color:gray">nodd
</span><span style="color:black">DOSCODE:883C                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:883C </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:883E                 </span><span style="color:navy">db </span><span style="color:#008040">66h
</span><span style="color:black">DOSCODE:883F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:883F
DOSCODE:883F </span><span style="color:gray">nodd</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:883F                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:8841                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8842                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8843 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8843
DOSCODE:8843 </span><span style="color:gray">noSC</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8843                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8844                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8844 </span>SC2BUF          endp
<span style="color:black">DOSCODE:8844
DOSCODE:8845
DOSCODE:8845 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8845
DOSCODE:8845
DOSCODE:8845 </span>BUILDDIR        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8845                 </span><span style="color:navy">mov     ax, </span>ENTFREE
<span style="color:black">DOSCODE:8848                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:884B                 </span><span style="color:navy">jz      short </span><span style="color:gray">CHECK_IF_ROOT
</span><span style="color:black">DOSCODE:884D                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:884E                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:884F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:884F
DOSCODE:884F </span><span style="color:gray">CHECK_IF_ROOT</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:884F                 </span><span style="color:navy">cmp     </span>DIRSTART<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8854                 </span><span style="color:navy">jnz     short </span>NEWDIR
<span style="color:black">DOSCODE:8856                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8857
DOSCODE:8857 </span><span style="color:gray">builddir_retn</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8857                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8858 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8858
DOSCODE:8858 </span>NEWDIR<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8858                 </span><span style="color:navy">mov     bx, </span>DIRSTART
<span style="color:black">DOSCODE:885C                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:885E                 </span><span style="color:navy">jz      short </span><span style="color:gray">NULLDIR
</span><span style="color:black">DOSCODE:8860                 </span><span style="color:navy">call    </span>GETEOF
<span style="color:black">DOSCODE:8863                 </span><span style="color:navy">jb      short </span><span style="color:gray">builddir_retn
</span><span style="color:black">DOSCODE:8865
DOSCODE:8865 </span><span style="color:gray">NULLDIR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8865                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8868                 </span><span style="color:navy">call    </span>ALLOCATE
<span style="color:black">DOSCODE:886B                 </span><span style="color:navy">jb      short </span><span style="color:gray">builddir_retn
</span><span style="color:black">DOSCODE:886D                 </span><span style="color:navy">mov     dx, </span>DIRSTART
<span style="color:black">DOSCODE:8871                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:8873                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ADDINGDIR
</span><span style="color:black">DOSCODE:8875                 </span><span style="color:navy">call    </span>SETDIRSRCH
<span style="color:black">DOSCODE:8878                 </span><span style="color:navy">jb      short </span><span style="color:gray">builddir_retn
</span><span style="color:black">DOSCODE:887A                 </span><span style="color:navy">mov     </span>LASTENT<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8880                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GOTDIRREC
</span><span style="color:black">DOSCODE:8882 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8882
DOSCODE:8882 </span><span style="color:gray">ADDINGDIR</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8882                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8883                 </span><span style="color:navy">mov     bx, </span>CLUSNUM
<span style="color:black">DOSCODE:8887                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:888A                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:888B                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOTFIRSTGROW
</span><span style="color:black">DOSCODE:888D                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:8891                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8892                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8893                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:8894                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8896                 </span><span style="color:navy">mov     dl, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:889A                 </span><span style="color:navy">mov     cx, </span>DIRSTART
<span style="color:black">DOSCODE:889E                 </span><span style="color:navy">mov     bp, bx
</span><span style="color:black">DOSCODE:88A0                 </span><span style="color:navy">call    </span>FastOpen_Update
<span style="color:black">DOSCODE:88A3                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:88A4                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:88A5                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:88A6
DOSCODE:88A6 </span><span style="color:gray">NOTFIRSTGROW</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:88A6                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:black">DOSCODE:88A8                 </span><span style="color:navy">xor     bl, bl
</span><span style="color:black">DOSCODE:88AA                 </span><span style="color:navy">call    </span>FIGREC
<span style="color:black">DOSCODE:88AD
DOSCODE:88AD </span><span style="color:gray">GOTDIRREC</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:88AD                 </span><span style="color:navy">mov     cl, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:88B1                 </span><span style="color:navy">inc     cl
</span><span style="color:black">DOSCODE:88B3                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:88B5
DOSCODE:88B5 </span><span style="color:gray">ZERODIR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:88B5                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:88B6                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:88BB                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:88BD                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:black">DOSCODE:88C0                 </span><span style="color:navy">jnb     short </span><span style="color:gray">GET_SSIZE
</span><span style="color:black">DOSCODE:88C2                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:88C3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:88C4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:88C4
DOSCODE:88C4 </span><span style="color:gray">GET_SSIZE</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:88C4                 </span><span style="color:navy">mov     cx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:88C8                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:88C9                 </span><span style="color:navy">les     di, </span>CURBUF
<span style="color:black">DOSCODE:88CD                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4
</span><span style="color:black">DOSCODE:88D2                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:88D3                 </span><span style="color:navy">add     di, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:88D6                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:88D8                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:88DA                 </span><span style="color:navy">rep stosw
</span><span style="color:black">DOSCODE:88DC                 </span><span style="color:navy">jnb     short </span><span style="color:gray">EVENZ
</span><span style="color:black">DOSCODE:88DE                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:88DF
DOSCODE:88DF </span><span style="color:gray">EVENZ</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:88DF                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:88E0                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:88E5                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty7
</span><span style="color:black">DOSCODE:88E7                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:88EA                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:88EF
DOSCODE:88EF </span><span style="color:gray">yesdirty7</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:88EF                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:88F0                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:88F1                 </span><span style="color:navy">add     dx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:88F4                 </span><span style="color:navy">adc     </span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:88F9                 </span><span style="color:navy">loop    </span><span style="color:gray">ZERODIR
</span><span style="color:black">DOSCODE:88FB                 </span><span style="color:navy">mov     ax, </span>LASTENT
<span style="color:black">DOSCODE:88FE                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:88FF                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8900                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8900 </span>BUILDDIR        endp
<span style="color:black">DOSCODE:8900
DOSCODE:8901
DOSCODE:8901 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8901
DOSCODE:8901
DOSCODE:8901 </span>SETDOTENT       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8901                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8902                 </span><span style="color:navy">mov     cx, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:8905                 </span><span style="color:navy">mov     ax, </span><span style="color:green">2020h
</span><span style="color:black">DOSCODE:8908                 </span><span style="color:navy">rep stosw
</span><span style="color:black">DOSCODE:890A                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:890B                 </span><span style="color:navy">mov     al, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:890D                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:890E                 </span><span style="color:navy">add     di, </span><span style="color:green">10
</span><span style="color:black">DOSCODE:8911                 </span><span style="color:navy">mov     si, word ptr </span>THISSFT
<span style="color:black">DOSCODE:8915                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:green">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8918                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8919                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:green">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:891C                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:891D                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:891F                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8920                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8922                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8923                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8924                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8924 </span>SETDOTENT       endp
<span style="color:black">DOSCODE:8924
DOSCODE:8925
DOSCODE:8925 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8925
DOSCODE:8925
DOSCODE:8925 </span>MakeNode        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8925                 </span><span style="color:navy">mov     word ptr </span>CREATING<span style="color:navy">, </span><span style="color:green">0E5FFh
</span><span style="color:black">DOSCODE:892B                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:892C                 </span><span style="color:navy">mov     </span>NoSetDir<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8931                 </span><span style="color:navy">mov     </span>SATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:8934                 </span><span style="color:navy">call    </span>GetPathNoSet
<span style="color:black">DOSCODE:8937                 </span><span style="color:navy">mov     dl, cl
</span><span style="color:black">DOSCODE:8939                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:893B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:893C                 </span><span style="color:navy">jnb     short </span><span style="color:gray">make_exists
</span><span style="color:black">DOSCODE:893E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">make_err_4
</span><span style="color:black">DOSCODE:8940                 </span><span style="color:navy">cmp     dl, </span><span style="color:#ff8000">80h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:8943                 </span><span style="color:navy">jz      short </span>RENAME_MAKE
<span style="color:black">DOSCODE:8945
DOSCODE:8945 </span><span style="color:gray">make_err_4</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8945                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:8947
DOSCODE:8947 </span>make_err_ret<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8947                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:8949                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:894A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:894B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:894B
DOSCODE:894B </span>RENAME_MAKE<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:894B                 </span><span style="color:navy">test    </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8950                 </span><span style="color:navy">jz      short </span>make_type2
<span style="color:black">DOSCODE:8952                 </span><span style="color:navy">or      </span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:8957                 </span><span style="color:navy">test    byte ptr </span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:895C                 </span><span style="color:navy">jnz     short </span>make_type2
<span style="color:black">DOSCODE:895E                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:895F                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:8962
DOSCODE:8962 </span>make_retn<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8962                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8963 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8963
DOSCODE:8963 </span>make_type2<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8963                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:8967                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8969                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:896A                 </span><span style="color:navy">jmp     short </span>make_new
<span style="color:black">DOSCODE:896C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:896C
DOSCODE:896C </span><span style="color:gray">make_exists</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:896C                 </span><span style="color:navy">jz      short </span><span style="color:gray">make_exists_dir
</span><span style="color:black">DOSCODE:896E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:8970                 </span><span style="color:navy">test    </span>ATTRIB<span style="color:navy">, </span><span style="color:green">18h
</span><span style="color:black">DOSCODE:8975                 </span><span style="color:navy">jnz     short </span><span style="color:gray">make_err_ret_5
</span><span style="color:black">DOSCODE:8977                 </span><span style="color:navy">or      ch, ch
</span><span style="color:black">DOSCODE:8979                 </span><span style="color:navy">js      short </span><span style="color:gray">make_share
</span><span style="color:black">DOSCODE:897B                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:897D                 </span><span style="color:navy">jnz     short </span>make_err_ret
<span style="color:black">DOSCODE:897F                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8980                 </span><span style="color:navy">mov     es, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8984                 </span><span style="color:navy">mov     ch, es:[bx+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8988                 </span><span style="color:navy">test    ch, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:898B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">make_err_ret_5P
</span><span style="color:black">DOSCODE:898D                 </span><span style="color:navy">call    </span>MatchAttributes
<span style="color:black">DOSCODE:8990                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8991                 </span><span style="color:navy">jnz     short </span><span style="color:gray">make_err_ret_5
</span><span style="color:black">DOSCODE:8993                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:8995
DOSCODE:8995 </span><span style="color:gray">make_share</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8995                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:8997                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8998                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8999                 </span><span style="color:navy">mov     ah, ch
</span><span style="color:black">DOSCODE:899B                 </span><span style="color:navy">call    </span>DOOPEN
<span style="color:black">DOSCODE:899E                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:89A2                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:89A3                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:89A4                 </span><span style="color:navy">call    </span>ShareEnter
<span style="color:black">DOSCODE:89A7                 </span><span style="color:navy">jnb     short </span><span style="color:gray">MakeEndShare
</span><span style="color:black">DOSCODE:89A9                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:89AA                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:89AB                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:89AC                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:89AD
DOSCODE:89AD </span>Make_Share_ret<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89AD                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:89AF                 </span><span style="color:navy">jmp     short </span>make_err_ret
<span style="color:black">DOSCODE:89B1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:89B1
DOSCODE:89B1 </span><span style="color:gray">make_err_ret_5P</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89B1                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:89B2
DOSCODE:89B2 </span><span style="color:gray">make_err_ret_5</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89B2                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:89B4                 </span><span style="color:navy">jmp     short </span>make_err_ret
<span style="color:black">DOSCODE:89B6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:89B6
DOSCODE:89B6 </span><span style="color:gray">make_exists_dir</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89B6                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:89B8                 </span><span style="color:navy">jmp     short </span>make_err_ret
<span style="color:black">DOSCODE:89BA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:89BA
DOSCODE:89BA </span>make_save<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89BA                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:89BB                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:black">DOSCODE:89BD                 </span><span style="color:navy">call    </span>NEWENTRY
<span style="color:black">DOSCODE:89C0                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:89C1                 </span><span style="color:navy">jnb     short </span>make_retn
<span style="color:black">DOSCODE:89C3                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:89C5
DOSCODE:89C5 </span>make_save_retn<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89C5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:89C6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:89C6
DOSCODE:89C6 </span>make_new<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89C6                 </span><span style="color:navy">call    </span>make_save
<span style="color:black">DOSCODE:89C9                 </span><span style="color:navy">jb      short </span>make_save_retn
<span style="color:black">DOSCODE:89CB                 </span><span style="color:navy">test    </span>ATTRIB<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:89D0                 </span><span style="color:navy">jnz     short </span>make_save_retn
<span style="color:black">DOSCODE:89D2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:89D3                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:89D4                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:89D5                 </span><span style="color:navy">call    </span>ShareEnter
<span style="color:black">DOSCODE:89D8                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:89D9                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:89DA                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:89DB                 </span><span style="color:navy">jnb     short </span>make_save_retn
<span style="color:black">DOSCODE:89DD                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:89DE                 </span><span style="color:navy">les     di, </span>CURBUF
<span style="color:black">DOSCODE:89E2                 </span><span style="color:navy">mov     byte ptr es:[bx], </span><span style="color:#ff8000">0E5h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:89E6                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:89EB                 </span><span style="color:navy">jnz     short </span>yesdirty8
<span style="color:black">DOSCODE:89ED                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:89F0                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:89F5
DOSCODE:89F5 </span>yesdirty8<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:89F5                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:89F9                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:89FD                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:8A00                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8A01                 </span><span style="color:navy">jmp     short </span>Make_Share_ret
<span style="color:black">DOSCODE:8A03 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8A03
DOSCODE:8A03 </span><span style="color:gray">MakeEndShare</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A03                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:8A07                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8A09                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:8A0C                 </span><span style="color:navy">xchg    ax, es:[di]
</span><span style="color:black">DOSCODE:8A0F                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8A10                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8A11                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8A12                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:8A13                 </span><span style="color:navy">call    </span>ShareEnd
<span style="color:black">DOSCODE:8A16                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:8A17                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8A18                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8A19                 </span><span style="color:navy">pop     word ptr es:[di]
</span><span style="color:black">DOSCODE:8A1C                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:8A1F                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8A20                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8A21                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8A22                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8A23                 </span><span style="color:navy">call    </span>make_save
<span style="color:black">DOSCODE:8A26                 </span><span style="color:navy">jb      short </span>make_save_retn
<span style="color:black">DOSCODE:8A28                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8A29                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8A2A                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:8A2B                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:8A2C                 </span><span style="color:navy">call    </span>ShareEnter
<span style="color:black">DOSCODE:8A2F                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:8A30                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8A31                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8A32                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8A33
DOSCODE:8A33 </span>makeendshare_retn<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A33                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8A33 </span>MakeNode        endp
<span style="color:black">DOSCODE:8A33
DOSCODE:8A34
DOSCODE:8A34 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8A34
DOSCODE:8A34
DOSCODE:8A34 </span>NEWENTRY        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A34                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:8A38                 </span><span style="color:navy">jnb     short </span><span style="color:gray">EXISTENT
</span><span style="color:black">DOSCODE:8A3A                 </span><span style="color:navy">cmp     </span>FAILERR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8A3F                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8A40                 </span><span style="color:navy">jnz     short </span>makeendshare_retn
<span style="color:black">DOSCODE:8A42                 </span><span style="color:navy">call    </span>BUILDDIR
<span style="color:black">DOSCODE:8A45                 </span><span style="color:navy">jb      short </span>makeendshare_retn
<span style="color:black">DOSCODE:8A47                 </span><span style="color:navy">call    </span>GETENT
<span style="color:black">DOSCODE:8A4A                 </span><span style="color:navy">jb      short </span>makeendshare_retn
<span style="color:black">DOSCODE:8A4C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">FREESPOT
</span><span style="color:black">DOSCODE:8A4E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8A4E
DOSCODE:8A4E </span><span style="color:gray">ERRRET3</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A4E                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8A4F
DOSCODE:8A4F </span><span style="color:gray">newentry_retn</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A4F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8A50 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8A50
DOSCODE:8A50 </span><span style="color:gray">EXISTENT</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A50                 </span><span style="color:navy">or      ah, ah
</span><span style="color:black">DOSCODE:8A52                 </span><span style="color:navy">jns     short </span><span style="color:gray">NOT_DEV1
</span><span style="color:black">DOSCODE:8A54                 </span><span style="color:navy">jmp     </span>DOOPEN
<span style="color:black">DOSCODE:8A57 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8A57
DOSCODE:8A57 </span><span style="color:gray">NOT_DEV1</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A57                 </span><span style="color:navy">call    </span>FREEENT
<span style="color:black">DOSCODE:8A5A                 </span><span style="color:navy">jb      short </span><span style="color:gray">newentry_retn
</span><span style="color:black">DOSCODE:8A5C
DOSCODE:8A5C </span><span style="color:gray">FREESPOT</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A5C                 </span><span style="color:navy">test    </span>ATTRIB<span style="color:navy">, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:8A61                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOTVOLID
</span><span style="color:black">DOSCODE:8A63                 </span><span style="color:navy">cmp     </span>VOLID<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8A68                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ERRRET3
</span><span style="color:black">DOSCODE:8A6A
DOSCODE:8A6A </span><span style="color:gray">NOTVOLID</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8A6A                 </span><span style="color:navy">mov     es, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8A6E                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:8A70                 </span><span style="color:navy">mov     si, offset </span>NAME1
<span style="color:black">DOSCODE:8A73                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:8A76                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:8A78                 </span><span style="color:navy">movsb
</span><span style="color:black">DOSCODE:8A79                 </span><span style="color:navy">mov     al, </span>ATTRIB
<span style="color:black">DOSCODE:8A7C                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8A7D                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:8A7F                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8A81                 </span><span style="color:navy">rep stosw
</span><span style="color:black">DOSCODE:8A83                 </span><span style="color:navy">call    </span>DATE16
<span style="color:black">DOSCODE:8A86                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:8A87                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8A88                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:8A89                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8A8A                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8A8C                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8A8D                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8A8E                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8A8F                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8A90                 </span><span style="color:navy">mov     si, word ptr </span>CURBUF
<span style="color:black">DOSCODE:8A94                 </span><span style="color:navy">test    byte ptr es:[si+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:8A99                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty9
</span><span style="color:black">DOSCODE:8A9B                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:8A9E                 </span><span style="color:navy">or      byte ptr es:[si+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:8AA3
DOSCODE:8AA3 </span><span style="color:gray">yesdirty9</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8AA3                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:8AA7                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8AAB                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8AAC                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8AAD                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8AAE                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8AAF                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:8AB3                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:8AB8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GotADevice
</span><span style="color:black">DOSCODE:8ABA                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:8ABB                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8ABC                 </span><span style="color:navy">lds     bx, </span>THISDPB
<span style="color:black">DOSCODE:8AC0                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:8AC4                 </span><span style="color:navy">mov     bx, ds
</span><span style="color:black">DOSCODE:8AC6                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">9</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:8ACA                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8ACB                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8ACC                 </span><span style="color:navy">call    </span>DEV_OPEN_SFT
<span style="color:black">DOSCODE:8ACF                 </span><span style="color:navy">mov     </span>VIRTUAL_OPEN<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8AD4
DOSCODE:8AD4 </span><span style="color:gray">GotADevice</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8AD4                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8AD5                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8AD6                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:8AD9                 </span><span style="color:navy">call    </span>CHECK_VIRT_OPEN
<span style="color:black">DOSCODE:8ADC                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8ADD                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8ADE                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8ADF                 </span><span style="color:navy">mov     ah, al
</span><span style="color:black">DOSCODE:8AE1                 </span><span style="color:navy">jnb     short </span>DOOPEN
<span style="color:black">DOSCODE:8AE3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8AE3 </span>NEWENTRY        endp
<span style="color:black">DOSCODE:8AE3
DOSCODE:8AE4
DOSCODE:8AE4 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8AE4
DOSCODE:8AE4
DOSCODE:8AE4 </span>DOOPEN          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8AE4                 </span><span style="color:navy">mov     dh, ah
</span><span style="color:black">DOSCODE:8AE6                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:8AEA                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:8AED                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:8AEF                 </span><span style="color:navy">or      dh, dh
</span><span style="color:black">DOSCODE:8AF1                 </span><span style="color:navy">js      short </span><span style="color:gray">DEV_SFT1
</span><span style="color:black">DOSCODE:8AF3                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8AF7                 </span><span style="color:navy">mov     al, [bx+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8AFA
DOSCODE:8AFA </span><span style="color:gray">DEV_SFT1</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8AFA                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8AFB                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8AFD                 </span><span style="color:navy">mov     al, dh
</span><span style="color:black">DOSCODE:8AFF                 </span><span style="color:navy">or      al, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:8B01                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B02                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:8B03                 </span><span style="color:navy">lds     ax, [bx+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B06                 </span><span style="color:navy">or      dh, dh
</span><span style="color:black">DOSCODE:8B08                 </span><span style="color:navy">js      short </span><span style="color:gray">DEV_SFT2
</span><span style="color:black">DOSCODE:8B0A                 </span><span style="color:navy">lds     ax, ss:</span>THISDPB
<span style="color:black">DOSCODE:8B0F
DOSCODE:8B0F </span><span style="color:gray">DEV_SFT2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8B0F                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B10                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:8B12                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8B13                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B14                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:8B15                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:8B16                 </span><span style="color:navy">sub     si, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:8B19                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:8B1A                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:8B1B                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:8B1C                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:8B1D                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:8B1F                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:8B20                 </span><span style="color:navy">or      dh, dh
</span><span style="color:black">DOSCODE:8B22                 </span><span style="color:navy">jns     short </span><span style="color:gray">FILE_SFT1
</span><span style="color:black">DOSCODE:8B24                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8B26                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:8B28
DOSCODE:8B28 </span><span style="color:gray">FILE_SFT1</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8B28                 </span><span style="color:navy">xchg    ax, cx
</span><span style="color:black">DOSCODE:8B29                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B2A                 </span><span style="color:navy">xchg    ax, cx
</span><span style="color:black">DOSCODE:8B2B                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B2C                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8B2E                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B2F                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B30                 </span><span style="color:navy">or      dh, dh
</span><span style="color:black">DOSCODE:8B32                 </span><span style="color:navy">js      short </span><span style="color:gray">DEV_SFT3
</span><span style="color:black">DOSCODE:8B34                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B35                 </span><span style="color:navy">mov     ax, [bx+</span><span style="color:#ff8000">1Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B38                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8B39                 </span><span style="color:navy">sub     di, </span><span style="color:#ff8000">1Bh
</span><span style="color:black">DOSCODE:8B3C                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">35h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:8B40                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8B41                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:8B42                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8B43                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8B44                 </span><span style="color:navy">test    </span>FastOpenFlg<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:8B49                 </span><span style="color:navy">jz      short </span><span style="color:gray">Not_FastOpen
</span><span style="color:black">DOSCODE:8B4B                 </span><span style="color:navy">mov     si, offset </span>FastOpen_Ext_Info
<span style="color:black">DOSCODE:8B4E                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B51                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B52                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">3</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B55                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B56                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:black">DOSCODE:8B58                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8B59                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8B5A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">Next_Name
</span><span style="color:black">DOSCODE:8B5C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8B5C
DOSCODE:8B5C </span><span style="color:gray">Not_FastOpen</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8B5C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8B5D                 </span><span style="color:navy">mov     si, word ptr ss:</span>CURBUF
<span style="color:black">DOSCODE:8B62                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B65                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B66                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B69                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8B6A                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:8B6C                 </span><span style="color:navy">add     si, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:8B6F                 </span><span style="color:navy">sub     ax, si
</span><span style="color:black">DOSCODE:8B71                 </span><span style="color:navy">mov     cl, </span><span style="color:green">32
</span><span style="color:black">DOSCODE:8B73                 </span><span style="color:navy">div     cl
</span><span style="color:black">DOSCODE:8B75                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8B76
DOSCODE:8B76 </span><span style="color:gray">Next_Name</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8B76                 </span><span style="color:navy">jmp     short </span><span style="color:gray">FILE_SFT2
</span><span style="color:black">DOSCODE:8B78 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8B78
DOSCODE:8B78 </span><span style="color:gray">DEV_SFT3</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8B78                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:8B7B
DOSCODE:8B7B </span><span style="color:gray">FILE_SFT2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8B7B                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:8B7D                 </span><span style="color:navy">mov     cx, </span><span style="color:green">11
</span><span style="color:black">DOSCODE:8B80                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:8B82                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8B83                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8B84                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8B85                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8B86                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8B86 </span>DOOPEN          endp
<span style="color:black">DOSCODE:8B86
DOSCODE:8B87
DOSCODE:8B87 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8B87
DOSCODE:8B87
DOSCODE:8B87 </span>FREEENT         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8B87                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:8B88                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:8B8C                 </span><span style="color:navy">mov     cx, [si]
</span><span style="color:black">DOSCODE:8B8E                 </span><span style="color:navy">mov     dx, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B91                 </span><span style="color:navy">mov     ss:</span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:8B96                 </span><span style="color:navy">mov     dx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8B99                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8B9A                 </span><span style="color:navy">cmp     cx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:8B9D                 </span><span style="color:navy">jb      short </span><span style="color:gray">RET1
</span><span style="color:black">DOSCODE:8B9F                 </span><span style="color:navy">cmp     cx, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8BA3                 </span><span style="color:navy">ja      short </span><span style="color:gray">RET1
</span><span style="color:black">DOSCODE:8BA5                 </span><span style="color:navy">sub     bx, di
</span><span style="color:black">DOSCODE:8BA7                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8BA8                 </span><span style="color:navy">push    </span>HIGH_SECTOR
<span style="color:black">DOSCODE:8BAC                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:8BAD                 </span><span style="color:navy">mov     bx, cx
</span><span style="color:black">DOSCODE:8BAF                 </span><span style="color:navy">call    </span>RELEASE
<span style="color:black">DOSCODE:8BB2                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:8BB3                 </span><span style="color:navy">pop     </span>HIGH_SECTOR
<span style="color:black">DOSCODE:8BB7                 </span><span style="color:navy">jnb     short </span><span style="color:gray">GET_BUF_BACK
</span><span style="color:black">DOSCODE:8BB9                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8BBA
DOSCODE:8BBA </span><span style="color:gray">freeent_retn</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8BBA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8BBB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8BBB
DOSCODE:8BBB </span><span style="color:gray">GET_BUF_BACK</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8BBB                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:8BC0                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:8BC2                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:black">DOSCODE:8BC5                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8BC6                 </span><span style="color:navy">jb      short </span><span style="color:gray">freeent_retn
</span><span style="color:black">DOSCODE:8BC8                 </span><span style="color:navy">call    </span>SET_BUF_AS_DIR
<span style="color:black">DOSCODE:8BCB                 </span><span style="color:navy">add     bx, word ptr </span>CURBUF
<span style="color:black">DOSCODE:8BCF                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:8BD1                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:8BD4
DOSCODE:8BD4 </span><span style="color:gray">RET1</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8BD4                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8BD5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8BD5 </span>FREEENT         endp
<span style="color:black">DOSCODE:8BD5
DOSCODE:8BD6
DOSCODE:8BD6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8BD6
DOSCODE:8BD6
DOSCODE:8BD6 </span>CHECK_VIRT_OPEN proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8BD6                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8BD7                 </span><span style="color:navy">lahf
</span><span style="color:black">DOSCODE:8BD8                 </span><span style="color:navy">cmp     </span>VIRTUAL_OPEN<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8BDD                 </span><span style="color:navy">jz      short </span><span style="color:gray">ALL_CLOSED
</span><span style="color:black">DOSCODE:8BDF                 </span><span style="color:navy">mov     </span>VIRTUAL_OPEN<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8BE4                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8BE5                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8BE6                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:8BEA                 </span><span style="color:navy">call    </span>DEV_CLOSE_SFT
<span style="color:black">DOSCODE:8BED                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8BEE                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8BEF
DOSCODE:8BEF </span><span style="color:gray">ALL_CLOSED</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8BEF                 </span><span style="color:navy">sahf
</span><span style="color:black">DOSCODE:8BF0                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8BF1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8BF1 </span>CHECK_VIRT_OPEN endp
<span style="color:black">DOSCODE:8BF1
DOSCODE:8BF2
DOSCODE:8BF2 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8BF2
DOSCODE:8BF2
DOSCODE:8BF2 </span>FNDCLUS         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8BF2                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8BF3                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:8BF7                 </span><span style="color:navy">mov     bx, es:[di+</span><span style="color:#ff8000">35h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8BFB                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">19h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8BFF                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:8C01                 </span><span style="color:navy">jz      short </span>NOCLUS
<span style="color:black">DOSCODE:8C03                 </span><span style="color:navy">sub     cx, dx
</span><span style="color:black">DOSCODE:8C05                 </span><span style="color:navy">jnb     short </span><span style="color:gray">FINDIT
</span><span style="color:black">DOSCODE:8C07                 </span><span style="color:navy">add     cx, dx
</span><span style="color:black">DOSCODE:8C09                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:8C0B                 </span><span style="color:navy">mov     bx, es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8C0F
DOSCODE:8C0F </span><span style="color:gray">FINDIT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C0F                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8C10                 </span><span style="color:navy">jcxz    short </span>RET9
<span style="color:black">DOSCODE:8C12
DOSCODE:8C12 </span>SKPCLP<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C12                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8C15                 </span><span style="color:navy">jb      short </span>fndclus_retn
<span style="color:black">DOSCODE:8C17                 </span><span style="color:navy">xchg    bx, di
</span><span style="color:black">DOSCODE:8C19                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:8C1C                 </span><span style="color:navy">xchg    bx, di
</span><span style="color:black">DOSCODE:8C1E                 </span><span style="color:navy">jnb     short </span>RET9
<span style="color:black">DOSCODE:8C20                 </span><span style="color:navy">xchg    bx, di
</span><span style="color:black">DOSCODE:8C22                 </span><span style="color:navy">inc     dx
</span><span style="color:black">DOSCODE:8C23                 </span><span style="color:navy">loop    </span>SKPCLP
<span style="color:black">DOSCODE:8C25
DOSCODE:8C25 </span>RET9<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C25                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8C26                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8C27 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8C27
DOSCODE:8C27 </span>NOCLUS<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C27                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8C28                 </span><span style="color:navy">inc     cx
</span><span style="color:black">DOSCODE:8C29                 </span><span style="color:navy">dec     dx
</span><span style="color:black">DOSCODE:8C2A                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8C2B
DOSCODE:8C2B </span>fndclus_retn<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C2B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8C2B </span>FNDCLUS         endp
<span style="color:black">DOSCODE:8C2B
DOSCODE:8C2C
DOSCODE:8C2C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8C2C
DOSCODE:8C2C
DOSCODE:8C2C </span>BUFSEC          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C2C                 </span><span style="color:navy">mov     dx, </span>CLUSNUM
<span style="color:black">DOSCODE:8C30                 </span><span style="color:navy">mov     bl, </span>SECCLUSPOS
<span style="color:black">DOSCODE:8C34                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">38h </span><span style="color:gray">; &#039;8&#039;
</span><span style="color:black">DOSCODE:8C39                 </span><span style="color:navy">call    </span>FIGREC
<span style="color:black">DOSCODE:8C3C                 </span><span style="color:navy">call    </span>GETBUFFR
<span style="color:black">DOSCODE:8C3F                 </span><span style="color:navy">jb      short </span>fndclus_retn
<span style="color:black">DOSCODE:8C41                 </span><span style="color:navy">mov     </span>TRANS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8C46                 </span><span style="color:navy">mov     si, </span>NEXTADD
<span style="color:black">DOSCODE:8C4A                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:8C4C                 </span><span style="color:navy">mov     cx, </span>BYTCNT1
<span style="color:black">DOSCODE:8C50                 </span><span style="color:navy">add     di, cx
</span><span style="color:black">DOSCODE:8C52                 </span><span style="color:navy">mov     </span>NEXTADD<span style="color:navy">, di
</span><span style="color:black">DOSCODE:8C56                 </span><span style="color:navy">les     di, </span>CURBUF
<span style="color:black">DOSCODE:8C5A                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:8C5F                 </span><span style="color:navy">lea     di, [di+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8C62                 </span><span style="color:navy">add     di, </span>BYTSECPOS
<span style="color:black">DOSCODE:8C66                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8C67                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8C67 </span>BUFSEC          endp
<span style="color:black">DOSCODE:8C67
DOSCODE:8C68
DOSCODE:8C68 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8C68
DOSCODE:8C68
DOSCODE:8C68 </span>BUFRD           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C68                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8C69                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:8C6B                 </span><span style="color:navy">call    </span>BUFSEC
<span style="color:black">DOSCODE:8C6E                 </span><span style="color:navy">jnb     short </span><span style="color:gray">BUF_OK
</span><span style="color:black">DOSCODE:8C70
DOSCODE:8C70 </span>BUF_IO_FAIL<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C70                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8C71                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RBUFPLACED
</span><span style="color:black">DOSCODE:8C73 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8C73
DOSCODE:8C73 </span><span style="color:gray">BUF_OK</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C73                 </span><span style="color:navy">mov     bx, es
</span><span style="color:black">DOSCODE:8C75                 </span><span style="color:navy">mov     es, word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8C79                 </span><span style="color:navy">mov     ds, bx
</span><span style="color:black">DOSCODE:8C7B                 </span><span style="color:navy">xchg    di, si
</span><span style="color:black">DOSCODE:8C7D                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8C7F                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:8C81                 </span><span style="color:navy">adc     cx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8C84                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:8C86                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8C87                 </span><span style="color:navy">lds     di, ss:</span>CURBUF
<span style="color:black">DOSCODE:8C8C                 </span><span style="color:navy">lea     bx, [di+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8C8F                 </span><span style="color:navy">sub     si, bx
</span><span style="color:black">DOSCODE:8C91                 </span><span style="color:navy">call    </span>PLACEBUF
<span style="color:black">DOSCODE:8C94                 </span><span style="color:navy">cmp     si, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8C98                 </span><span style="color:navy">jb      short </span><span style="color:gray">RBUFPLACEDC
</span><span style="color:black">DOSCODE:8C9A                 </span><span style="color:navy">mov     word ptr ss:</span>BufferQueue<span style="color:navy">, di
</span><span style="color:black">DOSCODE:8C9F
DOSCODE:8C9F </span><span style="color:gray">RBUFPLACEDC</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8C9F                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8CA0
DOSCODE:8CA0 </span><span style="color:gray">RBUFPLACED</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8CA0                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8CA1                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8CA2                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8CA2 </span>BUFRD           endp
<span style="color:black">DOSCODE:8CA2
DOSCODE:8CA3
DOSCODE:8CA3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8CA3
DOSCODE:8CA3
DOSCODE:8CA3 </span>BUFWRT          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8CA3                 </span><span style="color:navy">mov     ax, </span>SECPOS
<span style="color:black">DOSCODE:8CA6                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8CA9                 </span><span style="color:navy">mov     </span>SECPOS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8CAC                 </span><span style="color:navy">adc     </span>SECPOS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8CB1                 </span><span style="color:navy">mov     ax, </span>SECPOS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8CB4                 </span><span style="color:navy">cmp     ax, </span>VALSEC<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8CB8                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8CBA                 </span><span style="color:navy">ja      short </span><span style="color:gray">NOREAD
</span><span style="color:black">DOSCODE:8CBC                 </span><span style="color:navy">jb      short </span><span style="color:gray">_doread
</span><span style="color:black">DOSCODE:8CBE                 </span><span style="color:navy">mov     ax, </span>SECPOS
<span style="color:black">DOSCODE:8CC1                 </span><span style="color:navy">cmp     ax, </span>VALSEC
<span style="color:black">DOSCODE:8CC5                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8CC7                 </span><span style="color:navy">ja      short </span><span style="color:gray">NOREAD
</span><span style="color:black">DOSCODE:8CC9
DOSCODE:8CC9 </span><span style="color:gray">_doread</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8CC9                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:8CCB
DOSCODE:8CCB </span><span style="color:gray">NOREAD</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8CCB                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8CCC                 </span><span style="color:navy">call    </span>BUFSEC
<span style="color:black">DOSCODE:8CCF                 </span><span style="color:navy">jb      short </span>BUF_IO_FAIL
<span style="color:black">DOSCODE:8CD1                 </span><span style="color:navy">mov     ds, word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:8CD5                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8CD7                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:8CD9                 </span><span style="color:navy">adc     cx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8CDC                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:8CDE                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8CDF                 </span><span style="color:navy">lds     bx, ss:</span>CURBUF
<span style="color:black">DOSCODE:8CE4                 </span><span style="color:navy">test    byte ptr [bx+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:8CE8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty10
</span><span style="color:black">DOSCODE:8CEA                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:8CED                 </span><span style="color:navy">or      byte ptr [bx+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:8CF1
DOSCODE:8CF1 </span><span style="color:gray">yesdirty10</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8CF1                 </span><span style="color:navy">lea     si, [bx+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8CF4                 </span><span style="color:navy">sub     di, si
</span><span style="color:black">DOSCODE:8CF6                 </span><span style="color:navy">cmp     di, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8CFA                 </span><span style="color:navy">jb      short </span><span style="color:gray">WBUFPLACED
</span><span style="color:black">DOSCODE:8CFC                 </span><span style="color:navy">mov     word ptr ss:</span>BufferQueue<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:8D01
DOSCODE:8D01 </span><span style="color:gray">WBUFPLACED</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D01                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8D02                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8D03                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:8D04                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8D04 </span>BUFWRT          endp
<span style="color:black">DOSCODE:8D04
DOSCODE:8D05
DOSCODE:8D05 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8D05
DOSCODE:8D05
DOSCODE:8D05 </span>NEXTSEC         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D05                 </span><span style="color:navy">test    </span>TRANS<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:8D0A                 </span><span style="color:navy">jz      short </span><span style="color:gray">CLRET
</span><span style="color:black">DOSCODE:8D0C                 </span><span style="color:navy">mov     al, </span>SECCLUSPOS
<span style="color:black">DOSCODE:8D0F                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:8D11                 </span><span style="color:navy">cmp     al, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8D15                 </span><span style="color:navy">jbe     short </span><span style="color:gray">SAVPOS
</span><span style="color:black">DOSCODE:8D17                 </span><span style="color:navy">mov     bx, </span>CLUSNUM
<span style="color:black">DOSCODE:8D1B                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:8D1E                 </span><span style="color:navy">jnb     short </span><span style="color:gray">NONEXT
</span><span style="color:black">DOSCODE:8D20                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8D23                 </span><span style="color:navy">jb      short </span><span style="color:gray">NONEXT
</span><span style="color:black">DOSCODE:8D25                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, di
</span><span style="color:black">DOSCODE:8D29                 </span><span style="color:navy">inc     </span>LASTPOS
<span style="color:black">DOSCODE:8D2D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8D2F
DOSCODE:8D2F </span><span style="color:gray">SAVPOS</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D2F                 </span><span style="color:navy">mov     </span>SECCLUSPOS<span style="color:navy">, al
</span><span style="color:black">DOSCODE:8D32
DOSCODE:8D32 </span><span style="color:gray">CLRET</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D32                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8D33                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8D34 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8D34
DOSCODE:8D34 </span><span style="color:gray">NONEXT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D34                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8D35                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8D35 </span>NEXTSEC         endp
<span style="color:black">DOSCODE:8D35
DOSCODE:8D36
DOSCODE:8D36 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8D36
DOSCODE:8D36
DOSCODE:8D36 </span>OPTIMIZE        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D36                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:8D37                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8D38                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8D3C                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:8D3E                 </span><span style="color:navy">mov     ah, al
</span><span style="color:black">DOSCODE:8D40                 </span><span style="color:navy">sub     al, dl
</span><span style="color:black">DOSCODE:8D42                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:8D44                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8D47
DOSCODE:8D47 </span><span style="color:gray">OPTCLUS</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D47                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8D4A                 </span><span style="color:navy">jb      short </span><span style="color:gray">OP_ERR
</span><span style="color:black">DOSCODE:8D4C                 </span><span style="color:navy">add     cl, al
</span><span style="color:black">DOSCODE:8D4E                 </span><span style="color:navy">adc     ch, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8D51                 </span><span style="color:navy">cmp     cx, dx
</span><span style="color:black">DOSCODE:8D53                 </span><span style="color:navy">jnb     short </span><span style="color:gray">BLKDON
</span><span style="color:black">DOSCODE:8D55                 </span><span style="color:navy">mov     al, ah
</span><span style="color:black">DOSCODE:8D57                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:8D58                 </span><span style="color:navy">cmp     di, bx
</span><span style="color:black">DOSCODE:8D5A                 </span><span style="color:navy">jz      short </span><span style="color:gray">OPTCLUS
</span><span style="color:black">DOSCODE:8D5C                 </span><span style="color:navy">dec     bx
</span><span style="color:black">DOSCODE:8D5D
DOSCODE:8D5D </span><span style="color:gray">FINCLUS</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D5D                 </span><span style="color:navy">mov     </span>CLUSNUM<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:8D61                 </span><span style="color:navy">sub     dx, cx
</span><span style="color:black">DOSCODE:8D63                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:8D64                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:black">DOSCODE:8D66                 </span><span style="color:navy">mul     word ptr es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8D6A                 </span><span style="color:navy">mov     si, </span>NEXTADD
<span style="color:black">DOSCODE:8D6E                 </span><span style="color:navy">add     ax, si
</span><span style="color:black">DOSCODE:8D70                 </span><span style="color:navy">mov     </span>NEXTADD<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:8D73                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8D74                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:8D75                 </span><span style="color:navy">sub     bx, dx
</span><span style="color:black">DOSCODE:8D77                 </span><span style="color:navy">add     </span>LASTPOS<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:8D7B                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8D7C                 </span><span style="color:navy">call    </span>FIGREC
<span style="color:black">DOSCODE:8D7F                 </span><span style="color:navy">mov     bx, si
</span><span style="color:black">DOSCODE:8D81                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8D82                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8D83 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8D83
DOSCODE:8D83 </span><span style="color:gray">OP_ERR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D83                 </span><span style="color:navy">add     sp, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:8D86                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8D87                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8D88 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8D88
DOSCODE:8D88 </span><span style="color:gray">BLKDON</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D88                 </span><span style="color:navy">sub     cx, dx
</span><span style="color:black">DOSCODE:8D8A                 </span><span style="color:navy">sub     ah, cl
</span><span style="color:black">DOSCODE:8D8C                 </span><span style="color:navy">dec     ah
</span><span style="color:black">DOSCODE:8D8E                 </span><span style="color:navy">mov     </span>SECCLUSPOS<span style="color:navy">, ah
</span><span style="color:black">DOSCODE:8D92                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:black">DOSCODE:8D94                 </span><span style="color:navy">jmp     short </span><span style="color:gray">FINCLUS
</span><span style="color:black">DOSCODE:8D94 </span>OPTIMIZE        endp
<span style="color:black">DOSCODE:8D94
DOSCODE:8D96
DOSCODE:8D96 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8D96
DOSCODE:8D96
DOSCODE:8D96 </span>FIGREC          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8D96                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8D97                 </span><span style="color:navy">mov     cl, es:[bp+</span><span style="color:#ff8000">5</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8D9B                 </span><span style="color:navy">dec     dx
</span><span style="color:black">DOSCODE:8D9C                 </span><span style="color:navy">dec     dx
</span><span style="color:black">DOSCODE:8D9D                 </span><span style="color:navy">mov     ss:</span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8DA4                 </span><span style="color:navy">or      cl, cl
</span><span style="color:black">DOSCODE:8DA6                 </span><span style="color:navy">jz      short </span><span style="color:gray">noshift
</span><span style="color:black">DOSCODE:8DA8                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:8DAA
DOSCODE:8DAA </span><span style="color:gray">rotleft</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8DAA                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8DAB                 </span><span style="color:navy">rcl     dx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8DAD                 </span><span style="color:navy">rcl     ss:</span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8DB2                 </span><span style="color:navy">loop    </span><span style="color:gray">rotleft
</span><span style="color:black">DOSCODE:8DB4
DOSCODE:8DB4 </span><span style="color:gray">noshift</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8DB4                 </span><span style="color:navy">or      dl, bl
</span><span style="color:black">DOSCODE:8DB6                 </span><span style="color:navy">add     dx, es:[bp+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8DBA                 </span><span style="color:navy">adc     ss:</span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8DC0                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8DC1
DOSCODE:8DC1 </span>figrec_retn<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8DC1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8DC1 </span>FIGREC          endp
<span style="color:black">DOSCODE:8DC1
</span><span style="color:maroon">DOSCODE:8DC2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:8DC2
DOSCODE:8DC2 </span>callmagic<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:8DC2                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:8DC3                 </span><span style="color:navy">push    ss:</span>OffsetMagicPatch
<span style="color:maroon">DOSCODE:8DC8                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:8DC9
DOSCODE:8DC9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8DC9
DOSCODE:8DC9
DOSCODE:8DC9 </span>ALLOCATE        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8DC9                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:8DCA                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:8DCB                 </span><span style="color:navy">call    </span>callmagic
<span style="color:black">DOSCODE:8DCE                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Regular_Allocate_Path
</span><span style="color:black">DOSCODE:8DD0                 </span><span style="color:navy">jmp     </span><span style="color:gray">Disk_Full_Return
</span><span style="color:black">DOSCODE:8DD3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8DD3
DOSCODE:8DD3 </span><span style="color:gray">Regular_Allocate_Path</span><span style="color:navy">:                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8DD3                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8DD4                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:8DD6                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8DD9                 </span><span style="color:navy">mov     </span>FATBYT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:8DDD                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8DDE                 </span><span style="color:navy">jb      short </span>figrec_retn
<span style="color:black">DOSCODE:8DE0                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8DE1                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8DE2                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:black">DOSCODE:8DE4                 </span><span style="color:navy">mov     bx, es:[bp+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8DE8                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:8DEB                 </span><span style="color:navy">ja      short </span><span style="color:gray">FINDFRE
</span><span style="color:black">DOSCODE:8DED
DOSCODE:8DED </span><span style="color:gray">ads1</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8DED                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">], </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:8DF3                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8DF6
DOSCODE:8DF6 </span><span style="color:gray">FINDFRE</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8DF6                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:8DF7                 </span><span style="color:navy">cmp     bx, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8DFB                 </span><span style="color:navy">ja      short </span><span style="color:gray">ads7
</span><span style="color:black">DOSCODE:8DFD                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8E00                 </span><span style="color:navy">jb      short </span><span style="color:gray">ads4
</span><span style="color:black">DOSCODE:8E02                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FINDFRE
</span><span style="color:black">DOSCODE:8E04                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:8E08                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:8E09                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8E0C                 </span><span style="color:navy">call    </span>PACK
<span style="color:black">DOSCODE:8E0F                 </span><span style="color:navy">jb      short </span><span style="color:gray">ads4
</span><span style="color:black">DOSCODE:8E11                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8E16                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_ALLOC
</span><span style="color:black">DOSCODE:8E18                 </span><span style="color:navy">dec     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8E1C
DOSCODE:8E1C </span><span style="color:gray">NO_ALLOC</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E1C                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:8E1D                 </span><span style="color:navy">xchg    bx, dx
</span><span style="color:black">DOSCODE:8E1F                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:black">DOSCODE:8E21                 </span><span style="color:navy">call    </span>PACK
<span style="color:black">DOSCODE:8E24                 </span><span style="color:navy">jb      short </span><span style="color:gray">ads4
</span><span style="color:black">DOSCODE:8E26                 </span><span style="color:navy">xchg    ax, bx
</span><span style="color:black">DOSCODE:8E27                 </span><span style="color:navy">mov     dx, bx
</span><span style="color:black">DOSCODE:8E29                 </span><span style="color:navy">loop    </span><span style="color:gray">FINDFRE
</span><span style="color:black">DOSCODE:8E2B                 </span><span style="color:navy">mov     dx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8E2E                 </span><span style="color:navy">call    </span>PACK
<span style="color:black">DOSCODE:8E31
DOSCODE:8E31 </span><span style="color:gray">ads4</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E31                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8E32                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8E33                 </span><span style="color:navy">jb      short </span>figrec_retn
<span style="color:black">DOSCODE:8E35                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8E38                 </span><span style="color:navy">jb      short </span>figrec_retn
<span style="color:black">DOSCODE:8E3A                 </span><span style="color:navy">call    </span>RESTFATBYT
<span style="color:black">DOSCODE:8E3D                 </span><span style="color:navy">jb      short </span>figrec_retn
<span style="color:black">DOSCODE:8E3F                 </span><span style="color:navy">xchg    bx, di
</span><span style="color:black">DOSCODE:8E41                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:8E43                 </span><span style="color:navy">jz      short </span><span style="color:gray">dofastk
</span><span style="color:black">DOSCODE:8E45                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8E46 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8E46
DOSCODE:8E46 </span><span style="color:gray">dofastk</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E46                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:8E47                 </span><span style="color:navy">mov     dl, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8E4B                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8E4C                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:8E50                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:8E54                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">35h</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:8E58                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8E59                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:8E5A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8E5B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8E5B
DOSCODE:8E5B </span><span style="color:gray">ads7</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E5B                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">], </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:8E60                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ads1
</span><span style="color:black">DOSCODE:8E62                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8E63                 </span><span style="color:navy">mov     dx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:8E66                 </span><span style="color:navy">call    </span>RELBLKS
<span style="color:black">DOSCODE:8E69                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8E6A                 </span><span style="color:navy">sub     ax, cx
</span><span style="color:black">DOSCODE:8E6C                 </span><span style="color:navy">call    </span>RESTFATBYT
<span style="color:black">DOSCODE:8E6F
DOSCODE:8E6F </span><span style="color:gray">Disk_Full_Return</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E6F                 </span><span style="color:navy">mov     </span>DISK_FULL<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8E74                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:8E75                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8E75 </span>ALLOCATE        endp
<span style="color:black">DOSCODE:8E75
DOSCODE:8E76
DOSCODE:8E76 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8E76
DOSCODE:8E76
DOSCODE:8E76 </span>RESTFATBYT      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E76                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8E77                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:8E78                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8E79                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:8E7B                 </span><span style="color:navy">mov     dx, </span>FATBYT
<span style="color:black">DOSCODE:8E7F                 </span><span style="color:navy">call    </span>PACK
<span style="color:black">DOSCODE:8E82                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8E83                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:8E84                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8E85                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8E85 </span>RESTFATBYT      endp
<span style="color:black">DOSCODE:8E85
DOSCODE:8E86
DOSCODE:8E86 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8E86
DOSCODE:8E86
DOSCODE:8E86 </span>RELEASE         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E86                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:8E88
DOSCODE:8E88 </span>RELBLKS<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8E88                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8E8B                 </span><span style="color:navy">jb      short </span><span style="color:gray">RELEASE_flush
</span><span style="color:black">DOSCODE:8E8D                 </span><span style="color:navy">jz      short </span><span style="color:gray">RELEASE_flush
</span><span style="color:black">DOSCODE:8E8F                 </span><span style="color:navy">mov     ax, di
</span><span style="color:black">DOSCODE:8E91                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:8E92                 </span><span style="color:navy">call    </span>PACK
<span style="color:black">DOSCODE:8E95                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:8E96                 </span><span style="color:navy">jb      short </span><span style="color:gray">RELEASE_flush
</span><span style="color:black">DOSCODE:8E98                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:8E9A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO_DEALLOC
</span><span style="color:black">DOSCODE:8E9C                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], -</span><span style="color:green">1
</span><span style="color:black">DOSCODE:8EA1                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_DEALLOC
</span><span style="color:black">DOSCODE:8EA3                 </span><span style="color:navy">inc     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8EA7
DOSCODE:8EA7 </span><span style="color:gray">NO_DEALLOC</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8EA7                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:black">DOSCODE:8EA9                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:8EAA                 </span><span style="color:navy">jz      short </span><span style="color:gray">RELEASE_flush
</span><span style="color:black">DOSCODE:8EAC                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:8EAF                 </span><span style="color:navy">jb      short </span>RELEASE
<span style="color:black">DOSCODE:8EB1
DOSCODE:8EB1 </span><span style="color:gray">RELEASE_flush</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8EB1                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:8EB5                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:8EB6                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:8EB7                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:8EB8                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:8EB9                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:8EBC                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:8EBD                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8EBE                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:8EBF                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:8EC0
DOSCODE:8EC0 </span>RET12<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8EC0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8EC0 </span>RELEASE         endp
<span style="color:black">DOSCODE:8EC0
DOSCODE:8EC1
DOSCODE:8EC1 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8EC1
DOSCODE:8EC1
DOSCODE:8EC1 </span>GETEOF          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8EC1                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:8EC4                 </span><span style="color:navy">jb      short </span>RET12
<span style="color:black">DOSCODE:8EC6                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:8EC7                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:8EC9                 </span><span style="color:navy">call    </span>IsEOF
<span style="color:black">DOSCODE:8ECC                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:8ECD                 </span><span style="color:navy">jnb     short </span>RET12
<span style="color:black">DOSCODE:8ECF                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:8ED1                 </span><span style="color:navy">jmp     short </span>GETEOF
<span style="color:black">DOSCODE:8ED1 </span>GETEOF          endp
<span style="color:black">DOSCODE:8ED1
DOSCODE:8ED3
DOSCODE:8ED3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8ED3
DOSCODE:8ED3
DOSCODE:8ED3 </span>MAKEFCB         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8ED3                 </span><span style="color:navy">mov     ss:</span>SpaceFlag<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8ED9                 </span><span style="color:navy">xor     dl, dl
</span><span style="color:black">DOSCODE:8EDB                 </span><span style="color:navy">test    al, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:8EDD                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DEFDRV
</span><span style="color:black">DOSCODE:8EDF                 </span><span style="color:navy">mov     byte ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:8EE3
DOSCODE:8EE3 </span><span style="color:gray">DEFDRV</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8EE3                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:8EE4                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:8EE7                 </span><span style="color:navy">test    al, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:8EE9                 </span><span style="color:navy">xchg    ax, bx
</span><span style="color:black">DOSCODE:8EEA                 </span><span style="color:navy">mov     al, &#039; &#039;
</span><span style="color:black">DOSCODE:8EEC                 </span><span style="color:navy">jz      short </span><span style="color:gray">FILLB
</span><span style="color:black">DOSCODE:8EEE                 </span><span style="color:navy">add     di, cx
</span><span style="color:black">DOSCODE:8EF0                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:8EF2
DOSCODE:8EF2 </span><span style="color:gray">FILLB</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8EF2                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:8EF4                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:8EF6                 </span><span style="color:navy">test    bl, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:8EF9                 </span><span style="color:navy">jz      short </span><span style="color:gray">FILLB2
</span><span style="color:black">DOSCODE:8EFB                 </span><span style="color:navy">add     di, cx
</span><span style="color:black">DOSCODE:8EFD                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:8EFF
DOSCODE:8EFF </span><span style="color:gray">FILLB2</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8EFF                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:8F01                 </span><span style="color:navy">xchg    ax, cx
</span><span style="color:black">DOSCODE:8F02                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8F03                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:8F04                 </span><span style="color:navy">sub     di, </span><span style="color:green">16
</span><span style="color:black">DOSCODE:8F07                 </span><span style="color:navy">test    bl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8F0A                 </span><span style="color:navy">jz      short </span><span style="color:gray">SKPSPC
</span><span style="color:black">DOSCODE:8F0C                 </span><span style="color:navy">call    </span>SCANB
<span style="color:black">DOSCODE:8F0F                 </span><span style="color:navy">call    </span>DELIM
<span style="color:black">DOSCODE:8F12                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOSCAN
</span><span style="color:black">DOSCODE:8F14                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:8F15
DOSCODE:8F15 </span><span style="color:gray">SKPSPC</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F15                 </span><span style="color:navy">call    </span>SCANB
<span style="color:black">DOSCODE:8F18
DOSCODE:8F18 </span><span style="color:gray">NOSCAN</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F18                 </span><span style="color:navy">call    </span>GETLET
<span style="color:black">DOSCODE:8F1B                 </span><span style="color:navy">jbe     short </span><span style="color:gray">NODRV
</span><span style="color:black">DOSCODE:8F1D                 </span><span style="color:navy">cmp     byte ptr [si], &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:8F20                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NODRV
</span><span style="color:black">DOSCODE:8F22                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:8F23                 </span><span style="color:navy">sub     al, &#039;</span><span style="color:green">@&#039;
</span><span style="color:black">DOSCODE:8F25                 </span><span style="color:navy">jbe     short </span><span style="color:gray">BADDRV
</span><span style="color:black">DOSCODE:8F27                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:8F28                 </span><span style="color:navy">call    </span>GetVisDrv
<span style="color:black">DOSCODE:8F2B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:8F2C                 </span><span style="color:navy">jnb     short </span><span style="color:gray">HAVDRV
</span><span style="color:black">DOSCODE:8F2E                 </span><span style="color:navy">cmp     ss:</span>DrvErr<span style="color:navy">, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:8F34                 </span><span style="color:navy">jz      short </span><span style="color:gray">HAVDRV
</span><span style="color:black">DOSCODE:8F36
DOSCODE:8F36 </span><span style="color:gray">BADDRV</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F36                 </span><span style="color:navy">mov     dl, -</span><span style="color:green">1
</span><span style="color:black">DOSCODE:8F38
DOSCODE:8F38 </span><span style="color:gray">HAVDRV</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F38                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8F39                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:8F3A                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:8F3B
DOSCODE:8F3B </span><span style="color:gray">NODRV</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F3B                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:8F3C                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:8F3D
DOSCODE:8F3D </span>NORMSCAN<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F3D                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:8F40                 </span><span style="color:navy">call    </span>GETWORD
<span style="color:black">DOSCODE:8F43                 </span><span style="color:navy">cmp     byte ptr [si], &#039;</span><span style="color:green">.&#039;
</span><span style="color:black">DOSCODE:8F46                 </span><span style="color:navy">jnz     short </span>NODOT
<span style="color:black">DOSCODE:8F48                 </span><span style="color:navy">inc     si
</span><span style="color:black">DOSCODE:8F49                 </span><span style="color:navy">test    byte ptr ss:</span>DOS34_FLAG<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8F4F                 </span><span style="color:navy">jz      short </span>VOLOK
<span style="color:black">DOSCODE:8F51                 </span><span style="color:navy">movsb
</span><span style="color:black">DOSCODE:8F52                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:8F55                 </span><span style="color:navy">jmp     short </span>contvol
<span style="color:black">DOSCODE:8F57 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8F57
DOSCODE:8F57 </span>VOLOK<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F57                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:8F5A
DOSCODE:8F5A </span>contvol<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F5A                 </span><span style="color:navy">call    </span>MUSTGETWORD
<span style="color:black">DOSCODE:8F5D
DOSCODE:8F5D </span>NODOT<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F5D                 </span><span style="color:navy">mov     al, dl
</span><span style="color:black">DOSCODE:8F5F                 </span><span style="color:navy">and     ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">0FEFFh
</span><span style="color:black">DOSCODE:8F66                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8F66 </span>MAKEFCB         endp
<span style="color:black">DOSCODE:8F66
DOSCODE:8F67 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8F67 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR GETWORD
</span><span style="color:black">DOSCODE:8F67
DOSCODE:8F67 </span><span style="color:gray">NONAM</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F67                 </span><span style="color:navy">add     di, cx
</span><span style="color:black">DOSCODE:8F69                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:8F6A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8F6A </span><span style="color:gray">; END OF FUNCTION CHUNK FOR GETWORD
</span><span style="color:black">DOSCODE:8F6B
DOSCODE:8F6B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8F6B
DOSCODE:8F6B
DOSCODE:8F6B </span>GETWORD         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F6B
DOSCODE:8F6B </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:8F67 SIZE 00000004 BYTES
</span><span style="color:black">DOSCODE:8F6B
DOSCODE:8F6B                 </span><span style="color:navy">call    </span>GETLET
<span style="color:black">DOSCODE:8F6E                 </span><span style="color:navy">jbe     short </span><span style="color:gray">NONAM
</span><span style="color:black">DOSCODE:8F70                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:8F71
DOSCODE:8F71 </span>MUSTGETWORD<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F71                 </span><span style="color:navy">call    </span>GETLET
<span style="color:black">DOSCODE:8F74                 </span><span style="color:navy">jnz     short </span><span style="color:gray">MustCheckCX
</span><span style="color:black">DOSCODE:8F76                 </span><span style="color:navy">test    ss:</span>SpaceFlag<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:8F7C                 </span><span style="color:navy">jz      short </span><span style="color:gray">FILLNAM
</span><span style="color:black">DOSCODE:8F7E                 </span><span style="color:navy">cmp     al, &#039; &#039;
</span><span style="color:black">DOSCODE:8F80                 </span><span style="color:navy">jnz     short </span><span style="color:gray">FILLNAM
</span><span style="color:black">DOSCODE:8F82
DOSCODE:8F82 </span><span style="color:gray">MustCheckCX</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F82                 </span><span style="color:navy">jcxz    short </span>MUSTGETWORD
<span style="color:black">DOSCODE:8F84                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:8F85                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">*&#039;
</span><span style="color:black">DOSCODE:8F87                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOSTAR
</span><span style="color:black">DOSCODE:8F89                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:8F8B                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:8F8D
DOSCODE:8F8D </span><span style="color:gray">NOSTAR</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F8D                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8F8E                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">?&#039;
</span><span style="color:black">DOSCODE:8F90                 </span><span style="color:navy">jnz     short </span>MUSTGETWORD
<span style="color:black">DOSCODE:8F92                 </span><span style="color:navy">or      dl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:8F95                 </span><span style="color:navy">jmp     short </span>MUSTGETWORD
<span style="color:black">DOSCODE:8F97 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:8F97
DOSCODE:8F97 </span><span style="color:gray">FILLNAM</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F97                 </span><span style="color:navy">mov     al, &#039; &#039;
</span><span style="color:black">DOSCODE:8F99                 </span><span style="color:navy">rep stosb
</span><span style="color:black">DOSCODE:8F9B                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:8F9C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8F9C </span>GETWORD         endp
<span style="color:black">DOSCODE:8F9C
DOSCODE:8F9D
DOSCODE:8F9D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8F9D
DOSCODE:8F9D
DOSCODE:8F9D </span>SCANB           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8F9D                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:8F9E                 </span><span style="color:navy">call    </span>SPCHK
<span style="color:black">DOSCODE:8FA1                 </span><span style="color:navy">jz      short </span>SCANB
<span style="color:black">DOSCODE:8FA3                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:8FA4
DOSCODE:8FA4 </span>scanb_retn<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:8FA4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8FA4 </span>SCANB           endp
<span style="color:black">DOSCODE:8FA4
DOSCODE:8FA5
DOSCODE:8FA5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:8FA5
DOSCODE:8FA5
DOSCODE:8FA5 </span>NameTrans       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:8FA5                 </span><span style="color:navy">mov     ss:</span>SpaceFlag<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:8FAB                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:8FAC                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:8FAD                 </span><span style="color:navy">mov     di, offset </span>NAME1
<span style="color:black">DOSCODE:8FB0                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:8FB1                 </span><span style="color:navy">mov     ax, &#039;  &#039;
</span><span style="color:black">DOSCODE:8FB4                 </span><span style="color:navy">mov     cx, </span><span style="color:green">5
</span><span style="color:black">DOSCODE:8FB7                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8FB8                 </span><span style="color:navy">rep stosw
</span><span style="color:black">DOSCODE:8FBA                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:8FBC                 </span><span style="color:navy">mov     dl, al
</span><span style="color:black">DOSCODE:8FBE                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:8FBF                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:8FC0                 </span><span style="color:navy">call    </span>NORMSCAN
<span style="color:black">DOSCODE:8FC3                 </span><span style="color:navy">cmp     ss:</span>NAME1<span style="color:navy">, </span><span style="color:green">0E5h
</span><span style="color:black">DOSCODE:8FC9                 </span><span style="color:navy">jnz     short </span>scanb_retn
<span style="color:black">DOSCODE:8FCB                 </span><span style="color:navy">mov     ss:</span>NAME1<span style="color:navy">, </span><span style="color:green">5
</span><span style="color:black">DOSCODE:8FD1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:8FD1 </span>NameTrans       endp
<span style="color:black">DOSCODE:8FD1
DOSCODE:8FD1 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:8FD2 </span>CharType        <span style="color:navy">db  </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">06h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:8FD2                 </span><span style="color:navy">db  </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:gray">; 8
DOSCODE:8FD2                 </span><span style="color:navy">db </span><span style="color:#008040">0F8h</span><span style="color:navy">,</span><span style="color:#008040">0F6h</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">4Fh</span><span style="color:navy">,</span><span style="color:#008040">0F4h</span><span style="color:navy">, </span><span style="color:#008040">6Eh</span><span style="color:gray">; 16
DOSCODE:8FD2                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">44h</span><span style="color:navy">, </span><span style="color:#008040">44h</span><span style="color:navy">,</span><span style="color:#008040">0F4h</span><span style="color:gray">; 24
DOSCODE:8FD2                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:gray">; 32
DOSCODE:8FD2                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">6Fh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:gray">; 40
DOSCODE:8FD2                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:gray">; 48
DOSCODE:8FD2                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0FFh</span><span style="color:navy">,</span><span style="color:#008040">0F4h</span><span style="color:gray">; 56
</span><span style="color:black">DOSCODE:9011
DOSCODE:9011 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9011
DOSCODE:9011
DOSCODE:9011 </span>GETLET          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9011                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:9011 </span>GETLET          endp
<span style="color:black">DOSCODE:9011
DOSCODE:9012
DOSCODE:9012 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9012
DOSCODE:9012
DOSCODE:9012 </span>UCase           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9012                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9013                 </span><span style="color:navy">mov     bx, offset </span>FILE_UCASE_TAB_2
<span style="color:black">DOSCODE:9016
DOSCODE:9016 </span>gl_0<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9016                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">a&#039;
</span><span style="color:black">DOSCODE:9018                 </span><span style="color:navy">jb      short </span><span style="color:gray">gl_2
</span><span style="color:black">DOSCODE:901A                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">z&#039;
</span><span style="color:black">DOSCODE:901C                 </span><span style="color:navy">ja      short </span><span style="color:gray">gl_1
</span><span style="color:black">DOSCODE:901E                 </span><span style="color:navy">sub     al, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:9020
DOSCODE:9020 </span><span style="color:gray">gl_1</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9020                 </span><span style="color:navy">cmp     al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:9022                 </span><span style="color:navy">jb      short </span><span style="color:gray">gl_2
</span><span style="color:black">DOSCODE:9024                 </span><span style="color:navy">sub     al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:9026                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9027                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:902C                 </span><span style="color:navy">xlat
</span><span style="color:black">DOSCODE:902D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:902E
DOSCODE:902E </span><span style="color:gray">gl_2</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:902E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:902F                 </span><span style="color:navy">call    </span>GetCharType
<span style="color:black">DOSCODE:9032                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9034                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9035                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:9036                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9036 </span>UCase           endp
<span style="color:black">DOSCODE:9036
DOSCODE:9037
DOSCODE:9037 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9037
DOSCODE:9037
DOSCODE:9037 </span>GETLET3         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9037                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9038                 </span><span style="color:navy">jmp     short </span>gl_0
<span style="color:black">DOSCODE:9038 </span>GETLET3         endp
<span style="color:black">DOSCODE:9038
DOSCODE:903A
DOSCODE:903A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:903A
DOSCODE:903A
DOSCODE:903A </span>DELIM           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:903A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:903B                 </span><span style="color:navy">call    </span>GetCharType
<span style="color:black">DOSCODE:903E                 </span><span style="color:navy">test    al, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:9040                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9041                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9041 </span>DELIM           endp
<span style="color:black">DOSCODE:9041
DOSCODE:9042
DOSCODE:9042 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9042
DOSCODE:9042
DOSCODE:9042 </span>SPCHK           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9042                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9043                 </span><span style="color:navy">call    </span>GetCharType
<span style="color:black">DOSCODE:9046                 </span><span style="color:navy">test    al, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:9048                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9049                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9049 </span>SPCHK           endp
<span style="color:black">DOSCODE:9049
DOSCODE:904A
DOSCODE:904A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:904A
DOSCODE:904A
DOSCODE:904A </span>GetCharType     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:904A                 </span><span style="color:navy">cmp     al, </span><span style="color:green">7Eh
</span><span style="color:black">DOSCODE:904C                 </span><span style="color:navy">jnb     short </span><span style="color:gray">gct_90
</span><span style="color:black">DOSCODE:904E                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:904F                 </span><span style="color:navy">mov     bx, offset </span>CharType
<span style="color:black">DOSCODE:9052                 </span><span style="color:navy">shr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9054                 </span><span style="color:navy">xlat    byte ptr cs:[bx]
</span><span style="color:black">DOSCODE:9056                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:9057                 </span><span style="color:navy">jnb     short </span><span style="color:gray">gct_80
</span><span style="color:black">DOSCODE:9059                 </span><span style="color:navy">shr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:905B                 </span><span style="color:navy">shr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:905D                 </span><span style="color:navy">shr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:905F                 </span><span style="color:navy">shr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9061
DOSCODE:9061 </span><span style="color:gray">gct_80</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9061                 </span><span style="color:navy">and     al, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:9063                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9064 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9064
DOSCODE:9064 </span><span style="color:gray">gct_90</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9064                 </span><span style="color:navy">mov     al, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:9066                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9066 </span>GetCharType     endp
<span style="color:black">DOSCODE:9066
DOSCODE:9067
DOSCODE:9067 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9067
DOSCODE:9067
DOSCODE:9067 </span>PATHCHRCMP      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9067                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">/&#039;
</span><span style="color:black">DOSCODE:9069                 </span><span style="color:navy">jbe     short </span><span style="color:gray">PathRet
</span><span style="color:black">DOSCODE:906B                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:906D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:906E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:906E
DOSCODE:906E </span><span style="color:gray">GotFor</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:906E                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:9070                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9071 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9071
DOSCODE:9071 </span><span style="color:gray">PathRet</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9071                 </span><span style="color:navy">jz      short </span><span style="color:gray">GotFor
</span><span style="color:black">DOSCODE:9073                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9073 </span>PATHCHRCMP      endp
<span style="color:black">DOSCODE:9073
DOSCODE:9073 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:9074 </span>LowInt23Addr    <span style="color:navy">dd </span>LowInt23             <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:9078 </span>LowInt24Addr    <span style="color:navy">dd </span>LowInt24             <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:907C </span>LowInt28Addr    <span style="color:navy">dd </span>LowInt28             <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:9080
DOSCODE:9080 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9080
DOSCODE:9080
DOSCODE:9080 </span>DSKSTATCHK      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9080                 </span><span style="color:navy">cmp     ss:</span>INDOS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9086                 </span><span style="color:navy">jz      short </span><span style="color:gray">dskstatchk1
</span><span style="color:black">DOSCODE:9088                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9089 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9089
DOSCODE:9089 </span><span style="color:gray">dskstatchk1</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9089                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:908A                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:908B                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:908C                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:908D                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:908E                 </span><span style="color:navy">mov     bx, ss
</span><span style="color:black">DOSCODE:9090                 </span><span style="color:navy">mov     es, bx
</span><span style="color:black">DOSCODE:9092                 </span><span style="color:navy">mov     ds, bx
</span><span style="color:black">DOSCODE:9094                 </span><span style="color:navy">mov     ss:</span>DSKSTCOM<span style="color:navy">, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:909A                 </span><span style="color:navy">mov     ss:</span>DSKSTCALL<span style="color:navy">, </span><span style="color:#ff8000">0Eh
</span><span style="color:black">DOSCODE:90A0                 </span><span style="color:navy">mov     ss:</span>DSKSTST<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:90A7                 </span><span style="color:navy">mov     bx, offset </span>DSKSTCALL
<span style="color:black">DOSCODE:90AA                 </span><span style="color:navy">lds     si, ss:</span>BCON
<span style="color:black">DOSCODE:90AF                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:90B2                 </span><span style="color:navy">test    byte ptr ss:</span>DSKSTST<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:90B8                 </span><span style="color:navy">jz      short </span><span style="color:gray">_GotCh
</span><span style="color:black">DOSCODE:90BA                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:90BC
DOSCODE:90BC </span><span style="color:gray">RET36</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:90BC                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:90BD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:90BE                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:90BF                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:90C0                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:90C1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:90C2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:90C2
DOSCODE:90C2 </span><span style="color:gray">_GotCh</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:90C2                 </span><span style="color:navy">mov     al, ss:</span>DSKCHRET
<span style="color:black">DOSCODE:90C6                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:90C8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">RET36
</span><span style="color:black">DOSCODE:90CA                 </span><span style="color:navy">mov     ss:</span>DSKSTCOM<span style="color:navy">, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:90D0                 </span><span style="color:navy">mov     ss:</span>DSKSTCALL<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:90D6                 </span><span style="color:navy">mov     ss:</span>DSKCHRET<span style="color:navy">, cl
</span><span style="color:black">DOSCODE:90DB                 </span><span style="color:navy">mov     ss:</span>DSKSTST<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:90E2                 </span><span style="color:navy">mov     ss:</span>DSKSTCNT<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:90E9                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:90EC                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:90ED                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:90EE                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:90EF                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:90F0                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:90F1                 </span><span style="color:navy">jmp     </span>CNTCHAND
<span style="color:black">DOSCODE:90F1 </span>DSKSTATCHK      endp
<span style="color:black">DOSCODE:90F1
DOSCODE:90F4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:90F4 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR STATCHK
</span><span style="color:black">DOSCODE:90F4
DOSCODE:90F4 </span><span style="color:gray">NOSTOP</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:90F4                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:90F6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">check_next
</span><span style="color:black">DOSCODE:90F8                 </span><span style="color:navy">cmp     ss:</span>SCAN_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:90FE                 </span><span style="color:navy">jz      short </span><span style="color:gray">INCHKJ
</span><span style="color:black">DOSCODE:9100                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9101 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9101
DOSCODE:9101 </span><span style="color:gray">check_next</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9101                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:9103                 </span><span style="color:navy">jz      short </span><span style="color:gray">INCHKJ
</span><span style="color:black">DOSCODE:9105
DOSCODE:9105 </span><span style="color:gray">check_end</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9105                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9106 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9106
DOSCODE:9106 </span><span style="color:gray">INCHKJ</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9106                 </span><span style="color:navy">jmp     </span><span style="color:gray">INCHK
</span><span style="color:black">DOSCODE:9106 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR STATCHK
</span><span style="color:black">DOSCODE:9109
DOSCODE:9109 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9109
DOSCODE:9109
DOSCODE:9109 </span>SPOOLINT        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9109                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:910A                 </span><span style="color:navy">cmp     ss:</span>IDLEINT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9110                 </span><span style="color:navy">jz      short </span><span style="color:gray">POPFRET
</span><span style="color:black">DOSCODE:9112                 </span><span style="color:navy">cmp     ss:</span>ERRORMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9118                 </span><span style="color:navy">jnz     short </span><span style="color:gray">POPFRET
</span><span style="color:black">DOSCODE:911A                 </span><span style="color:navy">push    word ptr ss:</span>IDLEINT
<span style="color:black">DOSCODE:911F                 </span><span style="color:navy">cmp     ss:</span>DosHasHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9125                 </span><span style="color:navy">jnz     short </span><span style="color:gray">do_low_int28
</span><span style="color:black">DOSCODE:9127                 </span><span style="color:navy">int     </span><span style="color:green">28h             </span>; DOS 2+ internal - KEYBOARD BUSY LOOP
<span style="color:black">DOSCODE:9129                 </span><span style="color:navy">jmp     short </span><span style="color:gray">spool_ret_addr
</span><span style="color:black">DOSCODE:912B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:912B
DOSCODE:912B </span><span style="color:gray">do_low_int28</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:912B                 </span><span style="color:navy">call    cs:</span>LowInt28Addr
<span style="color:black">DOSCODE:9130
DOSCODE:9130 </span><span style="color:gray">spool_ret_addr</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9130                 </span><span style="color:navy">pop     word ptr ss:</span>IDLEINT
<span style="color:black">DOSCODE:9135
DOSCODE:9135 </span><span style="color:gray">POPFRET</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9135                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:9136
DOSCODE:9136 </span>_RET18<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9136                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9136 </span>SPOOLINT        endp
<span style="color:black">DOSCODE:9136
DOSCODE:9137
DOSCODE:9137 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9137
DOSCODE:9137
DOSCODE:9137 </span>STATCHK         proc far                <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9137
DOSCODE:9137 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:40D0 SIZE 00000003 BYTES
</span><span style="color:black">DOSCODE:9137 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:40F8 SIZE 00000006 BYTES
</span><span style="color:black">DOSCODE:9137 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:90F4 SIZE 00000015 BYTES
</span><span style="color:black">DOSCODE:9137
DOSCODE:9137                 </span><span style="color:navy">call    </span>DSKSTATCHK
<span style="color:black">DOSCODE:913A                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:913B                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:913D                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:9140                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:9141                 </span><span style="color:navy">jb      short </span>_RET18
<span style="color:black">DOSCODE:9143                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9145                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:9148                 </span><span style="color:navy">jz      short </span>SPOOLINT
<span style="color:black">DOSCODE:914A                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">13h
</span><span style="color:black">DOSCODE:914C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOSTOP
</span><span style="color:black">DOSCODE:914E                 </span><span style="color:navy">cmp     ss:</span>SCAN_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9154                 </span><span style="color:navy">jnz     short </span><span style="color:gray">check_end
</span><span style="color:black">DOSCODE:9156                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:9158                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:915B                 </span><span style="color:navy">jmp     short </span><span style="color:gray">PAUSOSTRT
</span><span style="color:black">DOSCODE:915D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:915D
DOSCODE:915D </span><span style="color:gray">PRINTONOFF</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:915D                 </span><span style="color:navy">not     ss:</span>PFLAG
<span style="color:black">DOSCODE:9162                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9163                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:9166                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:9169                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:916A                 </span><span style="color:navy">jb      short </span>_RET18
<span style="color:black">DOSCODE:916C                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:916D                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:916E                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:916F                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9170                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:9172                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:9177                 </span><span style="color:navy">jz      short </span><span style="color:gray">NORM_PR
</span><span style="color:black">DOSCODE:9179                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:917A                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1126h
</span><span style="color:black">DOSCODE:917D                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - ???
<span style="color:black">DOSCODE:917D                                         </span>; Return: CF set on error, AX = error code
<span style="color:black">DOSCODE:917D                                         </span>; STACK unchanged
<span style="color:black">DOSCODE:917F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9180                 </span><span style="color:navy">jnb     short </span><span style="color:gray">NORM_PR
</span><span style="color:black">DOSCODE:9182                 </span><span style="color:navy">mov     ss:</span>PFLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9188                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9189                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1124h
</span><span style="color:black">DOSCODE:918C                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - ???
<span style="color:black">DOSCODE:918C                                         </span>; ES:DI -&gt; SFT, SS = DOS CS
<span style="color:black">DOSCODE:918E                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:918F                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RETP6
</span><span style="color:black">DOSCODE:9191 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9191
DOSCODE:9191 </span><span style="color:gray">NORM_PR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9191                 </span><span style="color:navy">cmp     ss:</span>PFLAG<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9197                 </span><span style="color:navy">jnz     short </span><span style="color:gray">PRNOPN
</span><span style="color:black">DOSCODE:9199                 </span><span style="color:navy">call    </span>DEV_CLOSE_SFT
<span style="color:black">DOSCODE:919C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">RETP6
</span><span style="color:black">DOSCODE:919E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:919E
DOSCODE:919E </span><span style="color:gray">PRNOPN</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:919E                 </span><span style="color:navy">call    </span>DEV_OPEN_SFT
<span style="color:black">DOSCODE:91A1
DOSCODE:91A1 </span><span style="color:gray">RETP6</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91A1                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:91A2                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:91A3
DOSCODE:91A3 </span><span style="color:gray">STATCHK_RETN</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91A3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:91A4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:91A4
DOSCODE:91A4 </span><span style="color:gray">PAUSOLP</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91A4                 </span><span style="color:navy">call    </span>SPOOLINT
<span style="color:black">DOSCODE:91A7
DOSCODE:91A7 </span><span style="color:gray">PAUSOSTRT</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91A7                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:91A9                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:91AC                 </span><span style="color:navy">jz      short </span><span style="color:gray">PAUSOLP
</span><span style="color:black">DOSCODE:91AE
DOSCODE:91AE </span><span style="color:gray">INCHK</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91AE                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:91AF                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:91B1                 </span><span style="color:navy">call    </span>GET_IO_SFT
<span style="color:black">DOSCODE:91B4                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:91B5                 </span><span style="color:navy">jb      short </span><span style="color:gray">STATCHK_RETN
</span><span style="color:black">DOSCODE:91B7                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:91B9                 </span><span style="color:navy">call    </span>IOFUNC
<span style="color:black">DOSCODE:91BC                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:91BE                 </span><span style="color:navy">jz      short </span><span style="color:gray">PRINTONOFF
</span><span style="color:black">DOSCODE:91C0                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:91C2                 </span><span style="color:navy">jnz     short </span><span style="color:gray">STATCHK_RETN
</span><span style="color:black">DOSCODE:91C4
DOSCODE:91C4 </span>CNTCHAND<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91C4                 </span><span style="color:navy">test    byte ptr ss:</span>DOS34_FLAG<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:91CA                 </span><span style="color:navy">jnz     short </span><span style="color:gray">around_deadlock
</span><span style="color:black">DOSCODE:91CC                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:91CE                 </span><span style="color:navy">call    </span>BUFOUT
<span style="color:black">DOSCODE:91D1                 </span><span style="color:navy">call    </span>CRLF
<span style="color:black">DOSCODE:91D4
DOSCODE:91D4 </span><span style="color:gray">around_deadlock</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91D4                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:91D5                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:91D6                 </span><span style="color:navy">cmp     </span>CONSWAP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:91DB                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOSWAP
</span><span style="color:black">DOSCODE:91DD                 </span><span style="color:navy">call    </span>SWAPBACK
<span style="color:black">DOSCODE:91E0
DOSCODE:91E0 </span><span style="color:gray">NOSWAP</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:91E0                 </span><span style="color:navy">cli
</span><span style="color:black">DOSCODE:91E1                 </span><span style="color:navy">mov     ss, </span>USER_SS
<span style="color:black">DOSCODE:91E5                 </span><span style="color:navy">mov     sp, </span>USER_SP
<span style="color:black">DOSCODE:91E9                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:91EC                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:91ED                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:91EE                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:91F3                 </span><span style="color:navy">mov     </span>INDOS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:91F8                 </span><span style="color:navy">mov     </span>ERRORMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:91FD                 </span><span style="color:navy">mov     </span>ConC_Spsave<span style="color:navy">, sp
</span><span style="color:black">DOSCODE:9201                 </span><span style="color:navy">add     </span>ConC_Spsave<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:9206                 </span><span style="color:navy">cmp     </span>DosHasHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:920B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:920C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">do_low_int23
</span><span style="color:black">DOSCODE:920E                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:920F                 </span><span style="color:navy">int     </span><span style="color:green">23h             </span>; DOS - CONTROL &quot;C&quot; EXIT ADDRESS
<span style="color:black">DOSCODE:920F                                         </span>; Return: return via RETF 2 with CF set
<span style="color:black">DOSCODE:920F                                         </span>; DOS will abort program with errorlevel 0
<span style="color:black">DOSCODE:920F                                         </span>; else
<span style="color:black">DOSCODE:920F                                         </span>; interrupted DOS call continues
<span style="color:black">DOSCODE:9211                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ctrlc_ret_addr
</span><span style="color:black">DOSCODE:9213 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9213
DOSCODE:9213 </span><span style="color:gray">do_low_int23</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9213                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:9214                 </span><span style="color:navy">call    cs:</span>LowInt23Addr
<span style="color:black">DOSCODE:9219
DOSCODE:9219 </span><span style="color:gray">ctrlc_ret_addr</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9219                 </span><span style="color:navy">cli
</span><span style="color:black">DOSCODE:921A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:921B                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:921D                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:9222                 </span><span style="color:navy">mov     </span>TEMPSEG<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9225                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9226                 </span><span style="color:navy">mov     </span>USER_IN_AX<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9229                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:922A                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:922B                 </span><span style="color:navy">cmp     sp, </span>ConC_Spsave
<span style="color:black">DOSCODE:922F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ctrlc_try_new
</span><span style="color:black">DOSCODE:9231
DOSCODE:9231 </span><span style="color:gray">ctrlc_repeat</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9231                 </span><span style="color:navy">mov     ax, </span>USER_IN_AX
<span style="color:black">DOSCODE:9234                 </span><span style="color:navy">mov     ds, </span>TEMPSEG
<span style="color:black">DOSCODE:9238
DOSCODE:9238 </span><span style="color:gray">COMMANDJ</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9238                 </span><span style="color:navy">jmp     </span>command
<span style="color:black">DOSCODE:923B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:923B
DOSCODE:923B </span><span style="color:gray">ctrlc_try_new</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:923B                 </span><span style="color:navy">add     sp, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:923E                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9240                 </span><span style="color:navy">jz      short </span><span style="color:gray">ctrlc_repeat
</span><span style="color:black">DOSCODE:9242                 </span><span style="color:navy">mov     ds, </span>TEMPSEG
<span style="color:black">DOSCODE:9246
DOSCODE:9246 </span>ctrlc_abort<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9246                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">4C00h
</span><span style="color:black">DOSCODE:9249                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:924A                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:924F                 </span><span style="color:navy">mov     </span>DidCTRLC<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9254                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9255                 </span><span style="color:navy">jmp     short </span><span style="color:gray">COMMANDJ
</span><span style="color:black">DOSCODE:9255 </span>STATCHK         endp
<span style="color:black">DOSCODE:9255
</span><span style="color:maroon">DOSCODE:9257 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:9257
DOSCODE:9257 </span>DIVOV<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:9257                 </span><span style="color:navy">mov     si, offset </span>DIVMES <span style="color:gray">; &quot;\r\nDivide overflow\r\n&quot;
</span><span style="color:maroon">DOSCODE:925A                 </span><span style="color:navy">mov     bx, cs:</span>DivMesLen
<span style="color:maroon">DOSCODE:925F                 </span><span style="color:navy">mov     ss, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:9264                 </span><span style="color:navy">mov     sp, offset </span>AUXSTACK
<span style="color:maroon">DOSCODE:9267                 </span><span style="color:navy">call    </span>_OUTMES
<span style="color:maroon">DOSCODE:926A                 </span><span style="color:navy">jmp     short </span>ctrlc_abort
<span style="color:black">DOSCODE:926C
DOSCODE:926C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:926C
DOSCODE:926C
DOSCODE:926C </span>_OUTMES         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:926C                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:926D                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:926E                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:926F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9270                 </span><span style="color:navy">mov     </span>DSKSTCOM<span style="color:navy">, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:9275                 </span><span style="color:navy">mov     </span>DSKSTCALL<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:927A                 </span><span style="color:navy">mov     </span>DSKSTST<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9280                 </span><span style="color:navy">mov     </span>DSKSTCNT<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:9284                 </span><span style="color:navy">mov     bx, offset </span>DSKSTCALL
<span style="color:black">DOSCODE:9287                 </span><span style="color:navy">mov     </span>DEVIOBUF_PTR<span style="color:navy">, si
</span><span style="color:black">DOSCODE:928B                 </span><span style="color:navy">mov     </span>DOSSEG_INIT<span style="color:navy">, cs
</span><span style="color:black">DOSCODE:928F                 </span><span style="color:navy">lds     si, </span>BCON
<span style="color:black">DOSCODE:9293                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:9296                 </span><span style="color:navy">mov     es:</span>DEVIOBUF_PTR<span style="color:navy">, offset </span>DEVIOBUF
<span style="color:black">DOSCODE:929D                 </span><span style="color:navy">mov     es:</span>DSKSTCNT<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:92A4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:92A4 </span>_OUTMES         endp
<span style="color:black">DOSCODE:92A4
DOSCODE:92A5
DOSCODE:92A5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:92A5
DOSCODE:92A5
DOSCODE:92A5 </span>CHARHARD        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:92A5                 </span><span style="color:navy">cmp     ss:</span>ERRORMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:92AB                 </span><span style="color:navy">jnz     short </span><span style="color:gray">chard1
</span><span style="color:black">DOSCODE:92AD                 </span><span style="color:navy">or      ah, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:92B0                 </span><span style="color:navy">test    ss:</span>PFLAG<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:92B6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ctrlp
</span><span style="color:black">DOSCODE:92B8
DOSCODE:92B8 </span><span style="color:gray">chard1</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:92B8                 </span><span style="color:navy">or      ah, </span><span style="color:green">38h
</span><span style="color:black">DOSCODE:92BB
DOSCODE:92BB </span><span style="color:gray">ctrlp</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:92BB                 </span><span style="color:navy">mov     ss:</span>ALLOWED<span style="color:navy">, ah
</span><span style="color:black">DOSCODE:92C0                 </span><span style="color:navy">mov     word ptr ss:</span>EXITHOLD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:92C5                 </span><span style="color:navy">mov     word ptr ss:</span>EXITHOLD<span style="color:navy">, bp
</span><span style="color:black">DOSCODE:92CA                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:92CB                 </span><span style="color:navy">and     di, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:92CF                 </span><span style="color:navy">mov     bp, ds
</span><span style="color:black">DOSCODE:92D1                 </span><span style="color:navy">call    </span>FATALC
<span style="color:black">DOSCODE:92D4                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:92D5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:92D5 </span>CHARHARD        endp
<span style="color:black">DOSCODE:92D5
DOSCODE:92D6
DOSCODE:92D6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:92D6
DOSCODE:92D6
DOSCODE:92D6 </span>HARDERR         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:92D6                 </span><span style="color:navy">xchg    ax, di
</span><span style="color:black">DOSCODE:92D7                 </span><span style="color:navy">and     di, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:92DB                 </span><span style="color:navy">cmp     di, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:92DE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NOSETWRPERR
</span><span style="color:black">DOSCODE:92E0                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:92E1                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:92E5                 </span><span style="color:navy">mov     ss:</span>WPERR<span style="color:navy">, al
</span><span style="color:black">DOSCODE:92E9                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:92EA
DOSCODE:92EA </span><span style="color:gray">NOSETWRPERR</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:92EA                 </span><span style="color:navy">sub     ax, cx
</span><span style="color:black">DOSCODE:92EC                 </span><span style="color:navy">add     dx, ax
</span><span style="color:black">DOSCODE:92EE                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:92EF                 </span><span style="color:navy">mul     word ptr es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:92F3                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:92F4                 </span><span style="color:navy">add     bx, ax
</span><span style="color:black">DOSCODE:92F6                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:92F8                 </span><span style="color:navy">cmp     dx, es:[bp+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:92FC                 </span><span style="color:navy">jb      short </span><span style="color:gray">ERRINT
</span><span style="color:black">DOSCODE:92FE                 </span><span style="color:navy">inc     ah
</span><span style="color:black">DOSCODE:9300                 </span><span style="color:navy">cmp     dx, es:[bp+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9304                 </span><span style="color:navy">jnb     short </span><span style="color:gray">TESTDIR
</span><span style="color:black">DOSCODE:9306                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:930C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ERRINT
</span><span style="color:black">DOSCODE:930E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:930E
DOSCODE:930E </span><span style="color:gray">TESTDIR</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:930E                 </span><span style="color:navy">inc     ah
</span><span style="color:black">DOSCODE:9310                 </span><span style="color:navy">cmp     dx, es:[bp+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9314                 </span><span style="color:navy">jb      short </span><span style="color:gray">ERRINT
</span><span style="color:black">DOSCODE:9316                 </span><span style="color:navy">inc     ah
</span><span style="color:black">DOSCODE:9318
DOSCODE:9318 </span><span style="color:gray">ERRINT</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9318                 </span><span style="color:navy">shl     ah, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:931A                 </span><span style="color:navy">or      ah, ss:</span>READOP
<span style="color:black">DOSCODE:931F                 </span><span style="color:navy">or      ah, ss:</span>ALLOWED
<span style="color:black">DOSCODE:931F </span>HARDERR         endp
<span style="color:black">DOSCODE:931F
DOSCODE:9324
DOSCODE:9324 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9324
DOSCODE:9324
DOSCODE:9324 </span>FATAL           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9324                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9328
DOSCODE:9328 </span>FATAL1<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9328                 </span><span style="color:navy">mov     word ptr ss:</span>EXITHOLD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:932D                 </span><span style="color:navy">mov     word ptr ss:</span>EXITHOLD<span style="color:navy">, bp
</span><span style="color:black">DOSCODE:9332                 </span><span style="color:navy">les     si, es:[bp+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9336                 </span><span style="color:navy">mov     bp, es
</span><span style="color:black">DOSCODE:9336 </span>FATAL           endp
<span style="color:black">DOSCODE:9336
DOSCODE:9338
DOSCODE:9338 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9338
DOSCODE:9338
DOSCODE:9338 </span>FATALC          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9338
DOSCODE:9338 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:9433 SIZE 000000A0 BYTES
</span><span style="color:black">DOSCODE:9338 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A1EA SIZE 0000000D BYTES
</span><span style="color:black">DOSCODE:9338 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A1FF SIZE 00000022 BYTES
</span><span style="color:black">DOSCODE:9338
DOSCODE:9338                 </span><span style="color:navy">call    </span>SET_I24_EXTENDED_ERROR
<span style="color:black">DOSCODE:933B                 </span><span style="color:navy">cmp     di, </span><span style="color:#ff8000">0Ch
</span><span style="color:black">DOSCODE:933E                 </span><span style="color:navy">jbe     short </span>NET_I24_ENTRY
<span style="color:black">DOSCODE:9340                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Ch
</span><span style="color:black">DOSCODE:9343
DOSCODE:9343 </span>NET_I24_ENTRY<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9343                 </span><span style="color:navy">cmp     ss:</span>ERRORMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9349                 </span><span style="color:navy">jz      short </span><span style="color:gray">NoSetFail
</span><span style="color:black">DOSCODE:934B                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:934D                 </span><span style="color:navy">jmp     short </span><span style="color:gray">FailRet
</span><span style="color:black">DOSCODE:934F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:934F
DOSCODE:934F </span><span style="color:gray">NoSetFail</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:934F                 </span><span style="color:navy">mov     ss:</span>CONTSTK<span style="color:navy">, sp
</span><span style="color:black">DOSCODE:9354                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9355                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9356                 </span><span style="color:navy">cmp     ss:</span>SFN<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:935C                 </span><span style="color:navy">jz      short </span><span style="color:gray">_NoFree
</span><span style="color:black">DOSCODE:935E                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:935F                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:9360                 </span><span style="color:navy">lds     si, ss:</span>PJFN
<span style="color:black">DOSCODE:9365                 </span><span style="color:navy">mov     byte ptr [si], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9368                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:9369                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:936A
DOSCODE:936A </span><span style="color:gray">_NoFree</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:936A                 </span><span style="color:navy">cli
</span><span style="color:black">DOSCODE:936B                 </span><span style="color:navy">inc     ss:</span>ERRORMODE
<span style="color:black">DOSCODE:9370                 </span><span style="color:navy">dec     ss:</span>INDOS
<span style="color:black">DOSCODE:9375                 </span><span style="color:navy">test    ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:937B                 </span><span style="color:navy">jz      short </span><span style="color:gray">i24yes
</span><span style="color:black">DOSCODE:937D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:937F                 </span><span style="color:navy">jmp     short </span><span style="color:gray">passi24
</span><span style="color:black">DOSCODE:9381 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9381
DOSCODE:9381 </span><span style="color:gray">i24yes</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9381                 </span><span style="color:navy">mov     ss, ss:</span>USER_SS
<span style="color:black">DOSCODE:9386                 </span><span style="color:navy">mov     sp, es:</span>USER_SP
<span style="color:black">DOSCODE:938B                 </span><span style="color:navy">cmp     es:</span>DosHasHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9391                 </span><span style="color:navy">jnz     short </span><span style="color:gray">do_low_int24
</span><span style="color:black">DOSCODE:9393                 </span><span style="color:navy">int     </span><span style="color:green">24h             </span>; DOS - FATAL ERROR HANDLER ADDRESS
<span style="color:black">DOSCODE:9393                                         </span>; Automatically called upon detection of unrecoverable I/O error.
<span style="color:black">DOSCODE:9395                 </span><span style="color:navy">jmp     short </span><span style="color:gray">criterr_ret_addr
</span><span style="color:black">DOSCODE:9397 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9397
DOSCODE:9397 </span><span style="color:gray">do_low_int24</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9397                 </span><span style="color:navy">call    cs:</span>LowInt24Addr
<span style="color:black">DOSCODE:939C
DOSCODE:939C </span><span style="color:gray">criterr_ret_addr</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:939C                 </span><span style="color:navy">mov     es:</span>USER_SP<span style="color:navy">, sp
</span><span style="color:black">DOSCODE:93A1                 </span><span style="color:navy">mov     es:</span>USER_SS<span style="color:navy">, ss
</span><span style="color:black">DOSCODE:93A6                 </span><span style="color:navy">mov     bp, es
</span><span style="color:black">DOSCODE:93A8                 </span><span style="color:navy">mov     ss, bp
</span><span style="color:black">DOSCODE:93AA
DOSCODE:93AA </span><span style="color:gray">passi24</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:93AA                 </span><span style="color:navy">mov     sp, ss:</span>CONTSTK
<span style="color:black">DOSCODE:93AF                 </span><span style="color:navy">inc     ss:</span>INDOS
<span style="color:black">DOSCODE:93B4                 </span><span style="color:navy">mov     ss:</span>ERRORMODE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:93BA                 </span><span style="color:navy">sti
</span><span style="color:black">DOSCODE:93BB
DOSCODE:93BB </span><span style="color:gray">FailRet</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:93BB                 </span><span style="color:navy">les     bp, ss:</span>EXITHOLD
<span style="color:black">DOSCODE:93C0                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:93C2                 </span><span style="color:navy">jb      short </span><span style="color:gray">CheckIgnore
</span><span style="color:black">DOSCODE:93C4                 </span><span style="color:navy">jz      short </span><span style="color:gray">CheckRetry
</span><span style="color:black">DOSCODE:93C6                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:93C8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoAbort
</span><span style="color:black">DOSCODE:93CA                 </span><span style="color:navy">test    ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:93D0                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoAbort
</span><span style="color:black">DOSCODE:93D2
DOSCODE:93D2 </span><span style="color:gray">DoFail</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:93D2                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:93D4                 </span><span style="color:navy">test    ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:93DA                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CleanUp
</span><span style="color:black">DOSCODE:93DC                 </span><span style="color:navy">inc     ss:</span>FAILERR
<span style="color:black">DOSCODE:93E1
DOSCODE:93E1 </span><span style="color:gray">CleanUp</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:93E1                 </span><span style="color:navy">mov     ss:</span>WPERR<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:93E7                 </span><span style="color:navy">cmp     ss:</span>SFN<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:93ED                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CleanUp2
</span><span style="color:black">DOSCODE:93EF                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:93F0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:93F0
DOSCODE:93F0 </span><span style="color:gray">CleanUp2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:93F0                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:93F1                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:93F2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:93F3                 </span><span style="color:navy">mov     ax, ss:</span>SFN
<span style="color:black">DOSCODE:93F7                 </span><span style="color:navy">lds     si, ss:</span>PJFN
<span style="color:black">DOSCODE:93FC                 </span><span style="color:navy">mov     [si], al
</span><span style="color:black">DOSCODE:93FE                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:93FF                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:9400                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9401                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9402 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9402
DOSCODE:9402 </span><span style="color:gray">CheckIgnore</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9402                 </span><span style="color:navy">test    ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:9408                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoFail
</span><span style="color:black">DOSCODE:940A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">CleanUp
</span><span style="color:black">DOSCODE:940C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:940C
DOSCODE:940C </span><span style="color:gray">CheckRetry</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:940C                 </span><span style="color:navy">test    ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:9412                 </span><span style="color:navy">jz      short </span><span style="color:gray">DoFail
</span><span style="color:black">DOSCODE:9414                 </span><span style="color:navy">jmp     short </span><span style="color:gray">CleanUp
</span><span style="color:black">DOSCODE:9416 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9416
DOSCODE:9416 </span><span style="color:gray">DoAbort</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9416                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9417                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9418                 </span><span style="color:navy">cmp     </span>CONSWAP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:941D                 </span><span style="color:navy">jz      short </span><span style="color:gray">NOSWAP2
</span><span style="color:black">DOSCODE:941F                 </span><span style="color:navy">call    </span>SWAPBACK
<span style="color:black">DOSCODE:9422
DOSCODE:9422 </span><span style="color:gray">NOSWAP2</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9422                 </span><span style="color:navy">cmp     </span>fAborting<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9427                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoFail
</span><span style="color:black">DOSCODE:9429                 </span><span style="color:navy">mov     </span>EXIT_TYPE<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:942E                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:9430                 </span><span style="color:navy">jmp     </span>exit_inner
<span style="color:black">DOSCODE:9430 </span>FATALC          endp
<span style="color:black">DOSCODE:9430
DOSCODE:9433 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9433 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR FATALC
</span><span style="color:black">DOSCODE:9433
DOSCODE:9433 </span><span style="color:gray">reset_environment</span><span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9433                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9434                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">82h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:9436                 </span><span style="color:navy">int     </span><span style="color:green">2Ah             </span>; Microsoft Networks - END DOS CRITICAL SECTIONS 0 THROUGH 7
<span style="color:black">DOSCODE:9438                 </span><span style="color:navy">mov     ss:</span>fAborting<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:943E                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1122h
</span><span style="color:black">DOSCODE:9441                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - PROCESS TERMINATION HOOK
<span style="color:black">DOSCODE:9441                                         </span>; SS = DOS CS
<span style="color:black">DOSCODE:9443                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">22h </span><span style="color:gray">; &#039;&quot;&#039;
</span><span style="color:black">DOSCODE:9445                 </span><span style="color:navy">call    </span>$GET_INTERRUPT_VECTOR
<span style="color:black">DOSCODE:9448                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9449                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:944A                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:944B                 </span><span style="color:navy">mov     bx, ss:</span>CurrentPDB
<span style="color:black">DOSCODE:9450                 </span><span style="color:navy">mov     ds, bx
</span><span style="color:black">DOSCODE:9452                 </span><span style="color:navy">mov     ax, word ptr </span>OEM_HANDLER<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:9455                 </span><span style="color:navy">cmp     ax, bx
</span><span style="color:black">DOSCODE:9457                 </span><span style="color:navy">jz      short </span><span style="color:gray">reset_return
</span><span style="color:black">DOSCODE:9459                 </span><span style="color:navy">cmp     bx, cx
</span><span style="color:black">DOSCODE:945B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">reset_return
</span><span style="color:black">DOSCODE:945D                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:945E                 </span><span style="color:navy">cmp     ss:</span>EXIT_TYPE<span style="color:navy">, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:9464                 </span><span style="color:navy">jz      short </span><span style="color:gray">reset_to_parent
</span><span style="color:black">DOSCODE:9466                 </span><span style="color:navy">call    </span>arena_free_process
<span style="color:black">DOSCODE:9469                 </span><span style="color:navy">call    </span>DOS_ABORT
<span style="color:black">DOSCODE:946C
DOSCODE:946C </span><span style="color:gray">reset_to_parent</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:946C                 </span><span style="color:navy">pop     ss:</span>CurrentPDB
<span style="color:black">DOSCODE:9471
DOSCODE:9471 </span><span style="color:gray">reset_return</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9471                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9472                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9473                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9475                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:9478                 </span><span style="color:navy">call    </span>FLUSHBUF
<span style="color:black">DOSCODE:947B                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:947E                 </span><span style="color:navy">call    </span>CHECK_VIRT_OPEN
<span style="color:black">DOSCODE:9481                 </span><span style="color:navy">cli
</span><span style="color:black">DOSCODE:9482                 </span><span style="color:navy">mov     </span>INDOS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9487                 </span><span style="color:navy">mov     </span>WPERR<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:948C                 </span><span style="color:navy">mov     </span>fAborting<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9491                 </span><span style="color:navy">pop     word ptr </span>EXITHOLD
<span style="color:black">DOSCODE:9495                 </span><span style="color:navy">pop     word ptr </span>EXITHOLD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:9499                 </span><span style="color:navy">mov     ds, </span>CurrentPDB
<span style="color:black">DOSCODE:949D                 </span><span style="color:navy">mov     ss, word ptr </span>BCLOCK<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:94A1                 </span><span style="color:navy">mov     sp, word ptr </span>BCLOCK
<span style="color:black">DOSCODE:94A5                 </span><span style="color:navy">call    </span>restore_world
<span style="color:black">DOSCODE:94A8                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:94A9                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:94AA                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:94AC                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:94B1                 </span><span style="color:navy">mov     </span>TEMPSEG<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:94B4                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:94B5                 </span><span style="color:navy">mov     </span>USER_SP<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:94B8                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:94B9                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:94BA                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:94BB                 </span><span style="color:navy">lahf
</span><span style="color:black">DOSCODE:94BC                 </span><span style="color:navy">xchg    ah, al
</span><span style="color:black">DOSCODE:94BE                 </span><span style="color:navy">and     al, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:94C0                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0F2h </span><span style="color:gray">; &#039;_&#039;
</span><span style="color:black">DOSCODE:94C2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:94C3                 </span><span style="color:navy">push    word ptr </span>EXITHOLD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:94C7                 </span><span style="color:navy">push    word ptr </span>EXITHOLD
<span style="color:black">DOSCODE:94CB                 </span><span style="color:navy">mov     ax, </span>USER_SP
<span style="color:black">DOSCODE:94CE                 </span><span style="color:navy">mov     ds, </span>TEMPSEG
<span style="color:black">DOSCODE:94D2                 </span><span style="color:navy">iret
</span><span style="color:black">DOSCODE:94D2 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR FATALC
</span><span style="color:black">DOSCODE:94D3
DOSCODE:94D3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:94D3
DOSCODE:94D3
DOSCODE:94D3 </span>SET_I24_EXTENDED_ERROR proc near        <span style="color:green">; ...
</span><span style="color:black">DOSCODE:94D3                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:94D4                 </span><span style="color:navy">mov     ax, offset </span>FIRST_BUFF_ADDR
<span style="color:black">DOSCODE:94D7                 </span><span style="color:navy">sub     ax, offset </span>ErrMap24
<span style="color:black">DOSCODE:94DA                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:94DB                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:94E0                 </span><span style="color:navy">cmp     di, ax
</span><span style="color:black">DOSCODE:94E2                 </span><span style="color:navy">mov     ax, di
</span><span style="color:black">DOSCODE:94E4                 </span><span style="color:navy">jnb     short </span><span style="color:gray">NoTrans
</span><span style="color:black">DOSCODE:94E6                 </span><span style="color:navy">mov     al, </span>ErrMap24<span style="color:navy">[di]
</span><span style="color:black">DOSCODE:94EA                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:94EC
DOSCODE:94EC </span><span style="color:gray">NoTrans</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:94EC                 </span><span style="color:navy">mov     </span>EXTERR<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:94EF                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:94F0                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:94F1                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:94F2                 </span><span style="color:navy">mov     si, offset </span>ERR_TABLE_24
<span style="color:black">DOSCODE:94F5                 </span><span style="color:navy">call    </span>CAL_LK
<span style="color:black">DOSCODE:94F8                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:94F9                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:94F9 </span>SET_I24_EXTENDED_ERROR endp
<span style="color:black">DOSCODE:94F9
DOSCODE:94FA
DOSCODE:94FA </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:94FA
DOSCODE:94FA
DOSCODE:94FA </span>IsEOF           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:94FA                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], </span><span style="color:#ff8000">0FF6h
</span><span style="color:black">DOSCODE:9500                 </span><span style="color:navy">jnb     short </span><span style="color:gray">EOF16
</span><span style="color:black">DOSCODE:9502                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">0FF0h
</span><span style="color:black">DOSCODE:9506                 </span><span style="color:navy">jz      short </span><span style="color:gray">IsEOF_other
</span><span style="color:black">DOSCODE:9508                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">0FF8h
</span><span style="color:black">DOSCODE:950C
DOSCODE:950C </span><span style="color:gray">IsEOF_other</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:950C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:950D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:950D
DOSCODE:950D </span><span style="color:gray">EOF16</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:950D                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">0FFF8h
</span><span style="color:black">DOSCODE:9510                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9510 </span>IsEOF           endp
<span style="color:black">DOSCODE:9510
DOSCODE:9511
DOSCODE:9511 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9511
DOSCODE:9511
DOSCODE:9511 </span>UNPACK          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9511                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:9513                 </span><span style="color:navy">jnz     short </span><span style="color:gray">up_cont
</span><span style="color:black">DOSCODE:9515                 </span><span style="color:navy">mov     di, </span>CL0FATENTRY
<span style="color:black">DOSCODE:9519                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:951B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:951C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:951C
DOSCODE:951C </span><span style="color:gray">up_cont</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:951C                 </span><span style="color:navy">cmp     bx, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9520                 </span><span style="color:navy">ja      short </span><span style="color:gray">HURTFAT
</span><span style="color:black">DOSCODE:9522                 </span><span style="color:navy">call    </span>MAPCLUSTER
<span style="color:black">DOSCODE:9525                 </span><span style="color:navy">jb      short </span>_DoContext
<span style="color:black">DOSCODE:9527                 </span><span style="color:navy">mov     di, [di]
</span><span style="color:black">DOSCODE:9529                 </span><span style="color:navy">jnz     short </span><span style="color:gray">High12
</span><span style="color:black">DOSCODE:952B                 </span><span style="color:navy">mov     si, es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:952F                 </span><span style="color:navy">cmp     si, </span><span style="color:#ff8000">0FF6h
</span><span style="color:black">DOSCODE:9533                 </span><span style="color:navy">jb      short </span><span style="color:gray">Unpack12
</span><span style="color:black">DOSCODE:9535                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:9537                 </span><span style="color:navy">jmp     short </span>_DoContext
<span style="color:black">DOSCODE:9539 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9539
DOSCODE:9539 </span><span style="color:gray">High12</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9539                 </span><span style="color:navy">shr     di, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:953B                 </span><span style="color:navy">shr     di, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:953D                 </span><span style="color:navy">shr     di, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:953F                 </span><span style="color:navy">shr     di, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9541
DOSCODE:9541 </span><span style="color:gray">Unpack12</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9541                 </span><span style="color:navy">and     di, </span><span style="color:green">0FFFh
</span><span style="color:black">DOSCODE:9545
DOSCODE:9545 </span>_DoContext<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9545                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9546                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9547                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9548 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9548
DOSCODE:9548 </span><span style="color:gray">HURTFAT</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9548                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:954E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:954F                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">88h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:9551                 </span><span style="color:navy">mov     ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:9557                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0FFFh
</span><span style="color:black">DOSCODE:955A                 </span><span style="color:navy">call    </span>FATAL
<span style="color:black">DOSCODE:955D                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:955F                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:9560                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OKU_RET
</span><span style="color:black">DOSCODE:9562                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:9563
DOSCODE:9563 </span><span style="color:gray">OKU_RET</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9563                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9564
DOSCODE:9564 </span>hurtfat_retn<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9564                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9564 </span>UNPACK          endp
<span style="color:black">DOSCODE:9564
DOSCODE:9565
DOSCODE:9565 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9565
DOSCODE:9565
DOSCODE:9565 </span>PACK            proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9565                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:9567                 </span><span style="color:navy">jnz     short </span><span style="color:gray">p_cont
</span><span style="color:black">DOSCODE:9569                 </span><span style="color:navy">mov     </span>CL0FATENTRY<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:956D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:956E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:956E
DOSCODE:956E </span><span style="color:gray">p_cont</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:956E                 </span><span style="color:navy">call    </span>MAPCLUSTER
<span style="color:black">DOSCODE:9571                 </span><span style="color:navy">jb      short </span>_DoContext
<span style="color:black">DOSCODE:9573                 </span><span style="color:navy">mov     si, [di]
</span><span style="color:black">DOSCODE:9575                 </span><span style="color:navy">jz      short </span><span style="color:gray">ALIGNED
</span><span style="color:black">DOSCODE:9577                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9578                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:957A                 </span><span style="color:navy">shl     dx, cl
</span><span style="color:black">DOSCODE:957C                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:957D                 </span><span style="color:navy">and     si, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:9580                 </span><span style="color:navy">jmp     short </span><span style="color:gray">PACKIN
</span><span style="color:black">DOSCODE:9582 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9582
DOSCODE:9582 </span><span style="color:gray">ALIGNED</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9582                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], </span><span style="color:#ff8000">0FF6h
</span><span style="color:black">DOSCODE:9588                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Pack16
</span><span style="color:black">DOSCODE:958A                 </span><span style="color:navy">and     si, </span><span style="color:green">0F000h
</span><span style="color:black">DOSCODE:958E                 </span><span style="color:navy">and     dx, </span><span style="color:green">0FFFh
</span><span style="color:black">DOSCODE:9592                 </span><span style="color:navy">jmp     short </span><span style="color:gray">PACKIN
</span><span style="color:black">DOSCODE:9594 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9594
DOSCODE:9594 </span><span style="color:gray">Pack16</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9594                 </span><span style="color:navy">xor     si, si
</span><span style="color:black">DOSCODE:9596
DOSCODE:9596 </span><span style="color:gray">PACKIN</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9596                 </span><span style="color:navy">or      si, dx
</span><span style="color:black">DOSCODE:9598                 </span><span style="color:navy">mov     [di], si
</span><span style="color:black">DOSCODE:959A                 </span><span style="color:navy">lds     si, ss:</span>CURBUF
<span style="color:black">DOSCODE:959F                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:95A3                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty11
</span><span style="color:black">DOSCODE:95A5                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:95A8                 </span><span style="color:navy">or      byte ptr [si+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:95AC
DOSCODE:95AC </span><span style="color:gray">yesdirty11</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:95AC                 </span><span style="color:navy">cmp     ss:</span>CLUSSPLIT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:95B2                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:95B3                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:95B4                 </span><span style="color:navy">jz      short </span>hurtfat_retn
<span style="color:black">DOSCODE:95B6                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:95B7                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:95B8                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:95B9                 </span><span style="color:navy">mov     ax, </span>CLUSSAVE
<span style="color:black">DOSCODE:95BC                 </span><span style="color:navy">mov     ds, word ptr </span>CURBUF<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:95C0                 </span><span style="color:navy">add     si, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:95C3                 </span><span style="color:navy">mov     [si], ah
</span><span style="color:black">DOSCODE:95C5                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:95C6                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:95C7                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:95C8                 </span><span style="color:navy">mov     dx, </span>CLUSSEC<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:95CC                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:95D0                 </span><span style="color:navy">mov     dx, </span>CLUSSEC
<span style="color:black">DOSCODE:95D4                 </span><span style="color:navy">mov     si, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:95D7                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:95D9                 </span><span style="color:navy">call    </span>GETBUFFRB
<span style="color:black">DOSCODE:95DC                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:95DD                 </span><span style="color:navy">jb      short </span><span style="color:gray">POPP_RET
</span><span style="color:black">DOSCODE:95DF                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:95E3                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:95E7                 </span><span style="color:navy">jnz     short </span><span style="color:gray">yesdirty12
</span><span style="color:black">DOSCODE:95E9                 </span><span style="color:navy">call    </span>INC_DIRTY_COUNT
<span style="color:black">DOSCODE:95EC                 </span><span style="color:navy">or      byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:95F0
DOSCODE:95F0 </span><span style="color:gray">yesdirty12</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:95F0                 </span><span style="color:navy">add     di, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:95F3                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:95F4                 </span><span style="color:navy">add     di, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:95F8                 </span><span style="color:navy">mov     [di], al
</span><span style="color:black">DOSCODE:95FA                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:95FB
DOSCODE:95FB </span><span style="color:gray">POPP_RET</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:95FB                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:95FC                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:95FD                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:95FE                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:95FF                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9600                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9600 </span>PACK            endp
<span style="color:black">DOSCODE:9600
DOSCODE:9601
DOSCODE:9601 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9601
DOSCODE:9601
DOSCODE:9601 </span>MAPCLUSTER      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9601                 </span><span style="color:navy">mov     </span>CLUSSPLIT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9606                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9607                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9608                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9609                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:960A                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:960C                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], </span><span style="color:#ff8000">0FF6h
</span><span style="color:black">DOSCODE:9612                 </span><span style="color:navy">jnb     short </span><span style="color:gray">Map16
</span><span style="color:black">DOSCODE:9614                 </span><span style="color:navy">shr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9616
DOSCODE:9616 </span><span style="color:gray">Map16</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9616                 </span><span style="color:navy">xor     di, di
</span><span style="color:black">DOSCODE:9618                 </span><span style="color:navy">add     ax, bx
</span><span style="color:black">DOSCODE:961A                 </span><span style="color:navy">adc     di, di
</span><span style="color:black">DOSCODE:961C                 </span><span style="color:navy">mov     cx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9620                 </span><span style="color:navy">cmp     cx, </span><span style="color:green">512
</span><span style="color:black">DOSCODE:9624                 </span><span style="color:navy">jnz     short </span><span style="color:gray">_DoDiv
</span><span style="color:black">DOSCODE:9626                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:9628                 </span><span style="color:navy">and     dx, </span><span style="color:green">1FFh
</span><span style="color:black">DOSCODE:962C                 </span><span style="color:navy">mov     al, ah
</span><span style="color:black">DOSCODE:962E                 </span><span style="color:navy">shr     di, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9630                 </span><span style="color:navy">rcr     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9632                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:9634                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DivDone
</span><span style="color:black">DOSCODE:9636 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9636
DOSCODE:9636 </span><span style="color:gray">_DoDiv</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9636                 </span><span style="color:navy">mov     dx, di
</span><span style="color:black">DOSCODE:9638                 </span><span style="color:navy">div     cx
</span><span style="color:black">DOSCODE:963A
DOSCODE:963A </span><span style="color:gray">DivDone</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:963A                 </span><span style="color:navy">add     ax, es:[bp+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:963E                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:963F                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9640                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:9641                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9642                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:9644                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:964A                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:964C                 </span><span style="color:navy">mov     si, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:964F                 </span><span style="color:navy">call    </span>GETBUFFRB
<span style="color:black">DOSCODE:9652                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9653                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9654                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:9655                 </span><span style="color:navy">jb      short </span><span style="color:gray">MAP_POP
</span><span style="color:black">DOSCODE:9657                 </span><span style="color:navy">lds     si, </span>CURBUF
<span style="color:black">DOSCODE:965B                 </span><span style="color:navy">lea     di, [si+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:965E                 </span><span style="color:navy">add     di, ax
</span><span style="color:black">DOSCODE:9660                 </span><span style="color:navy">cmp     ax, cx
</span><span style="color:black">DOSCODE:9662                 </span><span style="color:navy">jnz     short </span><span style="color:gray">MAPRET
</span><span style="color:black">DOSCODE:9664                 </span><span style="color:navy">mov     al, [di]
</span><span style="color:black">DOSCODE:9666                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9667                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9668                 </span><span style="color:navy">inc     </span>CLUSSPLIT
<span style="color:black">DOSCODE:966C                 </span><span style="color:navy">mov     byte ptr </span>CLUSSAVE<span style="color:navy">, al
</span><span style="color:black">DOSCODE:966F                 </span><span style="color:navy">mov     </span>CLUSSEC<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:9673                 </span><span style="color:navy">mov     </span>CLUSSEC<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9679                 </span><span style="color:navy">inc     dx
</span><span style="color:black">DOSCODE:967A                 </span><span style="color:navy">mov     </span>HIGH_SECTOR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9680                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:9682                 </span><span style="color:navy">mov     si, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9685                 </span><span style="color:navy">call    </span>GETBUFFRB
<span style="color:black">DOSCODE:9688                 </span><span style="color:navy">jb      short </span><span style="color:gray">MAP_POP
</span><span style="color:black">DOSCODE:968A                 </span><span style="color:navy">lds     si, </span>CURBUF
<span style="color:black">DOSCODE:968E                 </span><span style="color:navy">lea     di, [si+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9691                 </span><span style="color:navy">mov     al, [di]
</span><span style="color:black">DOSCODE:9693                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9694                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9695                 </span><span style="color:navy">mov     byte ptr </span>CLUSSAVE<span style="color:navy">+</span><span style="color:green">1</span><span style="color:navy">, al
</span><span style="color:black">DOSCODE:9698                 </span><span style="color:navy">mov     di, offset </span>CLUSSAVE
<span style="color:black">DOSCODE:969B
DOSCODE:969B </span><span style="color:gray">MAPRET</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:969B                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:969C                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:969D                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:969E                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:96A0                 </span><span style="color:navy">cmp     word ptr es:[bp+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], </span><span style="color:#ff8000">0FF6h
</span><span style="color:black">DOSCODE:96A6                 </span><span style="color:navy">jnb     short </span><span style="color:gray">MapSet
</span><span style="color:black">DOSCODE:96A8                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:96AA
DOSCODE:96AA </span><span style="color:gray">MapSet</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:96AA                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:96AC                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:96AD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:96AE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:96AE
DOSCODE:96AE </span><span style="color:gray">MAP_POP</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:96AE                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:96AF                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:96B0                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:96B1                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:96B2                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:96B2 </span>MAPCLUSTER      endp
<span style="color:black">DOSCODE:96B2
DOSCODE:96B3
DOSCODE:96B3 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:96B3
DOSCODE:96B3
DOSCODE:96B3 </span>FATREAD_SFT     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:96B3                 </span><span style="color:navy">les     bp, es:[di+</span><span style="color:#ff8000">7</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:96B7                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:96BB                 </span><span style="color:navy">mov     </span>THISDRV<span style="color:navy">, al
</span><span style="color:black">DOSCODE:96BE                 </span><span style="color:navy">call    </span>GOTDPB
<span style="color:black">DOSCODE:96C1                 </span><span style="color:navy">call    </span>FAT_GOT_DPB
<span style="color:black">DOSCODE:96C4
DOSCODE:96C4 </span>fatread_sft_retn<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:96C4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:96C4 </span>FATREAD_SFT     endp
<span style="color:black">DOSCODE:96C4
DOSCODE:96C5
DOSCODE:96C5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:96C5
DOSCODE:96C5
DOSCODE:96C5 </span>FATREAD_CDS     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:96C5                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:96C6                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:96C7                 </span><span style="color:navy">les     bp, es:[di+</span><span style="color:#ff8000">45h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:96CB                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:96CF                 </span><span style="color:navy">mov     </span>THISDRV<span style="color:navy">, al
</span><span style="color:black">DOSCODE:96D2                 </span><span style="color:navy">call    </span>GOTDPB
<span style="color:black">DOSCODE:96D5                 </span><span style="color:navy">call    </span>FAT_GOT_DPB
<span style="color:black">DOSCODE:96D8                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:96D9                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:96DA                 </span><span style="color:navy">jb      short </span>fatread_sft_retn
<span style="color:black">DOSCODE:96DC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NO_CHANGE
</span><span style="color:black">DOSCODE:96DE                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:96E0                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:96E1                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:96E2                 </span><span style="color:navy">mov     cl, </span>CDSCOUNT
<span style="color:black">DOSCODE:96E6                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:96E8                 </span><span style="color:navy">lds     si, es:[di+</span><span style="color:#ff8000">45h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:96EC                 </span><span style="color:navy">les     di, ss:</span>CDSADDR
<span style="color:black">DOSCODE:96F1
DOSCODE:96F1 </span><span style="color:gray">frcd20</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:96F1                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:96F6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">frcd25
</span><span style="color:black">DOSCODE:96F8                 </span><span style="color:navy">cmp     si, es:[di+</span><span style="color:#ff8000">45h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:96FC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">frcd25
</span><span style="color:black">DOSCODE:96FE                 </span><span style="color:navy">mov     bx, ds
</span><span style="color:black">DOSCODE:9700                 </span><span style="color:navy">cmp     bx, es:[di+</span><span style="color:#ff8000">47h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9704                 </span><span style="color:navy">jnz     short </span><span style="color:gray">frcd25
</span><span style="color:black">DOSCODE:9706                 </span><span style="color:navy">test    es:[di+</span><span style="color:#ff8000">49h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:970A                 </span><span style="color:navy">jz      short </span><span style="color:gray">frcd25
</span><span style="color:black">DOSCODE:970C                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">49h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9710
DOSCODE:9710 </span><span style="color:gray">frcd25</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9710                 </span><span style="color:navy">add     di, </span><span style="color:green">88
</span><span style="color:black">DOSCODE:9713                 </span><span style="color:navy">loop    </span><span style="color:gray">frcd20
</span><span style="color:black">DOSCODE:9715                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9716
DOSCODE:9716 </span><span style="color:gray">NO_CHANGE</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9716                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:971A                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:971B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:971B </span>FATREAD_CDS     endp
<span style="color:black">DOSCODE:971B
DOSCODE:971C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:971C </span><span style="color:gray">; START OF FUNCTION CHUNK FOR FAT_GOT_DPB
</span><span style="color:black">DOSCODE:971C
DOSCODE:971C </span><span style="color:gray">FAT_operation</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:971C                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:9722                 </span><span style="color:navy">and     di, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:9726                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:972B                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">1Ah
</span><span style="color:black">DOSCODE:972D                 </span><span style="color:navy">mov     al, </span>THISDRV
<span style="color:black">DOSCODE:9730                 </span><span style="color:navy">call    </span>FATAL1
<span style="color:black">DOSCODE:9733                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:9737                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:9739                 </span><span style="color:navy">jnz     short </span>FAT_GOT_DPB
<span style="color:black">DOSCODE:973B                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:973C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:973C </span><span style="color:gray">; END OF FUNCTION CHUNK FOR FAT_GOT_DPB
</span><span style="color:black">DOSCODE:973D
DOSCODE:973D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:973D
DOSCODE:973D
DOSCODE:973D </span>FAT_GOT_DPB     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:973D
DOSCODE:973D </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:971C SIZE 00000021 BYTES
</span><span style="color:black">DOSCODE:973D
DOSCODE:973D                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:973E                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:973F                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Fh
</span><span style="color:black">DOSCODE:9741                 </span><span style="color:navy">mov     ah, es:[bp+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9745                 </span><span style="color:navy">mov     word ptr </span>DEVCALL<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9748                 </span><span style="color:navy">mov     </span>DEVCALL_REQFUNC<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:974D                 </span><span style="color:navy">mov     </span>DEVCALL_REQSTAT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9753                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9757                 </span><span style="color:navy">mov     </span>CALLUNIT<span style="color:navy">, al
</span><span style="color:black">DOSCODE:975A                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:975B                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:975C                 </span><span style="color:navy">mov     bx, offset </span>DEVCALL
<span style="color:black">DOSCODE:975F                 </span><span style="color:navy">lds     si, es:[bp+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9763                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9764                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:9767                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9768                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9769                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:976A                 </span><span style="color:navy">mov     di, </span>DEVCALL_REQSTAT
<span style="color:black">DOSCODE:976E                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:9770                 </span><span style="color:navy">js      short </span><span style="color:gray">FAT_operation
</span><span style="color:black">DOSCODE:9772                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:9774                 </span><span style="color:navy">xchg    ah, es:[bp+</span><span style="color:#ff8000">18h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9778                 </span><span style="color:navy">mov     al, </span>THISDRV
<span style="color:black">DOSCODE:977B                 </span><span style="color:navy">cmp     </span>VOLCHNG_FLAG<span style="color:navy">, al
</span><span style="color:black">DOSCODE:977F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CHECK_BYT
</span><span style="color:black">DOSCODE:9781                 </span><span style="color:navy">mov     </span>VOLCHNG_FLAG<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9786                 </span><span style="color:navy">jmp     </span><span style="color:gray">GOGETBPB
</span><span style="color:black">DOSCODE:9789 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9789
DOSCODE:9789 </span><span style="color:gray">CHECK_BYT</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9789                 </span><span style="color:navy">or      ah, byte ptr </span>CALLBR
<span style="color:black">DOSCODE:978D                 </span><span style="color:navy">jns     short </span><span style="color:gray">CHECK_ZR
</span><span style="color:black">DOSCODE:978F                 </span><span style="color:navy">jmp     short </span><span style="color:gray">NEWDSK
</span><span style="color:black">DOSCODE:9791 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9791
DOSCODE:9791 </span><span style="color:gray">CHECK_ZR</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9791                 </span><span style="color:navy">jz      short </span><span style="color:gray">CHKBUFFDIRT
</span><span style="color:black">DOSCODE:9793                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:9794                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9795 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9795
DOSCODE:9795 </span><span style="color:gray">DISK_CHNG_ERR</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9795                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9796                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:9797                 </span><span style="color:navy">les     bp, es:[bp+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:979B                 </span><span style="color:navy">test    byte ptr es:[bp+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:black">DOSCODE:97A0                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:97A1                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:97A2                 </span><span style="color:navy">jz      short </span><span style="color:gray">FAIL_OPJ2
</span><span style="color:black">DOSCODE:97A4                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:97A5                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:97A6                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:97A7                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:97A8                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:97AD                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:97AE                 </span><span style="color:navy">les     di, </span>CALLBR<span style="color:navy">+</span><span style="color:green">1
</span><span style="color:black">DOSCODE:97B2                 </span><span style="color:navy">mov     word ptr </span>EXTERRPT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:97B6                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:97B7                 </span><span style="color:navy">mov     word ptr </span>EXTERRPT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:97BB                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">0Fh
</span><span style="color:black">DOSCODE:97BE                 </span><span style="color:navy">mov     </span>READOP<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:97C3                 </span><span style="color:navy">call    </span>HARDERR
<span style="color:black">DOSCODE:97C6                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:97C7                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:97C8                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:97CA
DOSCODE:97CA </span><span style="color:gray">FAIL_OPJ2</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:97CA                 </span><span style="color:navy">jz      short </span><span style="color:gray">FAIL_OP
</span><span style="color:black">DOSCODE:97CC                 </span><span style="color:navy">jmp     </span>FAT_GOT_DPB
<span style="color:black">DOSCODE:97CF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:97CF
DOSCODE:97CF </span><span style="color:gray">CHKBUFFDIRT</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:97CF                 </span><span style="color:navy">cmp     ss:</span>DirtyBufferCount<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:97D5                 </span><span style="color:navy">jz      short </span><span style="color:gray">NEWDSK
</span><span style="color:black">DOSCODE:97D7                 </span><span style="color:navy">call    </span>GETCURHEAD
<span style="color:black">DOSCODE:97DA
DOSCODE:97DA </span><span style="color:gray">nbuffer</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:97DA                 </span><span style="color:navy">cmp     [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:97DD                 </span><span style="color:navy">jnz     short </span><span style="color:gray">lfnxt
</span><span style="color:black">DOSCODE:97DF                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:97E3                 </span><span style="color:navy">jz      short </span><span style="color:gray">lfnxt
</span><span style="color:black">DOSCODE:97E5                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:97E6                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:97E7                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:97E8                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:97E9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:97E9
DOSCODE:97E9 </span><span style="color:gray">FAIL_OP</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:97E9                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:97EA                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:97EB                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:97EC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:97ED </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:97ED
DOSCODE:97ED </span><span style="color:gray">lfnxt</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:97ED                 </span><span style="color:navy">mov     di, [di]
</span><span style="color:black">DOSCODE:97EF                 </span><span style="color:navy">cmp     ss:</span>FIRST_BUFF_ADDR<span style="color:navy">, di
</span><span style="color:black">DOSCODE:97F4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">nbuffer
</span><span style="color:black">DOSCODE:97F6
DOSCODE:97F6 </span><span style="color:gray">NEWDSK</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:97F6                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Fh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:97FC                 </span><span style="color:navy">call    </span>GETCURHEAD
<span style="color:black">DOSCODE:97FF
DOSCODE:97FF </span><span style="color:gray">nxbuffer</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:97FF                 </span><span style="color:navy">cmp     [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:9802                 </span><span style="color:navy">jnz     short </span><span style="color:gray">lfnxt2
</span><span style="color:black">DOSCODE:9804                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9808                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DISK_CHNG_ERR
</span><span style="color:black">DOSCODE:980A                 </span><span style="color:navy">mov     word ptr [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:#ff8000">20FFh
</span><span style="color:black">DOSCODE:980F                 </span><span style="color:navy">call    </span>SCANPLACE
<span style="color:black">DOSCODE:9812                 </span><span style="color:navy">jmp     short </span><span style="color:gray">skpbuff
</span><span style="color:black">DOSCODE:9814 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9814
DOSCODE:9814 </span><span style="color:gray">lfnxt2</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9814                 </span><span style="color:navy">mov     di, [di]
</span><span style="color:black">DOSCODE:9816
DOSCODE:9816 </span><span style="color:gray">skpbuff</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9816                 </span><span style="color:navy">cmp     di, ss:</span>FIRST_BUFF_ADDR
<span style="color:black">DOSCODE:981B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">nxbuffer
</span><span style="color:black">DOSCODE:981D                 </span><span style="color:navy">cmp     ss:</span>SC_CACHE_COUNT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9823                 </span><span style="color:navy">jz      short </span><span style="color:gray">GOGETBPB
</span><span style="color:black">DOSCODE:9825                 </span><span style="color:navy">cmp     al, ss:</span>CurSC_DRIVE
<span style="color:black">DOSCODE:982A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GOGETBPB
</span><span style="color:black">DOSCODE:982C                 </span><span style="color:navy">mov     ss:</span>CurSC_DRIVE<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9832
DOSCODE:9832 </span><span style="color:gray">GOGETBPB</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9832                 </span><span style="color:navy">lds     di, es:[bp+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9836                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:983A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GETFREEBUF
</span><span style="color:black">DOSCODE:983C                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:983D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:983E                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:9841                 </span><span style="color:navy">call    </span>UNPACK
<span style="color:black">DOSCODE:9844
DOSCODE:9844 </span><span style="color:gray">FAIL_OPJ</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9844                 </span><span style="color:navy">jb      short </span><span style="color:gray">FAIL_OP
</span><span style="color:black">DOSCODE:9846                 </span><span style="color:navy">lds     di, </span>CURBUF
<span style="color:black">DOSCODE:984A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GOTGETBUF
</span><span style="color:black">DOSCODE:984C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:984C
DOSCODE:984C </span><span style="color:gray">GETFREEBUF</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:984C                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:984D                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:984E                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:9850                 </span><span style="color:navy">mov     ss:</span>HIGH_SECTOR<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:9855                 </span><span style="color:navy">call    </span>GETCURHEAD
<span style="color:black">DOSCODE:9858                 </span><span style="color:navy">call    </span>BUFWRITE
<span style="color:black">DOSCODE:985B                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:985C                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:985D                 </span><span style="color:navy">jb      short </span><span style="color:gray">FAIL_OPJ
</span><span style="color:black">DOSCODE:985F
DOSCODE:985F </span><span style="color:gray">GOTGETBUF</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:985F                 </span><span style="color:navy">add     di, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:9862                 </span><span style="color:navy">mov     word ptr ss:</span>CALLBR<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:9867                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9868                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9869                 </span><span style="color:navy">mov     word ptr </span>CALLBR<span style="color:navy">, di
</span><span style="color:black">DOSCODE:986D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">16h
</span><span style="color:black">DOSCODE:986F                 </span><span style="color:navy">mov     ah, es:[bp+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9873                 </span><span style="color:navy">mov     word ptr </span>DEVCALL<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9876                 </span><span style="color:navy">mov     </span>DEVCALL_REQFUNC<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:987B                 </span><span style="color:navy">mov     </span>DEVCALL_REQSTAT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9881                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9885                 </span><span style="color:navy">mov     </span>CALLUNIT<span style="color:navy">, al
</span><span style="color:black">DOSCODE:9888                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9889                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:988A                 </span><span style="color:navy">push    word ptr es:[bp+</span><span style="color:#ff8000">15h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:988E                 </span><span style="color:navy">push    word ptr es:[bp+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9892                 </span><span style="color:navy">mov     bx, offset </span>DEVCALL
<span style="color:black">DOSCODE:9895                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:9896                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9897                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9898                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:989B                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:989C                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:989D                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:989E                 </span><span style="color:navy">mov     di, </span>DEVCALL_REQSTAT
<span style="color:black">DOSCODE:98A2                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:98A4                 </span><span style="color:navy">js      short </span><span style="color:gray">FATERRJ
</span><span style="color:black">DOSCODE:98A6                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:98AA                 </span><span style="color:navy">lds     si, </span>CALLBPB
<span style="color:black">DOSCODE:98AE                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Dh</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:98B4                 </span><span style="color:navy">call    </span>$SETDPB
<span style="color:black">DOSCODE:98B7                 </span><span style="color:navy">lds     di, ss:</span>CALLBR
<span style="color:black">DOSCODE:98BC                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:98C0                 </span><span style="color:navy">mov     [di-</span><span style="color:green">0Ah</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:98C3                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:98C7                 </span><span style="color:navy">mov     [di-</span><span style="color:green">9</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:98CA                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:98CB                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:98CC                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:98CE                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:98CF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:98CF
DOSCODE:98CF </span><span style="color:gray">FATERRJ</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:98CF                 </span><span style="color:navy">jmp     </span><span style="color:gray">FAT_operation
</span><span style="color:black">DOSCODE:98CF </span>FAT_GOT_DPB     endp
<span style="color:black">DOSCODE:98CF
DOSCODE:98D2
DOSCODE:98D2 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:98D2
DOSCODE:98D2
DOSCODE:98D2 </span>GETCURHEAD      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:98D2                 </span><span style="color:navy">lds     di, ss:</span>BufferQueue
<span style="color:black">DOSCODE:98D7                 </span><span style="color:navy">mov     word ptr ss:</span>LastBuffer<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:98DE                 </span><span style="color:navy">mov     ss:</span>FIRST_BUFF_ADDR<span style="color:navy">, di
</span><span style="color:black">DOSCODE:98E3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:98E3 </span>GETCURHEAD      endp
<span style="color:black">DOSCODE:98E3
DOSCODE:98E4
DOSCODE:98E4 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:98E4
DOSCODE:98E4
DOSCODE:98E4 </span>SCANPLACE       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:98E4                 </span><span style="color:navy">push    word ptr [di]
</span><span style="color:black">DOSCODE:98E6                 </span><span style="color:navy">call    </span>PLACEBUF
<span style="color:black">DOSCODE:98E9                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:98EA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:98EA </span>SCANPLACE       endp
<span style="color:black">DOSCODE:98EA
DOSCODE:98EB
DOSCODE:98EB </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:98EB
DOSCODE:98EB
DOSCODE:98EB </span>PLACEBUF        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:98EB                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:98EC                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:98ED                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:98EE                 </span><span style="color:navy">mov     ax, [di]
</span><span style="color:black">DOSCODE:98F0                 </span><span style="color:navy">mov     bx, word ptr ss:</span>BufferQueue
<span style="color:black">DOSCODE:98F5                 </span><span style="color:navy">cmp     ax, bx
</span><span style="color:black">DOSCODE:98F7                 </span><span style="color:navy">jz      short </span><span style="color:gray">nret
</span><span style="color:black">DOSCODE:98F9                 </span><span style="color:navy">cmp     di, bx
</span><span style="color:black">DOSCODE:98FB                 </span><span style="color:navy">jnz     short </span><span style="color:gray">not_first
</span><span style="color:black">DOSCODE:98FD                 </span><span style="color:navy">mov     word ptr ss:</span>BufferQueue<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9901                 </span><span style="color:navy">jmp     short </span><span style="color:gray">nret
</span><span style="color:black">DOSCODE:9903 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9903
DOSCODE:9903 </span><span style="color:gray">not_first</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9903                 </span><span style="color:navy">mov     si, [di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9906                 </span><span style="color:navy">mov     [si], ax
</span><span style="color:black">DOSCODE:9908                 </span><span style="color:navy">xchg    ax, si
</span><span style="color:black">DOSCODE:9909                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:990C                 </span><span style="color:navy">mov     si, [bx+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:990F                 </span><span style="color:navy">mov     [si], di
</span><span style="color:black">DOSCODE:9911                 </span><span style="color:navy">mov     [bx+</span><span style="color:#ff8000">2</span><span style="color:navy">], di
</span><span style="color:black">DOSCODE:9914                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">2</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:9917                 </span><span style="color:navy">mov     [di], bx
</span><span style="color:black">DOSCODE:9919
DOSCODE:9919 </span><span style="color:gray">nret</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9919                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:991A                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:991B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:991C                 </span><span style="color:navy">cmp     byte ptr [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9920                 </span><span style="color:navy">jnz     short </span><span style="color:gray">pbx
</span><span style="color:black">DOSCODE:9922                 </span><span style="color:navy">mov     word ptr ss:</span>BufferQueue<span style="color:navy">, di
</span><span style="color:black">DOSCODE:9927
DOSCODE:9927 </span><span style="color:gray">pbx</span><span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9927                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9927 </span>PLACEBUF        endp
<span style="color:black">DOSCODE:9927
</span><span style="color:maroon">DOSCODE:9928 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:9928
DOSCODE:9928 </span>POINTCOMP<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:9928                 </span><span style="color:navy">cmp     si, di
</span><span style="color:maroon">DOSCODE:992A                 </span><span style="color:navy">jnz     short </span>_ret_label
<span style="color:maroon">DOSCODE:992C                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:992D                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:992E                 </span><span style="color:navy">mov     cx, ds
</span><span style="color:maroon">DOSCODE:9930                 </span><span style="color:navy">mov     dx, es
</span><span style="color:maroon">DOSCODE:9932                 </span><span style="color:navy">cmp     cx, dx
</span><span style="color:maroon">DOSCODE:9934                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:9935                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:9936
DOSCODE:9936 </span>_ret_label<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:9936                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9937
DOSCODE:9937 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9937
DOSCODE:9937
DOSCODE:9937 </span>GETBUFFR        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9937                 </span><span style="color:navy">xor     si, si
</span><span style="color:black">DOSCODE:9937 </span>GETBUFFR        endp
<span style="color:black">DOSCODE:9937
DOSCODE:9939
DOSCODE:9939 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9939
DOSCODE:9939
DOSCODE:9939 </span>GETBUFFRB       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9939                 </span><span style="color:navy">mov     </span>PREREAD<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:993C                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9940                 </span><span style="color:navy">lds     di, </span>LastBuffer
<span style="color:black">DOSCODE:9944                 </span><span style="color:navy">mov     cx, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:9949                 </span><span style="color:navy">cmp     di, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:994C                 </span><span style="color:navy">jz      short </span><span style="color:gray">getb5
</span><span style="color:black">DOSCODE:994E                 </span><span style="color:navy">cmp     dx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9951                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb5
</span><span style="color:black">DOSCODE:9953                 </span><span style="color:navy">cmp     cx, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9956                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb5
</span><span style="color:black">DOSCODE:9958                 </span><span style="color:navy">cmp     al, [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:995B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb5
</span><span style="color:black">DOSCODE:995D                 </span><span style="color:navy">jmp     </span><span style="color:gray">getb35
</span><span style="color:black">DOSCODE:9960 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9960
DOSCODE:9960 </span><span style="color:gray">getb5</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9960                 </span><span style="color:navy">call    </span>GETCURHEAD
<span style="color:black">DOSCODE:9963
DOSCODE:9963 </span><span style="color:gray">getb10</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9963                 </span><span style="color:navy">cmp     dx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9966                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb12
</span><span style="color:black">DOSCODE:9968                 </span><span style="color:navy">cmp     cx, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:996B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb12
</span><span style="color:black">DOSCODE:996D                 </span><span style="color:navy">cmp     al, [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9970                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb12
</span><span style="color:black">DOSCODE:9972                 </span><span style="color:navy">jmp     </span><span style="color:gray">getb25
</span><span style="color:black">DOSCODE:9975 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9975
DOSCODE:9975 </span><span style="color:gray">getb12</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9975                 </span><span style="color:navy">mov     di, [di]
</span><span style="color:black">DOSCODE:9977                 </span><span style="color:navy">cmp     di, ss:</span>FIRST_BUFF_ADDR
<span style="color:black">DOSCODE:997C                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb10
</span><span style="color:black">DOSCODE:997E                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:997F                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:9980                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:9981                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:9982                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9983                 </span><span style="color:navy">call    </span>BUFWRITE
<span style="color:black">DOSCODE:9986                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9987                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:9988                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:9989                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:998A                 </span><span style="color:navy">pop     ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:998F                 </span><span style="color:navy">jnb     short </span><span style="color:gray">getb13
</span><span style="color:black">DOSCODE:9991                 </span><span style="color:navy">jmp     </span><span style="color:gray">getbx
</span><span style="color:black">DOSCODE:9994 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9994
DOSCODE:9994 </span><span style="color:gray">getb13</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9994                 </span><span style="color:navy">call    </span>SET_RQ_SC_PARMS
<span style="color:black">DOSCODE:9997                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:9999                 </span><span style="color:navy">cmp     byte ptr ss:</span>PREREAD<span style="color:navy">, ah
</span><span style="color:black">DOSCODE:999E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">getb20
</span><span style="color:black">DOSCODE:99A0                 </span><span style="color:navy">lea     bx, [di+</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:99A3                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:99A6                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:99A7                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:99A8                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:99A9                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:99AA                 </span><span style="color:navy">cmp     ss:</span>BuffInHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:99B0                 </span><span style="color:navy">jz      short </span><span style="color:gray">getb14
</span><span style="color:black">DOSCODE:99B2                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:99B3                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:99B4                 </span><span style="color:navy">lds     bx, ss:</span>LoMemBuff
<span style="color:black">DOSCODE:99B9
DOSCODE:99B9 </span><span style="color:gray">getb14</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:99B9                 </span><span style="color:navy">or      si, si
</span><span style="color:black">DOSCODE:99BB                 </span><span style="color:navy">jz      short </span><span style="color:gray">getb15
</span><span style="color:black">DOSCODE:99BD                 </span><span style="color:navy">call    </span>FATSECRD
<span style="color:black">DOSCODE:99C0                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:99C2                 </span><span style="color:navy">jmp     short </span><span style="color:gray">getb17
</span><span style="color:black">DOSCODE:99C4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:99C4
DOSCODE:99C4 </span><span style="color:gray">getb15</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:99C4                 </span><span style="color:navy">call    </span>DREAD
<span style="color:black">DOSCODE:99C7                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:99C9
DOSCODE:99C9 </span><span style="color:gray">getb17</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:99C9                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:99CA                 </span><span style="color:navy">cmp     ss:</span>BuffInHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:99D0                 </span><span style="color:navy">jz      short </span><span style="color:gray">not_in_hma
</span><span style="color:black">DOSCODE:99D2                 </span><span style="color:navy">mov     cx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:99D6                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:99D8                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:99D9                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:99DB                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:99DC                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:99DD                 </span><span style="color:navy">cld
</span><span style="color:black">DOSCODE:99DE                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:99DF                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:99E1                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:99E2                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:99E3
DOSCODE:99E3 </span><span style="color:gray">not_in_hma</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:99E3                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:99E4                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:99E5                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:99E6                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:99E7                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:99E8                 </span><span style="color:navy">jb      short </span><span style="color:gray">getbx
</span><span style="color:black">DOSCODE:99EA
DOSCODE:99EA </span><span style="color:gray">getb20</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:99EA                 </span><span style="color:navy">mov     cx, ss:</span>HIGH_SECTOR
<span style="color:black">DOSCODE:99EF                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">8</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:99F2                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:99F5                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], bp
</span><span style="color:black">DOSCODE:99F8                 </span><span style="color:navy">mov     word ptr [di+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">], es
</span><span style="color:black">DOSCODE:99FB                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:99FF                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9A02
DOSCODE:9A02 </span><span style="color:gray">getb25</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A02                 </span><span style="color:navy">mov     byte ptr [di+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9A06                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:9A08                 </span><span style="color:navy">or      si, si
</span><span style="color:black">DOSCODE:9A0A                 </span><span style="color:navy">jz      short </span><span style="color:gray">getb30
</span><span style="color:black">DOSCODE:9A0C                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9A10                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:9A13                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9A17
DOSCODE:9A17 </span><span style="color:gray">getb30</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A17                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9A1A                 </span><span style="color:navy">call    </span>PLACEBUF
<span style="color:black">DOSCODE:9A1D
DOSCODE:9A1D </span><span style="color:gray">getb35</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A1D                 </span><span style="color:navy">mov     word ptr ss:</span>CURBUF<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:9A22                 </span><span style="color:navy">mov     word ptr ss:</span>LastBuffer<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:9A27                 </span><span style="color:navy">mov     word ptr ss:</span>CURBUF<span style="color:navy">, di
</span><span style="color:black">DOSCODE:9A2C                 </span><span style="color:navy">mov     word ptr ss:</span>LastBuffer<span style="color:navy">, di
</span><span style="color:black">DOSCODE:9A31                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:9A32
DOSCODE:9A32 </span><span style="color:gray">getbx</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A32                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9A33                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9A34
DOSCODE:9A34 </span>getbuffrb_retn<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A34                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9A34 </span>GETBUFFRB       endp
<span style="color:black">DOSCODE:9A34
DOSCODE:9A35
DOSCODE:9A35 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9A35
DOSCODE:9A35
DOSCODE:9A35 </span>FLUSHBUF        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A35                 </span><span style="color:navy">call    </span>GETCURHEAD
<span style="color:black">DOSCODE:9A38                 </span><span style="color:navy">test    byte ptr ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:9A3E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">scan_buf_queue
</span><span style="color:black">DOSCODE:9A40                 </span><span style="color:navy">cmp     ss:</span>DirtyBufferCount<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9A46                 </span><span style="color:navy">jz      short </span><span style="color:gray">end_scan
</span><span style="color:black">DOSCODE:9A48
DOSCODE:9A48 </span><span style="color:gray">scan_buf_queue</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A48                 </span><span style="color:navy">call    </span>CHECKFLUSH
<span style="color:black">DOSCODE:9A4B                 </span><span style="color:navy">mov     ah, [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9A4E                 </span><span style="color:navy">cmp     ss:</span>WPERR<span style="color:navy">, ah
</span><span style="color:black">DOSCODE:9A53                 </span><span style="color:navy">jz      short </span><span style="color:gray">free_the_buf
</span><span style="color:black">DOSCODE:9A55                 </span><span style="color:navy">test    byte ptr ss:</span>DOS34_FLAG<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:9A5B                 </span><span style="color:navy">jz      short </span><span style="color:gray">dont_free_the_buf
</span><span style="color:black">DOSCODE:9A5D
DOSCODE:9A5D </span><span style="color:gray">free_the_buf</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A5D                 </span><span style="color:navy">mov     word ptr [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9A62
DOSCODE:9A62 </span><span style="color:gray">dont_free_the_buf</span><span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A62                 </span><span style="color:navy">mov     di, [di]
</span><span style="color:black">DOSCODE:9A64                 </span><span style="color:navy">cmp     di, ss:</span>FIRST_BUFF_ADDR
<span style="color:black">DOSCODE:9A69                 </span><span style="color:navy">jnz     short </span><span style="color:gray">scan_buf_queue
</span><span style="color:black">DOSCODE:9A6B
DOSCODE:9A6B </span><span style="color:gray">end_scan</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A6B                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9A6C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9A6D                 </span><span style="color:navy">cmp     </span>FAILERR<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9A72                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bad_flush
</span><span style="color:black">DOSCODE:9A74                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9A75 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9A75
DOSCODE:9A75 </span><span style="color:gray">bad_flush</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A75                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:9A76                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9A76 </span>FLUSHBUF        endp
<span style="color:black">DOSCODE:9A76
DOSCODE:9A77
DOSCODE:9A77 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9A77
DOSCODE:9A77
DOSCODE:9A77 </span>CHECKFLUSH      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A77                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9A79                 </span><span style="color:navy">cmp     [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], ah
</span><span style="color:black">DOSCODE:9A7C                 </span><span style="color:navy">jz      short </span>getbuffrb_retn
<span style="color:black">DOSCODE:9A7E                 </span><span style="color:navy">cmp     ah, al
</span><span style="color:black">DOSCODE:9A80                 </span><span style="color:navy">jz      short </span><span style="color:gray">DOBUFFER
</span><span style="color:black">DOSCODE:9A82                 </span><span style="color:navy">cmp     al, [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9A85                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:9A86                 </span><span style="color:navy">jnz     short </span>getbuffrb_retn
<span style="color:black">DOSCODE:9A88
DOSCODE:9A88 </span><span style="color:gray">DOBUFFER</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A88                 </span><span style="color:navy">test    byte ptr [di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9A8C                 </span><span style="color:navy">jz      short </span>getbuffrb_retn
<span style="color:black">DOSCODE:9A8E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9A8F                 </span><span style="color:navy">push    word ptr [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9A92                 </span><span style="color:navy">call    </span>BUFWRITE
<span style="color:black">DOSCODE:9A95                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9A96                 </span><span style="color:navy">jb      short </span><span style="color:gray">LEAVE_BUF
</span><span style="color:black">DOSCODE:9A98                 </span><span style="color:navy">and     ah, </span><span style="color:green">0BFh
</span><span style="color:black">DOSCODE:9A9B                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">4</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9A9E
DOSCODE:9A9E </span><span style="color:gray">LEAVE_BUF</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A9E                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9A9F
DOSCODE:9A9F </span>checkflush_retn<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9A9F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9A9F </span>CHECKFLUSH      endp
<span style="color:black">DOSCODE:9A9F
DOSCODE:9AA0
DOSCODE:9AA0 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9AA0
DOSCODE:9AA0
DOSCODE:9AA0 </span>BUFWRITE        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9AA0                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9AA3                 </span><span style="color:navy">xchg    ax, [di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9AA6                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9AA8                 </span><span style="color:navy">jz      short </span>checkflush_retn
<span style="color:black">DOSCODE:9AAA                 </span><span style="color:navy">test    ah, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9AAD                 </span><span style="color:navy">jz      short </span>checkflush_retn
<span style="color:black">DOSCODE:9AAF                 </span><span style="color:navy">call    </span>DEC_DIRTY_COUNT
<span style="color:black">DOSCODE:9AB2                 </span><span style="color:navy">cmp     al, ss:</span>WPERR
<span style="color:black">DOSCODE:9AB7                 </span><span style="color:navy">jz      short </span>checkflush_retn
<span style="color:black">DOSCODE:9AB9                 </span><span style="color:navy">mov     ss:</span>SC_DRIVE<span style="color:navy">, al
</span><span style="color:black">DOSCODE:9ABD                 </span><span style="color:navy">les     bp, [di+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9AC0                 </span><span style="color:navy">lea     bx, [di+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9AC3                 </span><span style="color:navy">mov     dx, [di+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9AC6                 </span><span style="color:navy">mov     cx, [di+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9AC9                 </span><span style="color:navy">mov     ss:</span>HIGH_SECTOR<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:9ACE                 </span><span style="color:navy">mov     cl, [di+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9AD1                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:black">DOSCODE:9AD3                 </span><span style="color:navy">mov     ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:9AD9                 </span><span style="color:navy">test    ah, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:9ADC                 </span><span style="color:navy">jz      short </span><span style="color:gray">NO_IGNORE
</span><span style="color:black">DOSCODE:9ADE                 </span><span style="color:navy">or      ss:</span>ALLOWED<span style="color:navy">, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:9AE4
DOSCODE:9AE4 </span><span style="color:gray">NO_IGNORE</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9AE4                 </span><span style="color:navy">mov     ax, [di+</span><span style="color:green">11</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9AE7                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:9AE8                 </span><span style="color:navy">xor     di, di
</span><span style="color:black">DOSCODE:9AEA                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9AEB                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9AEC
DOSCODE:9AEC </span><span style="color:gray">WRTAGAIN</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9AEC                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:9AED                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9AEE                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9AEF                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9AF2                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9AF3                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:9AF4                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9AF5                 </span><span style="color:navy">cmp     ss:</span>BuffInHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9AFB                 </span><span style="color:navy">jz      short </span><span style="color:gray">NBUFFINHMA
</span><span style="color:black">DOSCODE:9AFD                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9AFE                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9AFF                 </span><span style="color:navy">mov     si, bx
</span><span style="color:black">DOSCODE:9B01                 </span><span style="color:navy">mov     cx, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9B05                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9B07                 </span><span style="color:navy">les     di, ss:</span>LoMemBuff
<span style="color:black">DOSCODE:9B0C                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:9B0E                 </span><span style="color:navy">cld
</span><span style="color:black">DOSCODE:9B0F                 </span><span style="color:navy">rep movsw
</span><span style="color:black">DOSCODE:9B11                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9B12                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9B13                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9B14                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9B15
DOSCODE:9B15 </span><span style="color:gray">NBUFFINHMA</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B15                 </span><span style="color:navy">call    </span>DWRITE
<span style="color:black">DOSCODE:9B18                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9B19                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:9B1A                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:9B1B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9B1C                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9B1D                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:9B1E                 </span><span style="color:navy">jb      short </span><span style="color:gray">NOSET
</span><span style="color:black">DOSCODE:9B20                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:9B21
DOSCODE:9B21 </span><span style="color:gray">NOSET</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B21                 </span><span style="color:navy">add     dx, ax
</span><span style="color:black">DOSCODE:9B23                 </span><span style="color:navy">loop    </span><span style="color:gray">WRTAGAIN
</span><span style="color:black">DOSCODE:9B25                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:9B26                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9B27                 </span><span style="color:navy">or      di, di
</span><span style="color:black">DOSCODE:9B29                 </span><span style="color:navy">jnz     short </span><span style="color:gray">BWROK
</span><span style="color:black">DOSCODE:9B2B                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:9B2C
DOSCODE:9B2C </span><span style="color:gray">BWROK</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B2C                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:9B2D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9B2D </span>BUFWRITE        endp
<span style="color:black">DOSCODE:9B2D
DOSCODE:9B2E
DOSCODE:9B2E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9B2E
DOSCODE:9B2E
DOSCODE:9B2E </span>SET_RQ_SC_PARMS proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B2E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9B2F                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9B33                 </span><span style="color:navy">mov     ss:</span>SC_SECTOR_SIZE<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9B37                 </span><span style="color:navy">mov     al, es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9B3B                 </span><span style="color:navy">mov     ss:</span>SC_DRIVE<span style="color:navy">, al
</span><span style="color:black">DOSCODE:9B3F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9B40                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9B40 </span>SET_RQ_SC_PARMS endp
<span style="color:black">DOSCODE:9B40
DOSCODE:9B41
DOSCODE:9B41 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9B41
DOSCODE:9B41
DOSCODE:9B41 </span>INC_DIRTY_COUNT proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B41                 </span><span style="color:navy">inc     ss:</span>DirtyBufferCount
<span style="color:black">DOSCODE:9B46                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9B46 </span>INC_DIRTY_COUNT endp
<span style="color:black">DOSCODE:9B46
DOSCODE:9B47
DOSCODE:9B47 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9B47
DOSCODE:9B47
DOSCODE:9B47 </span>DEC_DIRTY_COUNT proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B47                 </span><span style="color:navy">cmp     ss:</span>DirtyBufferCount<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9B4D                 </span><span style="color:navy">jz      short </span><span style="color:gray">ddcx
</span><span style="color:black">DOSCODE:9B4F                 </span><span style="color:navy">dec     ss:</span>DirtyBufferCount
<span style="color:black">DOSCODE:9B54
DOSCODE:9B54 </span><span style="color:gray">ddcx</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B54                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:9B54 </span>DEC_DIRTY_COUNT endp
<span style="color:black">DOSCODE:9B54
</span><span style="color:maroon">DOSCODE:9B55 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:9B55
DOSCODE:9B55 </span>$WAIT<span style="color:navy">:                                  </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:9B55                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:9B57                 </span><span style="color:navy">xchg    ax, ss:</span>exit_code
<span style="color:maroon">DOSCODE:9B5C                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:9B5F
DOSCODE:9B5F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:9B5F
DOSCODE:9B5F
DOSCODE:9B5F </span>$EXEC           proc far                <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:9B5F                 </span><span style="color:navy">mov     ss:</span>A20OFF_COUNT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9B65                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:9B67                 </span><span style="color:navy">jnz     short </span>Exec_@f
<span style="color:black">DOSCODE:9B69                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9B6A                 </span><span style="color:navy">mov     cx, offset </span>LeaveDOS
<span style="color:black">DOSCODE:9B6D                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9B6E
DOSCODE:9B6E </span>Exec_@f<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B6E                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:9B6F                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:black">DOSCODE:9B71                 </span><span style="color:navy">sub     sp, </span><span style="color:green">29
</span><span style="color:black">DOSCODE:9B74                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:9B76                 </span><span style="color:navy">jbe     short </span>Exec_Check_2
<span style="color:black">DOSCODE:9B78
DOSCODE:9B78 </span>Exec_Bad_Fun<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B78                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9B7E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9B80
DOSCODE:9B80 </span>Exec_Ret_Err<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B80                 </span><span style="color:navy">mov     sp, bp
</span><span style="color:black">DOSCODE:9B82                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:9B83                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:9B86 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9B86
DOSCODE:9B86 </span>ExecReadyJ<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B86                 </span><span style="color:navy">call    </span>ExecReady
<span style="color:black">DOSCODE:9B89                 </span><span style="color:navy">jmp     </span>norm_ovl
<span style="color:black">DOSCODE:9B8C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9B8C
DOSCODE:9B8C </span>Exec_Check_2<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9B8C                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:9B8E                 </span><span style="color:navy">jz      short </span>Exec_Bad_Fun
<span style="color:black">DOSCODE:9B90                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:9B92                 </span><span style="color:navy">jz      short </span>Exec_Bad_Fun
<span style="color:black">DOSCODE:9B94                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:9B96                 </span><span style="color:navy">jz      short </span>ExecReadyJ
<span style="color:black">DOSCODE:9B98                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">4</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:9B9B                 </span><span style="color:navy">mov     word ptr [bp-</span><span style="color:green">2</span><span style="color:navy">], es
</span><span style="color:black">DOSCODE:9B9E                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">5</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:9BA1                 </span><span style="color:navy">mov     byte ptr [bp-</span><span style="color:green">6</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9BA5                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">26</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:9BA8                 </span><span style="color:navy">mov     word ptr [bp-</span><span style="color:green">24</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:9BAB                 </span><span style="color:navy">mov     si, dx
</span><span style="color:black">DOSCODE:9BAD                 </span><span style="color:navy">call    </span>DStrLen
<span style="color:black">DOSCODE:9BB0                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">22</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:9BB3                 </span><span style="color:navy">mov     al, ss:</span>AllocMethod
<span style="color:black">DOSCODE:9BB7                 </span><span style="color:navy">mov     ss:</span>ALLOCMSAVE<span style="color:navy">, al
</span><span style="color:black">DOSCODE:9BBB                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:9BBD                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:9BBE                 </span><span style="color:navy">or      ss:</span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:9BC4                 </span><span style="color:navy">call    </span>$OPEN
<span style="color:black">DOSCODE:9BC7                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:9BC8                 </span><span style="color:navy">and     ss:</span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">0FEh
</span><span style="color:black">DOSCODE:9BCE                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:9BCF                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:9BD0                 </span><span style="color:navy">jb      short </span>Exec_Ret_Err
<span style="color:black">DOSCODE:9BD2                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">8</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9BD5                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:black">DOSCODE:9BD7                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:9BD9                 </span><span style="color:navy">call    </span>$IOCTL
<span style="color:black">DOSCODE:9BDC                 </span><span style="color:navy">jb      short </span>Exec_BombJ
<span style="color:black">DOSCODE:9BDE                 </span><span style="color:navy">test    dl, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:9BE1                 </span><span style="color:navy">jz      short </span>Exec_Check_Environ
<span style="color:black">DOSCODE:9BE3                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:9BE5
DOSCODE:9BE5 </span>Exec_BombJ<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9BE5                 </span><span style="color:navy">jmp     </span>Exec_Bomb
<span style="color:black">DOSCODE:9BE8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9BE8
DOSCODE:9BE8 </span>BadEnv<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9BE8                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Ah
</span><span style="color:black">DOSCODE:9BEA                 </span><span style="color:navy">jmp     </span>Exec_Bomb
<span style="color:black">DOSCODE:9BED </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9BED
DOSCODE:9BED </span>Exec_Check_Environ<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9BED                 </span><span style="color:navy">mov     word ptr [bp-</span><span style="color:green">18</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9BF2                 </span><span style="color:navy">mov     word ptr [bp-</span><span style="color:green">14</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9BF7                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">5</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:9BFB                 </span><span style="color:navy">jnz     short </span>Exec_Read_Header
<span style="color:black">DOSCODE:9BFD                 </span><span style="color:navy">lds     si, [bp-</span><span style="color:green">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9C00                 </span><span style="color:navy">mov     ax, [si]
</span><span style="color:black">DOSCODE:9C02                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:9C04                 </span><span style="color:navy">jnz     short </span>Exec_Scan_Env
<span style="color:black">DOSCODE:9C06                 </span><span style="color:navy">mov     ds, ss:</span>CurrentPDB
<span style="color:black">DOSCODE:9C0B                 </span><span style="color:navy">mov     ax, word ptr </span>SFT_ADDR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:9C0E                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:9C10                 </span><span style="color:navy">jz      short </span>Exec_Read_Header
<span style="color:black">DOSCODE:9C12
DOSCODE:9C12 </span>Exec_Scan_Env<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9C12                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:9C14                 </span><span style="color:navy">xor     di, di
</span><span style="color:black">DOSCODE:9C16                 </span><span style="color:navy">mov     cx, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:9C19                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:9C1B
DOSCODE:9C1B </span>Exec_Get_Environ_Len<span style="color:navy">:                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9C1B                 </span><span style="color:navy">repne scasb
</span><span style="color:black">DOSCODE:9C1D                 </span><span style="color:navy">jnz     short </span>BadEnv
<span style="color:black">DOSCODE:9C1F                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:9C20                 </span><span style="color:navy">js      short </span>BadEnv
<span style="color:black">DOSCODE:9C22                 </span><span style="color:navy">scasb
</span><span style="color:black">DOSCODE:9C23                 </span><span style="color:navy">jnz     short </span>Exec_Get_Environ_Len
<span style="color:black">DOSCODE:9C25                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:9C26                 </span><span style="color:navy">lea     bx, [di+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9C29                 </span><span style="color:navy">add     bx, [bp-</span><span style="color:green">22</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9C2C                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:9C2E                 </span><span style="color:navy">shr     bx, cl
</span><span style="color:black">DOSCODE:9C30                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9C31                 </span><span style="color:navy">call    </span>$ALLOC
<span style="color:black">DOSCODE:9C34                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9C35                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9C36                 </span><span style="color:navy">jnb     short </span>Exec_Save_Environ
<span style="color:black">DOSCODE:9C38                 </span><span style="color:navy">jmp     short </span>Exec_No_Mem
<span style="color:black">DOSCODE:9C3A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9C3A
DOSCODE:9C3A </span>Exec_Save_Environ<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9C3A                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:9C3C                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">14</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9C3F                 </span><span style="color:navy">xor     si, si
</span><span style="color:black">DOSCODE:9C41                 </span><span style="color:navy">mov     di, si
</span><span style="color:black">DOSCODE:9C43                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:9C45                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9C48                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:9C49                 </span><span style="color:navy">lds     si, [bp-</span><span style="color:green">26</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9C4C                 </span><span style="color:navy">mov     cx, [bp-</span><span style="color:green">22</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9C4F                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:9C51
DOSCODE:9C51 </span>Exec_Read_Header<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9C51                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:9C52                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9C53                 </span><span style="color:navy">mov     cx, </span><span style="color:green">26
</span><span style="color:black">DOSCODE:9C56                 </span><span style="color:navy">mov     dx, offset </span>exec_signature
<span style="color:black">DOSCODE:9C59                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9C5A                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9C5B                 </span><span style="color:navy">call    </span>ExecRead
<span style="color:black">DOSCODE:9C5E                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9C5F                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9C60                 </span><span style="color:navy">jb      short </span>Exec_Bad_File
<span style="color:black">DOSCODE:9C62                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:9C64                 </span><span style="color:navy">jz      short </span>Exec_Bad_File
<span style="color:black">DOSCODE:9C66                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">26
</span><span style="color:black">DOSCODE:9C69                 </span><span style="color:navy">jnz     short </span>Exec_Com_Filej
<span style="color:black">DOSCODE:9C6B                 </span><span style="color:navy">test    </span>exec_max_BSS<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:9C71                 </span><span style="color:navy">jnz     short </span>Exec_Check_Sig
<span style="color:black">DOSCODE:9C73                 </span><span style="color:navy">mov     byte ptr [bp-</span><span style="color:green">6</span><span style="color:navy">], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:9C77
DOSCODE:9C77 </span>Exec_Check_Sig<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9C77                 </span><span style="color:navy">mov     ax, </span>exec_signature
<span style="color:black">DOSCODE:9C7A                 </span><span style="color:navy">cmp     ax, &#039;</span><span style="color:green">ZM&#039;
</span><span style="color:black">DOSCODE:9C7D                 </span><span style="color:navy">jz      short </span>Exec_Save_Start
<span style="color:black">DOSCODE:9C7F                 </span><span style="color:navy">cmp     ax, &#039;</span><span style="color:green">MZ&#039;
</span><span style="color:black">DOSCODE:9C82                 </span><span style="color:navy">jz      short </span>Exec_Save_Start
<span style="color:black">DOSCODE:9C84
DOSCODE:9C84 </span>Exec_Com_Filej<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9C84                 </span><span style="color:navy">jmp     </span>Exec_Com_File
<span style="color:black">DOSCODE:9C87 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9C87
DOSCODE:9C87 </span>Exec_Save_Start<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9C87                 </span><span style="color:navy">mov     ax, </span>exec_pages
<span style="color:black">DOSCODE:9C8A                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">5
</span><span style="color:black">DOSCODE:9C8C                 </span><span style="color:navy">shl     ax, cl
</span><span style="color:black">DOSCODE:9C8E                 </span><span style="color:navy">sub     ax, </span>exec_par_dir
<span style="color:black">DOSCODE:9C92                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">12</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9C95                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">5</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:9C99                 </span><span style="color:navy">jz      short </span>Exec_Allocate
<span style="color:black">DOSCODE:9C9B                 </span><span style="color:navy">les     di, [bp-</span><span style="color:green">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9C9E                 </span><span style="color:navy">mov     ax, es:[di]
</span><span style="color:black">DOSCODE:9CA1                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">20</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9CA4                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9CA8                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">10</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9CAB                 </span><span style="color:navy">jmp     </span>Exec_Find_Res
<span style="color:black">DOSCODE:9CAE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9CAE
DOSCODE:9CAE </span>Exec_No_Mem<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9CAE                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:9CB0                 </span><span style="color:navy">jmp     short </span>Exec_Bomb
<span style="color:black">DOSCODE:9CB2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9CB2
DOSCODE:9CB2 </span>Exec_Bad_File<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9CB2                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Bh
</span><span style="color:black">DOSCODE:9CB4
DOSCODE:9CB4 </span>Exec_Bomb<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9CB4                 </span><span style="color:navy">mov     bx, [bp-</span><span style="color:green">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9CB7                 </span><span style="color:navy">call    </span>Exec_Dealloc
<span style="color:black">DOSCODE:9CBA                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:9CBD                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9CBE                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:9CBF                 </span><span style="color:navy">call    </span>$CLOSE
<span style="color:black">DOSCODE:9CC2                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:9CC3                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9CC4                 </span><span style="color:navy">jmp     </span>Exec_Ret_Err
<span style="color:black">DOSCODE:9CC7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9CC7
DOSCODE:9CC7 </span>Exec_Chk_Mem<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9CC7                 </span><span style="color:navy">mov     al, ss:</span>AllocMethod
<span style="color:black">DOSCODE:9CCB                 </span><span style="color:navy">mov     bl, ss:</span>ALLOCMSAVE
<span style="color:black">DOSCODE:9CD0                 </span><span style="color:navy">mov     ss:</span>AllocMethod<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:9CD5                 </span><span style="color:navy">test    bl, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9CD8                 </span><span style="color:navy">jnz     short </span>Exec_No_Mem
<span style="color:black">DOSCODE:9CDA                 </span><span style="color:navy">test    al, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9CDC                 </span><span style="color:navy">jz      short </span>Exec_No_Mem
<span style="color:black">DOSCODE:9CDE                 </span><span style="color:navy">mov     ax, ss:</span>SAVE_AX
<span style="color:black">DOSCODE:9CE2                 </span><span style="color:navy">jmp     short </span>Exec_Norm_Alloc
<span style="color:black">DOSCODE:9CE4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9CE4
DOSCODE:9CE4 </span>Exec_Allocate<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9CE4                 </span><span style="color:navy">mov     byte ptr [bp-</span><span style="color:green">29</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9CE8                 </span><span style="color:navy">cmp     </span>exec_SS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9CED                 </span><span style="color:navy">jnz     short </span>ea1
<span style="color:black">DOSCODE:9CEF                 </span><span style="color:navy">cmp     </span>exec_SP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9CF4                 </span><span style="color:navy">jnz     short </span>ea1
<span style="color:black">DOSCODE:9CF6                 </span><span style="color:navy">inc     byte ptr [bp-</span><span style="color:green">29</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9CF9                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">0FF0h
</span><span style="color:black">DOSCODE:9CFC                 </span><span style="color:navy">jnb     short </span>ea1
<span style="color:black">DOSCODE:9CFE                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:9D01
DOSCODE:9D01 </span>ea1<span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D01                 </span><span style="color:navy">test    </span>AllocMethod<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:9D06                 </span><span style="color:navy">jz      short </span>Exec_Norm_Alloc
<span style="color:black">DOSCODE:9D08                 </span><span style="color:navy">or      </span>AllocMethod<span style="color:navy">, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9D0D
DOSCODE:9D0D </span>Exec_Norm_Alloc<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D0D                 </span><span style="color:navy">mov     </span>SAVE_AX<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9D10                 </span><span style="color:navy">mov     bx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:9D13                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9D14                 </span><span style="color:navy">call    </span>$ALLOC
<span style="color:black">DOSCODE:9D17                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9D18                 </span><span style="color:navy">mov     ax, </span>SAVE_AX
<span style="color:black">DOSCODE:9D1B                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:9D1E                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">11h
</span><span style="color:black">DOSCODE:9D21                 </span><span style="color:navy">jb      short </span>Exec_Chk_Mem
<span style="color:black">DOSCODE:9D23                 </span><span style="color:navy">cmp     ax, bx
</span><span style="color:black">DOSCODE:9D25                 </span><span style="color:navy">ja      short </span>Exec_Chk_Mem
<span style="color:black">DOSCODE:9D27                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">6</span><span style="color:navy">], </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:9D2B                 </span><span style="color:navy">jnz     short </span>Exec_BX_Max
<span style="color:black">DOSCODE:9D2D                 </span><span style="color:navy">add     ax, </span>exec_min_BSS
<span style="color:black">DOSCODE:9D31                 </span><span style="color:navy">jb      short </span>Exec_Chk_Mem
<span style="color:black">DOSCODE:9D33                 </span><span style="color:navy">cmp     ax, bx
</span><span style="color:black">DOSCODE:9D35                 </span><span style="color:navy">ja      short </span>Exec_Chk_Mem
<span style="color:black">DOSCODE:9D37                 </span><span style="color:navy">sub     ax, </span>exec_min_BSS
<span style="color:black">DOSCODE:9D3B                 </span><span style="color:navy">add     ax, </span>exec_max_BSS
<span style="color:black">DOSCODE:9D3F                 </span><span style="color:navy">jb      short </span>Exec_BX_Max
<span style="color:black">DOSCODE:9D41                 </span><span style="color:navy">cmp     ax, bx
</span><span style="color:black">DOSCODE:9D43                 </span><span style="color:navy">jbe     short </span>Exec_Got_Block
<span style="color:black">DOSCODE:9D45
DOSCODE:9D45 </span>Exec_BX_Max<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D45                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:9D47
DOSCODE:9D47 </span>Exec_Got_Block<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D47                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9D48                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:black">DOSCODE:9D4A                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">16</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:9D4D                 </span><span style="color:navy">call    </span>$ALLOC
<span style="color:black">DOSCODE:9D50                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9D51                 </span><span style="color:navy">jnb     short </span>eat0
<span style="color:black">DOSCODE:9D53                 </span><span style="color:navy">jmp     </span>Exec_Chk_Mem
<span style="color:black">DOSCODE:9D56 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9D56
DOSCODE:9D56 </span>eat0<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D56                 </span><span style="color:navy">mov     cl, </span>ALLOCMSAVE
<span style="color:black">DOSCODE:9D5A                 </span><span style="color:navy">mov     </span>AllocMethod<span style="color:navy">, cl
</span><span style="color:black">DOSCODE:9D5E                 </span><span style="color:navy">cmp     byte ptr [bp-</span><span style="color:green">29</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9D62                 </span><span style="color:navy">jz      short </span>ea2
<span style="color:black">DOSCODE:9D64                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">1000h
</span><span style="color:black">DOSCODE:9D68                 </span><span style="color:navy">jnb     short </span>ea2
<span style="color:black">DOSCODE:9D6A                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:9D6C                 </span><span style="color:navy">shl     bx, cl
</span><span style="color:black">DOSCODE:9D6E                 </span><span style="color:navy">sub     bx, </span><span style="color:#ff8000">100h
</span><span style="color:black">DOSCODE:9D72                 </span><span style="color:navy">mov     </span>exec_SP<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:9D76
DOSCODE:9D76 </span>ea2<span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D76                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">18</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9D79                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:9D7C                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">6</span><span style="color:navy">], </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:9D80                 </span><span style="color:navy">jz      short </span>Exec_Use_AX
<span style="color:black">DOSCODE:9D82                 </span><span style="color:navy">add     ax, [bp-</span><span style="color:green">16</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9D85                 </span><span style="color:navy">sub     ax, [bp-</span><span style="color:green">12</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9D88                 </span><span style="color:navy">sub     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:9D8B
DOSCODE:9D8B </span>Exec_Use_AX<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D8B                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">10</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9D8E                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">20</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9D91
DOSCODE:9D91 </span>Exec_Find_Res<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9D91                 </span><span style="color:navy">mov     dx, [bp-</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9D94                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">28</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:9D97                 </span><span style="color:navy">mov     dx, </span>exec_par_dir
<span style="color:black">DOSCODE:9D9B                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:9D9C                 </span><span style="color:navy">mov     cl, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:9D9E                 </span><span style="color:navy">shl     dx, cl
</span><span style="color:black">DOSCODE:9DA0                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9DA1                 </span><span style="color:navy">mov     cl, </span><span style="color:green">12
</span><span style="color:black">DOSCODE:9DA3                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:black">DOSCODE:9DA5                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:black">DOSCODE:9DA7                 </span><span style="color:navy">mov     bx, [bp-</span><span style="color:green">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9DAA                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9DAB                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:9DAD                 </span><span style="color:navy">call    </span>$LSEEK
<span style="color:black">DOSCODE:9DB0                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9DB1                 </span><span style="color:navy">jnb     short </span>Exec_Big_Read
<span style="color:black">DOSCODE:9DB3                 </span><span style="color:navy">jmp     </span>Exec_Bomb
<span style="color:black">DOSCODE:9DB6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9DB6
DOSCODE:9DB6 </span>Exec_Big_Read<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9DB6                 </span><span style="color:navy">mov     bx, [bp-</span><span style="color:green">12</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9DB9                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">1000h
</span><span style="color:black">DOSCODE:9DBD                 </span><span style="color:navy">jb      short </span>Exec_Read_OK
<span style="color:black">DOSCODE:9DBF                 </span><span style="color:navy">mov     bx, </span><span style="color:#ff8000">0FE0h
</span><span style="color:black">DOSCODE:9DC2
DOSCODE:9DC2 </span>Exec_Read_OK<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9DC2                 </span><span style="color:navy">sub     [bp-</span><span style="color:green">12</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:9DC5                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9DC6                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:9DC8                 </span><span style="color:navy">shl     bx, cl
</span><span style="color:black">DOSCODE:9DCA                 </span><span style="color:navy">mov     cx, bx
</span><span style="color:black">DOSCODE:9DCC                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9DCD                 </span><span style="color:navy">mov     ds, word ptr [bp-</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9DD0                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:9DD2                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9DD3                 </span><span style="color:navy">call    </span>ExecRead
<span style="color:black">DOSCODE:9DD6                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9DD7                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9DD8                 </span><span style="color:navy">jb      short </span>Exec_Bad_FileJ
<span style="color:black">DOSCODE:9DDA                 </span><span style="color:navy">cmp     cx, ax
</span><span style="color:black">DOSCODE:9DDC                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:9DDD                 </span><span style="color:navy">jz      short </span>ExecCheckEnd
<span style="color:black">DOSCODE:9DDF                 </span><span style="color:navy">sub     cx, ax
</span><span style="color:black">DOSCODE:9DE1                 </span><span style="color:navy">cmp     cx, </span><span style="color:green">512
</span><span style="color:black">DOSCODE:9DE5                 </span><span style="color:navy">jnb     short </span>Exec_Bad_FileJ
<span style="color:black">DOSCODE:9DE7
DOSCODE:9DE7 </span>ExecCheckEnd<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9DE7                 </span><span style="color:navy">add     [bp-</span><span style="color:green">20</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:9DEA                 </span><span style="color:navy">test    word ptr [bp-</span><span style="color:green">12</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:9DEF                 </span><span style="color:navy">jnz     short </span>Exec_Big_Read
<span style="color:black">DOSCODE:9DF1                 </span><span style="color:navy">mov     cx, [bp-</span><span style="color:green">10</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9DF4                 </span><span style="color:navy">mov     ax, </span>exec_SS
<span style="color:black">DOSCODE:9DF7                 </span><span style="color:navy">add     ax, cx
</span><span style="color:black">DOSCODE:9DF9                 </span><span style="color:navy">mov     </span>exec_init_SS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9DFC                 </span><span style="color:navy">mov     ax, </span>exec_SP
<span style="color:black">DOSCODE:9DFF                 </span><span style="color:navy">mov     </span>exec_init_SP<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9E02                 </span><span style="color:navy">les     ax, dword ptr </span>exec_IP
<span style="color:black">DOSCODE:9E06                 </span><span style="color:navy">mov     </span>exec_init_IP<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9E09                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:9E0B                 </span><span style="color:navy">add     ax, cx
</span><span style="color:black">DOSCODE:9E0D                 </span><span style="color:navy">mov     </span>exec_init_CS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9E10                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:9E12                 </span><span style="color:navy">mov     dx, </span>exec_rle_table
<span style="color:black">DOSCODE:9E16                 </span><span style="color:navy">mov     bx, [bp-</span><span style="color:green">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9E19                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9E1A                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:9E1C                 </span><span style="color:navy">call    </span>$LSEEK
<span style="color:black">DOSCODE:9E1F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9E20                 </span><span style="color:navy">jnb     short </span>exec_get_entries
<span style="color:black">DOSCODE:9E22
DOSCODE:9E22 </span>Exec_Bad_FileJ<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E22                 </span><span style="color:navy">jmp     </span>Exec_Bad_File
<span style="color:black">DOSCODE:9E25 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9E25
DOSCODE:9E25 </span>exec_get_entries<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E25                 </span><span style="color:navy">mov     dx, </span>exec_rle_count
<span style="color:black">DOSCODE:9E29
DOSCODE:9E29 </span>exec_read_reloc<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E29                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:9E2A                 </span><span style="color:navy">mov     dx, offset </span>OPENBUF
<span style="color:black">DOSCODE:9E2D                 </span><span style="color:navy">mov     cx, </span><span style="color:green">396
</span><span style="color:black">DOSCODE:9E30                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9E31                 </span><span style="color:navy">call    </span>ExecRead
<span style="color:black">DOSCODE:9E34                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9E35                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:9E36                 </span><span style="color:navy">jb      short </span>Exec_Bad_FileJ
<span style="color:black">DOSCODE:9E38                 </span><span style="color:navy">mov     cx, </span><span style="color:green">99
</span><span style="color:black">DOSCODE:9E3B                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:black">DOSCODE:9E3E                 </span><span style="color:navy">mov     si, [bp-</span><span style="color:green">10</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9E41
DOSCODE:9E41 </span>exec_reloc_one<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E41                 </span><span style="color:navy">or      dx, dx
</span><span style="color:black">DOSCODE:9E43                 </span><span style="color:navy">jz      short </span>Exec_Set_PDBJ
<span style="color:black">DOSCODE:9E45
DOSCODE:9E45 </span>exec_get_addr<span style="color:navy">:
</span><span style="color:black">DOSCODE:9E45                 </span><span style="color:navy">lds     bx, es:[di]
</span><span style="color:black">DOSCODE:9E48                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:9E4A                 </span><span style="color:navy">add     ax, [bp-</span><span style="color:green">28</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9E4D                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:9E4F                 </span><span style="color:navy">add     [bx], si
</span><span style="color:black">DOSCODE:9E51                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:9E54                 </span><span style="color:navy">dec     dx
</span><span style="color:black">DOSCODE:9E55                 </span><span style="color:navy">loop    </span>exec_reloc_one
<span style="color:black">DOSCODE:9E57                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9E58                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:9E59                 </span><span style="color:navy">jmp     short </span>exec_read_reloc
<span style="color:black">DOSCODE:9E5B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9E5B
DOSCODE:9E5B </span>Exec_Set_PDBJ<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E5B                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9E5C                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9E5D                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9E5E                 </span><span style="color:navy">mov     es, word ptr [bp-</span><span style="color:green">28</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9E61                 </span><span style="color:navy">mov     ax, ss:</span>exec_init_CS
<span style="color:black">DOSCODE:9E65                 </span><span style="color:navy">mov     cx, ss:</span>exec_init_IP
<span style="color:black">DOSCODE:9E6A                 </span><span style="color:navy">call    ss:</span>FixExePatch
<span style="color:black">DOSCODE:9E6F                 </span><span style="color:navy">call    ss:</span>Rational386PatchPtr
<span style="color:black">DOSCODE:9E74                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9E75                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:9E76                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9E77                 </span><span style="color:navy">jmp     </span>Exec_Set_PDB
<span style="color:black">DOSCODE:9E7A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9E7A
DOSCODE:9E7A </span>Exec_No_Memj<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E7A                 </span><span style="color:navy">jmp     </span>Exec_No_Mem
<span style="color:black">DOSCODE:9E7D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9E7D
DOSCODE:9E7D </span>Exec_Com_File<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E7D                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">5</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:9E81                 </span><span style="color:navy">jz      short </span>Exec_Alloc_Com_File
<span style="color:black">DOSCODE:9E83                 </span><span style="color:navy">lds     si, [bp-</span><span style="color:green">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9E86                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:9E87                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">20</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9E8A                 </span><span style="color:navy">mov     ax, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:9E8D                 </span><span style="color:navy">jmp     short </span>Exec_Read_Block
<span style="color:black">DOSCODE:9E8F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9E8F
DOSCODE:9E8F </span>Exec_Chk_Com_Mem<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9E8F                 </span><span style="color:navy">mov     al, ss:</span>AllocMethod
<span style="color:black">DOSCODE:9E93                 </span><span style="color:navy">mov     bl, ss:</span>ALLOCMSAVE
<span style="color:black">DOSCODE:9E98                 </span><span style="color:navy">mov     ss:</span>AllocMethod<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:9E9D                 </span><span style="color:navy">test    bl, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9EA0                 </span><span style="color:navy">jnz     short </span>Exec_No_Memj
<span style="color:black">DOSCODE:9EA2                 </span><span style="color:navy">test    al, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9EA4                 </span><span style="color:navy">jz      short </span>Exec_No_Memj
<span style="color:black">DOSCODE:9EA6                 </span><span style="color:navy">mov     ax, [bp-</span><span style="color:green">18</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9EA9                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:9EAB                 </span><span style="color:navy">call    </span>ChangeOwner
<span style="color:black">DOSCODE:9EAE                 </span><span style="color:navy">jmp     short </span>Exec_Norm_Com_Alloc
<span style="color:black">DOSCODE:9EB0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9EB0
DOSCODE:9EB0 </span>Exec_Alloc_Com_File<span style="color:navy">:                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9EB0                 </span><span style="color:navy">test    ss:</span>AllocMethod<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:9EB6                 </span><span style="color:navy">jz      short </span>Exec_Norm_Com_Alloc
<span style="color:black">DOSCODE:9EB8                 </span><span style="color:navy">or      ss:</span>AllocMethod<span style="color:navy">, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:9EBE
DOSCODE:9EBE </span>Exec_Norm_Com_Alloc<span style="color:navy">:                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9EBE                 </span><span style="color:navy">mov     bx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:9EC1                 </span><span style="color:navy">call    </span>$ALLOC
<span style="color:black">DOSCODE:9EC4                 </span><span style="color:navy">or      bx, bx
</span><span style="color:black">DOSCODE:9EC6                 </span><span style="color:navy">jz      short </span>Exec_Chk_Com_Mem
<span style="color:black">DOSCODE:9EC8                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">16</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:9ECB                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:9ECC                 </span><span style="color:navy">call    </span>$ALLOC
<span style="color:black">DOSCODE:9ECF                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:9ED0                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">18</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9ED3                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:9ED6                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">20</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:9ED9                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:9EDB                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">1000h
</span><span style="color:black">DOSCODE:9EDF                 </span><span style="color:navy">jnb     short </span>Exec_Read_Com
<span style="color:black">DOSCODE:9EE1                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:9EE3                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:9EE5                 </span><span style="color:navy">shl     ax, cl
</span><span style="color:black">DOSCODE:9EE7                 </span><span style="color:navy">cmp     ax, </span><span style="color:#ff8000">200h
</span><span style="color:black">DOSCODE:9EEA                 </span><span style="color:navy">jbe     short </span>Exec_Chk_Com_Mem
<span style="color:black">DOSCODE:9EEC                 </span><span style="color:navy">sub     ax, </span><span style="color:#ff8000">100h
</span><span style="color:black">DOSCODE:9EEF
DOSCODE:9EEF </span>Exec_Read_Com<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9EEF                 </span><span style="color:navy">sub     ax, </span><span style="color:#ff8000">100h
</span><span style="color:black">DOSCODE:9EF2
DOSCODE:9EF2 </span>Exec_Read_Block<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9EF2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:9EF3                 </span><span style="color:navy">mov     bx, [bp-</span><span style="color:green">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9EF6                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:9EF8                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:9EFA                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:9EFC                 </span><span style="color:navy">call    </span>$LSEEK
<span style="color:black">DOSCODE:9EFF                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9F00                 </span><span style="color:navy">mov     ds, word ptr [bp-</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9F03                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:black">DOSCODE:9F05                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9F06                 </span><span style="color:navy">call    </span>ExecRead
<span style="color:black">DOSCODE:9F09                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:9F0A                 </span><span style="color:navy">jnb     short </span>OkRead
<span style="color:black">DOSCODE:9F0C                 </span><span style="color:navy">jmp     </span>Exec_Bad_File
<span style="color:black">DOSCODE:9F0F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9F0F
DOSCODE:9F0F </span>OkRead<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9F0F                 </span><span style="color:navy">cmp     ax, si
</span><span style="color:black">DOSCODE:9F11                 </span><span style="color:navy">jnz     short </span>OkRead2
<span style="color:black">DOSCODE:9F13                 </span><span style="color:navy">jmp     </span>Exec_Chk_Com_Mem
<span style="color:black">DOSCODE:9F16 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9F16
DOSCODE:9F16 </span>OkRead2<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9F16                 </span><span style="color:navy">mov     bl, ss:</span>ALLOCMSAVE
<span style="color:black">DOSCODE:9F1B                 </span><span style="color:navy">mov     ss:</span>AllocMethod<span style="color:navy">, bl
</span><span style="color:black">DOSCODE:9F20                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">5</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:9F24                 </span><span style="color:navy">jnz     short </span>Exec_Set_PDB
<span style="color:black">DOSCODE:9F26                 </span><span style="color:navy">mov     ax, [bp-</span><span style="color:green">20</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9F29                 </span><span style="color:navy">sub     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:9F2C                 </span><span style="color:navy">mov     ss:</span>exec_init_CS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9F30                 </span><span style="color:navy">mov     ss:</span>exec_init_IP<span style="color:navy">, </span><span style="color:#ff8000">100h
</span><span style="color:black">DOSCODE:9F37                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">0FEh </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:9F3B                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFEh
</span><span style="color:black">DOSCODE:9F3E                 </span><span style="color:navy">jz      short </span>Exec_St_Ok
<span style="color:black">DOSCODE:9F40                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">100h
</span><span style="color:black">DOSCODE:9F44
DOSCODE:9F44 </span>Exec_St_Ok<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9F44                 </span><span style="color:navy">mov     ss:</span>exec_init_SP<span style="color:navy">, si
</span><span style="color:black">DOSCODE:9F49                 </span><span style="color:navy">mov     ss:</span>exec_init_SS<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:9F4D                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:9F4F                 </span><span style="color:navy">mov     word ptr [si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9F53                 </span><span style="color:navy">call    ss:</span>ChkCopyProt
<span style="color:black">DOSCODE:9F58
DOSCODE:9F58 </span>Exec_Set_PDB<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9F58                 </span><span style="color:navy">mov     bx, [bp-</span><span style="color:green">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9F5B                 </span><span style="color:navy">call    </span>Exec_Dealloc
<span style="color:black">DOSCODE:9F5E                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:9F5F                 </span><span style="color:navy">call    </span>$CLOSE
<span style="color:black">DOSCODE:9F62                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:9F63                 </span><span style="color:navy">call    </span>Exec_Alloc
<span style="color:black">DOSCODE:9F66                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">5</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:9F6A                 </span><span style="color:navy">jz      short </span>Exec_Build_Header
<span style="color:black">DOSCODE:9F6C                 </span><span style="color:navy">call    </span>Scan_Execname
<span style="color:black">DOSCODE:9F6F                 </span><span style="color:navy">call    </span>Scan_Special_Entries
<span style="color:black">DOSCODE:9F72                 </span><span style="color:navy">cmp     ss:</span>DriverLoad<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9F78                 </span><span style="color:navy">jz      short </span>norm_ovl
<span style="color:black">DOSCODE:9F7A                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:9F7B                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:9F7C                 </span><span style="color:navy">les     si, ss:</span>BiosDataPtr
<span style="color:black">DOSCODE:9F81                 </span><span style="color:navy">cmp     byte ptr es:[si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9F85                 </span><span style="color:navy">jz      short </span>sysinit_done
<span style="color:black">DOSCODE:9F87                 </span><span style="color:navy">mov     es, ss:</span>CurrentPDB
<span style="color:black">DOSCODE:9F8C                 </span><span style="color:navy">push    ss:</span>SPECIAL_VERSION
<span style="color:black">DOSCODE:9F91                 </span><span style="color:navy">pop     word ptr es:</span>SFTFCB
<span style="color:black">DOSCODE:9F96                 </span><span style="color:navy">jmp     short </span>setver_done
<span style="color:black">DOSCODE:9F98 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9F98
DOSCODE:9F98 </span>sysinit_done<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9F98                 </span><span style="color:navy">mov     ss:</span>DriverLoad<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:9F9E
DOSCODE:9F9E </span>setver_done<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9F9E                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9F9F                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:9FA0
DOSCODE:9FA0 </span>norm_ovl<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9FA0                 </span><span style="color:navy">mov     sp, bp
</span><span style="color:black">DOSCODE:9FA2                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:9FA3                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:9FA6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:9FA6
DOSCODE:9FA6 </span>Exec_Build_Header<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9FA6                 </span><span style="color:navy">mov     dx, [bp-</span><span style="color:green">18</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9FA9                 </span><span style="color:navy">mov     si, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:9FAC                 </span><span style="color:navy">mov     ax, [bp-</span><span style="color:green">14</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9FAF                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:9FB1                 </span><span style="color:navy">jz      short </span>No_Owner
<span style="color:black">DOSCODE:9FB3                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:9FB4                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:9FB6                 </span><span style="color:navy">mov     [si], dx
</span><span style="color:black">DOSCODE:9FB8
DOSCODE:9FB8 </span>No_Owner<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9FB8                 </span><span style="color:navy">mov     ax, [bp-</span><span style="color:green">18</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9FBB                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:9FBC                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:9FBE                 </span><span style="color:navy">mov     [si], dx
</span><span style="color:black">DOSCODE:9FC0                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:9FC1                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:9FC2                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:9FC5                 </span><span style="color:navy">call    </span>Scan_Execname
<span style="color:black">DOSCODE:9FC8                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:9FC9                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:9FCA
DOSCODE:9FCA </span>MoveName<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9FCA                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:9FCB                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">.&#039;
</span><span style="color:black">DOSCODE:9FCD                 </span><span style="color:navy">jz      short </span>mem_done
<span style="color:black">DOSCODE:9FCF                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:9FD0                 </span><span style="color:navy">cmp     di, </span><span style="color:green">16
</span><span style="color:black">DOSCODE:9FD3                 </span><span style="color:navy">jnb     short </span>mem_done
<span style="color:black">DOSCODE:9FD5                 </span><span style="color:navy">loop    </span>MoveName
<span style="color:black">DOSCODE:9FD7
DOSCODE:9FD7 </span>mem_done<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9FD7                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:9FD9                 </span><span style="color:navy">cmp     di, </span><span style="color:green">16
</span><span style="color:black">DOSCODE:9FDC                 </span><span style="color:navy">jnb     short </span>Fill8
<span style="color:black">DOSCODE:9FDE                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:9FDF
DOSCODE:9FDF </span>Fill8<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:9FDF                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:9FE0                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:9FE1                 </span><span style="color:navy">call    </span>Scan_Special_Entries
<span style="color:black">DOSCODE:9FE4                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:9FE5                 </span><span style="color:navy">mov     si, [bp-</span><span style="color:green">16</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9FE8                 </span><span style="color:navy">add     si, dx
</span><span style="color:black">DOSCODE:9FEA                 </span><span style="color:navy">call    </span>$DUP_PDB
<span style="color:black">DOSCODE:9FED                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:9FEE                 </span><span style="color:navy">push    word ptr [bp-</span><span style="color:green">14</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:9FF1                 </span><span style="color:navy">pop     word ptr es:</span>SFT_ADDR<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:9FF6                 </span><span style="color:navy">push    ss:</span>SPECIAL_VERSION
<span style="color:black">DOSCODE:9FFB                 </span><span style="color:navy">pop     word ptr es:</span>SFTFCB
<span style="color:black">DOSCODE:A000                 </span><span style="color:navy">lds     si, [bp-</span><span style="color:green">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A003                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:A004                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:A005                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A008                 </span><span style="color:navy">mov     cx, </span><span style="color:green">12
</span><span style="color:black">DOSCODE:A00B                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:A00C                 </span><span style="color:navy">mov     di, </span><span style="color:green">5Ch
</span><span style="color:black">DOSCODE:A00F                 </span><span style="color:navy">mov     bl, [si]
</span><span style="color:black">DOSCODE:A011                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:A013                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:A015                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:A016                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:A017                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:A018                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:A019                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A01A                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:A01B                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:A01C                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A01F                 </span><span style="color:navy">mov     bh, [si]
</span><span style="color:black">DOSCODE:A021                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:A023                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:A024                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:A025                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:A026                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A027                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A02A                 </span><span style="color:navy">or      cl, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:A02D                 </span><span style="color:navy">mov     di, cx
</span><span style="color:black">DOSCODE:A02F                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:A031                 </span><span style="color:navy">dec     cl
</span><span style="color:black">DOSCODE:A033                 </span><span style="color:navy">mov     al, bh
</span><span style="color:black">DOSCODE:A035                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:black">DOSCODE:A037                 </span><span style="color:navy">call    </span>GetVisDrv
<span style="color:black">DOSCODE:A03A                 </span><span style="color:navy">jnb     short </span>Exec_BL
<span style="color:black">DOSCODE:A03C                 </span><span style="color:navy">mov     bh, cl
</span><span style="color:black">DOSCODE:A03E
DOSCODE:A03E </span>Exec_BL<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A03E                 </span><span style="color:navy">mov     al, bl
</span><span style="color:black">DOSCODE:A040                 </span><span style="color:navy">xor     bl, bl
</span><span style="color:black">DOSCODE:A042                 </span><span style="color:navy">call    </span>GetVisDrv
<span style="color:black">DOSCODE:A045                 </span><span style="color:navy">jnb     short </span>Exec_Set_Return
<span style="color:black">DOSCODE:A047                 </span><span style="color:navy">mov     bl, cl
</span><span style="color:black">DOSCODE:A049
DOSCODE:A049 </span>Exec_Set_Return<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A049                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:A04C                 </span><span style="color:navy">push    word ptr [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A04F                 </span><span style="color:navy">push    word ptr [si+</span><span style="color:#ff8000">12h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A052                 </span><span style="color:navy">push    word ptr [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A055                 </span><span style="color:navy">push    word ptr [si+</span><span style="color:#ff8000">12h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A058                 </span><span style="color:navy">pop     word ptr es:</span>WinoldPatch1<span style="color:navy">+</span><span style="color:green">4
</span><span style="color:black">DOSCODE:A05D                 </span><span style="color:navy">pop     word ptr es:</span>WinoldPatch1<span style="color:navy">+</span><span style="color:green">6
</span><span style="color:black">DOSCODE:A062                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:A064                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:A066                 </span><span style="color:navy">pop     </span>UNPACK_OFFSET<span style="color:navy">+</span><span style="color:green">1
</span><span style="color:black">DOSCODE:A06A                 </span><span style="color:navy">pop     </span>SAVE_AX
<span style="color:black">DOSCODE:A06E                 </span><span style="color:navy">mov     word ptr ss:</span>DMAADD<span style="color:navy">, </span><span style="color:#ff8000">80h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:black">DOSCODE:A075                 </span><span style="color:navy">mov     ds, ss:</span>CurrentPDB
<span style="color:black">DOSCODE:A07A                 </span><span style="color:navy">mov     word ptr ss:</span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:A07F                 </span><span style="color:navy">test    byte ptr [bp-</span><span style="color:green">5</span><span style="color:navy">], </span><span style="color:green">1
</span><span style="color:black">DOSCODE:A083                 </span><span style="color:navy">jz      short </span>exec_go
<span style="color:black">DOSCODE:A085                 </span><span style="color:navy">lds     si, dword ptr ss:</span>exec_init_SP
<span style="color:black">DOSCODE:A08A                 </span><span style="color:navy">les     di, [bp-</span><span style="color:green">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A08D                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">10h</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:A091                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:A092                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:A093                 </span><span style="color:navy">mov     [si], bx
</span><span style="color:black">DOSCODE:A095                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:A099                 </span><span style="color:navy">lds     ax, dword ptr ss:</span>exec_init_IP
<span style="color:black">DOSCODE:A09E                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">14h</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:A0A2                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">12h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:A0A6                 </span><span style="color:navy">mov     sp, bp
</span><span style="color:black">DOSCODE:A0A8                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:A0A9                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:A0AC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A0AC
DOSCODE:A0AC </span>exec_go<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A0AC                 </span><span style="color:navy">lds     si, dword ptr ss:</span>exec_init_IP
<span style="color:black">DOSCODE:A0B1                 </span><span style="color:navy">les     di, dword ptr ss:</span>exec_init_SP
<span style="color:black">DOSCODE:A0B6                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:A0B8                 </span><span style="color:navy">cmp     ss:</span>DosHasHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A0BE                 </span><span style="color:navy">jz      short </span>Xfer_To_User
<span style="color:black">DOSCODE:A0C0                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:A0C1                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:A0C6                 </span><span style="color:navy">or      </span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:A0CB                 </span><span style="color:navy">mov     </span>A20OFF_PSP<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:A0CF                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:A0D1                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A0D2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A0D3                 </span><span style="color:navy">mov     ax, offset </span>disa20_xfer
<span style="color:black">DOSCODE:A0D6                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A0D7                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:A0D9                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:A0DA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A0DA
DOSCODE:A0DA </span>Xfer_To_User<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A0DA                 </span><span style="color:navy">cli
</span><span style="color:black">DOSCODE:A0DB                 </span><span style="color:navy">mov     ss:</span>INDOS<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A0E1                 </span><span style="color:navy">mov     ss, ax
</span><span style="color:black">DOSCODE:A0E3                 </span><span style="color:navy">mov     sp, di
</span><span style="color:black">DOSCODE:A0E5                 </span><span style="color:navy">sti
</span><span style="color:black">DOSCODE:A0E6                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:A0E7                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:A0E8                 </span><span style="color:navy">mov     es, dx
</span><span style="color:black">DOSCODE:A0EA                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:black">DOSCODE:A0EC                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:A0EE                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:A0EE </span>$EXEC           endp
<span style="color:black">DOSCODE:A0EE
DOSCODE:A0EF
DOSCODE:A0EF </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A0EF
DOSCODE:A0EF
DOSCODE:A0EF </span>ExecRead        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A0EF                 </span><span style="color:navy">call    </span>Exec_Dealloc
<span style="color:black">DOSCODE:A0F2                 </span><span style="color:navy">mov     bx, [bp-</span><span style="color:green">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A0F5                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:A0F6                 </span><span style="color:navy">call    </span>$READ
<span style="color:black">DOSCODE:A0F9                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:A0FA                 </span><span style="color:navy">call    </span>Exec_Alloc
<span style="color:black">DOSCODE:A0FD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A0FD </span>ExecRead        endp
<span style="color:black">DOSCODE:A0FD
DOSCODE:A0FE
DOSCODE:A0FE </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A0FE
DOSCODE:A0FE
DOSCODE:A0FE </span>Exec_Dealloc    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A0FE                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:A0FF                 </span><span style="color:navy">sub     bx, bx
</span><span style="color:black">DOSCODE:A101                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:A104                 </span><span style="color:navy">call    </span>ChangeOwners
<span style="color:black">DOSCODE:A107                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:A108                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A108 </span>Exec_Dealloc    endp
<span style="color:black">DOSCODE:A108
DOSCODE:A109
DOSCODE:A109 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A109
DOSCODE:A109
DOSCODE:A109 </span>Exec_Alloc      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A109                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:A10A                 </span><span style="color:navy">mov     bx, ss:</span>CurrentPDB
<span style="color:black">DOSCODE:A10F                 </span><span style="color:navy">call    </span>ChangeOwners
<span style="color:black">DOSCODE:A112                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:A115                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:A116                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A116 </span>Exec_Alloc      endp
<span style="color:black">DOSCODE:A116
DOSCODE:A117
DOSCODE:A117 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A117
DOSCODE:A117
DOSCODE:A117 </span>ChangeOwners    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A117                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:A118                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A119                 </span><span style="color:navy">mov     ax, [bp-</span><span style="color:green">14</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A11C                 </span><span style="color:navy">call    </span>ChangeOwner
<span style="color:black">DOSCODE:A11F                 </span><span style="color:navy">mov     ax, [bp-</span><span style="color:green">18</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A122                 </span><span style="color:navy">call    </span>ChangeOwner
<span style="color:black">DOSCODE:A125                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A126                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:A127
DOSCODE:A127 </span>chgown_retn<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A127                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A127 </span>ChangeOwners    endp
<span style="color:black">DOSCODE:A127
DOSCODE:A128
DOSCODE:A128 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A128
DOSCODE:A128
DOSCODE:A128 </span>ChangeOwner     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A128                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:A12A                 </span><span style="color:navy">jz      short </span>chgown_retn
<span style="color:black">DOSCODE:A12C                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:A12D                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:A12E                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:A130                 </span><span style="color:navy">mov     word ptr byte_0+</span><span style="color:green">1</span><span style="color:navy">, bx
</span><span style="color:black">DOSCODE:A134                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A135                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A135 </span>ChangeOwner     endp
<span style="color:black">DOSCODE:A135
DOSCODE:A136
DOSCODE:A136 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A136
DOSCODE:A136
DOSCODE:A136 </span>Scan_Execname   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A136                 </span><span style="color:navy">lds     si, [bp-</span><span style="color:green">26</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A139
DOSCODE:A139 </span>Scan_Execname1<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A139                 </span><span style="color:navy">mov     cx, si
</span><span style="color:black">DOSCODE:A13B
DOSCODE:A13B </span><span style="color:gray">Scan0</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A13B                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:A13C                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:A13E                 </span><span style="color:navy">jz      short </span>Scan_Execname1
<span style="color:black">DOSCODE:A140                 </span><span style="color:navy">cmp     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:A142                 </span><span style="color:navy">jz      short </span>Scan_Execname1
<span style="color:black">DOSCODE:A144                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:A146                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Scan0
</span><span style="color:black">DOSCODE:A148                 </span><span style="color:navy">sub     si, cx
</span><span style="color:black">DOSCODE:A14A                 </span><span style="color:navy">xchg    si, cx
</span><span style="color:black">DOSCODE:A14C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A14C </span>Scan_Execname   endp
<span style="color:black">DOSCODE:A14C
DOSCODE:A14D
DOSCODE:A14D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A14D
DOSCODE:A14D
DOSCODE:A14D </span>Scan_Special_Entries proc near          <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A14D                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:A14E                 </span><span style="color:navy">mov     ss:</span>SPECIAL_VERSION<span style="color:navy">, </span><span style="color:green">1406h
</span><span style="color:black">DOSCODE:A155                 </span><span style="color:navy">les     di, ss:</span>UU_IFS_DOS_CALL
<span style="color:black">DOSCODE:A15A                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:A15C                 </span><span style="color:navy">or      ax, di
</span><span style="color:black">DOSCODE:A15E                 </span><span style="color:navy">jz      short </span><span style="color:gray">End_List
</span><span style="color:black">DOSCODE:A160
DOSCODE:A160 </span><span style="color:gray">GetEntries</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A160                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:A163                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:A165                 </span><span style="color:navy">jz      short </span><span style="color:gray">End_List
</span><span style="color:black">DOSCODE:A167                 </span><span style="color:navy">mov     ss:</span>TEMP_VAR2<span style="color:navy">, di
</span><span style="color:black">DOSCODE:A16C                 </span><span style="color:navy">cmp     al, cl
</span><span style="color:black">DOSCODE:A16E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SkipOne
</span><span style="color:black">DOSCODE:A170                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:A171                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:A172                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:A173                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A174
DOSCODE:A174 </span><span style="color:gray">sse_next_char</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A174                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:A175                 </span><span style="color:navy">call    </span>UCase
<span style="color:black">DOSCODE:A178                 </span><span style="color:navy">scasb
</span><span style="color:black">DOSCODE:A179                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Not_Matched
</span><span style="color:black">DOSCODE:A17B                 </span><span style="color:navy">loop    </span><span style="color:gray">sse_next_char
</span><span style="color:black">DOSCODE:A17D                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A17E                 </span><span style="color:navy">mov     ax, es:[di]
</span><span style="color:black">DOSCODE:A181                 </span><span style="color:navy">mov     ss:</span>SPECIAL_VERSION<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A185                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:A186                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:A187                 </span><span style="color:navy">jmp     short </span><span style="color:gray">End_List
</span><span style="color:black">DOSCODE:A189 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A189
DOSCODE:A189 </span><span style="color:gray">Not_Matched</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A189                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A18A                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:A18B                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:A18C
DOSCODE:A18C </span><span style="color:gray">SkipOne</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A18C                 </span><span style="color:navy">mov     di, ss:</span>TEMP_VAR2
<span style="color:black">DOSCODE:A191                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:A193                 </span><span style="color:navy">add     di, ax
</span><span style="color:black">DOSCODE:A195                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:A198                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GetEntries
</span><span style="color:black">DOSCODE:A19A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A19A
DOSCODE:A19A </span><span style="color:gray">End_List</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A19A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A19A </span>Scan_Special_Entries endp
<span style="color:black">DOSCODE:A19A
</span><span style="color:maroon">DOSCODE:A19B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A19B
DOSCODE:A19B </span>$KEEP_PROCESS<span style="color:navy">:                          </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A19B                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:A19C                 </span><span style="color:navy">mov     ss:</span>EXIT_TYPE<span style="color:navy">, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:A1A2                 </span><span style="color:navy">mov     es, ss:</span>CurrentPDB
<span style="color:maroon">DOSCODE:A1A7                 </span><span style="color:navy">cmp     dx, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:A1AA                 </span><span style="color:navy">jnb     short </span>Keep_Shrink
<span style="color:maroon">DOSCODE:A1AC                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:A1AF
DOSCODE:A1AF </span>Keep_Shrink<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A1AF                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:maroon">DOSCODE:A1B1                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:A1B2                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:A1B3                 </span><span style="color:navy">call    </span>$SETBLOCK
<span style="color:maroon">DOSCODE:A1B6                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:A1B7                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A1B8                 </span><span style="color:navy">jb      short </span>Keep_Done
<span style="color:maroon">DOSCODE:A1BA                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:A1BC                 </span><span style="color:navy">add     ax, bx
</span><span style="color:maroon">DOSCODE:A1BE                 </span><span style="color:navy">mov     word ptr byte_0+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:A1C1
DOSCODE:A1C1 </span>Keep_Done<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A1C1                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:A1C2                 </span><span style="color:navy">jmp     short </span>exit_inner
<span style="color:maroon">DOSCODE:A1C4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A1C4
DOSCODE:A1C4 </span>stay_resident<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A1C4                 </span><span style="color:navy">mov     ax, </span><span style="color:green">3100h
</span><span style="color:maroon">DOSCODE:A1C7                 </span><span style="color:navy">add     dx, </span><span style="color:green">15
</span><span style="color:maroon">DOSCODE:A1CA                 </span><span style="color:navy">rcr     dx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A1CC                 </span><span style="color:navy">mov     cl, </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:A1CE                 </span><span style="color:navy">shr     dx, cl
</span><span style="color:maroon">DOSCODE:A1D0                 </span><span style="color:navy">jmp     </span>command
<span style="color:maroon">DOSCODE:A1D3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A1D3
DOSCODE:A1D3 </span>$EXIT<span style="color:navy">:                                  </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A1D3                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:A1D5                 </span><span style="color:navy">xchg    ah, ss:</span>DidCTRLC
<span style="color:maroon">DOSCODE:A1DA                 </span><span style="color:navy">or      ah, ah
</span><span style="color:maroon">DOSCODE:A1DC                 </span><span style="color:navy">mov     ss:</span>EXIT_TYPE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:A1E2                 </span><span style="color:navy">jz      short </span>exit_inner
<span style="color:maroon">DOSCODE:A1E4                 </span><span style="color:navy">mov     ss:</span>EXIT_TYPE<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A1EA </span><span style="color:gray">; START OF FUNCTION CHUNK FOR FATALC
</span><span style="color:black">DOSCODE:A1EA
DOSCODE:A1EA </span>exit_inner<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A1EA                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:A1ED                 </span><span style="color:navy">push    ss:</span>CurrentPDB
<span style="color:black">DOSCODE:A1F2                 </span><span style="color:navy">pop     word ptr [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A1F5                 </span><span style="color:navy">jmp     short </span><span style="color:gray">abort_inner
</span><span style="color:black">DOSCODE:A1F5 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR FATALC
</span><span style="color:maroon">DOSCODE:A1F7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A1F7
DOSCODE:A1F7 </span>$ABORT<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A1F7                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:A1F9                 </span><span style="color:navy">mov     ss:</span>EXIT_TYPE<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A1FF </span><span style="color:gray">; START OF FUNCTION CHUNK FOR FATALC
</span><span style="color:black">DOSCODE:A1FF
DOSCODE:A1FF </span><span style="color:gray">abort_inner</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A1FF                 </span><span style="color:navy">mov     ah, ss:</span>EXIT_TYPE
<span style="color:black">DOSCODE:A204                 </span><span style="color:navy">mov     ss:</span>exit_code<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A208                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:A20B                 </span><span style="color:navy">mov     ds, word ptr [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A20E                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:A210                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:A212                 </span><span style="color:navy">mov     si, </span><span style="color:green">10
</span><span style="color:black">DOSCODE:A215                 </span><span style="color:navy">mov     di, </span><span style="color:green">88h
</span><span style="color:black">DOSCODE:A218                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:A219                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:A21A                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:A21B                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:A21C                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:A21D                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:A21E                 </span><span style="color:navy">jmp     </span><span style="color:gray">reset_environment
</span><span style="color:black">DOSCODE:A21E </span><span style="color:gray">; END OF FUNCTION CHUNK FOR FATALC
</span><span style="color:maroon">DOSCODE:A221 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A221
DOSCODE:A221 </span>RetExePatch<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A221                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A222
DOSCODE:A222 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A222
DOSCODE:A222
DOSCODE:A222 </span>arena_free_process proc near            <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A222                 </span><span style="color:navy">mov     ax, ss:</span>arena_head
<span style="color:black">DOSCODE:A226
DOSCODE:A226 </span><span style="color:gray">arena_free_process_start</span><span style="color:navy">:               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A226                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A229                 </span><span style="color:navy">call    </span>check_signature
<span style="color:black">DOSCODE:A22C
DOSCODE:A22C </span><span style="color:gray">arena_free_process_loop</span><span style="color:navy">:                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A22C                 </span><span style="color:navy">jb      short </span>check_signature_ok
<span style="color:black">DOSCODE:A22E                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:A22F                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A230                 </span><span style="color:navy">cmp     word ptr byte_0+</span><span style="color:green">1</span><span style="color:navy">, bx
</span><span style="color:black">DOSCODE:A234                 </span><span style="color:navy">jnz     short </span><span style="color:gray">arena_free_next
</span><span style="color:black">DOSCODE:A236                 </span><span style="color:navy">mov     word ptr byte_0+</span><span style="color:green">1</span><span style="color:navy">, di
</span><span style="color:black">DOSCODE:A23A
DOSCODE:A23A </span><span style="color:gray">arena_free_next</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A23A                 </span><span style="color:navy">cmp     byte ptr [di], </span><span style="color:#ff8000">5Ah </span><span style="color:gray">; &#039;Z&#039;
</span><span style="color:black">DOSCODE:A23D                 </span><span style="color:navy">jz      short </span><span style="color:gray">arena_chk_umbs
</span><span style="color:black">DOSCODE:A23F                 </span><span style="color:navy">call    </span>arena_next
<span style="color:black">DOSCODE:A242                 </span><span style="color:navy">jmp     short </span><span style="color:gray">arena_free_process_loop
</span><span style="color:black">DOSCODE:A244 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A244
DOSCODE:A244 </span><span style="color:gray">arena_chk_umbs</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A244                 </span><span style="color:navy">mov     ax, ss:</span>UMB_HEAD
<span style="color:black">DOSCODE:A248                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:A24B                 </span><span style="color:navy">jz      short </span>check_signature_ok
<span style="color:black">DOSCODE:A24D                 </span><span style="color:navy">mov     di, ds
</span><span style="color:black">DOSCODE:A24F                 </span><span style="color:navy">cmp     di, ax
</span><span style="color:black">DOSCODE:A251                 </span><span style="color:navy">jnb     short </span>check_signature_ok
<span style="color:black">DOSCODE:A253                 </span><span style="color:navy">jmp     short </span><span style="color:gray">arena_free_process_start
</span><span style="color:black">DOSCODE:A253 </span>arena_free_process endp
<span style="color:black">DOSCODE:A253
DOSCODE:A255
DOSCODE:A255 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A255
DOSCODE:A255
DOSCODE:A255 </span>arena_next      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A255                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:A257                 </span><span style="color:navy">add     ax, word ptr byte_0+</span><span style="color:green">3
</span><span style="color:black">DOSCODE:A25B                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:A25B </span>arena_next      endp
<span style="color:black">DOSCODE:A25B
DOSCODE:A25C
DOSCODE:A25C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A25C
DOSCODE:A25C
DOSCODE:A25C </span>check_signature proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A25C                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:A25E                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">4Dh </span><span style="color:gray">; &#039;M&#039;
</span><span style="color:black">DOSCODE:A262                 </span><span style="color:navy">jz      short </span>check_signature_ok
<span style="color:black">DOSCODE:A264                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">5Ah </span><span style="color:gray">; &#039;Z&#039;
</span><span style="color:black">DOSCODE:A268                 </span><span style="color:navy">jz      short </span>check_signature_ok
<span style="color:black">DOSCODE:A26A                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:A26B
DOSCODE:A26B </span>check_signature_ok<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A26B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A26B </span>check_signature endp
<span style="color:black">DOSCODE:A26B
DOSCODE:A26C
DOSCODE:A26C </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A26C
DOSCODE:A26C
DOSCODE:A26C </span>Coalesce        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A26C                 </span><span style="color:navy">cmp     byte ptr [di], </span><span style="color:#ff8000">5Ah </span><span style="color:gray">; &#039;Z&#039;
</span><span style="color:black">DOSCODE:A26F                 </span><span style="color:navy">jz      short </span>check_signature_ok
<span style="color:black">DOSCODE:A271                 </span><span style="color:navy">call    </span>arena_next
<span style="color:black">DOSCODE:A274                 </span><span style="color:navy">jb      short </span>check_signature_ok
<span style="color:black">DOSCODE:A276                 </span><span style="color:navy">cmp     word ptr es:byte_0+</span><span style="color:green">1</span><span style="color:navy">, di
</span><span style="color:black">DOSCODE:A27B                 </span><span style="color:navy">jnz     short </span>check_signature_ok
<span style="color:black">DOSCODE:A27D                 </span><span style="color:navy">mov     cx, word ptr es:byte_0+</span><span style="color:green">3
</span><span style="color:black">DOSCODE:A282                 </span><span style="color:navy">inc     cx
</span><span style="color:black">DOSCODE:A283                 </span><span style="color:navy">add     word ptr byte_0+</span><span style="color:green">3</span><span style="color:navy">, cx
</span><span style="color:black">DOSCODE:A287                 </span><span style="color:navy">mov     cl, es:[di]
</span><span style="color:black">DOSCODE:A28A                 </span><span style="color:navy">mov     [di], cl
</span><span style="color:black">DOSCODE:A28C                 </span><span style="color:navy">jmp     short </span>Coalesce
<span style="color:black">DOSCODE:A28C </span>Coalesce        endp
<span style="color:black">DOSCODE:A28C
DOSCODE:A28E
DOSCODE:A28E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A28E
DOSCODE:A28E
DOSCODE:A28E </span>$ALLOC          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A28E                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:A291                 </span><span style="color:navy">mov     ax, ss:</span>arena_head
<span style="color:black">DOSCODE:A295                 </span><span style="color:navy">mov     ss:</span>START_ARENA<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A299                 </span><span style="color:navy">test    ss:</span>AllocMethod<span style="color:navy">, </span><span style="color:green">0C0h
</span><span style="color:black">DOSCODE:A29F                 </span><span style="color:navy">jz      short </span><span style="color:gray">norm_alloc
</span><span style="color:black">DOSCODE:A2A1                 </span><span style="color:navy">test    ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:A2A7                 </span><span style="color:navy">jz      short </span><span style="color:gray">norm_alloc
</span><span style="color:black">DOSCODE:A2A9                 </span><span style="color:navy">mov     ax, ss:</span>UMB_HEAD
<span style="color:black">DOSCODE:A2AD                 </span><span style="color:navy">mov     ss:</span>START_ARENA<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A2B1
DOSCODE:A2B1 </span><span style="color:gray">norm_alloc</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A2B1                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:A2B3                 </span><span style="color:navy">mov     di, ax
</span><span style="color:black">DOSCODE:A2B5                 </span><span style="color:navy">mov     ss:</span>FirstArena<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A2B9                 </span><span style="color:navy">mov     ss:</span>BestArena<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A2BD                 </span><span style="color:navy">mov     ss:</span>LastArena<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A2C1                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A2C2
DOSCODE:A2C2 </span><span style="color:gray">start_scan</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A2C2                 </span><span style="color:navy">mov     ax, ss:</span>START_ARENA
<span style="color:black">DOSCODE:A2C6                 </span><span style="color:navy">call    </span>check_signature
<span style="color:black">DOSCODE:A2C9                 </span><span style="color:navy">jb      short </span><span style="color:gray">alloc_err
</span><span style="color:black">DOSCODE:A2CB
DOSCODE:A2CB </span><span style="color:gray">alloc_scan</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A2CB                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:A2CC                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A2CD                 </span><span style="color:navy">cmp     word ptr byte_0+</span><span style="color:green">1</span><span style="color:navy">, di
</span><span style="color:black">DOSCODE:A2D1                 </span><span style="color:navy">jz      short </span><span style="color:gray">alloc_free
</span><span style="color:black">DOSCODE:A2D3
DOSCODE:A2D3 </span><span style="color:gray">alloc_next</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A2D3                 </span><span style="color:navy">test    ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:A2D9                 </span><span style="color:navy">jz      short </span><span style="color:gray">norm_strat
</span><span style="color:black">DOSCODE:A2DB                 </span><span style="color:navy">test    ss:</span>AllocMethod<span style="color:navy">, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:A2E1                 </span><span style="color:navy">jz      short </span><span style="color:gray">norm_strat
</span><span style="color:black">DOSCODE:A2E3                 </span><span style="color:navy">mov     ax, ss:</span>START_ARENA
<span style="color:black">DOSCODE:A2E7                 </span><span style="color:navy">cmp     ax, ss:</span>arena_head
<span style="color:black">DOSCODE:A2EC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">norm_strat
</span><span style="color:black">DOSCODE:A2EE                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:A2F0                 </span><span style="color:navy">cmp     ax, ss:</span>UMB_HEAD
<span style="color:black">DOSCODE:A2F5                 </span><span style="color:navy">jmp     short </span><span style="color:gray">alloc_chk_end
</span><span style="color:black">DOSCODE:A2F7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A2F7
DOSCODE:A2F7 </span><span style="color:gray">norm_strat</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A2F7                 </span><span style="color:navy">cmp     byte ptr [di], </span><span style="color:#ff8000">5Ah </span><span style="color:gray">; &#039;Z&#039;
</span><span style="color:black">DOSCODE:A2FA
DOSCODE:A2FA </span><span style="color:gray">alloc_chk_end</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A2FA                 </span><span style="color:navy">jz      short </span><span style="color:gray">alloc_end
</span><span style="color:black">DOSCODE:A2FC                 </span><span style="color:navy">call    </span>arena_next
<span style="color:black">DOSCODE:A2FF                 </span><span style="color:navy">jnb     short </span><span style="color:gray">alloc_scan
</span><span style="color:black">DOSCODE:A301
DOSCODE:A301 </span><span style="color:gray">alloc_err</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A301                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A302
DOSCODE:A302 </span>alloc_trashed<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A302                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:A305                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">7
</span><span style="color:black">DOSCODE:A307
DOSCODE:A307 </span><span style="color:gray">alloc_errj</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A307                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:A30A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A30A
DOSCODE:A30A </span><span style="color:gray">alloc_end</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A30A                 </span><span style="color:navy">cmp     ss:</span>FirstArena<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A310                 </span><span style="color:navy">jz      short </span><span style="color:gray">alloc_chk
</span><span style="color:black">DOSCODE:A312                 </span><span style="color:navy">jmp     </span><span style="color:gray">alloc_do_split
</span><span style="color:black">DOSCODE:A315 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A315
DOSCODE:A315 </span><span style="color:gray">alloc_chk</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A315                 </span><span style="color:navy">mov     ax, ss:</span>arena_head
<span style="color:black">DOSCODE:A319                 </span><span style="color:navy">cmp     ax, ss:</span>START_ARENA
<span style="color:black">DOSCODE:A31E                 </span><span style="color:navy">jz      short </span>alloc_fail
<span style="color:black">DOSCODE:A320                 </span><span style="color:navy">test    ss:</span>AllocMethod<span style="color:navy">, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:A326                 </span><span style="color:navy">jnz     short </span>alloc_fail
<span style="color:black">DOSCODE:A328                 </span><span style="color:navy">mov     ss:</span>START_ARENA<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A32C                 </span><span style="color:navy">jmp     short </span><span style="color:gray">start_scan
</span><span style="color:black">DOSCODE:A32E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A32E
DOSCODE:A32E </span>alloc_fail<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A32E                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:A331                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:A332                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:black">DOSCODE:A335                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:A338                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:A33A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">alloc_errj
</span><span style="color:black">DOSCODE:A33C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A33C
DOSCODE:A33C </span><span style="color:gray">alloc_free</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A33C                 </span><span style="color:navy">call    </span>Coalesce
<span style="color:black">DOSCODE:A33F                 </span><span style="color:navy">jb      short </span><span style="color:gray">alloc_err
</span><span style="color:black">DOSCODE:A341                 </span><span style="color:navy">mov     cx, word ptr byte_0+</span><span style="color:green">3
</span><span style="color:black">DOSCODE:A345                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:A346                 </span><span style="color:navy">cmp     cx, dx
</span><span style="color:black">DOSCODE:A348                 </span><span style="color:navy">jbe     short </span><span style="color:gray">alloc_test
</span><span style="color:black">DOSCODE:A34A                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:black">DOSCODE:A34C
DOSCODE:A34C </span><span style="color:gray">alloc_test</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A34C                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:A34D                 </span><span style="color:navy">cmp     bx, cx
</span><span style="color:black">DOSCODE:A34F                 </span><span style="color:navy">ja      short </span><span style="color:gray">alloc_next
</span><span style="color:black">DOSCODE:A351                 </span><span style="color:navy">cmp     ss:</span>FirstArena<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A357                 </span><span style="color:navy">jnz     short </span><span style="color:gray">alloc_best
</span><span style="color:black">DOSCODE:A359                 </span><span style="color:navy">mov     ss:</span>FirstArena<span style="color:navy">, ds
</span><span style="color:black">DOSCODE:A35E
DOSCODE:A35E </span><span style="color:gray">alloc_best</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A35E                 </span><span style="color:navy">cmp     ss:</span>BestArena<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A364                 </span><span style="color:navy">jz      short </span><span style="color:gray">alloc_make_best
</span><span style="color:black">DOSCODE:A366                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:A367                 </span><span style="color:navy">mov     es, ss:</span>BestArena
<span style="color:black">DOSCODE:A36C                 </span><span style="color:navy">cmp     word ptr es:byte_0+</span><span style="color:green">3</span><span style="color:navy">, cx
</span><span style="color:black">DOSCODE:A371                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:A372                 </span><span style="color:navy">jbe     short </span><span style="color:gray">alloc_last
</span><span style="color:black">DOSCODE:A374
DOSCODE:A374 </span><span style="color:gray">alloc_make_best</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A374                 </span><span style="color:navy">mov     ss:</span>BestArena<span style="color:navy">, ds
</span><span style="color:black">DOSCODE:A379
DOSCODE:A379 </span><span style="color:gray">alloc_last</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A379                 </span><span style="color:navy">mov     ss:</span>LastArena<span style="color:navy">, ds
</span><span style="color:black">DOSCODE:A37E                 </span><span style="color:navy">jmp     </span><span style="color:gray">alloc_next
</span><span style="color:black">DOSCODE:A381 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A381
DOSCODE:A381 </span><span style="color:gray">alloc_do_split_high</span><span style="color:navy">:                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A381                 </span><span style="color:navy">mov     ds, ss:</span>LastArena
<span style="color:black">DOSCODE:A386                 </span><span style="color:navy">mov     cx, word ptr byte_0+</span><span style="color:green">3
</span><span style="color:black">DOSCODE:A38A                 </span><span style="color:navy">sub     cx, bx
</span><span style="color:black">DOSCODE:A38C                 </span><span style="color:navy">mov     dx, ds
</span><span style="color:black">DOSCODE:A38E                 </span><span style="color:navy">jz      short </span><span style="color:gray">alloc_set_owner
</span><span style="color:black">DOSCODE:A390                 </span><span style="color:navy">add     dx, cx
</span><span style="color:black">DOSCODE:A392                 </span><span style="color:navy">mov     es, dx
</span><span style="color:black">DOSCODE:A394                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:A395                 </span><span style="color:navy">xchg    bx, cx
</span><span style="color:black">DOSCODE:A397                 </span><span style="color:navy">jmp     short </span><span style="color:gray">alloc_set_sizes
</span><span style="color:black">DOSCODE:A399 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A399
DOSCODE:A399 </span><span style="color:gray">alloc_do_split</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A399                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:A39B                 </span><span style="color:navy">mov     cl, ss:</span>AllocMethod
<span style="color:black">DOSCODE:A3A0                 </span><span style="color:navy">and     cx, </span><span style="color:green">0FF3Fh
</span><span style="color:black">DOSCODE:A3A4                 </span><span style="color:navy">cmp     cx, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A3A7                 </span><span style="color:navy">ja      short </span><span style="color:gray">alloc_do_split_high
</span><span style="color:black">DOSCODE:A3A9                 </span><span style="color:navy">mov     ds, ss:</span>FirstArena
<span style="color:black">DOSCODE:A3AE                 </span><span style="color:navy">jb      short </span>alloc_get_size
<span style="color:black">DOSCODE:A3B0                 </span><span style="color:navy">mov     ds, ss:</span>BestArena
<span style="color:black">DOSCODE:A3B5
DOSCODE:A3B5 </span>alloc_get_size<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A3B5                 </span><span style="color:navy">mov     cx, word ptr byte_0+</span><span style="color:green">3
</span><span style="color:black">DOSCODE:A3B9                 </span><span style="color:navy">sub     cx, bx
</span><span style="color:black">DOSCODE:A3BB                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:A3BD                 </span><span style="color:navy">mov     dx, ax
</span><span style="color:black">DOSCODE:A3BF                 </span><span style="color:navy">jz      short </span><span style="color:gray">alloc_set_owner
</span><span style="color:black">DOSCODE:A3C1                 </span><span style="color:navy">add     ax, bx
</span><span style="color:black">DOSCODE:A3C3                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:A3C4                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:A3C6                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:A3C7
DOSCODE:A3C7 </span><span style="color:gray">alloc_set_sizes</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A3C7                 </span><span style="color:navy">mov     word ptr byte_0+</span><span style="color:green">3</span><span style="color:navy">, bx
</span><span style="color:black">DOSCODE:A3CB                 </span><span style="color:navy">mov     word ptr es:byte_0+</span><span style="color:green">3</span><span style="color:navy">, cx
</span><span style="color:black">DOSCODE:A3D0                 </span><span style="color:navy">mov     bl, </span><span style="color:#ff8000">4Dh </span><span style="color:gray">; &#039;M&#039;
</span><span style="color:black">DOSCODE:A3D2                 </span><span style="color:navy">xchg    bl, [di]
</span><span style="color:black">DOSCODE:A3D4                 </span><span style="color:navy">mov     es:[di], bl
</span><span style="color:black">DOSCODE:A3D7                 </span><span style="color:navy">mov     word ptr es:byte_0+</span><span style="color:green">1</span><span style="color:navy">, di
</span><span style="color:black">DOSCODE:A3DC
DOSCODE:A3DC </span><span style="color:gray">alloc_set_owner</span><span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A3DC                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:black">DOSCODE:A3DE                 </span><span style="color:navy">mov     ax, ss:</span>CurrentPDB
<span style="color:black">DOSCODE:A3E2                 </span><span style="color:navy">mov     word ptr byte_0+</span><span style="color:green">1</span><span style="color:navy">, ax
</span><span style="color:black">DOSCODE:A3E5                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:A3E7                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:A3E8                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:A3E9                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:A3EC
DOSCODE:A3EC </span>alloc_ok<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A3EC                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:A3EC </span>$ALLOC          endp
<span style="color:black">DOSCODE:A3EC
</span><span style="color:maroon">DOSCODE:A3EF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A3EF
DOSCODE:A3EF </span>$SETBLOCK<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A3EF                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:A3F2                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:A3F5                 </span><span style="color:navy">mov     ax, es
</span><span style="color:maroon">DOSCODE:A3F7                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:A3F8                 </span><span style="color:navy">call    </span>check_signature
<span style="color:maroon">DOSCODE:A3FB                 </span><span style="color:navy">jnb     short </span>setblock_grab
<span style="color:maroon">DOSCODE:A3FD
DOSCODE:A3FD </span>setblock_bad<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A3FD                 </span><span style="color:navy">jmp     </span>alloc_trashed
<span style="color:maroon">DOSCODE:A400 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A400
DOSCODE:A400 </span>setblock_grab<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A400                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:A402                 </span><span style="color:navy">call    </span>Coalesce
<span style="color:maroon">DOSCODE:A405                 </span><span style="color:navy">jb      short </span>setblock_bad
<span style="color:maroon">DOSCODE:A407                 </span><span style="color:navy">mov     cx, word ptr byte_0+</span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:A40B                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:A40C                 </span><span style="color:navy">cmp     bx, cx
</span><span style="color:maroon">DOSCODE:A40E                 </span><span style="color:navy">jbe     short </span>alloc_get_size
<span style="color:maroon">DOSCODE:A410                 </span><span style="color:navy">jmp     </span>alloc_fail
<span style="color:black">DOSCODE:A413
DOSCODE:A413 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A413
DOSCODE:A413
DOSCODE:A413 </span>$DEALLOC        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A413                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:A416                 </span><span style="color:navy">test    ss:</span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:A41C                 </span><span style="color:navy">jz      short </span><span style="color:gray">deallocate
</span><span style="color:black">DOSCODE:A41E                 </span><span style="color:navy">cmp     ss:</span>A20OFF_COUNT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A424                 </span><span style="color:navy">jnz     short </span><span style="color:gray">deallocate
</span><span style="color:black">DOSCODE:A426                 </span><span style="color:navy">mov     ss:</span>A20OFF_COUNT<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A42C
DOSCODE:A42C </span><span style="color:gray">deallocate</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A42C                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A42F                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:A431                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:A432                 </span><span style="color:navy">call    </span>check_signature
<span style="color:black">DOSCODE:A435                 </span><span style="color:navy">jb      short </span><span style="color:gray">dealloc_err
</span><span style="color:black">DOSCODE:A437                 </span><span style="color:navy">mov     word ptr es:byte_0+</span><span style="color:green">1</span><span style="color:navy">, di
</span><span style="color:black">DOSCODE:A43C                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:A43F
DOSCODE:A43F </span>dealloc_ok<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A43F                 </span><span style="color:navy">jmp     short </span>alloc_ok
<span style="color:black">DOSCODE:A441 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A441
DOSCODE:A441 </span><span style="color:gray">dealloc_err</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A441                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:A444                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">9
</span><span style="color:black">DOSCODE:A446
DOSCODE:A446 </span>dealloc_errj<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A446                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:A446 </span>$DEALLOC        endp
<span style="color:black">DOSCODE:A446
</span><span style="color:maroon">DOSCODE:A449 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A449
DOSCODE:A449 </span>$ALLOCOPER<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A449                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:A44B                 </span><span style="color:navy">jz      short </span>AllocGetStrat
<span style="color:maroon">DOSCODE:A44D                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A44F                 </span><span style="color:navy">jz      short </span>AllocSetStrat
<span style="color:maroon">DOSCODE:A451                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:A453                 </span><span style="color:navy">jz      short </span>AllocGetLink
<span style="color:maroon">DOSCODE:A455                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:A457                 </span><span style="color:navy">jz      short </span>AllocSetLink
<span style="color:maroon">DOSCODE:A459
DOSCODE:A459 </span>AllocOperError<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A459                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:A45F                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A461
DOSCODE:A461 </span>AllocOperErrj<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A461                 </span><span style="color:navy">jmp     short </span>dealloc_errj
<span style="color:maroon">DOSCODE:A463 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A463
DOSCODE:A463 </span>AllocArenaError<span style="color:navy">:                        </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A463                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:A469                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:A46B                 </span><span style="color:navy">jmp     short </span>AllocOperErrj
<span style="color:maroon">DOSCODE:A46D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A46D
DOSCODE:A46D </span>AllocGetStrat<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A46D                 </span><span style="color:navy">mov     al, ss:</span>AllocMethod
<span style="color:maroon">DOSCODE:A471                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:maroon">DOSCODE:A473
DOSCODE:A473 </span>AllocOperOK<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A473                 </span><span style="color:navy">jmp     short </span>dealloc_ok
<span style="color:maroon">DOSCODE:A475 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A475
DOSCODE:A475 </span>AllocSetStrat<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A475                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:A476                 </span><span style="color:navy">and     bx, </span><span style="color:green">0FF3Fh
</span><span style="color:maroon">DOSCODE:A47A                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:A47D                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A47E                 </span><span style="color:navy">ja      short </span>AllocOperError
<span style="color:maroon">DOSCODE:A480
DOSCODE:A480 </span>AllocOperSet<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:A480                 </span><span style="color:navy">mov     ss:</span>AllocMethod<span style="color:navy">, bl
</span><span style="color:maroon">DOSCODE:A485
DOSCODE:A485 </span>AllocOperSetOK<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A485                 </span><span style="color:navy">jmp     short </span>AllocOperOK
<span style="color:maroon">DOSCODE:A487 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A487
DOSCODE:A487 </span>AllocGetLink<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A487                 </span><span style="color:navy">mov     al, ss:</span>UMBFLAG
<span style="color:maroon">DOSCODE:A48B                 </span><span style="color:navy">and     al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A48D
DOSCODE:A48D </span>AllocGetLinkOK<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A48D                 </span><span style="color:navy">jmp     short </span>AllocOperSetOK
<span style="color:maroon">DOSCODE:A48F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A48F
DOSCODE:A48F </span>AllocSetLink<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A48F                 </span><span style="color:navy">mov     cx, ss:</span>UMB_HEAD
<span style="color:maroon">DOSCODE:A494                 </span><span style="color:navy">cmp     cx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:A497                 </span><span style="color:navy">jz      short </span>AllocOperError
<span style="color:maroon">DOSCODE:A499                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A49C                 </span><span style="color:navy">jb      short </span>UnlinkUmbs
<span style="color:maroon">DOSCODE:A49E                 </span><span style="color:navy">jz      short </span>LinkUmbs
<span style="color:maroon">DOSCODE:A4A0                 </span><span style="color:navy">jmp     short </span>AllocOperError
<span style="color:maroon">DOSCODE:A4A2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A4A2
DOSCODE:A4A2 </span>UnlinkUmbs<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A4A2                 </span><span style="color:navy">test    ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A4A8                 </span><span style="color:navy">jz      short </span>unlinked
<span style="color:maroon">DOSCODE:A4AA                 </span><span style="color:navy">call    </span>GetLastArena
<span style="color:maroon">DOSCODE:A4AD                 </span><span style="color:navy">jb      short </span>AllocArenaError
<span style="color:maroon">DOSCODE:A4AF                 </span><span style="color:navy">mov     </span>byte ptr 0<span style="color:navy">, </span><span style="color:#ff8000">5Ah </span><span style="color:gray">; &#039;Z&#039;
</span><span style="color:maroon">DOSCODE:A4B4                 </span><span style="color:navy">and     ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">0FEh
</span><span style="color:maroon">DOSCODE:A4BA
DOSCODE:A4BA </span>unlinked<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A4BA                 </span><span style="color:navy">jmp     short </span>AllocGetLinkOK
<span style="color:maroon">DOSCODE:A4BC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A4BC
DOSCODE:A4BC </span>LinkUmbs<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A4BC                 </span><span style="color:navy">test    ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A4C2                 </span><span style="color:navy">jnz     short </span>linked
<span style="color:maroon">DOSCODE:A4C4                 </span><span style="color:navy">call    </span>GetLastArena
<span style="color:maroon">DOSCODE:A4C7                 </span><span style="color:navy">jb      short </span>AllocArenaError
<span style="color:maroon">DOSCODE:A4C9                 </span><span style="color:navy">mov     </span>byte ptr 0<span style="color:navy">, </span><span style="color:#ff8000">4Dh </span><span style="color:gray">; &#039;M&#039;
</span><span style="color:maroon">DOSCODE:A4CE                 </span><span style="color:navy">or      ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A4D4
DOSCODE:A4D4 </span>linked<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A4D4                 </span><span style="color:navy">jmp     short </span>unlinked
<span style="color:black">DOSCODE:A4D6
DOSCODE:A4D6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A4D6
DOSCODE:A4D6
DOSCODE:A4D6 </span>GetLastArena    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A4D6                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A4D7                 </span><span style="color:navy">mov     ax, ss:</span>arena_head
<span style="color:black">DOSCODE:A4DB                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:A4DD                 </span><span style="color:navy">xor     di, di
</span><span style="color:black">DOSCODE:A4DF                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">5Ah </span><span style="color:gray">; &#039;Z&#039;
</span><span style="color:black">DOSCODE:A4E3                 </span><span style="color:navy">jz      short </span><span style="color:gray">GLA_done
</span><span style="color:black">DOSCODE:A4E5
DOSCODE:A4E5 </span><span style="color:gray">GLA_next</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A4E5                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:A4E7                 </span><span style="color:navy">call    </span>arena_next
<span style="color:black">DOSCODE:A4EA                 </span><span style="color:navy">jb      short </span><span style="color:gray">GLA_err
</span><span style="color:black">DOSCODE:A4EC                 </span><span style="color:navy">test    ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:A4F2                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GLA_chkumb
</span><span style="color:black">DOSCODE:A4F4                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">5Ah </span><span style="color:gray">; &#039;Z&#039;
</span><span style="color:black">DOSCODE:A4F8                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GLA_@f
</span><span style="color:black">DOSCODE:A4FA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A4FA
DOSCODE:A4FA </span><span style="color:gray">GLA_chkumb</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A4FA                 </span><span style="color:navy">cmp     ax, cx
</span><span style="color:black">DOSCODE:A4FC
DOSCODE:A4FC </span><span style="color:gray">GLA_@f</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A4FC                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GLA_next
</span><span style="color:black">DOSCODE:A4FE
DOSCODE:A4FE </span><span style="color:gray">GLA_done</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A4FE                 </span><span style="color:navy">test    ss:</span>UMBFLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:A504                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GLA_ret
</span><span style="color:black">DOSCODE:A506                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:A508                 </span><span style="color:navy">call    </span>arena_next
<span style="color:black">DOSCODE:A50B                 </span><span style="color:navy">jb      short </span><span style="color:gray">GLA_err
</span><span style="color:black">DOSCODE:A50D                 </span><span style="color:navy">cmp     ax, cx
</span><span style="color:black">DOSCODE:A50F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GLA_err
</span><span style="color:black">DOSCODE:A511
DOSCODE:A511 </span><span style="color:gray">GLA_ret</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A511                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:A512                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A513                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A514 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A514
DOSCODE:A514 </span><span style="color:gray">GLA_err</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A514                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:A515                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A516                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A516 </span>GetLastArena    endp
<span style="color:black">DOSCODE:A516
DOSCODE:A516 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:A517 </span>SERVERTAB       <span style="color:navy">dw offset </span>SERVER_DISP   <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:A519 </span>SERVERLEAVE     <span style="color:navy">dw offset </span>SERVERRETURN  <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:A51B </span>SERVER_DISP     <span style="color:navy">db </span><span style="color:#008040">11                   </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:A51C                 </span><span style="color:navy">dw offset </span>SRV_CALL
<span style="color:gray">DOSCODE:A51E                 </span><span style="color:navy">dw offset </span>COMMIT_ALL
<span style="color:gray">DOSCODE:A520                 </span><span style="color:navy">dw offset </span>CLOSE_NAME
<span style="color:gray">DOSCODE:A522                 </span><span style="color:navy">dw offset </span>CLOSE_UID
<span style="color:gray">DOSCODE:A524                 </span><span style="color:navy">dw offset </span>CLOSE_UID_PID
<span style="color:gray">DOSCODE:A526                 </span><span style="color:navy">dw offset </span>GET_LIST
<span style="color:gray">DOSCODE:A528                 </span><span style="color:navy">dw offset </span>GET_DOS_DATA
<span style="color:gray">DOSCODE:A52A                 </span><span style="color:navy">dw offset </span>SPOOL_OPER
<span style="color:gray">DOSCODE:A52C                 </span><span style="color:navy">dw offset </span>SPOOL_OPER
<span style="color:gray">DOSCODE:A52E                 </span><span style="color:navy">dw offset </span>SPOOL_OPER
<span style="color:gray">DOSCODE:A530                 </span><span style="color:navy">dw offset </span>_$SetExtendedError
<span style="color:maroon">DOSCODE:A532 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A532
DOSCODE:A532 </span>$ServerCall<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A532                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:A534                 </span><span style="color:navy">jb      short </span>SET_STUFF
<span style="color:maroon">DOSCODE:A536                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">9
</span><span style="color:maroon">DOSCODE:A538                 </span><span style="color:navy">jbe     short </span>NO_SET_ID
<span style="color:maroon">DOSCODE:A53A
DOSCODE:A53A </span>SET_STUFF<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A53A                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:A53C                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">12h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A53F                 </span><span style="color:navy">test    ss:</span>IsWin386<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A545                 </span><span style="color:navy">jnz     short </span>skip_win386
<span style="color:maroon">DOSCODE:A547                 </span><span style="color:navy">mov     ss:</span>USER_ID<span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:A54C
DOSCODE:A54C </span>skip_win386<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A54C                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">14h</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A54F                 </span><span style="color:navy">mov     ss:</span>PROC_ID<span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:A554
DOSCODE:A554 </span>NO_SET_ID<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A554                 </span><span style="color:navy">push    cs:</span>SERVERLEAVE
<span style="color:maroon">DOSCODE:A559                 </span><span style="color:navy">push    cs:</span>SERVERTAB
<span style="color:maroon">DOSCODE:A55E                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:A55F                 </span><span style="color:navy">call    </span>TableDispatch
<span style="color:maroon">DOSCODE:A562                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A568                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A56A
DOSCODE:A56A </span>servercall_error<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A56A                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:A56D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A56D
DOSCODE:A56D </span>SERVERRETURN<span style="color:navy">:                           </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A56D                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:A56E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A56E
DOSCODE:A56E </span>COMMIT_ALL<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A56E                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:maroon">DOSCODE:A570                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:A571                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:A572                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:A575
DOSCODE:A575 </span>CommitLoop<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A575                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:A576                 </span><span style="color:navy">call    </span>SFFromSFN
<span style="color:maroon">DOSCODE:A579                 </span><span style="color:navy">jb      short </span>CommitDone
<span style="color:maroon">DOSCODE:A57B                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:A57F                 </span><span style="color:navy">jz      short </span>CommitNext
<span style="color:maroon">DOSCODE:A581                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:A585                 </span><span style="color:navy">jz      short </span>CommitNext
<span style="color:maroon">DOSCODE:A587                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:maroon">DOSCODE:A58D                 </span><span style="color:navy">jnz     short </span>CommitNext
<span style="color:maroon">DOSCODE:A58F                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, di
</span><span style="color:maroon">DOSCODE:A593                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:A597                 </span><span style="color:navy">call    </span>DOS_COMMIT
<span style="color:maroon">DOSCODE:A59A
DOSCODE:A59A </span>CommitNext<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A59A                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A59B                 </span><span style="color:navy">inc     bx
</span><span style="color:maroon">DOSCODE:A59C                 </span><span style="color:navy">jmp     short </span>CommitLoop
<span style="color:maroon">DOSCODE:A59E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A59E
DOSCODE:A59E </span>CommitDone<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A59E                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:A5A1                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A5A2
DOSCODE:A5A2 </span>jmp_to_SYS_RET_OK<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A5A2                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:A5A5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A5A5
DOSCODE:A5A5 </span>CLOSE_NAME<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A5A5                 </span><span style="color:navy">call    ss:</span>MFTCloN
<span style="color:maroon">DOSCODE:A5AA
DOSCODE:A5AA </span>CheckReturns<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A5AA                 </span><span style="color:navy">jb      short </span>func_err
<span style="color:maroon">DOSCODE:A5AC
DOSCODE:A5AC </span>jmp_to_jmp_to_SYS_RET_OK<span style="color:navy">:               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A5AC                 </span><span style="color:navy">jmp     short </span>jmp_to_SYS_RET_OK
<span style="color:maroon">DOSCODE:A5AE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A5AE
DOSCODE:A5AE </span>func_err<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A5AE                 </span><span style="color:navy">jmp     short </span>servercall_error
<span style="color:maroon">DOSCODE:A5B0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A5B0
DOSCODE:A5B0 </span>CLOSE_UID<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A5B0                 </span><span style="color:navy">call    ss:</span>MFTclU
<span style="color:maroon">DOSCODE:A5B5                 </span><span style="color:navy">jmp     short </span>CheckReturns
<span style="color:maroon">DOSCODE:A5B7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A5B7
DOSCODE:A5B7 </span>CLOSE_UID_PID<span style="color:navy">:                          </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A5B7                 </span><span style="color:navy">call    ss:</span>MFTCloseP
<span style="color:maroon">DOSCODE:A5BC                 </span><span style="color:navy">jmp     short </span>CheckReturns
<span style="color:maroon">DOSCODE:A5BE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A5BE
DOSCODE:A5BE </span>GET_LIST<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A5BE                 </span><span style="color:navy">call    ss:</span>MFT_get
<span style="color:maroon">DOSCODE:A5C3                 </span><span style="color:navy">jb      short </span>func_err
<span style="color:maroon">DOSCODE:A5C5                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:A5C8                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], bx
</span><span style="color:maroon">DOSCODE:A5CB                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">], di
</span><span style="color:maroon">DOSCODE:A5CE                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">10h</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:A5D1
DOSCODE:A5D1 </span>SetCXOK<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A5D1                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:A5D4
DOSCODE:A5D4 </span>third_jmp_short_SYS_RET_OK<span style="color:navy">:             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A5D4                 </span><span style="color:navy">jmp     short </span>jmp_to_jmp_to_SYS_RET_OK
<span style="color:maroon">DOSCODE:A5D6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A5D6
DOSCODE:A5D6 </span>SRV_CALL<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A5D6                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:A5D7                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:A5D8                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:A5D9                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:A5DC                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:A5DD                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:A5DE                 </span><span style="color:navy">call    </span>XCHGP
<span style="color:maroon">DOSCODE:A5E1                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:A5E2                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:A5E5                 </span><span style="color:navy">rep movsw
</span><span style="color:maroon">DOSCODE:A5E7                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:A5E8                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:A5E9                 </span><span style="color:navy">movsw
</span><span style="color:maroon">DOSCODE:A5EA                 </span><span style="color:navy">movsw
</span><span style="color:maroon">DOSCODE:A5EB                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:A5EC                 </span><span style="color:navy">mov     ax, [si]
</span><span style="color:maroon">DOSCODE:A5EE                 </span><span style="color:navy">mov     bx, [si+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A5F1                 </span><span style="color:navy">mov     cx, [si+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A5F4                 </span><span style="color:navy">mov     dx, [si+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A5F7                 </span><span style="color:navy">mov     di, [si+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A5FA                 </span><span style="color:navy">mov     es, word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A5FD                 </span><span style="color:navy">push    word ptr [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A600                 </span><span style="color:navy">mov     ds, word ptr [si+</span><span style="color:#ff8000">0Ch</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A603                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:A604                 </span><span style="color:navy">mov     ss:</span>SAVEDS<span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:A609                 </span><span style="color:navy">mov     ss:</span>SAVEBX<span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:A60E                 </span><span style="color:navy">mov     ss:</span>FSHARING<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:A614                 </span><span style="color:navy">jmp     </span>REDISP
<span style="color:maroon">DOSCODE:A617 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A617
DOSCODE:A617 </span>GET_DOS_DATA<span style="color:navy">:                           </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A617                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:A618                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:A619                 </span><span style="color:navy">mov     di, offset </span>ERRORMODE ; SWAP_START
<span style="color:maroon">DOSCODE:A61C                 </span><span style="color:navy">mov     cx, offset </span>SWAP_END
<span style="color:maroon">DOSCODE:A61F                 </span><span style="color:navy">mov     dx, offset </span>USER_IN_AX ; SWAP_ALWAYS
<span style="color:maroon">DOSCODE:A622                 </span><span style="color:navy">sub     cx, di
</span><span style="color:maroon">DOSCODE:A624                 </span><span style="color:navy">sub     dx, di
</span><span style="color:maroon">DOSCODE:A626                 </span><span style="color:navy">shr     cx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A628                 </span><span style="color:navy">adc     cx, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:A62B                 </span><span style="color:navy">shl     cx, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:A62D                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:A630                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:A633                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">8</span><span style="color:navy">], di
</span><span style="color:maroon">DOSCODE:A636                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:A639                 </span><span style="color:navy">jmp     short </span>SetCXOK
<span style="color:maroon">DOSCODE:A63B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A63B
DOSCODE:A63B </span>SPOOL_OPER<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A63B                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:A63C                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1125h
</span><span style="color:maroon">DOSCODE:A63F                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - REDIRECTED PRINTER MODE
<span style="color:maroon">DOSCODE:A63F                                         </span>; STACK: WORD subfunction
<span style="color:maroon">DOSCODE:A63F                                         </span>; Return: CF set on error, AX = error code
<span style="color:maroon">DOSCODE:A63F                                         </span>; STACK unchanged
<span style="color:maroon">DOSCODE:A641                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A642                 </span><span style="color:navy">jb      short </span>func_err2
<span style="color:maroon">DOSCODE:A644                 </span><span style="color:navy">jmp     short </span>third_jmp_short_SYS_RET_OK
<span style="color:maroon">DOSCODE:A646 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A646
DOSCODE:A646 </span>func_err2<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A646                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:A649 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A649
DOSCODE:A649 </span>_$SetExtendedError<span style="color:navy">:                     </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A649                 </span><span style="color:navy">mov     ax, [si]
</span><span style="color:maroon">DOSCODE:A64B                 </span><span style="color:navy">mov     ss:</span>EXTERR<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:A64F                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A652                 </span><span style="color:navy">mov     word ptr ss:</span>EXTERRPT<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:A656                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">0Eh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A659                 </span><span style="color:navy">mov     word ptr ss:</span>EXTERRPT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:A65D                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A660                 </span><span style="color:navy">mov     ss:</span>EXTERR_ACT_CLASS<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:A664                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A667                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, ah
</span><span style="color:maroon">DOSCODE:A66C                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A66D
DOSCODE:A66D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A66D
DOSCODE:A66D
DOSCODE:A66D </span>pJFNFromHandle  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A66D                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:A672                 </span><span style="color:navy">mov     es, es:</span>CurrentPDB
<span style="color:black">DOSCODE:A677                 </span><span style="color:navy">cmp     bx, word ptr es:</span>BCON
<span style="color:black">DOSCODE:A67C                 </span><span style="color:navy">jb      short </span><span style="color:gray">pjfn10
</span><span style="color:black">DOSCODE:A67E                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:A680
DOSCODE:A680 </span>ReturnCarry<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A680                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:A681                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A682 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A682
DOSCODE:A682 </span><span style="color:gray">pjfn10</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A682                 </span><span style="color:navy">les     di, es:</span>BCON<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:A687                 </span><span style="color:navy">add     di, bx
</span><span style="color:black">DOSCODE:A689
DOSCODE:A689 </span>pJFNFromHandle_error<span style="color:navy">:                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A689                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A689 </span>pJFNFromHandle  endp
<span style="color:black">DOSCODE:A689
DOSCODE:A68A
DOSCODE:A68A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A68A
DOSCODE:A68A
DOSCODE:A68A </span>SFFromHandle    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A68A                 </span><span style="color:navy">call    </span>pJFNFromHandle
<span style="color:black">DOSCODE:A68D                 </span><span style="color:navy">jb      short </span>pJFNFromHandle_error
<span style="color:black">DOSCODE:A68F                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:A693                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GetSF
</span><span style="color:black">DOSCODE:A695                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:A697                 </span><span style="color:navy">jmp     short </span>ReturnCarry
<span style="color:black">DOSCODE:A699 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A699
DOSCODE:A699 </span><span style="color:gray">GetSF</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A699                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:A69A                 </span><span style="color:navy">mov     bl, es:[di]
</span><span style="color:black">DOSCODE:A69D                 </span><span style="color:navy">xor     bh, bh
</span><span style="color:black">DOSCODE:A69F                 </span><span style="color:navy">call    </span>SFFromSFN
<span style="color:black">DOSCODE:A6A2                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:A6A3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A6A3 </span>SFFromHandle    endp
<span style="color:black">DOSCODE:A6A3
DOSCODE:A6A4
DOSCODE:A6A4 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A6A4
DOSCODE:A6A4
DOSCODE:A6A4 </span>SFFromSFN       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6A4                 </span><span style="color:navy">mov     es, cs:</span>DosDSeg
<span style="color:black">DOSCODE:A6A9                 </span><span style="color:navy">les     di, es:</span>SFT_ADDR
<span style="color:black">DOSCODE:A6AE
DOSCODE:A6AE </span><span style="color:gray">sfsfn5</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6AE                 </span><span style="color:navy">cmp     bx, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A6B2                 </span><span style="color:navy">jb      short </span><span style="color:gray">sfsfn7
</span><span style="color:black">DOSCODE:A6B4                 </span><span style="color:navy">sub     bx, es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A6B8                 </span><span style="color:navy">les     di, es:[di]
</span><span style="color:black">DOSCODE:A6BB                 </span><span style="color:navy">cmp     di, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:A6BE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">sfsfn5
</span><span style="color:black">DOSCODE:A6C0                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:A6C1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A6C2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A6C2
DOSCODE:A6C2 </span><span style="color:gray">sfsfn7</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6C2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A6C3                 </span><span style="color:navy">mov     ax, </span><span style="color:green">59
</span><span style="color:black">DOSCODE:A6C6                 </span><span style="color:navy">mul     bl
</span><span style="color:black">DOSCODE:A6C8                 </span><span style="color:navy">add     di, ax
</span><span style="color:black">DOSCODE:A6CA                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A6CB                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:A6CE                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A6CE </span>SFFromSFN       endp
<span style="color:black">DOSCODE:A6CE
DOSCODE:A6CF
DOSCODE:A6CF </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A6CF
DOSCODE:A6CF
DOSCODE:A6CF </span>JFNFree         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6CF                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:A6D1
DOSCODE:A6D1 </span><span style="color:gray">jfnf1</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6D1                 </span><span style="color:navy">call    </span>pJFNFromHandle
<span style="color:black">DOSCODE:A6D4                 </span><span style="color:navy">jb      short </span><span style="color:gray">jfnf5
</span><span style="color:black">DOSCODE:A6D6                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:A6DA                 </span><span style="color:navy">jz      short </span><span style="color:gray">jfnfx
</span><span style="color:black">DOSCODE:A6DC                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:A6DD                 </span><span style="color:navy">jmp     short </span><span style="color:gray">jfnf1
</span><span style="color:black">DOSCODE:A6DF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A6DF
DOSCODE:A6DF </span><span style="color:gray">jfnf5</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6DF                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:A6E1
DOSCODE:A6E1 </span><span style="color:gray">jfnfx</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6E1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A6E1 </span>JFNFree         endp
<span style="color:black">DOSCODE:A6E1
DOSCODE:A6E2
DOSCODE:A6E2 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A6E2
DOSCODE:A6E2
DOSCODE:A6E2 </span>SFNFree         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6E2                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A6E3                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:A6E5
DOSCODE:A6E5 </span><span style="color:gray">sfnf5</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6E5                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:A6E6                 </span><span style="color:navy">call    </span>SFFromSFN
<span style="color:black">DOSCODE:A6E9                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:A6EA                 </span><span style="color:navy">jb      short </span><span style="color:gray">sfnf95
</span><span style="color:black">DOSCODE:A6EC                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:A6F0                 </span><span style="color:navy">jz      short </span><span style="color:gray">sfnf20
</span><span style="color:black">DOSCODE:A6F2                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:A6F6                 </span><span style="color:navy">jz      short </span><span style="color:gray">sfnf10
</span><span style="color:black">DOSCODE:A6F8
DOSCODE:A6F8 </span><span style="color:gray">sfnf7</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6F8                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:A6F9                 </span><span style="color:navy">jmp     short </span><span style="color:gray">sfnf5
</span><span style="color:black">DOSCODE:A6FB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A6FB
DOSCODE:A6FB </span><span style="color:gray">sfnf10</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A6FB                 </span><span style="color:navy">mov     ax, ss:</span>USER_ID
<span style="color:black">DOSCODE:A6FF                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">2Fh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:A703                 </span><span style="color:navy">jnz     short </span><span style="color:gray">sfnf7
</span><span style="color:black">DOSCODE:A705                 </span><span style="color:navy">mov     ax, ss:</span>PROC_ID
<span style="color:black">DOSCODE:A709                 </span><span style="color:navy">cmp     es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:A70D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">sfnf7
</span><span style="color:black">DOSCODE:A70F
DOSCODE:A70F </span><span style="color:gray">sfnf20</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A70F                 </span><span style="color:navy">mov     word ptr es:[di], </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:A714                 </span><span style="color:navy">mov     ax, ss:</span>USER_ID
<span style="color:black">DOSCODE:A718                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">2Fh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:A71C                 </span><span style="color:navy">mov     ax, ss:</span>PROC_ID
<span style="color:black">DOSCODE:A720                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">31h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:A724                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A725                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:A726                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A727 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A727
DOSCODE:A727 </span><span style="color:gray">sfnf95</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A727                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A728                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:A72A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A72A </span>SFNFree         endp
<span style="color:black">DOSCODE:A72A
DOSCODE:A72B
DOSCODE:A72B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A72B
DOSCODE:A72B
DOSCODE:A72B </span>$CLOSE          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A72B                 </span><span style="color:navy">call    </span>CheckOwner
<span style="color:black">DOSCODE:A72E                 </span><span style="color:navy">jb      short </span>CloseError
<span style="color:black">DOSCODE:A730                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:A731                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A732                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:A736                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:A73A                 </span><span style="color:navy">cmp     word ptr es:[di], </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A73E                 </span><span style="color:navy">jz      short </span><span style="color:gray">FreeJFN
</span><span style="color:black">DOSCODE:A740                 </span><span style="color:navy">mov     al, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A744                 </span><span style="color:navy">and     al, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:A746                 </span><span style="color:navy">cmp     al, </span><span style="color:green">70h
</span><span style="color:black">DOSCODE:A748                 </span><span style="color:navy">jz      short </span><span style="color:gray">PostFree
</span><span style="color:black">DOSCODE:A74A
DOSCODE:A74A </span><span style="color:gray">FreeJFN</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A74A                 </span><span style="color:navy">call    </span>pJFNFromHandle
<span style="color:black">DOSCODE:A74D                 </span><span style="color:navy">mov     byte ptr es:[di], </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:A751
DOSCODE:A751 </span><span style="color:gray">PostFree</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A751                 </span><span style="color:navy">call    </span>DOS_CLOSE
<span style="color:black">DOSCODE:A754                 </span><span style="color:navy">jb      short </span>CloseError
<span style="color:black">DOSCODE:A756                 </span><span style="color:navy">mov     ah, </span><span style="color:green">3Eh
</span><span style="color:black">DOSCODE:A758
DOSCODE:A758 </span>Close_OK<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A758                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:A75B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A75B
DOSCODE:A75B </span>CloseError<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A75B                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:A75B </span>$CLOSE          endp
<span style="color:black">DOSCODE:A75B
</span><span style="color:maroon">DOSCODE:A75E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A75E
DOSCODE:A75E </span>$COMMIT<span style="color:navy">:                                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A75E                 </span><span style="color:navy">call    </span>CheckOwner
<span style="color:maroon">DOSCODE:A761                 </span><span style="color:navy">jb      short </span>CommitError
<span style="color:maroon">DOSCODE:A763                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:A764                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:A765                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">, di
</span><span style="color:maroon">DOSCODE:A769                 </span><span style="color:navy">mov     word ptr </span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:A76D                 </span><span style="color:navy">call    </span>DOS_COMMIT
<span style="color:maroon">DOSCODE:A770                 </span><span style="color:navy">jb      short </span>CommitError
<span style="color:maroon">DOSCODE:A772                 </span><span style="color:navy">mov     ah, </span><span style="color:green">68h
</span><span style="color:black">DOSCODE:A774 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $READ
</span><span style="color:black">DOSCODE:A774
DOSCODE:A774 </span><span style="color:gray">Commit_OK</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A774                 </span><span style="color:navy">jmp     short </span>Close_OK
<span style="color:black">DOSCODE:A776 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A776
DOSCODE:A776 </span>CommitError<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A776                 </span><span style="color:navy">jmp     short </span>CloseError
<span style="color:black">DOSCODE:A776 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $READ
</span><span style="color:maroon">DOSCODE:A778 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A778
DOSCODE:A778 </span>$ExtHandle<span style="color:navy">:                             </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A778                 </span><span style="color:navy">xor     bp, bp
</span><span style="color:maroon">DOSCODE:A77A                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">20
</span><span style="color:maroon">DOSCODE:A77D                 </span><span style="color:navy">jnb     short </span>exth2
<span style="color:maroon">DOSCODE:A77F                 </span><span style="color:navy">mov     bx, </span><span style="color:green">20          </span>; FILPERPROC
<span style="color:maroon">DOSCODE:A782
DOSCODE:A782 </span>exth2<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A782                 </span><span style="color:navy">mov     es, ss:</span>CurrentPDB
<span style="color:maroon">DOSCODE:A787                 </span><span style="color:navy">mov     cx, </span>word ptr es:32h ; [ES:PDB.JFN_Length]
<span style="color:maroon">DOSCODE:A78C                 </span><span style="color:navy">cmp     bx, cx
</span><span style="color:maroon">DOSCODE:A78E                 </span><span style="color:navy">jz      short </span>ok_done
<span style="color:maroon">DOSCODE:A790                 </span><span style="color:navy">ja      short </span>larger
<span style="color:maroon">DOSCODE:A792                 </span><span style="color:navy">mov     bp, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A795                 </span><span style="color:navy">mov     ds, </span>word ptr es:36h ; [ES:PDB.JFN_Pointer+2]
<span style="color:maroon">DOSCODE:A79A                 </span><span style="color:navy">mov     si, bx
</span><span style="color:maroon">DOSCODE:A79C                 </span><span style="color:navy">sub     cx, bx
</span><span style="color:maroon">DOSCODE:A79E
DOSCODE:A79E </span>chck_handles<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A79E                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:A7A1                 </span><span style="color:navy">jnz     short </span>too_many_files
<span style="color:maroon">DOSCODE:A7A3                 </span><span style="color:navy">inc     si
</span><span style="color:maroon">DOSCODE:A7A4                 </span><span style="color:navy">loop    </span>chck_handles
<span style="color:maroon">DOSCODE:A7A6                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">20
</span><span style="color:maroon">DOSCODE:A7A9                 </span><span style="color:navy">ja      short </span>larger
<span style="color:maroon">DOSCODE:A7AB                 </span><span style="color:navy">mov     bp, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:A7AE                 </span><span style="color:navy">mov     di, </span><span style="color:green">24          </span>; PDB.JFN_TABLE
<span style="color:maroon">DOSCODE:A7B1                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:A7B2                 </span><span style="color:navy">jmp     short </span>movhandl
<span style="color:maroon">DOSCODE:A7B4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A7B4
DOSCODE:A7B4 </span>larger<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A7B4                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:A7B7                 </span><span style="color:navy">jz      short </span>invalid_func
<span style="color:maroon">DOSCODE:A7B9                 </span><span style="color:navy">clc
</span><span style="color:maroon">DOSCODE:A7BA                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:A7BB                 </span><span style="color:navy">add     bx, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:A7BE                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:A7C0                 </span><span style="color:navy">rcr     bx, cl
</span><span style="color:maroon">DOSCODE:A7C2                 </span><span style="color:navy">and     bx, </span><span style="color:green">1FFFh
</span><span style="color:maroon">DOSCODE:A7C6                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:A7C7                 </span><span style="color:navy">call    </span>$ALLOC
<span style="color:maroon">DOSCODE:A7CA                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:A7CB                 </span><span style="color:navy">jb      short </span>no_memory
<span style="color:maroon">DOSCODE:A7CD                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:A7CF                 </span><span style="color:navy">xor     di, di
</span><span style="color:maroon">DOSCODE:A7D1
DOSCODE:A7D1 </span>movhandl<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A7D1                 </span><span style="color:navy">mov     ds, ss:</span>CurrentPDB
<span style="color:maroon">DOSCODE:A7D6                 </span><span style="color:navy">test    bp, </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:A7DA                 </span><span style="color:navy">jz      short </span>enlarge
<span style="color:maroon">DOSCODE:A7DC                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:A7DD                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:A7DE                 </span><span style="color:navy">jmp     short </span>copy_hand
<span style="color:black">DOSCODE:A7E0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A7E0 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $READ
</span><span style="color:black">DOSCODE:A7E0
DOSCODE:A7E0 </span>ok_done<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A7E0                 </span><span style="color:navy">jmp     short </span><span style="color:gray">Commit_OK
</span><span style="color:black">DOSCODE:A7E0 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $READ
</span><span style="color:maroon">DOSCODE:A7E2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A7E2
DOSCODE:A7E2 </span>too_many_files<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A7E2                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:A7E4 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $READ
</span><span style="color:black">DOSCODE:A7E4
DOSCODE:A7E4 </span><span style="color:gray">CommitErrorj</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A7E4                 </span><span style="color:navy">jmp     short </span>CommitError
<span style="color:black">DOSCODE:A7E4 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $READ
</span><span style="color:maroon">DOSCODE:A7E6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A7E6
DOSCODE:A7E6 </span>enlarge<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A7E6                 </span><span style="color:navy">mov     cx, </span>word ptr ds:32h ; [PDB.JFN_Length]
<span style="color:maroon">DOSCODE:A7EA
DOSCODE:A7EA </span>copy_hand<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A7EA                 </span><span style="color:navy">mov     dx, cx
</span><span style="color:maroon">DOSCODE:A7EC                 </span><span style="color:navy">lds     si, </span>ds:34h
<span style="color:maroon">DOSCODE:A7F0                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:A7F2                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:A7F3                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:A7F4                 </span><span style="color:navy">sub     cx, dx
</span><span style="color:maroon">DOSCODE:A7F6                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:A7F8                 </span><span style="color:navy">rep stosb
</span><span style="color:maroon">DOSCODE:A7FA                 </span><span style="color:navy">mov     ds, ss:</span>CurrentPDB
<span style="color:maroon">DOSCODE:A7FF                 </span><span style="color:navy">cmp     </span>word ptr ds:34h<span style="color:navy">, </span><span style="color:#ff8000">0 </span>; [PDB.JFN_Pointer]
<span style="color:maroon">DOSCODE:A804                 </span><span style="color:navy">jnz     short </span>update_info
<span style="color:maroon">DOSCODE:A806                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:A807                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:A808                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:A809                 </span><span style="color:navy">mov     es, </span>word ptr ds:36h ; [PDB.JFN_Pointer+2]
<span style="color:maroon">DOSCODE:A80D                 </span><span style="color:navy">call    </span>$DEALLOC
<span style="color:maroon">DOSCODE:A810                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:A811                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:A812                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:A813
DOSCODE:A813 </span>update_info<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A813                 </span><span style="color:navy">test    bp, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:A817                 </span><span style="color:navy">jz      short </span>non_psp
<span style="color:maroon">DOSCODE:A819                 </span><span style="color:navy">mov     </span>word ptr ds:34h<span style="color:navy">, </span><span style="color:green">18h </span>; 24
<span style="color:maroon">DOSCODE:A81F                 </span><span style="color:navy">jmp     short </span>final
<span style="color:maroon">DOSCODE:A821 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A821
DOSCODE:A821 </span>non_psp<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A821                 </span><span style="color:navy">mov     </span>word ptr ds:34h<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:A827
DOSCODE:A827 </span>final<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A827                 </span><span style="color:navy">mov     </span>word ptr ds:36h<span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:A82B                 </span><span style="color:navy">pop     </span>word ptr ds:32h
<span style="color:black">DOSCODE:A82F </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $READ
</span><span style="color:black">DOSCODE:A82F
DOSCODE:A82F </span><span style="color:gray">ExtHandle_OK</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A82F                 </span><span style="color:navy">jmp     short </span>ok_done
<span style="color:black">DOSCODE:A82F </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $READ
</span><span style="color:maroon">DOSCODE:A831 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A831
DOSCODE:A831 </span>no_memory<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A831                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A832                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">8
</span><span style="color:black">DOSCODE:A834 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $READ
</span><span style="color:black">DOSCODE:A834
DOSCODE:A834 </span><span style="color:gray">jmp_to_jmp_CommitError</span><span style="color:navy">:                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A834                 </span><span style="color:navy">jmp     short </span><span style="color:gray">CommitErrorj
</span><span style="color:black">DOSCODE:A834 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $READ
</span><span style="color:maroon">DOSCODE:A836 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A836
DOSCODE:A836 </span>invalid_func<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A836                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A838 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $READ
</span><span style="color:black">DOSCODE:A838
DOSCODE:A838 </span><span style="color:gray">ExtHandle_err</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A838                 </span><span style="color:navy">jmp     short </span><span style="color:gray">jmp_to_jmp_CommitError
</span><span style="color:black">DOSCODE:A838 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $READ
</span><span style="color:black">DOSCODE:A83A
DOSCODE:A83A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A83A
DOSCODE:A83A
DOSCODE:A83A </span>$READ           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A83A
DOSCODE:A83A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A774 SIZE 00000004 BYTES
</span><span style="color:black">DOSCODE:A83A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A7E0 SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:A83A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A7E4 SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:A83A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A82F SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:A83A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A834 SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:A83A </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:A838 SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:A83A
DOSCODE:A83A                 </span><span style="color:navy">mov     si, offset </span>DOS_READ
<span style="color:black">DOSCODE:A83D
DOSCODE:A83D </span>ReadDo<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A83D                 </span><span style="color:navy">call    </span>pJFNFromHandle
<span style="color:black">DOSCODE:A840                 </span><span style="color:navy">jb      short </span>ReadError
<span style="color:black">DOSCODE:A842                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:A845                 </span><span style="color:navy">call    </span>CheckOwner
<span style="color:black">DOSCODE:A848                 </span><span style="color:navy">jnb     short </span><span style="color:gray">ReadSetup
</span><span style="color:black">DOSCODE:A84A
DOSCODE:A84A </span>ReadError<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A84A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ExtHandle_err
</span><span style="color:black">DOSCODE:A84C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A84C
DOSCODE:A84C </span><span style="color:gray">ReadSetup</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A84C                 </span><span style="color:navy">mov     word ptr ss:</span>THISSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:A851                 </span><span style="color:navy">mov     word ptr ss:</span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:A856                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:A85B                 </span><span style="color:navy">jz      short </span><span style="color:gray">needi24
</span><span style="color:black">DOSCODE:A85D                 </span><span style="color:navy">or      ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:A863
DOSCODE:A863 </span><span style="color:gray">needi24</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A863                 </span><span style="color:navy">push    word ptr ss:</span>DMAADD
<span style="color:black">DOSCODE:A868                 </span><span style="color:navy">push    word ptr ss:</span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:A86D                 </span><span style="color:navy">call    </span>Align_Buffer
<span style="color:black">DOSCODE:A870                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:A871                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:A872                 </span><span style="color:navy">call    si
</span><span style="color:black">DOSCODE:A874                 </span><span style="color:navy">pop     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:A878                 </span><span style="color:navy">pop     word ptr </span>DMAADD
<span style="color:black">DOSCODE:A87C                 </span><span style="color:navy">jnb     short </span><span style="color:gray">READ_OK
</span><span style="color:black">DOSCODE:A87E                 </span><span style="color:navy">jmp     short </span>ReadError
<span style="color:black">DOSCODE:A880 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A880
DOSCODE:A880 </span><span style="color:gray">READ_OK</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A880                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:black">DOSCODE:A882
DOSCODE:A882 </span>Read_OK_j<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A882                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ExtHandle_OK
</span><span style="color:black">DOSCODE:A882 </span>$READ           endp
<span style="color:black">DOSCODE:A882
DOSCODE:A884
DOSCODE:A884 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A884
DOSCODE:A884
DOSCODE:A884 </span>Align_Buffer    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A884                 </span><span style="color:navy">mov     bx, dx
</span><span style="color:black">DOSCODE:A886                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:A887                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:black">DOSCODE:A889                 </span><span style="color:navy">shr     bx, cl
</span><span style="color:black">DOSCODE:A88B                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:A88C                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:black">DOSCODE:A88E                 </span><span style="color:navy">add     ax, bx
</span><span style="color:black">DOSCODE:A890                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:A892                 </span><span style="color:navy">and     dx, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:A895                 </span><span style="color:navy">mov     word ptr ss:</span>DMAADD<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:A89A                 </span><span style="color:navy">mov     word ptr ss:</span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:A89F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A89F </span>Align_Buffer    endp
<span style="color:black">DOSCODE:A89F
</span><span style="color:maroon">DOSCODE:A8A0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A8A0
DOSCODE:A8A0 </span>$WRITE<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A8A0                 </span><span style="color:navy">mov     si, offset </span>DOS_WRITE
<span style="color:maroon">DOSCODE:A8A3                 </span><span style="color:navy">jmp     short </span>ReadDo
<span style="color:black">DOSCODE:A8A5
DOSCODE:A8A5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A8A5
DOSCODE:A8A5
DOSCODE:A8A5 </span>$LSEEK          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8A5                 </span><span style="color:navy">call    </span>CheckOwner
<span style="color:black">DOSCODE:A8A8
DOSCODE:A8A8 </span>LSeekError<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8A8                 </span><span style="color:navy">jnb     short </span><span style="color:gray">CHKOWN_OK
</span><span style="color:black">DOSCODE:A8AA                 </span><span style="color:navy">jmp     short </span>ReadError
<span style="color:black">DOSCODE:A8AC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A8AC
DOSCODE:A8AC </span><span style="color:gray">CHKOWN_OK</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8AC                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:A8AE                 </span><span style="color:navy">jbe     short </span><span style="color:gray">LSeekDisp
</span><span style="color:black">DOSCODE:A8B0                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A8B6                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A8B8
DOSCODE:A8B8 </span><span style="color:gray">jmp_to_ReadError</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8B8                 </span><span style="color:navy">jmp     short </span>ReadError
<span style="color:black">DOSCODE:A8BA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A8BA
DOSCODE:A8BA </span><span style="color:gray">LSeekDisp</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8BA                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:A8BC                 </span><span style="color:navy">jb      short </span><span style="color:gray">LSeekStore
</span><span style="color:black">DOSCODE:A8BE                 </span><span style="color:navy">ja      short </span><span style="color:gray">LSeekEOF
</span><span style="color:black">DOSCODE:A8C0                 </span><span style="color:navy">add     dx, es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A8C4                 </span><span style="color:navy">adc     cx, es:[di+</span><span style="color:#ff8000">17h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A8C8
DOSCODE:A8C8 </span><span style="color:gray">LSeekStore</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8C8                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:black">DOSCODE:A8CA                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:black">DOSCODE:A8CB
DOSCODE:A8CB </span><span style="color:gray">LSeekSetpos</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8CB                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">15h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:A8CF                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">17h</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:A8D3                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:A8D6                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:black">DOSCODE:A8D9
DOSCODE:A8D9 </span>jmp_to_Read_OK_j<span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8D9                 </span><span style="color:navy">jmp     short </span>Read_OK_j
<span style="color:black">DOSCODE:A8DB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A8DB
DOSCODE:A8DB </span><span style="color:gray">LSeekEOF</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8DB                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:A8E0                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Check_LSeek_Mode
</span><span style="color:black">DOSCODE:A8E2
DOSCODE:A8E2 </span><span style="color:gray">LOCAL_LSeek</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8E2                 </span><span style="color:navy">add     dx, es:[di+</span><span style="color:#ff8000">11h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A8E6                 </span><span style="color:navy">adc     cx, es:[di+</span><span style="color:#ff8000">13h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A8EA                 </span><span style="color:navy">jmp     short </span><span style="color:gray">LSeekStore
</span><span style="color:black">DOSCODE:A8EC </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A8EC
DOSCODE:A8EC </span><span style="color:gray">Check_LSeek_Mode</span><span style="color:navy">:                       </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A8EC                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">3</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:A8F1                 </span><span style="color:navy">jnz     short </span><span style="color:gray">LOCAL_LSeek
</span><span style="color:black">DOSCODE:A8F3                 </span><span style="color:navy">mov     ax, es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A8F7                 </span><span style="color:navy">and     ax, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:A8FA                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:A8FD                 </span><span style="color:navy">jz      short </span><span style="color:gray">NET_LSEEK
</span><span style="color:black">DOSCODE:A8FF                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">30h
</span><span style="color:black">DOSCODE:A902                 </span><span style="color:navy">jnz     short </span><span style="color:gray">LOCAL_LSeek
</span><span style="color:black">DOSCODE:A904
DOSCODE:A904 </span><span style="color:gray">NET_LSEEK</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A904                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1121h
</span><span style="color:black">DOSCODE:A907                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - SEEK FROM END OF REMOTE FILE
<span style="color:black">DOSCODE:A907                                         </span>; CX:DX = offset (in bytes) from end
<span style="color:black">DOSCODE:A907                                         </span>; ES:DI -&gt; SFT, SFT DPB field -&gt; DPB of drive with file
<span style="color:black">DOSCODE:A907                                         </span>; SS = DOS CS
<span style="color:black">DOSCODE:A907                                         </span>; Return: CF set on error
<span style="color:black">DOSCODE:A907                                         </span>; CF clear if successful, DX:AX = new file position
<span style="color:black">DOSCODE:A909                 </span><span style="color:navy">jnb     short </span><span style="color:gray">LSeekSetpos
</span><span style="color:black">DOSCODE:A90B
DOSCODE:A90B </span>jmp_to_jmp_ReadError<span style="color:navy">:                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A90B                 </span><span style="color:navy">jmp     short </span><span style="color:gray">jmp_to_ReadError
</span><span style="color:black">DOSCODE:A90B </span>$LSEEK          endp
<span style="color:black">DOSCODE:A90B
</span><span style="color:maroon">DOSCODE:A90D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A90D
DOSCODE:A90D </span>$FILE_TIMES<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A90D                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:A90F                 </span><span style="color:navy">jnb     short </span>inval_func
<span style="color:maroon">DOSCODE:A911                 </span><span style="color:navy">call    </span>CheckOwner
<span style="color:maroon">DOSCODE:A914                 </span><span style="color:navy">jb      short </span>LSeekError
<span style="color:maroon">DOSCODE:A916                 </span><span style="color:navy">or      al, al
</span><span style="color:maroon">DOSCODE:A918                 </span><span style="color:navy">jnz     short </span>ft_set_time
<span style="color:maroon">DOSCODE:A91A                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:A91B                 </span><span style="color:navy">mov     cx, es:[di+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A91F                 </span><span style="color:navy">mov     dx, es:[di+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:A923                 </span><span style="color:navy">sti
</span><span style="color:maroon">DOSCODE:A924                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:A927                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:A92A                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">6</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:A92D                 </span><span style="color:navy">jmp     short </span>ok_ret
<span style="color:maroon">DOSCODE:A92F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A92F
DOSCODE:A92F </span>ft_set_time<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A92F                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:A932                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:A936                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Fh</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:A93A                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:A93C                 </span><span style="color:navy">call    ss:</span>ShSU
<span style="color:maroon">DOSCODE:A941                 </span><span style="color:navy">and     word ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">0FFBFh
</span><span style="color:maroon">DOSCODE:A946                 </span><span style="color:navy">or      word ptr es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], </span><span style="color:green">4000h
</span><span style="color:maroon">DOSCODE:A94C                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:A94F
DOSCODE:A94F </span>ok_ret<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A94F                 </span><span style="color:navy">jmp     short </span>jmp_to_Read_OK_j
<span style="color:maroon">DOSCODE:A951 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A951
DOSCODE:A951 </span>inval_func<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A951                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A957                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:A959
DOSCODE:A959 </span>jmp3_to_ReadError<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A959                 </span><span style="color:navy">jmp     short </span>jmp_to_jmp_ReadError
<span style="color:maroon">DOSCODE:A95B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A95B
DOSCODE:A95B </span>$DUP<span style="color:navy">:                                   </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A95B                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:maroon">DOSCODE:A95D                 </span><span style="color:navy">call    </span>JFNFree
<span style="color:maroon">DOSCODE:A960
DOSCODE:A960 </span>DupErrorCheck<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A960                 </span><span style="color:navy">jb      short </span>DupErr
<span style="color:maroon">DOSCODE:A962                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:A963                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:A964                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:A965                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:A966                 </span><span style="color:navy">xchg    ax, bx
</span><span style="color:maroon">DOSCODE:A967                 </span><span style="color:navy">call    </span>CheckOwner
<span style="color:maroon">DOSCODE:A96A                 </span><span style="color:navy">jb      short </span>DupErr
<span style="color:maroon">DOSCODE:A96C                 </span><span style="color:navy">call    </span>DOS_Dup_Direct
<span style="color:maroon">DOSCODE:A96F                 </span><span style="color:navy">call    </span>pJFNFromHandle
<span style="color:maroon">DOSCODE:A972                 </span><span style="color:navy">mov     bl, es:[di]
</span><span style="color:maroon">DOSCODE:A975                 </span><span style="color:navy">mov     [si], bl
</span><span style="color:maroon">DOSCODE:A977                 </span><span style="color:navy">jmp     short </span>ok_ret
<span style="color:maroon">DOSCODE:A979 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A979
DOSCODE:A979 </span>DupErr<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A979                 </span><span style="color:navy">jmp     short </span>jmp3_to_ReadError
<span style="color:maroon">DOSCODE:A97B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A97B
DOSCODE:A97B </span>$DUP2<span style="color:navy">:                                  </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A97B                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:A97C                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:A97D                 </span><span style="color:navy">mov     bx, cx
</span><span style="color:maroon">DOSCODE:A97F                 </span><span style="color:navy">call    </span>$CLOSE
<span style="color:maroon">DOSCODE:A982                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A983                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:A984                 </span><span style="color:navy">call    </span>pJFNFromHandle
<span style="color:maroon">DOSCODE:A987                 </span><span style="color:navy">jmp     short </span>DupErrorCheck
<span style="color:black">DOSCODE:A989
DOSCODE:A989 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A989
DOSCODE:A989
DOSCODE:A989 </span>CheckOwner      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A989                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:black">DOSCODE:A98C                 </span><span style="color:navy">jb      short </span><span style="color:gray">co_ret_label
</span><span style="color:black">DOSCODE:A98E                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A98F                 </span><span style="color:navy">test    ss:</span>IsWin386<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:A995                 </span><span style="color:navy">jz      short </span><span style="color:gray">no_win386
</span><span style="color:black">DOSCODE:A997                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:A999                 </span><span style="color:navy">jmp     short </span><span style="color:gray">_skip_win386
</span><span style="color:black">DOSCODE:A99B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A99B
DOSCODE:A99B </span><span style="color:gray">no_win386</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A99B                 </span><span style="color:navy">mov     ax, ss:</span>USER_ID
<span style="color:black">DOSCODE:A99F                 </span><span style="color:navy">cmp     ax, es:[di+</span><span style="color:green">47</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A9A3
DOSCODE:A9A3 </span><span style="color:gray">_skip_win386</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9A3                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:A9A4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CheckOwner_err
</span><span style="color:black">DOSCODE:A9A6                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A9A7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A9A7
DOSCODE:A9A7 </span><span style="color:gray">CheckOwner_err</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9A7                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:A9A9                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:A9AA
DOSCODE:A9AA </span><span style="color:gray">co_ret_label</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9AA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A9AA </span>CheckOwner      endp
<span style="color:black">DOSCODE:A9AA
</span><span style="color:maroon">DOSCODE:A9AB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A9AB
DOSCODE:A9AB </span>$AssignOper<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:A9AB                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:A9AD                 </span><span style="color:navy">jnz     short </span>chk08
<span style="color:maroon">DOSCODE:A9AF
DOSCODE:A9AF </span>srinuse<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A9AF                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:A9B0                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:A9B2                 </span><span style="color:navy">call    </span>GetCDSFromDrv
<span style="color:maroon">DOSCODE:A9B5                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:A9B6                 </span><span style="color:navy">jb      short </span>baddrv
<span style="color:maroon">DOSCODE:A9B8                 </span><span style="color:navy">cmp     word ptr [si+</span><span style="color:#ff8000">45h</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:A9BC                 </span><span style="color:navy">jz      short </span>baddrv
<span style="color:maroon">DOSCODE:A9BE                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">7
</span><span style="color:maroon">DOSCODE:A9C0                 </span><span style="color:navy">jnz     short </span>resetdrv
<span style="color:maroon">DOSCODE:A9C2                 </span><span style="color:navy">or      word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">4000h
</span><span style="color:maroon">DOSCODE:A9C7                 </span><span style="color:navy">jmp     short </span>okdone
<span style="color:maroon">DOSCODE:A9C9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A9C9
DOSCODE:A9C9 </span>resetdrv<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A9C9                 </span><span style="color:navy">and     word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">0BFFFh
</span><span style="color:maroon">DOSCODE:A9CE                 </span><span style="color:navy">jmp     short </span>okdone
<span style="color:maroon">DOSCODE:A9D0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A9D0
DOSCODE:A9D0 </span>baddrv<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A9D0                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:A9D3                 </span><span style="color:navy">jmp     short </span>ASS_ERR
<span style="color:maroon">DOSCODE:A9D5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A9D5
DOSCODE:A9D5 </span>chk08<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A9D5                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">8
</span><span style="color:maroon">DOSCODE:A9D7                 </span><span style="color:navy">jz      short </span>srinuse
<span style="color:maroon">DOSCODE:A9D9                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:A9DA                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">111Eh
</span><span style="color:maroon">DOSCODE:A9DD                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - DO REDIRECTION
<span style="color:maroon">DOSCODE:A9DD                                         </span>; SS = DOS CS
<span style="color:maroon">DOSCODE:A9DD                                         </span>; STACK: WORD function to execute
<span style="color:maroon">DOSCODE:A9DD                                         </span>; Return: CF set on error, AX = error code
<span style="color:maroon">DOSCODE:A9DD                                         </span>; STACK unchanged
<span style="color:maroon">DOSCODE:A9DF                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:A9E0                 </span><span style="color:navy">jb      short </span>ASS_ERR
<span style="color:maroon">DOSCODE:A9E2
DOSCODE:A9E2 </span>okdone<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A9E2                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:A9E5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:A9E5
DOSCODE:A9E5 </span>ASS_ERR<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:A9E5                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:A9E8
DOSCODE:A9E8 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A9E8
DOSCODE:A9E8
DOSCODE:A9E8 </span>FIND_DPB        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9E8                 </span><span style="color:navy">lds     si, ss:</span>DPBHEAD
<span style="color:black">DOSCODE:A9ED
DOSCODE:A9ED </span><span style="color:gray">fdpb5</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9ED                 </span><span style="color:navy">cmp     si, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:A9F0                 </span><span style="color:navy">jz      short </span><span style="color:gray">fdpb10
</span><span style="color:black">DOSCODE:A9F2                 </span><span style="color:navy">cmp     al, [si]
</span><span style="color:black">DOSCODE:A9F4                 </span><span style="color:navy">jz      short </span><span style="color:gray">ret_label15
</span><span style="color:black">DOSCODE:A9F6                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">19h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:A9F9                 </span><span style="color:navy">jmp     short </span><span style="color:gray">fdpb5
</span><span style="color:black">DOSCODE:A9FB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:A9FB
DOSCODE:A9FB </span><span style="color:gray">fdpb10</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9FB                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:A9FC
DOSCODE:A9FC </span><span style="color:gray">ret_label15</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9FC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:A9FC </span>FIND_DPB        endp
<span style="color:black">DOSCODE:A9FC
DOSCODE:A9FD
DOSCODE:A9FD </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:A9FD
DOSCODE:A9FD
DOSCODE:A9FD </span>InitCDS         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:A9FD                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:A9FE                 </span><span style="color:navy">les     di, ss:</span>THISCDS
<span style="color:black">DOSCODE:AA03                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AA09                 </span><span style="color:navy">sub     al, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;
</span><span style="color:black">DOSCODE:AA0B                 </span><span style="color:navy">cmp     ss:</span>NUMIO<span style="color:navy">, al
</span><span style="color:black">DOSCODE:AA10                 </span><span style="color:navy">jb      short </span><span style="color:gray">icdsx
</span><span style="color:black">DOSCODE:AA12                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:AA13                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:AA14                 </span><span style="color:navy">add     al, &#039;</span><span style="color:green">A&#039;
</span><span style="color:black">DOSCODE:AA16                 </span><span style="color:navy">mov     ah, &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:AA18                 </span><span style="color:navy">mov     es:[di], ax
</span><span style="color:black">DOSCODE:AA1B                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">2</span><span style="color:navy">], &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:AA21                 </span><span style="color:navy">or      byte ptr es:[di+</span><span style="color:#ff8000">44h</span><span style="color:navy">], </span><span style="color:green">40h
</span><span style="color:black">DOSCODE:AA26                 </span><span style="color:navy">sub     ax, ax
</span><span style="color:black">DOSCODE:AA28                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">49h</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:AA2C                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">4Bh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:AA30                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:AA32                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">4Fh</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:AA36                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AA37                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AA38                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AA39                 </span><span style="color:navy">call    </span>FIND_DPB
<span style="color:black">DOSCODE:AA3C                 </span><span style="color:navy">jb      short </span><span style="color:gray">icds5
</span><span style="color:black">DOSCODE:AA3E                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">45h</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:AA42                 </span><span style="color:navy">mov     word ptr es:[di+</span><span style="color:#ff8000">47h</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:AA46
DOSCODE:AA46 </span><span style="color:gray">icds5</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AA46                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:AA47                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AA48
DOSCODE:AA48 </span><span style="color:gray">icdsx</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AA48                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AA49
DOSCODE:AA49 </span>RET45<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AA49                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AA49 </span>InitCDS         endp
<span style="color:black">DOSCODE:AA49
</span><span style="color:maroon">DOSCODE:AA4A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:AA4A
DOSCODE:AA4A </span>$UserOper<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:AA4A                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:AA4B                 </span><span style="color:navy">sub     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:AA4D                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:AA4E                 </span><span style="color:navy">jb      short </span>UserGet
<span style="color:maroon">DOSCODE:AA50                 </span><span style="color:navy">jz      short </span>UserSet
<span style="color:maroon">DOSCODE:AA52                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:AA54                 </span><span style="color:navy">jbe     short </span>UserPrint
<span style="color:maroon">DOSCODE:AA56                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:AA5C                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:AA5E
DOSCODE:AA5E </span>useroper_error<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AA5E                 </span><span style="color:navy">jmp     short </span>ASS_ERR
<span style="color:maroon">DOSCODE:AA60 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:AA60
DOSCODE:AA60 </span>UserGet<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AA60                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:AA61                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:AA62                 </span><span style="color:navy">mov     di, dx
</span><span style="color:maroon">DOSCODE:AA64                 </span><span style="color:navy">mov     cx, ss:</span>MYNUM
<span style="color:maroon">DOSCODE:AA69                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:AA6C                 </span><span style="color:navy">mov     [si+</span><span style="color:green">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:AA6F                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:AA70                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:AA71                 </span><span style="color:navy">mov     si, offset </span>MYNAME
<span style="color:maroon">DOSCODE:AA74
DOSCODE:AA74 </span>UserMove<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AA74                 </span><span style="color:navy">mov     cx, </span><span style="color:green">15
</span><span style="color:maroon">DOSCODE:AA77                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:AA79                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:AA7B                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:AA7C
DOSCODE:AA7C </span>UserBye<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AA7C                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:AA7F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:AA7F
DOSCODE:AA7F </span>UserSet<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AA7F                 </span><span style="color:navy">mov     ss:</span>MYNUM<span style="color:navy">, cx
</span><span style="color:maroon">DOSCODE:AA84                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:AA86                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:AA87                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:AA88                 </span><span style="color:navy">mov     di, offset </span>MYNAME
<span style="color:maroon">DOSCODE:AA8B                 </span><span style="color:navy">inc     ss:</span>DIFFNAM
<span style="color:maroon">DOSCODE:AA90                 </span><span style="color:navy">jmp     short </span>UserMove
<span style="color:maroon">DOSCODE:AA92 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:AA92
DOSCODE:AA92 </span>UserPrint<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AA92                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:AA93                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">111Fh
</span><span style="color:maroon">DOSCODE:AA96                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - PRINTER SETUP
<span style="color:maroon">DOSCODE:AA96                                         </span>; STACK: WORD function
<span style="color:maroon">DOSCODE:AA96                                         </span>; Return: CF set on error, AX = error code
<span style="color:maroon">DOSCODE:AA96                                         </span>; STACK unchanged
<span style="color:maroon">DOSCODE:AA98                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:AA99                 </span><span style="color:navy">jnb     short </span>OKPA
<span style="color:maroon">DOSCODE:AA9B                 </span><span style="color:navy">jmp     short </span>useroper_error
<span style="color:maroon">DOSCODE:AA9D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:AA9D
DOSCODE:AA9D </span>OKPA<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AA9D                 </span><span style="color:navy">jmp     short </span>UserBye
<span style="color:black">DOSCODE:AA9F
DOSCODE:AA9F </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AA9F
DOSCODE:AA9F
DOSCODE:AA9F </span>GetVisDrv       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AA9F                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:black">DOSCODE:AAA2                 </span><span style="color:navy">jb      short </span>RET45
<span style="color:black">DOSCODE:AAA4                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AAA5                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AAA6                 </span><span style="color:navy">lds     si, ss:</span>THISCDS
<span style="color:black">DOSCODE:AAAB                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">2000h
</span><span style="color:black">DOSCODE:AAB0                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:AAB1                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AAB2                 </span><span style="color:navy">jz      short </span>RET45
<span style="color:black">DOSCODE:AAB4                 </span><span style="color:navy">mov     ss:</span>DrvErr<span style="color:navy">, </span><span style="color:#ff8000">0Fh
</span><span style="color:black">DOSCODE:AABA                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AABB                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AABB </span>GetVisDrv       endp
<span style="color:black">DOSCODE:AABB
DOSCODE:AABC
DOSCODE:AABC </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AABC
DOSCODE:AABC
DOSCODE:AABC </span>GETTHISDRV      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AABC                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:AABE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GTD10
</span><span style="color:black">DOSCODE:AAC0                 </span><span style="color:navy">mov     al, ss:</span>CURDRV
<span style="color:black">DOSCODE:AAC4                 </span><span style="color:navy">inc     ax
</span><span style="color:black">DOSCODE:AAC5
DOSCODE:AAC5 </span><span style="color:gray">GTD10</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AAC5                 </span><span style="color:navy">dec     ax
</span><span style="color:black">DOSCODE:AAC6                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AAC7                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AAC8                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:AACE                 </span><span style="color:navy">test    ss:</span>FSHARING<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:AAD4                 </span><span style="color:navy">jz      short </span><span style="color:gray">GTD20
</span><span style="color:black">DOSCODE:AAD6                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:AAD7                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:AAD8                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:AAD9                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">, offset </span>DUMMYCDS
<span style="color:black">DOSCODE:AAE0                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ss
</span><span style="color:black">DOSCODE:AAE5                 </span><span style="color:navy">add     al, &#039;</span><span style="color:green">A&#039;
</span><span style="color:black">DOSCODE:AAE7                 </span><span style="color:navy">call    </span>InitCDS
<span style="color:black">DOSCODE:AAEA                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">4000h
</span><span style="color:black">DOSCODE:AAF0                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AAF1                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AAF2                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AAF3                 </span><span style="color:navy">jz      short </span><span style="color:gray">GTD30
</span><span style="color:black">DOSCODE:AAF5                 </span><span style="color:navy">jmp     short </span><span style="color:gray">GTDX
</span><span style="color:black">DOSCODE:AAF7 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AAF7
DOSCODE:AAF7 </span><span style="color:gray">GTD20</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AAF7                 </span><span style="color:navy">call    </span>GetCDSFromDrv
<span style="color:black">DOSCODE:AAFA                 </span><span style="color:navy">jb      short </span><span style="color:gray">GTD30
</span><span style="color:black">DOSCODE:AAFC                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">4000h
</span><span style="color:black">DOSCODE:AB01                 </span><span style="color:navy">jnz     short </span><span style="color:gray">GTDX
</span><span style="color:black">DOSCODE:AB03
DOSCODE:AB03 </span><span style="color:gray">GTD30</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB03                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0Fh
</span><span style="color:black">DOSCODE:AB05                 </span><span style="color:navy">mov     ss:</span>DrvErr<span style="color:navy">, al
</span><span style="color:black">DOSCODE:AB09                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:AB0F                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AB10
DOSCODE:AB10 </span><span style="color:gray">GTDX</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB10                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:AB11                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AB12                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AB12 </span>GETTHISDRV      endp
<span style="color:black">DOSCODE:AB12
DOSCODE:AB13
DOSCODE:AB13 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AB13
DOSCODE:AB13
DOSCODE:AB13 </span>GetCDSFromDrv   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB13                 </span><span style="color:navy">cmp     al, ss:</span>CDSCOUNT
<span style="color:black">DOSCODE:AB18                 </span><span style="color:navy">jb      short </span><span style="color:gray">GetCDS
</span><span style="color:black">DOSCODE:AB1A                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AB1B                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AB1C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AB1C
DOSCODE:AB1C </span><span style="color:gray">GetCDS</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB1C                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:AB1D                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:AB1E                 </span><span style="color:navy">lds     si, ss:</span>CDSADDR
<span style="color:black">DOSCODE:AB23                 </span><span style="color:navy">mov     bl, </span><span style="color:green">88
</span><span style="color:black">DOSCODE:AB25                 </span><span style="color:navy">mul     bl
</span><span style="color:black">DOSCODE:AB27                 </span><span style="color:navy">add     si, ax
</span><span style="color:black">DOSCODE:AB29                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">, si
</span><span style="color:black">DOSCODE:AB2E                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:black">DOSCODE:AB33                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AB34                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:AB35                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:AB36                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AB36 </span>GetCDSFromDrv   endp
<span style="color:black">DOSCODE:AB36
DOSCODE:AB37
DOSCODE:AB37 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AB37
DOSCODE:AB37 </span><span style="color:gray">; Attributes: bp-based frame
</span><span style="color:black">DOSCODE:AB37
DOSCODE:AB37 </span>TransFCB        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB37
DOSCODE:AB37 </span><span style="color:green">FCBTmp          </span><span style="color:navy">= byte ptr </span><span style="color:#008040">-10h
</span><span style="color:black">DOSCODE:AB37
DOSCODE:AB37                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:AB38                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:black">DOSCODE:AB3A                 </span><span style="color:navy">sub     sp, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:AB3D                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:AB3E                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AB3F                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:AB40                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:AB41                 </span><span style="color:navy">lea     di, [bp+</span><span style="color:green">FCBTmp</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AB44                 </span><span style="color:navy">mov     ss:</span>EXTFCB<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AB4A                 </span><span style="color:navy">mov     ss:</span>SATTRIB<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AB50                 </span><span style="color:navy">call    </span>GetExtended
<span style="color:black">DOSCODE:AB53                 </span><span style="color:navy">jz      short </span><span style="color:gray">GetDrive
</span><span style="color:black">DOSCODE:AB55                 </span><span style="color:navy">mov     al, [si-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AB58                 </span><span style="color:navy">mov     ss:</span>SATTRIB<span style="color:navy">, al
</span><span style="color:black">DOSCODE:AB5C                 </span><span style="color:navy">mov     ss:</span>EXTFCB<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:AB62
DOSCODE:AB62 </span><span style="color:gray">GetDrive</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB62                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:AB63                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:black">DOSCODE:AB66                 </span><span style="color:navy">jb      short </span><span style="color:gray">BadPack
</span><span style="color:black">DOSCODE:AB68                 </span><span style="color:navy">call    </span>TextFromDrive
<span style="color:black">DOSCODE:AB6B                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">0Bh
</span><span style="color:black">DOSCODE:AB6E                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AB6F
DOSCODE:AB6F </span><span style="color:gray">FCBScan</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB6F                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:AB70                 </span><span style="color:navy">call    </span>GetCharType
<span style="color:black">DOSCODE:AB73                 </span><span style="color:navy">test    al, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:AB75                 </span><span style="color:navy">jz      short </span><span style="color:gray">BadPack
</span><span style="color:black">DOSCODE:AB77                 </span><span style="color:navy">loop    </span><span style="color:gray">FCBScan
</span><span style="color:black">DOSCODE:AB79                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:AB7A                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:AB7C                 </span><span style="color:navy">call    </span>PackName
<span style="color:black">DOSCODE:AB7F                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AB80                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AB81                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:AB82                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AB83                 </span><span style="color:navy">lea     si, [bp+</span><span style="color:green">FCBTmp</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AB86                 </span><span style="color:navy">cmp     byte ptr [bx], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AB89                 </span><span style="color:navy">jz      short </span><span style="color:gray">BadPack
</span><span style="color:black">DOSCODE:AB8B                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:AB8C                 </span><span style="color:navy">call    </span>TransPathSet
<span style="color:black">DOSCODE:AB8F                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:AB90                 </span><span style="color:navy">jnb     short </span><span style="color:gray">FCBRet
</span><span style="color:black">DOSCODE:AB92
DOSCODE:AB92 </span><span style="color:gray">BadPack</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB92                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AB93                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:AB95
DOSCODE:AB95 </span><span style="color:gray">FCBRet</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB95                 </span><span style="color:navy">mov     sp, bp
</span><span style="color:black">DOSCODE:AB97                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:AB98
DOSCODE:AB98 </span>TransPath_retn<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB98                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AB98 </span>TransFCB        endp
<span style="color:black">DOSCODE:AB98
DOSCODE:AB99
DOSCODE:AB99 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AB99
DOSCODE:AB99
DOSCODE:AB99 </span>TransPath       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB99                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:AB9B                 </span><span style="color:navy">jmp     short </span>SetSplice
<span style="color:black">DOSCODE:AB9B </span>TransPath       endp
<span style="color:black">DOSCODE:AB9B
DOSCODE:AB9D
DOSCODE:AB9D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AB9D
DOSCODE:AB9D
DOSCODE:AB9D </span>TransPathSet    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB9D
DOSCODE:AB9D </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:AC6D SIZE 0000004E BYTES
</span><span style="color:black">DOSCODE:AB9D
DOSCODE:AB9D                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:AB9F
DOSCODE:AB9F </span>SetSplice<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AB9F                 </span><span style="color:navy">mov     ss:</span>NoSetDir<span style="color:navy">, al
</span><span style="color:black">DOSCODE:ABA3                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:ABA5
DOSCODE:ABA5 </span>TransPathNoSet<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ABA5                 </span><span style="color:navy">mov     ss:</span>FSPLICE<span style="color:navy">, al
</span><span style="color:black">DOSCODE:ABA9                 </span><span style="color:navy">mov     ss:</span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:ABAF                 </span><span style="color:navy">mov     ss:</span>WFP_START<span style="color:navy">, di
</span><span style="color:black">DOSCODE:ABB4                 </span><span style="color:navy">mov     ss:</span>CURR_DIR_END<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:ABBB                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:ABBC                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:ABBD                 </span><span style="color:navy">lea     bp, [di+</span><span style="color:green">134</span><span style="color:navy">]    </span>; lea bp,[di+TEMPLEN]
<span style="color:black">DOSCODE:ABC1                 </span><span style="color:navy">test    ss:</span>FSHARING<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:ABC7                 </span><span style="color:navy">jz      short </span><span style="color:gray">CheckUNC
</span><span style="color:black">DOSCODE:ABC9                 </span><span style="color:navy">call    </span>DriveFromText
<span style="color:black">DOSCODE:ABCC                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:black">DOSCODE:ABCF                 </span><span style="color:navy">jb      short </span><span style="color:gray">NoPath
</span><span style="color:black">DOSCODE:ABD1                 </span><span style="color:navy">call    </span>TextFromDrive
<span style="color:black">DOSCODE:ABD4                 </span><span style="color:navy">lea     bx, [di+</span><span style="color:#ff8000">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:ABD7                 </span><span style="color:navy">call    </span>Canonicalize
<span style="color:black">DOSCODE:ABDA                 </span><span style="color:navy">jb      short </span>TransPath_retn
<span style="color:black">DOSCODE:ABDC                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:ABDD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:ABDE                 </span><span style="color:navy">mov     si, </span>WFP_START
<span style="color:black">DOSCODE:ABE2                 </span><span style="color:navy">test    </span>FSPLICE<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:ABE7                 </span><span style="color:navy">jz      short </span><span style="color:gray">NoServerSplice
</span><span style="color:black">DOSCODE:ABE9                 </span><span style="color:navy">call    </span>Splice
<span style="color:black">DOSCODE:ABEC
DOSCODE:ABEC </span><span style="color:gray">NoServerSplice</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ABEC                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:ABED                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:ABEE                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:black">DOSCODE:ABF2                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:black">DOSCODE:ABF5                 </span><span style="color:navy">call    </span>FATREAD_CDS
<span style="color:black">DOSCODE:ABF8                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:black">DOSCODE:ABFB
DOSCODE:ABFB </span><span style="color:gray">NoPath</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ABFB                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:ABFD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:ABFE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:ABFE
DOSCODE:ABFE </span><span style="color:gray">CheckUNC</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ABFE                 </span><span style="color:navy">mov     word ptr ss:</span>THISCDS<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:AC05                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">1123h
</span><span style="color:black">DOSCODE:AC08                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - QUALIFY REMOTE FILENAME
<span style="color:black">DOSCODE:AC08                                         </span>; DS:SI -&gt; ASCIZ filename to canonicalize
<span style="color:black">DOSCODE:AC08                                         </span>; ES:DI -&gt; 128-byte buffer for qualified name
<span style="color:black">DOSCODE:AC08                                         </span>; Return: CF set if not resolved
<span style="color:black">DOSCODE:AC0A                 </span><span style="color:navy">jnb     short </span><span style="color:gray">UNCDone
</span><span style="color:black">DOSCODE:AC0C                 </span><span style="color:navy">call    </span>DriveFromText
<span style="color:black">DOSCODE:AC0F                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:AC10                 </span><span style="color:navy">mov     ax, [si]
</span><span style="color:black">DOSCODE:AC12                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AC15                 </span><span style="color:navy">xchg    ah, al
</span><span style="color:black">DOSCODE:AC17                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AC1A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CheckDevice
</span><span style="color:black">DOSCODE:AC1C                 </span><span style="color:navy">cmp     ah, al
</span><span style="color:black">DOSCODE:AC1E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CheckDevice
</span><span style="color:black">DOSCODE:AC20                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AC21                 </span><span style="color:navy">movsw
</span><span style="color:black">DOSCODE:AC22
DOSCODE:AC22 </span><span style="color:gray">UNCCpy</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC22                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:AC23                 </span><span style="color:navy">call    </span>UCase
<span style="color:black">DOSCODE:AC26                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:AC28                 </span><span style="color:navy">jz      short </span><span style="color:gray">UNCTerm
</span><span style="color:black">DOSCODE:AC2A                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AC2D                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:AC2F                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AC30                 </span><span style="color:navy">jnz     short </span><span style="color:gray">UNCCpy
</span><span style="color:black">DOSCODE:AC32                 </span><span style="color:navy">call    </span>Canonicalize
<span style="color:black">DOSCODE:AC35
DOSCODE:AC35 </span><span style="color:gray">UNCDone</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC35                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:AC36                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AC37                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AC38 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AC38
DOSCODE:AC38 </span><span style="color:gray">UNCTerm</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC38                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AC39                 </span><span style="color:navy">jmp     short </span><span style="color:gray">UNCDone
</span><span style="color:black">DOSCODE:AC3B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AC3B
DOSCODE:AC3B </span><span style="color:gray">CheckDevice</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC3B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AC3C                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AC3F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CheckPath
</span><span style="color:black">DOSCODE:AC41                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:AC43                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AC44                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AC45 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AC45
DOSCODE:AC45 </span><span style="color:gray">CheckPath</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC45                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:AC46                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:AC47                 </span><span style="color:navy">call    </span>no5Dshere       ; call CheckThisDevice
<span style="color:black">DOSCODE:AC4A                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:AC4B                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AC4C                 </span><span style="color:navy">jnb     short </span><span style="color:gray">DoFile
</span><span style="color:black">DOSCODE:AC4E                 </span><span style="color:navy">mov     ss:</span>FSHARING<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:AC54                 </span><span style="color:navy">call    </span>GETTHISDRV
<span style="color:black">DOSCODE:AC57                 </span><span style="color:navy">mov     ss:</span>FSHARING<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AC5D                 </span><span style="color:navy">call    </span>TextFromDrive
<span style="color:black">DOSCODE:AC60                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">/&#039;
</span><span style="color:black">DOSCODE:AC62                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AC63                 </span><span style="color:navy">call    </span>StrCpy
<span style="color:black">DOSCODE:AC66                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:AC67                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:AC68                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AC69
DOSCODE:AC69 </span>DoFile_retn<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC69                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AC69 </span>TransPathSet    endp
<span style="color:black">DOSCODE:AC69
DOSCODE:AC6A
DOSCODE:AC6A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AC6A
DOSCODE:AC6A </span><span style="color:gray">; Attributes: thunk
</span><span style="color:black">DOSCODE:AC6A
DOSCODE:AC6A </span>no5Dshere       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC6A                 </span><span style="color:navy">jmp     </span>CheckThisDevice
<span style="color:black">DOSCODE:AC6A </span>no5Dshere       endp
<span style="color:black">DOSCODE:AC6A
DOSCODE:AC6D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AC6D </span><span style="color:gray">; START OF FUNCTION CHUNK FOR TransPathSet
</span><span style="color:black">DOSCODE:AC6D
DOSCODE:AC6D </span><span style="color:gray">DoFile</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AC6D                 </span><span style="color:navy">call    </span>GetVisDrv
<span style="color:black">DOSCODE:AC70                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:AC72                 </span><span style="color:navy">jb      short </span>DoFile_retn
<span style="color:black">DOSCODE:AC74                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AC75                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AC76                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:AC77                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:AC78                 </span><span style="color:navy">call    </span>ValidateCDS
<span style="color:black">DOSCODE:AC7B                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AC7C                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AC7D                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:AC7E                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AC7F                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:AC81                 </span><span style="color:navy">jb      short </span>DoFile_retn
<span style="color:black">DOSCODE:AC83                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AC84                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AC85                 </span><span style="color:navy">lds     si, ss:</span>THISCDS
<span style="color:black">DOSCODE:AC8A                 </span><span style="color:navy">mov     bx, di
</span><span style="color:black">DOSCODE:AC8C                 </span><span style="color:navy">add     bx, [si+</span><span style="color:green">79</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AC8F                 </span><span style="color:navy">lea     bp, [di+</span><span style="color:green">134</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AC93                 </span><span style="color:navy">call    </span>FStrCpy
<span style="color:black">DOSCODE:AC96                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:AC97                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:AC99                 </span><span style="color:navy">cmp     es:[di-</span><span style="color:green">1</span><span style="color:navy">], al
</span><span style="color:black">DOSCODE:AC9D                 </span><span style="color:navy">jz      short </span><span style="color:gray">GetOrig
</span><span style="color:black">DOSCODE:AC9F                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:ACA0
DOSCODE:ACA0 </span><span style="color:gray">GetOrig</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ACA0                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:ACA1                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:ACA2                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:ACA3                 </span><span style="color:navy">call    </span>PathSep
<span style="color:black">DOSCODE:ACA6                 </span><span style="color:navy">jnz     short </span><span style="color:gray">PathAssure
</span><span style="color:black">DOSCODE:ACA8                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:ACAA                 </span><span style="color:navy">jz      short </span>DoCanon
<span style="color:black">DOSCODE:ACAC                 </span><span style="color:navy">mov     di, bx
</span><span style="color:black">DOSCODE:ACAE
DOSCODE:ACAE </span><span style="color:gray">SkipPath</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ACAE                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:ACAF                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:ACB2                 </span><span style="color:navy">jz      short </span><span style="color:gray">SkipPath
</span><span style="color:black">DOSCODE:ACB4                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:ACB5                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:ACB7                 </span><span style="color:navy">jz      short </span>DoCanon
<span style="color:black">DOSCODE:ACB9
DOSCODE:ACB9 </span><span style="color:gray">PathAssure</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ACB9                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:ACB9 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR TransPathSet
</span><span style="color:maroon">DOSCODE:ACBB                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:ACBC
DOSCODE:ACBC </span>DoCanon<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:ACBC                 </span><span style="color:navy">call    </span>Canonicalize
<span style="color:maroon">DOSCODE:ACBF                 </span><span style="color:navy">jb      short </span>DoFile_retn
<span style="color:maroon">DOSCODE:ACC1                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:ACC2                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:ACC3                 </span><span style="color:navy">mov     di, </span>WFP_START
<span style="color:maroon">DOSCODE:ACC7                 </span><span style="color:navy">lds     si, </span>THISCDS
<span style="color:maroon">DOSCODE:ACCB                 </span><span style="color:navy">call    </span>PathPref
<span style="color:maroon">DOSCODE:ACCE                 </span><span style="color:navy">jnz     short </span>DoSplice
<span style="color:maroon">DOSCODE:ACD0                 </span><span style="color:navy">mov     al, [si-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:ACD3                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:maroon">DOSCODE:ACD6                 </span><span style="color:navy">jz      short </span>DoSplice
<span style="color:maroon">DOSCODE:ACD8
DOSCODE:ACD8 </span>Pathline<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:ACD8                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:ACDC                 </span><span style="color:navy">jz      short </span>DoSplice
<span style="color:maroon">DOSCODE:ACDE                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:ACDF                 </span><span style="color:navy">mov     ss:</span>CURR_DIR_END<span style="color:navy">, di
</span><span style="color:maroon">DOSCODE:ACE4
DOSCODE:ACE4 </span>DoSplice<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:ACE4                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:ACE5                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:ACE6                 </span><span style="color:navy">mov     si, </span>WFP_START
<span style="color:maroon">DOSCODE:ACEA                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:maroon">DOSCODE:ACEC                 </span><span style="color:navy">test    </span>FSPLICE<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:ACF1                 </span><span style="color:navy">jz      short </span>SkipSplice
<span style="color:maroon">DOSCODE:ACF3                 </span><span style="color:navy">call    </span>Splice
<span style="color:maroon">DOSCODE:ACF6
DOSCODE:ACF6 </span>SkipSplice<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:ACF6                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:ACF7                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:ACF8                 </span><span style="color:navy">les     di, </span>THISCDS
<span style="color:maroon">DOSCODE:ACFC                 </span><span style="color:navy">test    word ptr es:[di+</span><span style="color:green">67</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:maroon">DOSCODE:AD02                 </span><span style="color:navy">jnz     short </span>Done
<span style="color:maroon">DOSCODE:AD04                 </span><span style="color:navy">jcxz    short </span>Done
<span style="color:maroon">DOSCODE:AD06                 </span><span style="color:navy">call    </span>ECritDisk
<span style="color:maroon">DOSCODE:AD09                 </span><span style="color:navy">call    </span>FATREAD_CDS
<span style="color:maroon">DOSCODE:AD0C                 </span><span style="color:navy">call    </span>LCritDisk
<span style="color:maroon">DOSCODE:AD0F                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:AD11
DOSCODE:AD11 </span>Done<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:AD11                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AD12
DOSCODE:AD12 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AD12
DOSCODE:AD12
DOSCODE:AD12 </span>Canonicalize    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD12                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:AD13                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AD16                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CanonDec
</span><span style="color:black">DOSCODE:AD18                 </span><span style="color:navy">cmp     di, bp
</span><span style="color:black">DOSCODE:AD1A                 </span><span style="color:navy">jnb     short </span><span style="color:gray">CanonBad
</span><span style="color:black">DOSCODE:AD1C                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AD1D                 </span><span style="color:navy">jmp     short </span>Canonicalize
<span style="color:black">DOSCODE:AD1F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AD1F
DOSCODE:AD1F </span><span style="color:gray">CanonDec</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD1F                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:AD20
DOSCODE:AD20 </span><span style="color:gray">CanonLoop</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD20                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:AD22                 </span><span style="color:navy">cmp     [si], al
</span><span style="color:black">DOSCODE:AD24                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoComponent
</span><span style="color:black">DOSCODE:AD26                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:AD2B                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoTerminate
</span><span style="color:black">DOSCODE:AD2D                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:AD2F                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AD30                 </span><span style="color:navy">mov     al, ah
</span><span style="color:black">DOSCODE:AD32
DOSCODE:AD32 </span><span style="color:gray">DoTerminate</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD32                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AD33                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:AD34                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AD35 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AD35
DOSCODE:AD35 </span><span style="color:gray">CanonBad</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD35                 </span><span style="color:navy">call    </span>ScanPathChar
<span style="color:black">DOSCODE:AD38                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:AD3A                 </span><span style="color:navy">jz      short </span><span style="color:gray">PathEnc
</span><span style="color:black">DOSCODE:AD3C                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:AD3E
DOSCODE:AD3E </span><span style="color:gray">PathEnc</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD3E                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AD3F
DOSCODE:AD3F </span>CanonBad_retn<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD3F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AD40 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AD40
DOSCODE:AD40 </span><span style="color:gray">DoComponent</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD40                 </span><span style="color:navy">call    </span>CopyComponent
<span style="color:black">DOSCODE:AD43                 </span><span style="color:navy">jb      short </span>CanonBad_retn
<span style="color:black">DOSCODE:AD45                 </span><span style="color:navy">cmp     word ptr es:[di], &#039;</span><span style="color:green">.&#039; </span>; 2Eh
<span style="color:black">DOSCODE:AD49                 </span><span style="color:navy">jz      short </span><span style="color:gray">Skip1
</span><span style="color:black">DOSCODE:AD4B                 </span><span style="color:navy">cmp     word ptr es:[di], &#039;</span><span style="color:green">..&#039; </span>; 2E2Eh
<span style="color:black">DOSCODE:AD50                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CanonNormal
</span><span style="color:black">DOSCODE:AD52                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:AD53
DOSCODE:AD53 </span><span style="color:gray">Skip1</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD53                 </span><span style="color:navy">call    </span>SkipBack
<span style="color:black">DOSCODE:AD56                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:AD58                 </span><span style="color:navy">jb      short </span>CanonBad_retn
<span style="color:black">DOSCODE:AD5A                 </span><span style="color:navy">jmp     short </span><span style="color:gray">CanonPath
</span><span style="color:black">DOSCODE:AD5C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AD5C
DOSCODE:AD5C </span><span style="color:gray">CanonNormal</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD5C                 </span><span style="color:navy">add     di, cx
</span><span style="color:black">DOSCODE:AD5E
DOSCODE:AD5E </span><span style="color:gray">CanonPath</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD5E                 </span><span style="color:navy">call    </span>PathSep
<span style="color:black">DOSCODE:AD61                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CanonBad
</span><span style="color:black">DOSCODE:AD63                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:AD64                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AD67                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CanonDec
</span><span style="color:black">DOSCODE:AD69                 </span><span style="color:navy">cmp     di, bp
</span><span style="color:black">DOSCODE:AD6B                 </span><span style="color:navy">jnb     short </span><span style="color:gray">CanonBad
</span><span style="color:black">DOSCODE:AD6D                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AD6E
DOSCODE:AD6E </span><span style="color:gray">CanonPathLoop</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD6E                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:AD6F                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AD72                 </span><span style="color:navy">jz      short </span><span style="color:gray">CanonPathLoop
</span><span style="color:black">DOSCODE:AD74                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:AD75                 </span><span style="color:navy">jmp     short </span><span style="color:gray">CanonLoop
</span><span style="color:black">DOSCODE:AD75 </span>Canonicalize    endp
<span style="color:black">DOSCODE:AD75
DOSCODE:AD77
DOSCODE:AD77 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AD77
DOSCODE:AD77
DOSCODE:AD77 </span>PathSep         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD77                 </span><span style="color:navy">mov     al, [si]
</span><span style="color:black">DOSCODE:AD79
DOSCODE:AD79 </span>PathSepGotCh<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD79                 </span><span style="color:navy">or      al, al
</span><span style="color:black">DOSCODE:AD7B                 </span><span style="color:navy">jz      short </span>CanonBad_retn
<span style="color:black">DOSCODE:AD7D                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AD80                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AD80 </span>PathSep         endp
<span style="color:black">DOSCODE:AD80
DOSCODE:AD81
DOSCODE:AD81 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AD81
DOSCODE:AD81
DOSCODE:AD81 </span>SkipBack        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD81                 </span><span style="color:navy">cmp     di, bx
</span><span style="color:black">DOSCODE:AD83                 </span><span style="color:navy">jb      short </span><span style="color:gray">SkipBad
</span><span style="color:black">DOSCODE:AD85                 </span><span style="color:navy">dec     di
</span><span style="color:black">DOSCODE:AD86                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:AD89                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AD8C                 </span><span style="color:navy">jnz     short </span>SkipBack
<span style="color:black">DOSCODE:AD8E                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:AD8F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AD90 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AD90
DOSCODE:AD90 </span><span style="color:gray">SkipBad</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD90                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:AD92                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AD93                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AD93 </span>SkipBack        endp
<span style="color:black">DOSCODE:AD93
DOSCODE:AD94
DOSCODE:AD94 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AD94
DOSCODE:AD94
DOSCODE:AD94 </span>CopyComponent   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AD94                 </span><span style="color:navy">sub     sp, </span><span style="color:green">14
</span><span style="color:black">DOSCODE:AD97                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AD98                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AD99                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:AD9A                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:AD9B                 </span><span style="color:navy">push    bp
</span><span style="color:black">DOSCODE:AD9C                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:black">DOSCODE:AD9E                 </span><span style="color:navy">mov     ah, &#039;</span><span style="color:green">.&#039;
</span><span style="color:black">DOSCODE:ADA0                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:ADA1                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:ADA2                 </span><span style="color:navy">cmp     al, ah
</span><span style="color:black">DOSCODE:ADA4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">NormalComp
</span><span style="color:black">DOSCODE:ADA6                 </span><span style="color:navy">call    </span>PathSep
<span style="color:black">DOSCODE:ADA9                 </span><span style="color:navy">jz      short </span><span style="color:gray">NulTerm
</span><span style="color:black">DOSCODE:ADAB
DOSCODE:ADAB </span>TryTwoDot<span style="color:navy">:
</span><span style="color:black">DOSCODE:ADAB                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:ADAC                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:ADAD                 </span><span style="color:navy">cmp     al, ah
</span><span style="color:black">DOSCODE:ADAF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CopyBad
</span><span style="color:black">DOSCODE:ADB1                 </span><span style="color:navy">call    </span>PathSep
<span style="color:black">DOSCODE:ADB4                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CopyBad
</span><span style="color:black">DOSCODE:ADB6
DOSCODE:ADB6 </span><span style="color:gray">NulTerm</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ADB6                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:ADB8                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:ADB9                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">6</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:ADBC                 </span><span style="color:navy">jmp     short </span><span style="color:gray">_GoodRet
</span><span style="color:black">DOSCODE:ADBE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:ADBE
DOSCODE:ADBE </span><span style="color:gray">NormalComp</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ADBE                 </span><span style="color:navy">mov     si, [bp+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:ADC1                 </span><span style="color:navy">call    </span>NameTrans
<span style="color:black">DOSCODE:ADC4                 </span><span style="color:navy">cmp     si, [bp+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:ADC7                 </span><span style="color:navy">jz      short </span><span style="color:gray">CopyBad
</span><span style="color:black">DOSCODE:ADC9                 </span><span style="color:navy">test    ss:</span>FSHARING<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:ADCF                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoPack
</span><span style="color:black">DOSCODE:ADD1                 </span><span style="color:navy">and     dl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:ADD4                 </span><span style="color:navy">add     ss:</span>CMETA<span style="color:navy">, dl
</span><span style="color:black">DOSCODE:ADD9                 </span><span style="color:navy">jg      short </span><span style="color:gray">CopyBad
</span><span style="color:black">DOSCODE:ADDB                 </span><span style="color:navy">jnz     short </span><span style="color:gray">DoPack
</span><span style="color:black">DOSCODE:ADDD                 </span><span style="color:navy">or      dl, dl
</span><span style="color:black">DOSCODE:ADDF                 </span><span style="color:navy">jz      short </span><span style="color:gray">CopyBadPath
</span><span style="color:black">DOSCODE:ADE1
DOSCODE:ADE1 </span><span style="color:gray">DoPack</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:ADE1                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">6</span><span style="color:navy">], si
</span><span style="color:black">DOSCODE:ADE4                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:ADE5                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:ADE6                 </span><span style="color:navy">mov     si, offset </span>NAME1
<span style="color:black">DOSCODE:ADE9                 </span><span style="color:navy">lea     di, [bp+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:ADEC                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:ADED                 </span><span style="color:navy">call    </span>PackName
<span style="color:black">DOSCODE:ADF0                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:ADF1                 </span><span style="color:navy">call    </span>StrLen
<span style="color:black">DOSCODE:ADF4                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:ADF5                 </span><span style="color:navy">add     cx, [bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:ADF8                 </span><span style="color:navy">cmp     cx, [bp+</span><span style="color:#ff8000">0</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:ADFB                 </span><span style="color:navy">jnb     short </span><span style="color:gray">CopyBad
</span><span style="color:black">DOSCODE:ADFD                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:ADFF                 </span><span style="color:navy">les     di, [bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AE02                 </span><span style="color:navy">call    </span>FStrCpy
<span style="color:black">DOSCODE:AE05
DOSCODE:AE05 </span><span style="color:gray">_GoodRet</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE05                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:AE06                 </span><span style="color:navy">jmp     short </span><span style="color:gray">CopyEnd
</span><span style="color:black">DOSCODE:AE08 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AE08
DOSCODE:AE08 </span><span style="color:gray">CopyBad</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE08                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AE09                 </span><span style="color:navy">call    </span>ScanPathChar
<span style="color:black">DOSCODE:AE0C                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:AE0E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CopyEnd
</span><span style="color:black">DOSCODE:AE10
DOSCODE:AE10 </span><span style="color:gray">CopyBadPath</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE10                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:AE11                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:AE13
DOSCODE:AE13 </span><span style="color:gray">CopyEnd</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE13                 </span><span style="color:navy">pop     bp
</span><span style="color:black">DOSCODE:AE14                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AE15                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AE16                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:AE17                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AE18                 </span><span style="color:navy">lahf
</span><span style="color:black">DOSCODE:AE19                 </span><span style="color:navy">add     sp, </span><span style="color:green">14
</span><span style="color:black">DOSCODE:AE1C                 </span><span style="color:navy">call    </span>StrLen
<span style="color:black">DOSCODE:AE1F                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:AE20                 </span><span style="color:navy">sahf
</span><span style="color:black">DOSCODE:AE21                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AE21 </span>CopyComponent   endp
<span style="color:black">DOSCODE:AE21
DOSCODE:AE22
DOSCODE:AE22 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AE22
DOSCODE:AE22
DOSCODE:AE22 </span>Splice          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE22                 </span><span style="color:navy">test    ss:</span>SPLICES<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:AE28                 </span><span style="color:navy">jz      short </span><span style="color:gray">AllDone
</span><span style="color:black">DOSCODE:AE2A                 </span><span style="color:navy">push    word ptr ss:</span>THISCDS
<span style="color:black">DOSCODE:AE2F                 </span><span style="color:navy">push    word ptr ss:</span>THISCDS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:AE34                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AE35                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AE36                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AE37                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AE38                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:AE3A
DOSCODE:AE3A </span><span style="color:gray">SpliceScan</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE3A                 </span><span style="color:navy">call    </span>GetCDSFromDrv
<span style="color:black">DOSCODE:AE3D                 </span><span style="color:navy">jb      short </span><span style="color:gray">SpliceDone
</span><span style="color:black">DOSCODE:AE3F                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:AE41                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">43h</span><span style="color:navy">], </span><span style="color:green">2000h
</span><span style="color:black">DOSCODE:AE46                 </span><span style="color:navy">jz      short </span><span style="color:gray">SpliceScan
</span><span style="color:black">DOSCODE:AE48                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:AE49                 </span><span style="color:navy">call    </span>PathPref
<span style="color:black">DOSCODE:AE4C                 </span><span style="color:navy">jz      short </span><span style="color:gray">SpliceFound
</span><span style="color:black">DOSCODE:AE4E
DOSCODE:AE4E </span><span style="color:gray">SpliceSkip</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE4E                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AE4F                 </span><span style="color:navy">jmp     short </span><span style="color:gray">SpliceScan
</span><span style="color:black">DOSCODE:AE51 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AE51
DOSCODE:AE51 </span><span style="color:gray">SpliceFound</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE51                 </span><span style="color:navy">cmp     byte ptr es:[di], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AE55                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SpliceDo
</span><span style="color:black">DOSCODE:AE57                 </span><span style="color:navy">test    ss:</span>NoSetDir<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:AE5D                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SpliceSkip
</span><span style="color:black">DOSCODE:AE5F
DOSCODE:AE5F </span><span style="color:gray">SpliceDo</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE5F                 </span><span style="color:navy">mov     si, di
</span><span style="color:black">DOSCODE:AE61                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:AE62                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AE63                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AE64                 </span><span style="color:navy">call    </span>TextFromDrive1
<span style="color:black">DOSCODE:AE67                 </span><span style="color:navy">mov     ax, ss:</span>CURR_DIR_END
<span style="color:black">DOSCODE:AE6B                 </span><span style="color:navy">or      ax, ax
</span><span style="color:black">DOSCODE:AE6D                 </span><span style="color:navy">js      short </span><span style="color:gray">NoPoke
</span><span style="color:black">DOSCODE:AE6F                 </span><span style="color:navy">add     ax, di
</span><span style="color:black">DOSCODE:AE71                 </span><span style="color:navy">sub     ax, si
</span><span style="color:black">DOSCODE:AE73                 </span><span style="color:navy">mov     ss:</span>CURR_DIR_END<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:AE77
DOSCODE:AE77 </span><span style="color:gray">NoPoke</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE77                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:AE7A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">SpliceCopy
</span><span style="color:black">DOSCODE:AE7C                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:black">DOSCODE:AE7E                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:AE7F
DOSCODE:AE7F </span><span style="color:gray">SpliceCopy</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE7F                 </span><span style="color:navy">call    </span>FStrCpy
<span style="color:black">DOSCODE:AE82                 </span><span style="color:navy">add     sp, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:AE85                 </span><span style="color:navy">or      cl, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:AE88                 </span><span style="color:navy">jmp     short </span><span style="color:gray">DoSet
</span><span style="color:black">DOSCODE:AE8A </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AE8A
DOSCODE:AE8A </span><span style="color:gray">SpliceDone</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE8A                 </span><span style="color:navy">pop     word ptr ss:</span>THISCDS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:black">DOSCODE:AE8F                 </span><span style="color:navy">pop     word ptr ss:</span>THISCDS
<span style="color:black">DOSCODE:AE94
DOSCODE:AE94 </span><span style="color:gray">AllDone</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE94                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:AE96
DOSCODE:AE96 </span><span style="color:gray">DoSet</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AE96                 </span><span style="color:navy">lds     si, ss:</span>THISCDS
<span style="color:black">DOSCODE:AE9B                 </span><span style="color:navy">les     di, [si+</span><span style="color:#ff8000">45h</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AE9E                 </span><span style="color:navy">mov     word ptr ss:</span>THISDPB<span style="color:navy">, di
</span><span style="color:black">DOSCODE:AEA3                 </span><span style="color:navy">mov     word ptr ss:</span>THISDPB<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:AEA8
DOSCODE:AEA8 </span>Splice_retn<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AEA8                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AEA8 </span>Splice          endp
<span style="color:black">DOSCODE:AEA8
DOSCODE:AEA9
DOSCODE:AEA9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AEA9
DOSCODE:AEA9
DOSCODE:AEA9 </span>$NameTrans      proc far                <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:AEA9                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AEAA                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AEAB                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:AEAC                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:AEAD                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:AEAE                 </span><span style="color:navy">mov     ch, </span><span style="color:green">16h
</span><span style="color:black">DOSCODE:AEB0                 </span><span style="color:navy">call    </span>SetAttrib
<span style="color:black">DOSCODE:AEB3                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:black">DOSCODE:AEB6                 </span><span style="color:navy">call    </span>TransPath
<span style="color:black">DOSCODE:AEB9                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:AEBA                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AEBB                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AEBC                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:AEBD                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AEBE                 </span><span style="color:navy">jnb     short </span><span style="color:gray">TransOK
</span><span style="color:black">DOSCODE:AEC0                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:AEC3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AEC3
DOSCODE:AEC3 </span><span style="color:gray">TransOK</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AEC3                 </span><span style="color:navy">mov     si, offset </span>OPENBUF
<span style="color:black">DOSCODE:AEC6                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:AEC7                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AEC8                 </span><span style="color:navy">call    </span>FStrCpy
<span style="color:black">DOSCODE:AECB                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:AECB </span>$NameTrans      endp
<span style="color:black">DOSCODE:AECB
DOSCODE:AECE
DOSCODE:AECE </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AECE
DOSCODE:AECE
DOSCODE:AECE </span>DriveFromText   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AECE                 </span><span style="color:navy">xor     al, al
</span><span style="color:black">DOSCODE:AED0                 </span><span style="color:navy">cmp     byte ptr [si], </span><span style="color:green">0
</span><span style="color:black">DOSCODE:AED3                 </span><span style="color:navy">jz      short </span>Splice_retn
<span style="color:black">DOSCODE:AED5                 </span><span style="color:navy">cmp     byte ptr [si+</span><span style="color:green">1</span><span style="color:navy">], &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:AED9                 </span><span style="color:navy">jnz     short </span>Splice_retn
<span style="color:black">DOSCODE:AEDB                 </span><span style="color:navy">lodsw
</span><span style="color:black">DOSCODE:AEDC                 </span><span style="color:navy">or      al, </span><span style="color:green">20h
</span><span style="color:black">DOSCODE:AEDE                 </span><span style="color:navy">sub     al, </span><span style="color:green">60h
</span><span style="color:black">DOSCODE:AEE0                 </span><span style="color:navy">jnz     short </span>Splice_retn
<span style="color:black">DOSCODE:AEE2                 </span><span style="color:navy">mov     al, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:AEE4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AEE4 </span>DriveFromText   endp
<span style="color:black">DOSCODE:AEE4
DOSCODE:AEE5
DOSCODE:AEE5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AEE5
DOSCODE:AEE5
DOSCODE:AEE5 </span>TextFromDrive   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AEE5                 </span><span style="color:navy">inc     al
</span><span style="color:black">DOSCODE:AEE7
DOSCODE:AEE7 </span>TextFromDrive1<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AEE7                 </span><span style="color:navy">add     al, </span><span style="color:#ff8000">40h </span><span style="color:gray">; &#039;@&#039;   </span>; &#039;A&#039;-1
<span style="color:black">DOSCODE:AEE9                 </span><span style="color:navy">mov     ah, &#039;</span><span style="color:green">:&#039;
</span><span style="color:black">DOSCODE:AEEB                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:AEEC
DOSCODE:AEEC </span>PathPref_retn<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AEEC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AEEC </span>TextFromDrive   endp
<span style="color:black">DOSCODE:AEEC
DOSCODE:AEED
DOSCODE:AEED </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AEED
DOSCODE:AEED
DOSCODE:AEED </span>PathPref        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AEED                 </span><span style="color:navy">call    </span>DStrLen
<span style="color:black">DOSCODE:AEF0                 </span><span style="color:navy">dec     cx
</span><span style="color:black">DOSCODE:AEF1                 </span><span style="color:navy">repe cmpsb
</span><span style="color:black">DOSCODE:AEF3                 </span><span style="color:navy">jnz     short </span>PathPref_retn
<span style="color:black">DOSCODE:AEF5                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:AEF6                 </span><span style="color:navy">mov     al, [si-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:AEF9                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AEFC                 </span><span style="color:navy">jz      short </span><span style="color:gray">Prefix
</span><span style="color:black">DOSCODE:AEFE                 </span><span style="color:navy">mov     al, es:[di]
</span><span style="color:black">DOSCODE:AF01                 </span><span style="color:navy">call    </span>PathSepGotCh
<span style="color:black">DOSCODE:AF04
DOSCODE:AF04 </span><span style="color:gray">Prefix</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF04                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AF05                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AF05 </span>PathPref        endp
<span style="color:black">DOSCODE:AF05
DOSCODE:AF06
DOSCODE:AF06 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AF06
DOSCODE:AF06
DOSCODE:AF06 </span>ScanPathChar    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF06                 </span><span style="color:navy">lodsb
</span><span style="color:black">DOSCODE:AF07                 </span><span style="color:navy">call    </span>PathSepGotCh
<span style="color:black">DOSCODE:AF0A                 </span><span style="color:navy">jnz     short </span>ScanPathChar
<span style="color:black">DOSCODE:AF0C                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:black">DOSCODE:AF0F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:AF0F </span>ScanPathChar    endp
<span style="color:black">DOSCODE:AF0F
DOSCODE:AF10
DOSCODE:AF10 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AF10
DOSCODE:AF10
DOSCODE:AF10 </span>$OPEN           proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF10                 </span><span style="color:navy">xor     ah, ah
</span><span style="color:black">DOSCODE:AF12
DOSCODE:AF12 </span>$Open2<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF12                 </span><span style="color:navy">mov     ch, </span><span style="color:green">16h
</span><span style="color:black">DOSCODE:AF14                 </span><span style="color:navy">call    </span>SetAttrib
<span style="color:black">DOSCODE:AF17                 </span><span style="color:navy">mov     cx, offset </span>DOS_OPEN
<span style="color:black">DOSCODE:AF1A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:AF1B
DOSCODE:AF1B </span>AccessFile<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF1B                 </span><span style="color:navy">call    </span>ECritDisk       ; ECritSFT
<span style="color:black">DOSCODE:AF1E                 </span><span style="color:navy">call    </span>SFNFree
<span style="color:black">DOSCODE:AF21                 </span><span style="color:navy">call    </span>LCritDisk       ; LCritSFT
<span style="color:black">DOSCODE:AF24                 </span><span style="color:navy">jb      short </span><span style="color:gray">OpenFailJ
</span><span style="color:black">DOSCODE:AF26                 </span><span style="color:navy">mov     ss:</span>SFN<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:AF2B                 </span><span style="color:navy">mov     word ptr ss:</span>THISSFT<span style="color:navy">, di
</span><span style="color:black">DOSCODE:AF30                 </span><span style="color:navy">mov     word ptr ss:</span>THISSFT<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:AF35                 </span><span style="color:navy">call    </span>JFNFree
<span style="color:black">DOSCODE:AF38                 </span><span style="color:navy">jnb     short </span><span style="color:gray">SaveJFN
</span><span style="color:black">DOSCODE:AF3A
DOSCODE:AF3A </span><span style="color:gray">OpenFailJ</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF3A                 </span><span style="color:navy">jmp     </span><span style="color:gray">OpenFail
</span><span style="color:black">DOSCODE:AF3D </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AF3D
DOSCODE:AF3D </span><span style="color:gray">SaveJFN</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF3D                 </span><span style="color:navy">mov     word ptr ss:</span>PJFN<span style="color:navy">, di
</span><span style="color:black">DOSCODE:AF42                 </span><span style="color:navy">mov     word ptr ss:</span>PJFN<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:AF47                 </span><span style="color:navy">mov     ss:</span>JFN<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:AF4C                 </span><span style="color:navy">mov     bx, ss:</span>SFN
<span style="color:black">DOSCODE:AF51                 </span><span style="color:navy">mov     es:[di], bl
</span><span style="color:black">DOSCODE:AF54                 </span><span style="color:navy">mov     si, dx
</span><span style="color:black">DOSCODE:AF56                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:black">DOSCODE:AF59                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:AF5A                 </span><span style="color:navy">call    </span>TransPath
<span style="color:black">DOSCODE:AF5D                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:AF5E                 </span><span style="color:navy">lds     si, ss:</span>THISSFT
<span style="color:black">DOSCODE:AF63                 </span><span style="color:navy">jb      short </span><span style="color:gray">OpenCleanJ
</span><span style="color:black">DOSCODE:AF65                 </span><span style="color:navy">cmp     ss:</span>CMETA<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:AF6B                 </span><span style="color:navy">jz      short </span><span style="color:gray">SetSearch
</span><span style="color:black">DOSCODE:AF6D                 </span><span style="color:navy">mov     al, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:AF6F
DOSCODE:AF6F </span><span style="color:gray">OpenCleanJ</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF6F                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OpenClean
</span><span style="color:black">DOSCODE:AF71 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AF71
DOSCODE:AF71 </span><span style="color:gray">SetSearch</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF71                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:AF72                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:AF74                 </span><span style="color:navy">mov     [si+</span><span style="color:green">2</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:AF77                 </span><span style="color:navy">mov     [si+</span><span style="color:green">51</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:AF7A                 </span><span style="color:navy">cmp     bx, offset </span>DOS_OPEN
<span style="color:black">DOSCODE:AF7E                 </span><span style="color:navy">jnz     short </span><span style="color:gray">_DoOper
</span><span style="color:black">DOSCODE:AF80                 </span><span style="color:navy">test    al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:AF82                 </span><span style="color:navy">jz      short </span><span style="color:gray">_DoOper
</span><span style="color:black">DOSCODE:AF84                 </span><span style="color:navy">and     al, </span><span style="color:green">7Fh
</span><span style="color:black">DOSCODE:AF86                 </span><span style="color:navy">mov     cx, </span><span style="color:green">1000h
</span><span style="color:black">DOSCODE:AF89
DOSCODE:AF89 </span><span style="color:gray">_DoOper</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AF89                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:AF8A                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:AF8B                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:AF8C                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AF8D                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:AF8E                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AF8F                 </span><span style="color:navy">call    </span>Set_EXT_mode
<span style="color:black">DOSCODE:AF92                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:AF93                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:AF94                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:AF95                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:AF96                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:AF97                 </span><span style="color:navy">call    bx
</span><span style="color:black">DOSCODE:AF99                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:AF9A                 </span><span style="color:navy">lds     si, </span>THISSFT
<span style="color:black">DOSCODE:AF9E                 </span><span style="color:navy">jb      short </span><span style="color:gray">OpenE2
</span><span style="color:black">DOSCODE:AFA0
DOSCODE:AFA0 </span>OpenOK<span style="color:navy">:
</span><span style="color:black">DOSCODE:AFA0                 </span><span style="color:navy">mov     word ptr [si], </span><span style="color:green">1
</span><span style="color:black">DOSCODE:AFA4                 </span><span style="color:navy">or      [si+</span><span style="color:green">5</span><span style="color:navy">], cx
</span><span style="color:black">DOSCODE:AFA7                 </span><span style="color:navy">mov     ax, ss:</span>JFN
<span style="color:black">DOSCODE:AFAB                 </span><span style="color:navy">call    ss:</span>ShCol
<span style="color:black">DOSCODE:AFB0                 </span><span style="color:navy">mov     ss:</span>SFN<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:AFB7
DOSCODE:AFB7 </span>OpenOKJ<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFB7                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:AFBA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AFBA
DOSCODE:AFBA </span><span style="color:gray">OpenE2</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFBA                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">57h
</span><span style="color:black">DOSCODE:AFBD                 </span><span style="color:navy">jnz     short </span><span style="color:gray">OpenE
</span><span style="color:black">DOSCODE:AFBF                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OpenCritLeave
</span><span style="color:black">DOSCODE:AFC1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AFC1
DOSCODE:AFC1 </span><span style="color:gray">OpenClean</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFC1                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:AFC2
DOSCODE:AFC2 </span><span style="color:gray">OpenE</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFC2                 </span><span style="color:navy">mov     word ptr [si], </span><span style="color:green">0
</span><span style="color:black">DOSCODE:AFC6                 </span><span style="color:navy">lds     si, ss:</span>PJFN
<span style="color:black">DOSCODE:AFCB                 </span><span style="color:navy">mov     byte ptr [si], </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:AFCE                 </span><span style="color:navy">jmp     short </span><span style="color:gray">OpenCritLeave
</span><span style="color:black">DOSCODE:AFD0 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AFD0
DOSCODE:AFD0 </span><span style="color:gray">OpenFail</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFD0                 </span><span style="color:navy">sti
</span><span style="color:black">DOSCODE:AFD1                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:AFD2
DOSCODE:AFD2 </span><span style="color:gray">OpenCritLeave</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFD2                 </span><span style="color:navy">mov     ss:</span>SFN<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:AFD9                 </span><span style="color:navy">cmp     ss:</span>EXTERR<span style="color:navy">, </span><span style="color:green">25h  </span><span style="color:red">; ...
</span><span style="color:black">DOSCODE:AFDF                 </span><span style="color:navy">jnz     short </span>NORERR
<span style="color:black">DOSCODE:AFE1                 </span><span style="color:navy">jmp     </span>From_GetSet
<span style="color:black">DOSCODE:AFE4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:AFE4
DOSCODE:AFE4 </span>NORERR<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFE4                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:AFE4 </span>$OPEN           endp
<span style="color:black">DOSCODE:AFE4
DOSCODE:AFE7
DOSCODE:AFE7 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:AFE7
DOSCODE:AFE7
DOSCODE:AFE7 </span>$CREAT          proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFE7                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:AFE8                 </span><span style="color:navy">mov     cx, offset </span>DOS_CREATE
<span style="color:black">DOSCODE:AFE8 </span>$CREAT          endp
<span style="color:black">DOSCODE:AFE8
DOSCODE:AFEB </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $CreateNewFile
</span><span style="color:black">DOSCODE:AFEB
DOSCODE:AFEB </span><span style="color:gray">AccessSet</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:AFEB                 </span><span style="color:navy">mov     ss:</span>SATTRIB<span style="color:navy">, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:AFF1                 </span><span style="color:navy">jmp     </span>AccessFile
<span style="color:black">DOSCODE:AFF1 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $CreateNewFile
</span><span style="color:maroon">DOSCODE:AFF4 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:AFF4
DOSCODE:AFF4 </span>$CHMOD<span style="color:navy">:                                 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:AFF4                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:AFF7                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:AFF8                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:AFF9                 </span><span style="color:navy">mov     si, dx
</span><span style="color:maroon">DOSCODE:AFFB                 </span><span style="color:navy">call    </span>TransPathSet
<span style="color:maroon">DOSCODE:AFFE                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:AFFF                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:B000                 </span><span style="color:navy">jb      short </span>ChModErr
<span style="color:maroon">DOSCODE:B002                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:B003                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B004                 </span><span style="color:navy">cmp     </span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:B009                 </span><span style="color:navy">jnz     short </span>ChModErr
<span style="color:maroon">DOSCODE:B00B                 </span><span style="color:navy">mov     </span>SATTRIB<span style="color:navy">, </span><span style="color:#ff8000">16h
</span><span style="color:maroon">DOSCODE:B010                 </span><span style="color:navy">sub     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:B012                 </span><span style="color:navy">jb      short </span>ChModGet
<span style="color:maroon">DOSCODE:B014                 </span><span style="color:navy">jz      short </span>ChModSet
<span style="color:maroon">DOSCODE:B016                 </span><span style="color:navy">mov     </span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:B01B                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:B01D </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $UNLINK
</span><span style="color:black">DOSCODE:B01D
DOSCODE:B01D </span>ChModErrj<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B01D                 </span><span style="color:navy">jmp     short </span>NORERR
<span style="color:black">DOSCODE:B01D </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $UNLINK
</span><span style="color:maroon">DOSCODE:B01F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B01F
DOSCODE:B01F </span>ChModGet<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B01F                 </span><span style="color:navy">call    </span>GET_FILE_INFO
<span style="color:maroon">DOSCODE:B022                 </span><span style="color:navy">jb      short </span>ChModE
<span style="color:maroon">DOSCODE:B024                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:maroon">DOSCODE:B027                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:B02A </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $UNLINK
</span><span style="color:black">DOSCODE:B02A
DOSCODE:B02A </span><span style="color:gray">ChModOKj</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B02A                 </span><span style="color:navy">jmp     short </span>OpenOKJ
<span style="color:black">DOSCODE:B02A </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $UNLINK
</span><span style="color:maroon">DOSCODE:B02C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B02C
DOSCODE:B02C </span>ChModSet<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B02C                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:maroon">DOSCODE:B02E                 </span><span style="color:navy">call    </span>SET_FILE_ATTRIBUTE
<span style="color:maroon">DOSCODE:B031                 </span><span style="color:navy">jb      short </span>ChModE
<span style="color:black">DOSCODE:B033 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $UNLINK
</span><span style="color:black">DOSCODE:B033
DOSCODE:B033 </span><span style="color:gray">ChModOK</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B033                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ChModOKj
</span><span style="color:black">DOSCODE:B035 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B035
DOSCODE:B035 </span>ChModErr<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B035                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:B037
DOSCODE:B037 </span>ChModE<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B037                 </span><span style="color:navy">jmp     short </span>ChModErrj
<span style="color:black">DOSCODE:B037 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $UNLINK
</span><span style="color:black">DOSCODE:B039
DOSCODE:B039 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B039
DOSCODE:B039
DOSCODE:B039 </span>$UNLINK         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B039
DOSCODE:B039 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:B01D SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:B039 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:B02A SIZE 00000002 BYTES
</span><span style="color:black">DOSCODE:B039 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:B033 SIZE 00000006 BYTES
</span><span style="color:black">DOSCODE:B039
DOSCODE:B039                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B03A                 </span><span style="color:navy">mov     si, dx
</span><span style="color:black">DOSCODE:B03C                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:black">DOSCODE:B03F                 </span><span style="color:navy">call    </span>TransPathSet
<span style="color:black">DOSCODE:B042                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B043                 </span><span style="color:navy">jb      short </span>ChModErr
<span style="color:black">DOSCODE:B045                 </span><span style="color:navy">cmp     ss:</span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:black">DOSCODE:B04B                 </span><span style="color:navy">jnz     short </span>NotFound
<span style="color:black">DOSCODE:B04D                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:B04E                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B04F                 </span><span style="color:navy">mov     ch, </span><span style="color:#ff8000">6
</span><span style="color:black">DOSCODE:B051                 </span><span style="color:navy">call    </span>SetAttrib
<span style="color:black">DOSCODE:B054                 </span><span style="color:navy">call    </span>DOS_DELETE
<span style="color:black">DOSCODE:B057                 </span><span style="color:navy">jb      short </span>UnlinkE
<span style="color:black">DOSCODE:B059
DOSCODE:B059 </span>UnLinkOK<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B059                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ChModOK
</span><span style="color:black">DOSCODE:B05B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B05B
DOSCODE:B05B </span>NotFound<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B05B                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:B05D
DOSCODE:B05D </span>UnlinkE<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B05D                 </span><span style="color:navy">jmp     short </span>ChModE
<span style="color:black">DOSCODE:B05D </span>$UNLINK         endp
<span style="color:black">DOSCODE:B05D
</span><span style="color:maroon">DOSCODE:B05F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B05F
DOSCODE:B05F </span>$RENAME<span style="color:navy">:                                </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B05F                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:B060                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:B061                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:B062                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:B063                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B064                 </span><span style="color:navy">mov     si, di
</span><span style="color:maroon">DOSCODE:B066                 </span><span style="color:navy">mov     di, offset </span>RENBUF
<span style="color:maroon">DOSCODE:B069                 </span><span style="color:navy">call    </span>TransPathSet
<span style="color:maroon">DOSCODE:B06C                 </span><span style="color:navy">push    ss:</span>WFP_START
<span style="color:maroon">DOSCODE:B071                 </span><span style="color:navy">pop     ss:</span>REN_WFP
<span style="color:maroon">DOSCODE:B076                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:B077                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B078                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:B079
DOSCODE:B079 </span>epjc2<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B079                 </span><span style="color:navy">jb      short </span>ChModErr
<span style="color:maroon">DOSCODE:B07B                 </span><span style="color:navy">cmp     ss:</span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:B081                 </span><span style="color:navy">jnz     short </span>NotFound
<span style="color:maroon">DOSCODE:B083                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:B084                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:B087                 </span><span style="color:navy">call    </span>TransPathSet
<span style="color:maroon">DOSCODE:B08A                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:B08B                 </span><span style="color:navy">jb      short </span>epjc2
<span style="color:maroon">DOSCODE:B08D                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:B08E                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B08F                 </span><span style="color:navy">cmp     </span>CMETA<span style="color:navy">, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:B094                 </span><span style="color:navy">jb      short </span>NotFound
<span style="color:maroon">DOSCODE:B096                 </span><span style="color:navy">push    word ptr </span>THISCDS
<span style="color:maroon">DOSCODE:B09A                 </span><span style="color:navy">push    word ptr </span>THISCDS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:B09E                 </span><span style="color:navy">mov     di, offset </span>OPENBUF
<span style="color:maroon">DOSCODE:B0A1                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:B0A2                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:B0A3                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:B0A5
DOSCODE:B0A5 </span>rnloop<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B0A5                 </span><span style="color:navy">call    </span>GetCDSFromDrv
<span style="color:maroon">DOSCODE:B0A8                 </span><span style="color:navy">jb      short </span>dorn
<span style="color:maroon">DOSCODE:B0AA                 </span><span style="color:navy">call    </span>StrCmp
<span style="color:maroon">DOSCODE:B0AD                 </span><span style="color:navy">jz      short </span>rnerr
<span style="color:maroon">DOSCODE:B0AF                 </span><span style="color:navy">inc     al
</span><span style="color:maroon">DOSCODE:B0B1                 </span><span style="color:navy">jmp     short </span>rnloop
<span style="color:maroon">DOSCODE:B0B3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B0B3
DOSCODE:B0B3 </span>rnerr<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B0B3                 </span><span style="color:navy">add     sp, </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:B0B6                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">10h
</span><span style="color:maroon">DOSCODE:B0B8                 </span><span style="color:navy">jmp     short </span>UnlinkE
<span style="color:maroon">DOSCODE:B0BA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B0BA
DOSCODE:B0BA </span>dorn<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B0BA                 </span><span style="color:navy">pop     word ptr ss:</span>THISCDS<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:B0BF                 </span><span style="color:navy">pop     word ptr ss:</span>THISCDS
<span style="color:maroon">DOSCODE:B0C4                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:B0C5                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B0C6                 </span><span style="color:navy">mov     ch, </span><span style="color:#ff8000">16h
</span><span style="color:maroon">DOSCODE:B0C8                 </span><span style="color:navy">call    </span>SetAttrib
<span style="color:maroon">DOSCODE:B0CB                 </span><span style="color:navy">call    </span>DOS_RENAME
<span style="color:maroon">DOSCODE:B0CE                 </span><span style="color:navy">jb      short </span>UnlinkE
<span style="color:maroon">DOSCODE:B0D0                 </span><span style="color:navy">jmp     short </span>UnLinkOK
<span style="color:black">DOSCODE:B0D2
DOSCODE:B0D2 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B0D2
DOSCODE:B0D2
DOSCODE:B0D2 </span>$CreateNewFile  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B0D2
DOSCODE:B0D2 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:AFEB SIZE 00000009 BYTES
</span><span style="color:black">DOSCODE:B0D2
DOSCODE:B0D2                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B0D3                 </span><span style="color:navy">mov     cx, offset </span>DOS_Create_New
<span style="color:black">DOSCODE:B0D6                 </span><span style="color:navy">jmp     </span><span style="color:gray">AccessSet
</span><span style="color:black">DOSCODE:B0D6 </span>$CreateNewFile  endp
<span style="color:black">DOSCODE:B0D6
DOSCODE:B0D9
DOSCODE:B0D9 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B0D9
DOSCODE:B0D9
DOSCODE:B0D9 </span>BinToAscii      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B0D9                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">404h
</span><span style="color:black">DOSCODE:B0DC
DOSCODE:B0DC </span><span style="color:gray">bta5</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B0DC                 </span><span style="color:navy">rol     ax, cl
</span><span style="color:black">DOSCODE:B0DE                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:B0DF                 </span><span style="color:navy">and     al, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:B0E1                 </span><span style="color:navy">add     al, &#039;</span><span style="color:green">A&#039;
</span><span style="color:black">DOSCODE:B0E3                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:B0E4                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:B0E5                 </span><span style="color:navy">dec     ch
</span><span style="color:black">DOSCODE:B0E7                 </span><span style="color:navy">jnz     short </span><span style="color:gray">bta5
</span><span style="color:black">DOSCODE:B0E9                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B0E9 </span>BinToAscii      endp
<span style="color:black">DOSCODE:B0E9
</span><span style="color:maroon">DOSCODE:B0EA </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B0EA
DOSCODE:B0EA </span>$CreateTempFile<span style="color:navy">:                        </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B0EA                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:B0EB                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:maroon">DOSCODE:B0ED                 </span><span style="color:navy">sub     sp, </span><span style="color:green">10
</span><span style="color:maroon">DOSCODE:B0F0                 </span><span style="color:navy">test    cx, </span><span style="color:green">0FFD8h
</span><span style="color:maroon">DOSCODE:B0F4                 </span><span style="color:navy">jz      short </span>OKatts
<span style="color:maroon">DOSCODE:B0F6                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:B0F9                 </span><span style="color:navy">jmp     short </span>SETTMPERR
<span style="color:maroon">DOSCODE:B0FB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B0FB
DOSCODE:B0FB </span>OKatts<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B0FB                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">10</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:B0FE                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">8</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:B101                 </span><span style="color:navy">mov     word ptr [bp-</span><span style="color:green">6</span><span style="color:navy">], ds
</span><span style="color:maroon">DOSCODE:B104                 </span><span style="color:navy">mov     word ptr [bp-</span><span style="color:green">2</span><span style="color:navy">], ds
</span><span style="color:maroon">DOSCODE:B107                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:B108                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:B109                 </span><span style="color:navy">mov     di, dx
</span><span style="color:maroon">DOSCODE:B10B                 </span><span style="color:navy">mov     cx, di
</span><span style="color:maroon">DOSCODE:B10D                 </span><span style="color:navy">neg     cx
</span><span style="color:maroon">DOSCODE:B10F                 </span><span style="color:navy">or      cx, cx
</span><span style="color:maroon">DOSCODE:B111                 </span><span style="color:navy">jnz     short </span>okok
<span style="color:maroon">DOSCODE:B113                 </span><span style="color:navy">mov     cx, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:B116
DOSCODE:B116 </span>okok<span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B116                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:B118                 </span><span style="color:navy">repne scasb
</span><span style="color:maroon">DOSCODE:B11A                 </span><span style="color:navy">dec     di
</span><span style="color:maroon">DOSCODE:B11B                 </span><span style="color:navy">mov     al, es:[di-</span><span style="color:green">1</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B11F                 </span><span style="color:navy">call    </span>PATHCHRCMP
<span style="color:maroon">DOSCODE:B122                 </span><span style="color:navy">jz      short </span>SETENDPTR
<span style="color:maroon">DOSCODE:B124                 </span><span style="color:navy">mov     al, &#039;</span><span style="color:green">\&#039;
</span><span style="color:maroon">DOSCODE:B126                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:B127
DOSCODE:B127 </span>SETENDPTR<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B127                 </span><span style="color:navy">mov     [bp-</span><span style="color:green">4</span><span style="color:navy">], di
</span><span style="color:maroon">DOSCODE:B12A
DOSCODE:B12A </span>CreateLoop<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B12A                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:B12B                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B12C                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:B12D                 </span><span style="color:navy">call    </span>READTIME
<span style="color:maroon">DOSCODE:B130                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:B131                 </span><span style="color:navy">les     di, [bp-</span><span style="color:green">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B134                 </span><span style="color:navy">mov     ax, cx
</span><span style="color:maroon">DOSCODE:B136                 </span><span style="color:navy">call    </span>BinToAscii
<span style="color:maroon">DOSCODE:B139                 </span><span style="color:navy">mov     ax, dx
</span><span style="color:maroon">DOSCODE:B13B                 </span><span style="color:navy">call    </span>BinToAscii
<span style="color:maroon">DOSCODE:B13E                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:B140                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:B141                 </span><span style="color:navy">lds     dx, [bp-</span><span style="color:green">8</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B144                 </span><span style="color:navy">mov     cx, [bp-</span><span style="color:green">10</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B147                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:B148                 </span><span style="color:navy">call    </span>$CreateNewFile
<span style="color:maroon">DOSCODE:B14B                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:B14C                 </span><span style="color:navy">jnb     short </span>CreateDone
<span style="color:maroon">DOSCODE:B14E                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">50h </span><span style="color:gray">; &#039;P&#039;
</span><span style="color:maroon">DOSCODE:B150                 </span><span style="color:navy">jz      short </span>CreateLoop
<span style="color:maroon">DOSCODE:B152                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:B154                 </span><span style="color:navy">jnz     short </span>SETTMPERR
<span style="color:maroon">DOSCODE:B156                 </span><span style="color:navy">cmp     ss:</span>EXTERR<span style="color:navy">, </span><span style="color:#ff8000">41h </span><span style="color:gray">; &#039;A&#039;
</span><span style="color:maroon">DOSCODE:B15C                 </span><span style="color:navy">jz      short </span>SETTMPERR
<span style="color:maroon">DOSCODE:B15E                 </span><span style="color:navy">cmp     ss:</span>EXTERR<span style="color:navy">, </span><span style="color:#ff8000">53h </span><span style="color:gray">; &#039;S&#039;
</span><span style="color:maroon">DOSCODE:B164                 </span><span style="color:navy">jz      short </span>SETTMPERR
<span style="color:maroon">DOSCODE:B166                 </span><span style="color:navy">jmp     short </span>CreateLoop
<span style="color:maroon">DOSCODE:B168 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B168
DOSCODE:B168 </span>SETTMPERR<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B168                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:B169
DOSCODE:B169 </span>CreateDone<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B169                 </span><span style="color:navy">mov     sp, bp
</span><span style="color:maroon">DOSCODE:B16B                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:B16C                 </span><span style="color:navy">jb      short </span>CreateFail
<span style="color:maroon">DOSCODE:B16E                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:B171 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B171 </span><span style="color:gray">; START OF FUNCTION CHUNK FOR $Extended_Open
</span><span style="color:black">DOSCODE:B171
DOSCODE:B171 </span>CreateFail<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B171                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:B171 </span><span style="color:gray">; END OF FUNCTION CHUNK FOR $Extended_Open
</span><span style="color:black">DOSCODE:B174
DOSCODE:B174 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B174
DOSCODE:B174
DOSCODE:B174 </span>SetAttrib       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B174                 </span><span style="color:navy">test    ss:</span>FSHARING<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:B17A                 </span><span style="color:navy">jnz     short </span><span style="color:gray">Set
</span><span style="color:black">DOSCODE:B17C                 </span><span style="color:navy">mov     cl, ch
</span><span style="color:black">DOSCODE:B17E
DOSCODE:B17E </span><span style="color:gray">Set</span><span style="color:navy">:                                    </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B17E                 </span><span style="color:navy">mov     ss:</span>SATTRIB<span style="color:navy">, cl
</span><span style="color:black">DOSCODE:B183                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B183 </span>SetAttrib       endp
<span style="color:black">DOSCODE:B183
DOSCODE:B184
DOSCODE:B184 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B184
DOSCODE:B184
DOSCODE:B184 </span>$Extended_Open  proc near               <span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:B184
DOSCODE:B184 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:43F1 SIZE 00000009 BYTES
</span><span style="color:black">DOSCODE:B184 </span><span style="color:gray">; FUNCTION CHUNK AT DOSCODE:B171 SIZE 00000003 BYTES
</span><span style="color:black">DOSCODE:B184
DOSCODE:B184                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_FLAG<span style="color:navy">, dx
</span><span style="color:black">DOSCODE:B189                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_IO_MODE<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:B190                 </span><span style="color:navy">test    dx, </span><span style="color:green">0FE00h
</span><span style="color:black">DOSCODE:B194                 </span><span style="color:navy">jnz     short </span>ext_inval2
<span style="color:black">DOSCODE:B196                 </span><span style="color:navy">mov     ah, dl
</span><span style="color:black">DOSCODE:B198                 </span><span style="color:navy">cmp     dl, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:B19B                 </span><span style="color:navy">jz      short </span>ext_inval2
<span style="color:black">DOSCODE:B19D                 </span><span style="color:navy">and     dl, </span><span style="color:green">0Fh
</span><span style="color:black">DOSCODE:B1A0                 </span><span style="color:navy">cmp     dl, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B1A3                 </span><span style="color:navy">ja      short </span>ext_inval2
<span style="color:black">DOSCODE:B1A5                 </span><span style="color:navy">and     ah, </span><span style="color:green">0F0h
</span><span style="color:black">DOSCODE:B1A8                 </span><span style="color:navy">cmp     ah, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:B1AB                 </span><span style="color:navy">ja      short </span>ext_inval2
<span style="color:black">DOSCODE:B1AD                 </span><span style="color:navy">mov     ss:</span>SAVE_ES<span style="color:navy">, es
</span><span style="color:black">DOSCODE:B1B2                 </span><span style="color:navy">mov     ss:</span>SAVE_DI<span style="color:navy">, di
</span><span style="color:black">DOSCODE:B1B7                 </span><span style="color:navy">push    ss:</span>EXTOPEN_FLAG
<span style="color:black">DOSCODE:B1BC                 </span><span style="color:navy">pop     ss:</span>SAVE_DX
<span style="color:black">DOSCODE:B1C1                 </span><span style="color:navy">mov     ss:</span>SAVE_CX<span style="color:navy">, cx
</span><span style="color:black">DOSCODE:B1C6                 </span><span style="color:navy">mov     ss:</span>SAVE_BX<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:B1CB                 </span><span style="color:navy">mov     ss:</span>SAVE_DS<span style="color:navy">, ds
</span><span style="color:black">DOSCODE:B1D0                 </span><span style="color:navy">mov     ss:</span>SAVE_SI<span style="color:navy">, si
</span><span style="color:black">DOSCODE:B1D5                 </span><span style="color:navy">mov     dx, si
</span><span style="color:black">DOSCODE:B1D7                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:B1D9                 </span><span style="color:navy">jmp     short </span>goopen2
<span style="color:black">DOSCODE:B1DB </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B1DB
DOSCODE:B1DB </span>ext_inval2<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B1DB                 </span><span style="color:navy">mov     al, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:B1DD
DOSCODE:B1DD </span>jmp_to_CreateFail<span style="color:navy">:                      </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B1DD                 </span><span style="color:navy">jmp     short </span>CreateFail
<span style="color:black">DOSCODE:B1DF </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B1DF
DOSCODE:B1DF </span>ext_inval_parm<span style="color:navy">:
</span><span style="color:black">DOSCODE:B1DF                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B1E0                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:B1E1                 </span><span style="color:navy">mov     al, </span><span style="color:green">13
</span><span style="color:black">DOSCODE:B1E3                 </span><span style="color:navy">jmp     short </span>jmp_to_CreateFail
<span style="color:black">DOSCODE:B1E5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B1E5
DOSCODE:B1E5 </span>error_return<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B1E5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B1E6 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B1E6
DOSCODE:B1E6 </span>goopen2<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B1E6                 </span><span style="color:navy">test    bx, </span><span style="color:green">2000h
</span><span style="color:black">DOSCODE:B1EA                 </span><span style="color:navy">jz      short </span>goopen
<span style="color:black">DOSCODE:B1EC                 </span><span style="color:navy">or      ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B1F2
DOSCODE:B1F2 </span>goopen<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B1F2                 </span><span style="color:navy">or      ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:B1F8                 </span><span style="color:navy">and     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:B1FF                 </span><span style="color:navy">cmp     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:B205                 </span><span style="color:navy">jnz     short </span>chknext
<span style="color:black">DOSCODE:B207                 </span><span style="color:navy">call    </span>$CreateNewFile
<span style="color:black">DOSCODE:B20A                 </span><span style="color:navy">jb      short </span>error_return
<span style="color:black">DOSCODE:B20C
DOSCODE:B20C </span><span style="color:navy">loc_B20C:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B20C                 </span><span style="color:navy">cmp     ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:B212                 </span><span style="color:navy">jz      short </span>ok_return2
<span style="color:black">DOSCODE:B214                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B21B                 </span><span style="color:navy">jmp     </span>setXAttr
<span style="color:black">DOSCODE:B21E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B21E
DOSCODE:B21E </span>ok_return2<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B21E                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:B221 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B221
DOSCODE:B221 </span>chknext<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B221                 </span><span style="color:navy">test    ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:B228                 </span><span style="color:navy">jnz     short </span>exist_open
<span style="color:black">DOSCODE:B22A                 </span><span style="color:navy">call    </span>$CREAT
<span style="color:black">DOSCODE:B22D                 </span><span style="color:navy">jb      short </span>error_return
<span style="color:black">DOSCODE:B22F                 </span><span style="color:navy">cmp     ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:B235                 </span><span style="color:navy">jz      short </span>ok_return2
<span style="color:black">DOSCODE:B237                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B23E                 </span><span style="color:navy">test    ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:B244                 </span><span style="color:navy">jnz     short </span>setXAttr
<span style="color:black">DOSCODE:B246                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">3
</span><span style="color:black">DOSCODE:B24D                 </span><span style="color:navy">jmp     short </span>setXAttr
<span style="color:black">DOSCODE:B24F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B24F
DOSCODE:B24F </span>error_return2<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B24F                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:B250                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B251 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B251
DOSCODE:B251 </span>exist_open<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B251                 </span><span style="color:navy">test    ss:</span>FSHARING<span style="color:navy">, </span><span style="color:green">0FFh
</span><span style="color:black">DOSCODE:B257                 </span><span style="color:navy">jz      short </span>noserver
<span style="color:black">DOSCODE:B259                 </span><span style="color:navy">mov     cl, ch
</span><span style="color:black">DOSCODE:B25B
DOSCODE:B25B </span>noserver<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B25B                 </span><span style="color:navy">call    </span>$Open2
<span style="color:black">DOSCODE:B25E                 </span><span style="color:navy">jnb     short </span>ext_ok
<span style="color:black">DOSCODE:B260                 </span><span style="color:navy">cmp     ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:B266                 </span><span style="color:navy">jz      short </span>error_return2
<span style="color:black">DOSCODE:B268                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B26B                 </span><span style="color:navy">jnz     short </span>error_return2
<span style="color:black">DOSCODE:B26D                 </span><span style="color:navy">test    ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">10h
</span><span style="color:black">DOSCODE:B274                 </span><span style="color:navy">jnz     short </span>do_creat
<span style="color:black">DOSCODE:B276                 </span><span style="color:navy">jmp     short </span>extexit
<span style="color:black">DOSCODE:B278 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B278
DOSCODE:B278 </span>do_creat<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B278                 </span><span style="color:navy">mov     cx, ss:</span>SAVE_CX
<span style="color:black">DOSCODE:B27D                 </span><span style="color:navy">lds     si, dword ptr ss:</span>SAVE_SI
<span style="color:black">DOSCODE:B282                 </span><span style="color:navy">mov     dx, si
</span><span style="color:black">DOSCODE:B284                 </span><span style="color:navy">call    </span>$CREAT
<span style="color:black">DOSCODE:B287                 </span><span style="color:navy">jb      short </span>extexit
<span style="color:black">DOSCODE:B289                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B290                 </span><span style="color:navy">jmp     short </span>setXAttr
<span style="color:black">DOSCODE:B292 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B292
DOSCODE:B292 </span>ext_ok<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B292                 </span><span style="color:navy">cmp     ss:</span>EXTOPEN_ON<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:black">DOSCODE:B298                 </span><span style="color:navy">jz      short </span>ok_return
<span style="color:black">DOSCODE:B29A                 </span><span style="color:navy">mov     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:B2A1
DOSCODE:B2A1 </span>setXAttr<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B2A1                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:B2A2                 </span><span style="color:navy">call    </span>Get_User_Stack
<span style="color:black">DOSCODE:B2A5                 </span><span style="color:navy">mov     ax, ss:</span>EXTOPEN_FLAG
<span style="color:black">DOSCODE:B2A9                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:B2AC                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:B2AD                 </span><span style="color:navy">mov     [si], ax
</span><span style="color:black">DOSCODE:B2AF
DOSCODE:B2AF </span>ok_return<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B2AF                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:black">DOSCODE:B2B2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B2B2
DOSCODE:B2B2 </span>extexit2<span style="color:navy">:
</span><span style="color:black">DOSCODE:B2B2                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:B2B3                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:B2B4                 </span><span style="color:navy">cmp     ss:</span>EXTOPEN_FLAG<span style="color:navy">, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B2BA                 </span><span style="color:navy">jnz     short </span>justopen
<span style="color:black">DOSCODE:B2BC                 </span><span style="color:navy">lds     si, dword ptr ss:</span>SAVE_SI
<span style="color:black">DOSCODE:B2C1                 </span><span style="color:navy">lds     dx, [si]
</span><span style="color:black">DOSCODE:B2C3                 </span><span style="color:navy">call    </span>$UNLINK
<span style="color:black">DOSCODE:B2C6                 </span><span style="color:navy">jmp     short </span>reserror
<span style="color:black">DOSCODE:B2C8 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B2C8
DOSCODE:B2C8 </span>justopen<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B2C8                 </span><span style="color:navy">call    </span>$CLOSE
<span style="color:black">DOSCODE:B2CB
DOSCODE:B2CB </span>reserror<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B2CB                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:B2CC                 </span><span style="color:navy">jmp     short </span>extexit
<span style="color:black">DOSCODE:B2CE </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B2CE                 </span><span style="color:navy">mov     ax, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B2D1                 </span><span style="color:navy">jmp     short </span>extexit
<span style="color:black">DOSCODE:B2D3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B2D3                 </span><span style="color:navy">mov     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:B2D6
DOSCODE:B2D6 </span>extexit<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B2D6                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:black">DOSCODE:B2D6 </span>$Extended_Open  endp
<span style="color:black">DOSCODE:B2D6
</span><span style="color:maroon">DOSCODE:B2D9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B2D9
DOSCODE:B2D9 </span>$LockOper<span style="color:navy">:                              </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B2D9                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:B2DB                 </span><span style="color:navy">ja      short </span>lock_bad_func
<span style="color:maroon">DOSCODE:B2DD                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B2DE                 </span><span style="color:navy">call    </span>SFFromHandle
<span style="color:maroon">DOSCODE:B2E1                 </span><span style="color:navy">jnb     short </span>lock_do
<span style="color:maroon">DOSCODE:B2E3                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B2E4                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:B2E6
DOSCODE:B2E6 </span>LockOperErrj<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B2E6                 </span><span style="color:navy">jmp     </span>SYS_RET_ERR
<span style="color:maroon">DOSCODE:B2E9 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B2E9
DOSCODE:B2E9 </span>lock_bad_func<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B2E9                 </span><span style="color:navy">mov     ss:</span>EXTERR_LOCUS<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:B2EF                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:B2F1
DOSCODE:B2F1 </span>LockOperErr<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B2F1                 </span><span style="color:navy">jmp     short </span>LockOperErrj
<span style="color:maroon">DOSCODE:B2F3 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B2F3
DOSCODE:B2F3 </span>lock_do<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B2F3                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:maroon">DOSCODE:B2F5                 </span><span style="color:navy">mov     bp, offset </span>Lock_Buffer
<span style="color:maroon">DOSCODE:B2F8                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">0</span><span style="color:navy">], dx
</span><span style="color:maroon">DOSCODE:B2FB                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">2</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:B2FE                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:B2FF                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:B302                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">6</span><span style="color:navy">], si
</span><span style="color:maroon">DOSCODE:B305                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:B308                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:B309                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B30A                 </span><span style="color:navy">mov     dx, bp
</span><span style="color:maroon">DOSCODE:B30C                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:B30E                 </span><span style="color:navy">jnz     short </span>DOS_Unlock
<span style="color:maroon">DOSCODE:B310                 </span><span style="color:navy">jmp     short </span>DOS_Lock
<span style="color:maroon">DOSCODE:B312 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B312
DOSCODE:B312 </span>DOS_Unlock<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B312                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:maroon">DOSCODE:B317                 </span><span style="color:navy">jz      short </span>LOCAL_UNLOCK
<span style="color:maroon">DOSCODE:B319                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">110Ah
</span><span style="color:maroon">DOSCODE:B31C                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - LOCK REGION OF FILE
<span style="color:maroon">DOSCODE:B31C                                         </span>; BX = file handle, CX:DX = starting offset, SI = high word of size
<span style="color:maroon">DOSCODE:B31C                                         </span>; STACK: WORD low word of size, ES:DI -&gt; SFT
<span style="color:maroon">DOSCODE:B31C                                         </span>; SFT DPB field -&gt; DPB of drive containing file, SS = DOS CS
<span style="color:maroon">DOSCODE:B31C                                         </span>; Return: CF set error
<span style="color:maroon">DOSCODE:B31E                 </span><span style="color:navy">jmp     short </span>ValChk
<span style="color:maroon">DOSCODE:B320 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B320
DOSCODE:B320 </span>LOCAL_UNLOCK<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B320                 </span><span style="color:navy">call    </span>clr_block
<span style="color:maroon">DOSCODE:B324
DOSCODE:B324 </span>ValChk<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B324                 </span><span style="color:navy">jnb     short </span>Lock_OK
<span style="color:maroon">DOSCODE:B326                 </span><span style="color:navy">jmp     short </span>LockOperErr
<span style="color:maroon">DOSCODE:B328 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B328
DOSCODE:B328 </span>Lock_OK<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B328                 </span><span style="color:navy">mov     ax, </span>TEMP_VAR
<span style="color:maroon">DOSCODE:B32B                 </span><span style="color:navy">jmp     </span>SYS_RET_OK
<span style="color:maroon">DOSCODE:B32E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B32E
DOSCODE:B32E </span>DOS_Lock<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B32E                 </span><span style="color:navy">test    byte ptr es:[di+</span><span style="color:#ff8000">6</span><span style="color:navy">], </span><span style="color:green">80h
</span><span style="color:maroon">DOSCODE:B333                 </span><span style="color:navy">jz      short </span>LOCAL_LOCK
<span style="color:maroon">DOSCODE:B335                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">110Ah
</span><span style="color:maroon">DOSCODE:B338                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; Multiplex - NETWORK REDIRECTOR - LOCK REGION OF FILE
<span style="color:maroon">DOSCODE:B338                                         </span>; BX = file handle, CX:DX = starting offset, SI = high word of size
<span style="color:maroon">DOSCODE:B338                                         </span>; STACK: WORD low word of size, ES:DI -&gt; SFT
<span style="color:maroon">DOSCODE:B338                                         </span>; SFT DPB field -&gt; DPB of drive containing file, SS = DOS CS
<span style="color:maroon">DOSCODE:B338                                         </span>; Return: CF set error
<span style="color:maroon">DOSCODE:B33A                 </span><span style="color:navy">jmp     short </span>ValChk
<span style="color:maroon">DOSCODE:B33C </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B33C
DOSCODE:B33C </span>LOCAL_LOCK<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B33C                 </span><span style="color:navy">call    </span>set_block
<span style="color:maroon">DOSCODE:B340                 </span><span style="color:navy">jmp     short </span>ValChk
<span style="color:black">DOSCODE:B342
DOSCODE:B342 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B342
DOSCODE:B342
DOSCODE:B342 </span>LOCK_CHECK      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B342                 </span><span style="color:navy">mov     bx, </span>RetryCount
<span style="color:black">DOSCODE:B346
DOSCODE:B346 </span><span style="color:gray">LockRetry</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B346                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:B347                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:B348                 </span><span style="color:navy">call    </span>chk_block
<span style="color:black">DOSCODE:B34C                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:B34D                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:B34E                 </span><span style="color:navy">jnb     short </span>lc_ret_label
<span style="color:black">DOSCODE:B350                 </span><span style="color:navy">call    </span>Idle
<span style="color:black">DOSCODE:B353                 </span><span style="color:navy">dec     bx
</span><span style="color:black">DOSCODE:B354                 </span><span style="color:navy">jnz     short </span><span style="color:gray">LockRetry
</span><span style="color:black">DOSCODE:B356                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:B357
DOSCODE:B357 </span>lc_ret_label<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B357                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B357 </span>LOCK_CHECK      endp
<span style="color:black">DOSCODE:B357
DOSCODE:B358
DOSCODE:B358 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B358
DOSCODE:B358
DOSCODE:B358 </span>LOCK_VIOLATION  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B358                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:B359                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:B35A                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:B35B                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B35C                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">21h </span><span style="color:gray">; &#039;!&#039;
</span><span style="color:black">DOSCODE:B35F                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:B364                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:B368                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:B36B                 </span><span style="color:navy">mov     cx, di
</span><span style="color:black">DOSCODE:B36D                 </span><span style="color:navy">mov     dx, es:[bp+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B371                 </span><span style="color:navy">call    </span>HARDERR
<span style="color:black">DOSCODE:B374                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B375                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:B376                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:B377                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B378                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:B37A                 </span><span style="color:navy">jz      short </span>lc_ret_label
<span style="color:black">DOSCODE:B37C                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:B37D                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B37D </span>LOCK_VIOLATION  endp
<span style="color:black">DOSCODE:B37D
DOSCODE:B37E
DOSCODE:B37E </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B37E
DOSCODE:B37E
DOSCODE:B37E </span>CheckShare      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B37E                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:B37F                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:B384                 </span><span style="color:navy">cmp     </span>fShare<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:B389                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B38A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B38A </span>CheckShare      endp
<span style="color:black">DOSCODE:B38A
DOSCODE:B38B
DOSCODE:B38B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B38B
DOSCODE:B38B
DOSCODE:B38B </span>SHARE_CHECK     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B38B                 </span><span style="color:navy">call    </span>MFT_enter
<span style="color:black">DOSCODE:B38F
DOSCODE:B38F </span>shchk_retn<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B38F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B38F </span>SHARE_CHECK     endp
<span style="color:black">DOSCODE:B38F
DOSCODE:B390
DOSCODE:B390 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B390
DOSCODE:B390
DOSCODE:B390 </span>SHARE_VIOLATION proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B390                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:B391                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:B392                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:B393                 </span><span style="color:navy">mov     </span>READOP<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:B398                 </span><span style="color:navy">mov     </span>ALLOWED<span style="color:navy">, </span><span style="color:#ff8000">18h
</span><span style="color:black">DOSCODE:B39D                 </span><span style="color:navy">les     bp, </span>THISDPB
<span style="color:black">DOSCODE:B3A1                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:B3A4                 </span><span style="color:navy">mov     cx, di
</span><span style="color:black">DOSCODE:B3A6                 </span><span style="color:navy">mov     dx, es:[bp+</span><span style="color:green">17</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B3AA                 </span><span style="color:navy">call    </span>HARDERR
<span style="color:black">DOSCODE:B3AD                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:B3AE                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:B3AF                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B3B0                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">1
</span><span style="color:black">DOSCODE:B3B2                 </span><span style="color:navy">jz      short </span>shchk_retn
<span style="color:black">DOSCODE:B3B4                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:B3B5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B3B5 </span>SHARE_VIOLATION endp
<span style="color:black">DOSCODE:B3B5
DOSCODE:B3B6
DOSCODE:B3B6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B3B6
DOSCODE:B3B6
DOSCODE:B3B6 </span>ShareEnd        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B3B6                 </span><span style="color:navy">call    </span>MFTClose
<span style="color:black">DOSCODE:B3BA                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B3BA </span>ShareEnd        endp
<span style="color:black">DOSCODE:B3BA
DOSCODE:B3BB
DOSCODE:B3BB </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B3BB
DOSCODE:B3BB
DOSCODE:B3BB </span>ShareEnter      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B3BB                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B3BC
DOSCODE:B3BC </span><span style="color:gray">retry</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B3BC                 </span><span style="color:navy">mov     cx, </span>RetryCount
<span style="color:black">DOSCODE:B3C0
DOSCODE:B3C0 </span><span style="color:gray">attempt</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B3C0                 </span><span style="color:navy">les     di, </span>THISSFT
<span style="color:black">DOSCODE:B3C4                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:B3C6                 </span><span style="color:navy">mov     es:[di+</span><span style="color:green">51</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:B3CA                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B3CB                 </span><span style="color:navy">call    </span>SHARE_CHECK
<span style="color:black">DOSCODE:B3CE                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B3CF                 </span><span style="color:navy">jnb     short </span><span style="color:gray">done
</span><span style="color:black">DOSCODE:B3D1                 </span><span style="color:navy">call    </span>Idle
<span style="color:black">DOSCODE:B3D4                 </span><span style="color:navy">loop    </span><span style="color:gray">attempt
</span><span style="color:black">DOSCODE:B3D6                 </span><span style="color:navy">call    </span>SHARE_VIOLATION
<span style="color:black">DOSCODE:B3D9                 </span><span style="color:navy">jnb     short </span><span style="color:gray">retry
</span><span style="color:black">DOSCODE:B3DB
DOSCODE:B3DB </span><span style="color:gray">done</span><span style="color:navy">:                                   </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B3DB                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B3DC                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B3DC </span>ShareEnter      endp
<span style="color:black">DOSCODE:B3DC
DOSCODE:B3DD
DOSCODE:B3DD </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B3DD
DOSCODE:B3DD
DOSCODE:B3DD </span>ExecReady       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B3DD                 </span><span style="color:navy">mov     si, dx
</span><span style="color:black">DOSCODE:B3DF                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">1
</span><span style="color:black">DOSCODE:B3E4                 </span><span style="color:navy">jz      short </span><span style="color:gray">er_setver
</span><span style="color:black">DOSCODE:B3E6                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B3E9                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">10h
</span><span style="color:black">DOSCODE:B3EC                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:B3EE                 </span><span style="color:navy">mov     cx, [si+</span><span style="color:#ff8000">0Ah</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B3F1                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">0Ch</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B3F4                 </span><span style="color:navy">call    ss:</span>FixExePatch
<span style="color:black">DOSCODE:B3F9                 </span><span style="color:navy">call    ss:</span>Rational386PatchPtr
<span style="color:black">DOSCODE:B3FE
DOSCODE:B3FE </span><span style="color:gray">er_setver</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B3FE                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B403                 </span><span style="color:navy">jnz     short </span><span style="color:gray">er_chkdoshi
</span><span style="color:black">DOSCODE:B405                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:B406                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:B407                 </span><span style="color:navy">lds     si, [si+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B40A                 </span><span style="color:navy">call    </span>Scan_Execname1
<span style="color:black">DOSCODE:B40D                 </span><span style="color:navy">call    </span>Scan_Special_Entries
<span style="color:black">DOSCODE:B410                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:B411                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B412                 </span><span style="color:navy">mov     es, word ptr [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B415                 </span><span style="color:navy">mov     ax, ss:</span>SPECIAL_VERSION
<span style="color:black">DOSCODE:B419                 </span><span style="color:navy">mov     word ptr es:</span>SFTFCB<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:B41D
DOSCODE:B41D </span><span style="color:gray">er_chkdoshi</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B41D                 </span><span style="color:navy">cmp     ss:</span>DosHasHMA<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:B423                 </span><span style="color:navy">jz      short </span><span style="color:gray">er_done
</span><span style="color:black">DOSCODE:B425                 </span><span style="color:navy">mov     ax, [si+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B428                 </span><span style="color:navy">or      ss:</span>DOS_FLAG<span style="color:navy">, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:B42E                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">2</span><span style="color:navy">], </span><span style="color:green">1
</span><span style="color:black">DOSCODE:B433                 </span><span style="color:navy">jnz     short </span><span style="color:gray">er_seta20
</span><span style="color:black">DOSCODE:B435                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:B436                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:black">DOSCODE:B438                 </span><span style="color:navy">call    </span>IsCopyProt
<span style="color:black">DOSCODE:B43B                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B43C
DOSCODE:B43C </span><span style="color:gray">er_seta20</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B43C                 </span><span style="color:navy">inc     ss:</span>A20OFF_COUNT
<span style="color:black">DOSCODE:B441                 </span><span style="color:navy">mov     ss:</span>A20OFF_PSP<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:B445
DOSCODE:B445 </span><span style="color:gray">er_done</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B445                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:B447                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B447 </span>ExecReady       endp
<span style="color:black">DOSCODE:B447
DOSCODE:B447 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:B448 </span>rpFind1         <span style="color:navy">db </span><span style="color:#008040">0FAh</span><span style="color:navy">, </span><span style="color:#008040">0E4h</span><span style="color:navy">, </span><span style="color:#008040">21h</span><span style="color:navy">, </span><span style="color:#008040">60h</span><span style="color:navy">, </span><span style="color:#008040">33h</span><span style="color:navy">, </span><span style="color:#008040">0C0h</span><span style="color:navy">, </span><span style="color:#008040">0E6h</span><span style="color:navy">, </span><span style="color:#008040">43h</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">16h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B452 </span>rpFind1a        <span style="color:navy">db </span><span style="color:#008040">0B0h</span><span style="color:navy">, </span><span style="color:#008040">0Eh</span><span style="color:navy">, </span><span style="color:#008040">0E6h</span><span style="color:navy">, </span><span style="color:#008040">37h</span><span style="color:navy">, </span><span style="color:#008040">33h</span><span style="color:navy">, </span><span style="color:#008040">0C0h</span><span style="color:navy">, </span><span style="color:#008040">0E6h</span><span style="color:navy">, </span><span style="color:#008040">0F2h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B45A </span>rpFind2         <span style="color:navy">db </span><span style="color:#008040">0Fh</span><span style="color:navy">, </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">0C0h       </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B45D </span>rpFind3         <span style="color:navy">db </span><span style="color:#008040">0Fh</span><span style="color:navy">, </span><span style="color:#008040">22h</span><span style="color:navy">, </span><span style="color:#008040">0C0h</span><span style="color:navy">, </span><span style="color:#008040">0EAh </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B461 </span>rpRepl2         <span style="color:navy">db </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">50h</span><span style="color:navy">, </span><span style="color:#008040">51h</span><span style="color:navy">, </span><span style="color:#008040">0Fh</span><span style="color:navy">, </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">0C0h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B467 </span>rpRepl3         <span style="color:navy">db </span><span style="color:#008040">8Eh</span><span style="color:navy">, </span><span style="color:#008040">0D3h</span><span style="color:navy">, </span><span style="color:#008040">59h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">58h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B46C </span>rpFind4         <span style="color:navy">db </span><span style="color:#008040">93h</span><span style="color:navy">, </span><span style="color:#008040">58h</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0CCh  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B470 </span>rpFind5         <span style="color:navy">db </span><span style="color:#008040">0B8h</span><span style="color:navy">, </span><span style="color:#008040">0Ch</span><span style="color:navy">, </span><span style="color:#008040">0DEh</span><span style="color:navy">, </span><span style="color:#008040">0CDh</span><span style="color:navy">, </span><span style="color:#008040">67h</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0E1h</span><span style="color:navy">, </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">0E3h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B479 </span>rpRepl4         <span style="color:navy">db </span><span style="color:#008040">93h</span><span style="color:navy">, </span><span style="color:#008040">58h</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0CCh  </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B47D                 </span><span style="color:navy">db </span><span style="color:#008040">2Eh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">0A3h
</span><span style="color:gray">DOSCODE:B480                 </span><span style="color:navy">db </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0
</span><span style="color:gray">DOSCODE:B482                 </span><span style="color:navy">db </span><span style="color:#008040">2Eh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">89h</span><span style="color:navy">, </span><span style="color:#008040">36h
</span><span style="color:gray">DOSCODE:B486                 </span><span style="color:navy">db </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0
</span><span style="color:gray">DOSCODE:B488 </span>rpRepl5         <span style="color:navy">db </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0E1h            </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B48A                 </span><span style="color:navy">db </span><span style="color:#008040">2Eh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">0A1h
</span><span style="color:gray">DOSCODE:B48D                 </span><span style="color:navy">db </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0
</span><span style="color:gray">DOSCODE:B48F                 </span><span style="color:navy">db </span><span style="color:#008040">2Eh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">36h
</span><span style="color:gray">DOSCODE:B493                 </span><span style="color:navy">db </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0
</span><span style="color:gray">DOSCODE:B495                 </span><span style="color:navy">db </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">0E3h
</span><span style="color:gray">DOSCODE:B497 </span>rpFind6         <span style="color:navy">db </span><span style="color:#008040">0FAh</span><span style="color:navy">, </span><span style="color:#008040">52h</span><span style="color:navy">, </span><span style="color:#008040">51h       </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B49A </span>rpFind7a        <span style="color:navy">db </span><span style="color:#008040">0B8h</span><span style="color:navy">, </span><span style="color:#008040">0Ch</span><span style="color:navy">, </span><span style="color:#008040">0DEh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">26h</span><span style="color:navy">, </span><span style="color:#008040">0FFh</span><span style="color:navy">, </span><span style="color:#008040">1Eh </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4A1 </span>rpFind7b        <span style="color:navy">db </span><span style="color:#008040">59h</span><span style="color:navy">, </span><span style="color:#008040">5Ah</span><span style="color:navy">, </span><span style="color:#008040">5Bh        </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4A4 </span>rpRepl6         <span style="color:navy">db </span><span style="color:#008040">0FAh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">50h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">53h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">51h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">52h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4AD </span>rpRepl7         <span style="color:navy">db </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">5Ah</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">59h</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">5Bh</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">58h</span><span style="color:navy">, </span><span style="color:#008040">5Bh </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4B6 </span>rpFind8         <span style="color:navy">db </span><span style="color:#008040">60h</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">1Eh</span><span style="color:navy">, </span><span style="color:#008040">0B8h</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">0</span><span style="color:navy">, </span><span style="color:#008040">8Eh</span><span style="color:navy">, </span><span style="color:#008040">0D8h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4BE </span>rpFind9         <span style="color:navy">db </span><span style="color:#008040">1Fh</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">61h          </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4C1 </span>rpRepl8         <span style="color:navy">db </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">60h</span><span style="color:navy">, </span><span style="color:#008040">6</span><span style="color:navy">, </span><span style="color:#008040">1Eh     </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4C5 </span>rpRepl9         <span style="color:navy">db </span><span style="color:#008040">1Fh</span><span style="color:navy">, </span><span style="color:#008040">7</span><span style="color:navy">, </span><span style="color:#008040">66h</span><span style="color:navy">, </span><span style="color:#008040">61h</span><span style="color:navy">, </span><span style="color:#008040">0C3h </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4CA </span>rpBug1Strs      <span style="color:navy">dw offset </span>rpFind2       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4CC                 </span><span style="color:navy">dw </span><span style="color:#008040">3
</span><span style="color:gray">DOSCODE:B4CE                 </span><span style="color:navy">dw offset </span>rpFind3
<span style="color:gray">DOSCODE:B4D0                 </span><span style="color:navy">dw </span><span style="color:#008040">4
</span><span style="color:gray">DOSCODE:B4D2                 </span><span style="color:navy">dw </span><span style="color:#008040">20h
</span><span style="color:gray">DOSCODE:B4D4 </span>rpBug2Strs      <span style="color:navy">dw offset </span>rpFind4       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4D6                 </span><span style="color:navy">dw </span><span style="color:#008040">4
</span><span style="color:gray">DOSCODE:B4D8                 </span><span style="color:navy">dw offset </span>rpFind5
<span style="color:gray">DOSCODE:B4DA                 </span><span style="color:navy">dw </span><span style="color:#008040">9
</span><span style="color:gray">DOSCODE:B4DC                 </span><span style="color:navy">dw </span><span style="color:#008040">80h
</span><span style="color:gray">DOSCODE:B4DE </span>rpBug3Strs      <span style="color:navy">dw offset </span>rpFind6       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4E0                 </span><span style="color:navy">dw </span><span style="color:#008040">3
</span><span style="color:gray">DOSCODE:B4E2                 </span><span style="color:navy">dw offset </span>rpFind7a
<span style="color:gray">DOSCODE:B4E4                 </span><span style="color:navy">dw </span><span style="color:#008040">7
</span><span style="color:gray">DOSCODE:B4E6                 </span><span style="color:navy">dw </span><span style="color:#008040">80h
</span><span style="color:gray">DOSCODE:B4E8 </span>rpBug4Strs      <span style="color:navy">dw offset </span>rpFind8       <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B4EA                 </span><span style="color:navy">dw </span><span style="color:#008040">4
</span><span style="color:gray">DOSCODE:B4EC                 </span><span style="color:navy">dw offset </span>rpFind9
<span style="color:gray">DOSCODE:B4EE                 </span><span style="color:navy">dw </span><span style="color:#008040">3
</span><span style="color:gray">DOSCODE:B4F0                 </span><span style="color:navy">dw </span><span style="color:#008040">80h
</span><span style="color:maroon">DOSCODE:B4F2 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B4F2
DOSCODE:B4F2 </span>Rational386Patch<span style="color:navy">:                       </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B4F2                 </span><span style="color:navy">cmp     </span>word ptr es:0<span style="color:navy">, </span><span style="color:green">18Bh
</span><span style="color:maroon">DOSCODE:B4F9                 </span><span style="color:navy">jnb     short </span>rp3QuickOut
<span style="color:maroon">DOSCODE:B4FB                 </span><span style="color:navy">cmp     word ptr es:</span>WinoldPatch1<span style="color:navy">+</span><span style="color:green">6</span><span style="color:navy">, </span><span style="color:#ff8000">20h </span><span style="color:gray">; &#039; &#039;
</span><span style="color:maroon">DOSCODE:B501                 </span><span style="color:navy">jnz     short </span>rp3QuickOut
<span style="color:maroon">DOSCODE:B503                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:B504                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">18h
</span><span style="color:maroon">DOSCODE:B507                 </span><span style="color:navy">cmp     es:</span>LeaveAddr<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:B50C                 </span><span style="color:navy">jnz     short </span>rp3QO_ax
<span style="color:maroon">DOSCODE:B50E                 </span><span style="color:navy">cmp     es:</span>RetryLoop<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:B513                 </span><span style="color:navy">jnz     short </span>rp3QO_ax
<span style="color:maroon">DOSCODE:B515                 </span><span style="color:navy">cmp     es:</span>arena_head<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:B51A                 </span><span style="color:navy">jz      short </span>rp3Maybe
<span style="color:maroon">DOSCODE:B51C
DOSCODE:B51C </span>rp3QO_ax<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B51C                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:B51D
DOSCODE:B51D </span>rp3QuickOut<span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B51D                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:B51E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B51E
DOSCODE:B51E </span>rp3Maybe<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B51E                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:B51F                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:B520                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:B521                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:B522                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:B523                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B524                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:B525                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:B526                 </span><span style="color:navy">push    bp
</span><span style="color:maroon">DOSCODE:B527                 </span><span style="color:navy">sub     sp, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:B52A                 </span><span style="color:navy">mov     bp, sp
</span><span style="color:maroon">DOSCODE:B52C                 </span><span style="color:navy">push    cs
</span><span style="color:maroon">DOSCODE:B52D                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B52E                 </span><span style="color:navy">mov     ax, </span>word ptr es:0
<span style="color:maroon">DOSCODE:B532                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">0</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:B535                 </span><span style="color:navy">call    </span>VerifyVersion
<span style="color:maroon">DOSCODE:B538                 </span><span style="color:navy">jnz     short </span>rp3Exit_j
<span style="color:maroon">DOSCODE:B53A                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">4500h
</span><span style="color:maroon">DOSCODE:B53D                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">2</span><span style="color:navy">], cx
</span><span style="color:maroon">DOSCODE:B540                 </span><span style="color:navy">mov     es, word ptr es:</span>LastBuffer<span style="color:navy">+</span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:B545                 </span><span style="color:navy">mov     si, offset </span>rpFind1
<span style="color:maroon">DOSCODE:B548                 </span><span style="color:navy">mov     dx, </span><span style="color:green">10
</span><span style="color:maroon">DOSCODE:B54B                 </span><span style="color:navy">call    </span>ScanCodeSeq
<span style="color:maroon">DOSCODE:B54E                 </span><span style="color:navy">jz      short </span>rpGotPatch
<span style="color:maroon">DOSCODE:B550                 </span><span style="color:navy">mov     si, offset </span>rpFind1a
<span style="color:maroon">DOSCODE:B553                 </span><span style="color:navy">mov     dx, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:B556                 </span><span style="color:navy">call    </span>ScanCodeSeq
<span style="color:maroon">DOSCODE:B559                 </span><span style="color:navy">jz      short </span>rpGotPatch
<span style="color:maroon">DOSCODE:B55B
DOSCODE:B55B </span>rp3Exit_j<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B55B                 </span><span style="color:navy">jmp     </span>rp3Exit
<span style="color:maroon">DOSCODE:B55E </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B55E
DOSCODE:B55E </span>rpGotPatch<span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B55E                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">], di
</span><span style="color:maroon">DOSCODE:B561                 </span><span style="color:navy">cmp     word ptr [bp+</span><span style="color:#ff8000">0</span><span style="color:navy">], </span><span style="color:green">381
</span><span style="color:maroon">DOSCODE:B566                 </span><span style="color:navy">jnb     short </span>rpBug2
<span style="color:maroon">DOSCODE:B568                 </span><span style="color:navy">mov     bx, offset </span>rpBug1Strs
<span style="color:maroon">DOSCODE:B56B                 </span><span style="color:navy">call    </span>FindBadCode
<span style="color:maroon">DOSCODE:B56E                 </span><span style="color:navy">jb      short </span>rpBug2
<span style="color:maroon">DOSCODE:B570                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B571                 </span><span style="color:navy">mov     di, si
</span><span style="color:maroon">DOSCODE:B573                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:B576                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], </span><span style="color:#ff8000">51h </span><span style="color:gray">; &#039;Q&#039;
</span><span style="color:maroon">DOSCODE:B57B                 </span><span style="color:navy">jnz     short </span>rp_no_cx
<span style="color:maroon">DOSCODE:B57D                 </span><span style="color:navy">dec     di
</span><span style="color:maroon">DOSCODE:B57E                 </span><span style="color:navy">inc     dx
</span><span style="color:maroon">DOSCODE:B57F
DOSCODE:B57F </span>rp_no_cx<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B57F                 </span><span style="color:navy">mov     si, offset </span>rpRepl2
<span style="color:maroon">DOSCODE:B582                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">6
</span><span style="color:maroon">DOSCODE:B585                 </span><span style="color:navy">call    </span>GenPatch
<span style="color:maroon">DOSCODE:B588                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B589                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], </span><span style="color:#ff8000">59h </span><span style="color:gray">; &#039;Y&#039;
</span><span style="color:maroon">DOSCODE:B58E                 </span><span style="color:navy">jnz     short </span>rp_no_cx2
<span style="color:maroon">DOSCODE:B590                 </span><span style="color:navy">mov     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], </span><span style="color:#ff8000">90h </span><span style="color:gray">; &#039;&#039;
</span><span style="color:maroon">DOSCODE:B595
DOSCODE:B595 </span>rp_no_cx2<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B595                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B598                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">4</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:B59C                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B59D                 </span><span style="color:navy">mov     si, offset </span>rpRepl3
<span style="color:maroon">DOSCODE:B5A0                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:B5A3                 </span><span style="color:navy">call    </span>CopyPatch
<span style="color:maroon">DOSCODE:B5A6                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:B5A7                 </span><span style="color:navy">add     bx, </span><span style="color:#ff8000">8
</span><span style="color:maroon">DOSCODE:B5AA                 </span><span style="color:navy">call    </span>GenJump
<span style="color:maroon">DOSCODE:B5AD                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">], di
</span><span style="color:maroon">DOSCODE:B5B0
DOSCODE:B5B0 </span>rpBug2<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B5B0                 </span><span style="color:navy">mov     bx, offset </span>rpBug2Strs
<span style="color:maroon">DOSCODE:B5B3                 </span><span style="color:navy">call    </span>FindBadCode
<span style="color:maroon">DOSCODE:B5B6                 </span><span style="color:navy">jb      short </span>rpBug3
<span style="color:maroon">DOSCODE:B5B8                 </span><span style="color:navy">push    word ptr [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B5BB                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B5BC                 </span><span style="color:navy">mov     di, si
</span><span style="color:maroon">DOSCODE:B5BE                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:B5C1                 </span><span style="color:navy">mov     si, offset </span>rpRepl4
<span style="color:maroon">DOSCODE:B5C4                 </span><span style="color:navy">mov     cx, </span><span style="color:green">15
</span><span style="color:maroon">DOSCODE:B5C7                 </span><span style="color:navy">call    </span>GenPatch
<span style="color:maroon">DOSCODE:B5CA                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B5CB                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:B5CE                 </span><span style="color:navy">mov     bx, [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B5D1                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:B5D2                 </span><span style="color:navy">call    </span>GenJump
<span style="color:maroon">DOSCODE:B5D5                 </span><span style="color:navy">mov     si, offset </span>rpRepl5
<span style="color:maroon">DOSCODE:B5D8                 </span><span style="color:navy">mov     cx, </span><span style="color:green">15
</span><span style="color:maroon">DOSCODE:B5DB                 </span><span style="color:navy">call    </span>CopyPatch
<span style="color:maroon">DOSCODE:B5DE                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B5DF                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:B5E0                 </span><span style="color:navy">mov     ax, [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B5E3                 </span><span style="color:navy">mov     es:[si+</span><span style="color:#ff8000">7</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:B5E7                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">5</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:B5EB                 </span><span style="color:navy">add     ax, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:B5EE                 </span><span style="color:navy">mov     es:[si+</span><span style="color:#ff8000">0Dh</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:B5F2                 </span><span style="color:navy">mov     es:[di+</span><span style="color:#ff8000">0Bh</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:B5F6                 </span><span style="color:navy">add     word ptr [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:#ff8000">8
</span><span style="color:maroon">DOSCODE:B5FA
DOSCODE:B5FA </span>rpBug3<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B5FA                 </span><span style="color:navy">mov     bx, offset </span>rpBug3Strs
<span style="color:maroon">DOSCODE:B5FD                 </span><span style="color:navy">call    </span>FindBadCode
<span style="color:maroon">DOSCODE:B600                 </span><span style="color:navy">jb      short </span>rpBug4
<span style="color:maroon">DOSCODE:B602                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">9
</span><span style="color:maroon">DOSCODE:B605                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:B606                 </span><span style="color:navy">mov     si, offset </span>rpFind7b
<span style="color:maroon">DOSCODE:B609                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:B60C                 </span><span style="color:navy">call    </span>ScanCodeSeq_di
<span style="color:maroon">DOSCODE:B60F                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:B610                 </span><span style="color:navy">jnz     short </span>rpBug4
<span style="color:maroon">DOSCODE:B612                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B613                 </span><span style="color:navy">mov     di, si
</span><span style="color:maroon">DOSCODE:B615                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:B618                 </span><span style="color:navy">mov     si, offset </span>rpRepl6
<span style="color:maroon">DOSCODE:B61B                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">9
</span><span style="color:maroon">DOSCODE:B61E                 </span><span style="color:navy">call    </span>GenPatch
<span style="color:maroon">DOSCODE:B621                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B622                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:B625                 </span><span style="color:navy">mov     si, offset </span>rpRepl7
<span style="color:maroon">DOSCODE:B628                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">9
</span><span style="color:maroon">DOSCODE:B62B                 </span><span style="color:navy">call    </span>GenPatch
<span style="color:maroon">DOSCODE:B62E
DOSCODE:B62E </span>rpBug4<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B62E                 </span><span style="color:navy">cmp     word ptr [bp+</span><span style="color:#ff8000">0</span><span style="color:navy">], </span><span style="color:green">360
</span><span style="color:maroon">DOSCODE:B633                 </span><span style="color:navy">jbe     short </span>rp3Exit
<span style="color:maroon">DOSCODE:B635                 </span><span style="color:navy">mov     bx, offset </span>rpBug4Strs
<span style="color:maroon">DOSCODE:B638                 </span><span style="color:navy">call    </span>FindBadCode
<span style="color:maroon">DOSCODE:B63B                 </span><span style="color:navy">jb      short </span>rp3Exit
<span style="color:maroon">DOSCODE:B63D                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B63E                 </span><span style="color:navy">mov     di, si
</span><span style="color:maroon">DOSCODE:B640                 </span><span style="color:navy">mov     dx, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:B643                 </span><span style="color:navy">mov     si, offset </span>rpRepl8
<span style="color:maroon">DOSCODE:B646                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:B649                 </span><span style="color:navy">call    </span>GenPatch
<span style="color:maroon">DOSCODE:B64C                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B64D                 </span><span style="color:navy">mov     bx, [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:B650                 </span><span style="color:navy">call    </span>GenJump
<span style="color:maroon">DOSCODE:B653                 </span><span style="color:navy">mov     si, offset </span>rpRepl9
<span style="color:maroon">DOSCODE:B656                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">5
</span><span style="color:maroon">DOSCODE:B659                 </span><span style="color:navy">call    </span>CopyPatch
<span style="color:maroon">DOSCODE:B65C
DOSCODE:B65C </span>rp3Exit<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B65C                 </span><span style="color:navy">add     sp, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:B65F                 </span><span style="color:navy">pop     bp
</span><span style="color:maroon">DOSCODE:B660                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B661                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:B662                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B663                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:B664                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:B665                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:B666                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:B667                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:B668                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B669
DOSCODE:B669 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B669
DOSCODE:B669
DOSCODE:B669 </span>FindBadCode     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B669                 </span><span style="color:navy">mov     cx, [bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B66C                 </span><span style="color:navy">mov     si, [bx]
</span><span style="color:black">DOSCODE:B66E                 </span><span style="color:navy">mov     dx, [bx+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B671                 </span><span style="color:navy">call    </span>ScanCodeSeq
<span style="color:black">DOSCODE:B674                 </span><span style="color:navy">jnz     short </span><span style="color:gray">fbc_error
</span><span style="color:black">DOSCODE:B676                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:B677                 </span><span style="color:navy">mov     si, [bx+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B67A                 </span><span style="color:navy">mov     dx, [bx+</span><span style="color:#ff8000">6</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B67D                 </span><span style="color:navy">call    </span>ScanCodeSeq_di
<span style="color:black">DOSCODE:B680                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:B681                 </span><span style="color:navy">jnz     short </span><span style="color:gray">fbc_error
</span><span style="color:black">DOSCODE:B683                 </span><span style="color:navy">mov     ax, di
</span><span style="color:black">DOSCODE:B685                 </span><span style="color:navy">sub     ax, si
</span><span style="color:black">DOSCODE:B687                 </span><span style="color:navy">jb      short </span><span style="color:gray">fbc_error
</span><span style="color:black">DOSCODE:B689                 </span><span style="color:navy">cmp     ax, [bx+</span><span style="color:#ff8000">8</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B68C                 </span><span style="color:navy">ja      short </span><span style="color:gray">fbc_error
</span><span style="color:black">DOSCODE:B68E                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:B68F                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B690 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B690
DOSCODE:B690 </span><span style="color:gray">fbc_error</span><span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B690                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:B691                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B691 </span>FindBadCode     endp
<span style="color:black">DOSCODE:B691
DOSCODE:B692
DOSCODE:B692 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B692
DOSCODE:B692
DOSCODE:B692 </span>GenPatch        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B692                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:B693                 </span><span style="color:navy">mov     bx, [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B696                 </span><span style="color:navy">call    </span>GenJump
<span style="color:black">DOSCODE:B699                 </span><span style="color:navy">call    </span>CopyPatch
<span style="color:black">DOSCODE:B69C                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:B69D                 </span><span style="color:navy">add     bx, dx
</span><span style="color:black">DOSCODE:B69F                 </span><span style="color:navy">call    </span>GenJump
<span style="color:black">DOSCODE:B6A2                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">], di
</span><span style="color:black">DOSCODE:B6A5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B6A5 </span>GenPatch        endp
<span style="color:black">DOSCODE:B6A5
DOSCODE:B6A6
DOSCODE:B6A6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B6A6
DOSCODE:B6A6
DOSCODE:B6A6 </span>CopyPatch       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6A6                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B6A7                 </span><span style="color:navy">mov     di, [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:B6AA                 </span><span style="color:navy">cld
</span><span style="color:black">DOSCODE:B6AB                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B6AD                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B6AE                 </span><span style="color:navy">mov     [bp+</span><span style="color:#ff8000">4</span><span style="color:navy">], di
</span><span style="color:black">DOSCODE:B6B1                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B6B1 </span>CopyPatch       endp
<span style="color:black">DOSCODE:B6B1
DOSCODE:B6B2
DOSCODE:B6B2 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B6B2
DOSCODE:B6B2
DOSCODE:B6B2 </span>GenJump         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6B2                 </span><span style="color:navy">mov     al, </span><span style="color:green">0E9h
</span><span style="color:black">DOSCODE:B6B4                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:B6B5                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:B6B7                 </span><span style="color:navy">sub     ax, di
</span><span style="color:black">DOSCODE:B6B9                 </span><span style="color:navy">sub     ax, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:B6BC                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:B6BD                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B6BD </span>GenJump         endp
<span style="color:black">DOSCODE:B6BD
DOSCODE:B6BE
DOSCODE:B6BE </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B6BE
DOSCODE:B6BE
DOSCODE:B6BE </span>ScanCodeSeq     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6BE                 </span><span style="color:navy">mov     di, </span><span style="color:green">200h
</span><span style="color:black">DOSCODE:B6BE </span>ScanCodeSeq     endp
<span style="color:black">DOSCODE:B6BE
DOSCODE:B6C1
DOSCODE:B6C1 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B6C1
DOSCODE:B6C1
DOSCODE:B6C1 </span>ScanCodeSeq_di  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6C1                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B6C2                 </span><span style="color:navy">sub     cx, dx
</span><span style="color:black">DOSCODE:B6C4                 </span><span style="color:navy">inc     cx
</span><span style="color:black">DOSCODE:B6C5
DOSCODE:B6C5 </span><span style="color:gray">scsagain</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6C5                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:B6C6                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:B6C7                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B6C8                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:black">DOSCODE:B6CA                 </span><span style="color:navy">repe cmpsb
</span><span style="color:black">DOSCODE:B6CC                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B6CD                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:B6CE                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:B6CF                 </span><span style="color:navy">jz      short </span><span style="color:gray">scsfound
</span><span style="color:black">DOSCODE:B6D1                 </span><span style="color:navy">inc     di
</span><span style="color:black">DOSCODE:B6D2                 </span><span style="color:navy">loop    </span><span style="color:gray">scsagain
</span><span style="color:black">DOSCODE:B6D4
DOSCODE:B6D4 </span><span style="color:gray">scsfound</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6D4                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B6D5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B6D5 </span>ScanCodeSeq_di  endp
<span style="color:black">DOSCODE:B6D5
DOSCODE:B6D6
DOSCODE:B6D6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B6D6
DOSCODE:B6D6
DOSCODE:B6D6 </span>VerifyVersion   proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6D6                 </span><span style="color:navy">mov     si, word ptr es:</span>SFT_ADDR
<span style="color:black">DOSCODE:B6DB                 </span><span style="color:navy">mov     bl, </span><span style="color:green">10
</span><span style="color:black">DOSCODE:B6DD                 </span><span style="color:navy">add     si, </span><span style="color:green">3
</span><span style="color:black">DOSCODE:B6E0                 </span><span style="color:navy">call    </span>VVDigit
<span style="color:black">DOSCODE:B6E3                 </span><span style="color:navy">jnz     short </span><span style="color:gray">vvexit
</span><span style="color:black">DOSCODE:B6E5                 </span><span style="color:navy">call    </span>VVDigit
<span style="color:black">DOSCODE:B6E8                 </span><span style="color:navy">jnz     short </span><span style="color:gray">vvexit
</span><span style="color:black">DOSCODE:B6EA                 </span><span style="color:navy">cmp     byte ptr es:[si], &#039;</span><span style="color:green">.&#039;
</span><span style="color:black">DOSCODE:B6EE                 </span><span style="color:navy">jnz     short </span><span style="color:gray">vvexit
</span><span style="color:black">DOSCODE:B6F0                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:B6F1                 </span><span style="color:navy">call    </span>VVDigit
<span style="color:black">DOSCODE:B6F4
DOSCODE:B6F4 </span><span style="color:gray">vvexit</span><span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6F4                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B6F4 </span>VerifyVersion   endp
<span style="color:black">DOSCODE:B6F4
DOSCODE:B6F5
DOSCODE:B6F5 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B6F5
DOSCODE:B6F5
DOSCODE:B6F5 </span>VVDigit         proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B6F5                 </span><span style="color:navy">div     bl
</span><span style="color:black">DOSCODE:B6F7                 </span><span style="color:navy">add     ah, &#039;</span><span style="color:green">0&#039;
</span><span style="color:black">DOSCODE:B6FA                 </span><span style="color:navy">dec     si
</span><span style="color:black">DOSCODE:B6FB                 </span><span style="color:navy">cmp     es:[si+</span><span style="color:#ff8000">1</span><span style="color:navy">], ah
</span><span style="color:black">DOSCODE:B6FF                 </span><span style="color:navy">mov     ah, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:B701                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B701 </span>VVDigit         endp
<span style="color:black">DOSCODE:B701
</span><span style="color:maroon">DOSCODE:B702 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B702
DOSCODE:B702 </span>exepatch_start<span style="color:navy">:                         </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B702                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:B703                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:B705                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:maroon">DOSCODE:B707
DOSCODE:B707 </span>first<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:B707                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:B709                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B70B                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:B70E                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B70F                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">10h
</span><span style="color:maroon">DOSCODE:B712                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:B714                 </span><span style="color:navy">repe scasb
</span><span style="color:maroon">DOSCODE:B716                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:B717                 </span><span style="color:navy">mov     si, di
</span><span style="color:maroon">DOSCODE:B719                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B71A                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:B71B                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:maroon">DOSCODE:B71D
DOSCODE:B71D </span>second<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:B71D                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B71F
DOSCODE:B71F </span>_NextRec<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:B71F                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">204h
</span><span style="color:maroon">DOSCODE:B722
DOSCODE:B722 </span>_norm_agn<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B722                 </span><span style="color:navy">mov     ax, si
</span><span style="color:maroon">DOSCODE:B724                 </span><span style="color:navy">not     ax
</span><span style="color:maroon">DOSCODE:B726                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:maroon">DOSCODE:B728                 </span><span style="color:navy">jz      short </span>_SI_ok
<span style="color:maroon">DOSCODE:B72A                 </span><span style="color:navy">mov     dx, ds
</span><span style="color:maroon">DOSCODE:B72C                 </span><span style="color:navy">or      si, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:B72F                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:maroon">DOSCODE:B731                 </span><span style="color:navy">jnb     short </span>_SItoDS
<span style="color:maroon">DOSCODE:B733                 </span><span style="color:navy">neg     dx
</span><span style="color:maroon">DOSCODE:B735                 </span><span style="color:navy">shl     dx, cl
</span><span style="color:maroon">DOSCODE:B737                 </span><span style="color:navy">sub     si, dx
</span><span style="color:maroon">DOSCODE:B739                 </span><span style="color:navy">xor     dx, dx
</span><span style="color:maroon">DOSCODE:B73B
DOSCODE:B73B </span>_SItoDS<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B73B                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:maroon">DOSCODE:B73D
DOSCODE:B73D </span>_SI_ok<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B73D                 </span><span style="color:navy">xchg    si, di
</span><span style="color:maroon">DOSCODE:B73F                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:B740                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:B741                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B742                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:B743                 </span><span style="color:navy">dec     ch
</span><span style="color:maroon">DOSCODE:B745                 </span><span style="color:navy">jnz     short </span>_norm_agn
<span style="color:maroon">DOSCODE:B747                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:B748                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:maroon">DOSCODE:B749                 </span><span style="color:navy">dec     si
</span><span style="color:maroon">DOSCODE:B74A                 </span><span style="color:navy">lodsw
</span><span style="color:maroon">DOSCODE:B74B                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:maroon">DOSCODE:B74D                 </span><span style="color:navy">inc     si
</span><span style="color:maroon">DOSCODE:B74E                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:B750                 </span><span style="color:navy">and     al, </span><span style="color:green">0FEh
</span><span style="color:maroon">DOSCODE:B752                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0B0h        </span>; RPTREC
<span style="color:maroon">DOSCODE:B754                 </span><span style="color:navy">jnz     short </span>TryEnum
<span style="color:maroon">DOSCODE:B756                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:B757                 </span><span style="color:navy">rep stosb
</span><span style="color:maroon">DOSCODE:B759                 </span><span style="color:navy">jmp     short </span>TryNext
<span style="color:maroon">DOSCODE:B75B </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B75B
DOSCODE:B75B </span>TryEnum<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B75B                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0B2h        </span>; ENMREC
<span style="color:maroon">DOSCODE:B75D                 </span><span style="color:navy">jnz     short </span>CorruptExe ; db 75h,6Bh
<span style="color:maroon">DOSCODE:B75F                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:B761
DOSCODE:B761 </span>TryNext<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B761                 </span><span style="color:navy">xchg    ax, dx
</span><span style="color:maroon">DOSCODE:B762                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:B764                 </span><span style="color:navy">jz      short </span>NextRec   ; db 74h,0BAh
<span style="color:maroon">DOSCODE:B766                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSCODE:B767                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSCODE:B768
DOSCODE:B768 </span>scan_patch1<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B768                 </span><span style="color:navy">mov     bx, es
</span><span style="color:maroon">DOSCODE:B76A                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:B76C                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:maroon">DOSCODE:B76E                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:B770                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B772                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:B775                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">10h
</span><span style="color:maroon">DOSCODE:B778                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:B77A                 </span><span style="color:navy">repe scasb
</span><span style="color:maroon">DOSCODE:B77C                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:B77D                 </span><span style="color:navy">mov     si, di
</span><span style="color:maroon">DOSCODE:B77F                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:maroon">DOSCODE:B781                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:maroon">DOSCODE:B783                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B785                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:B788
DOSCODE:B788 </span>NextRec_1<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:B788                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:B78A                 </span><span style="color:navy">mov     ax, si
</span><span style="color:maroon">DOSCODE:B78C                 </span><span style="color:navy">not     ax
</span><span style="color:maroon">DOSCODE:B78E                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:maroon">DOSCODE:B790                 </span><span style="color:navy">jz      short </span>SI_ok_1
<span style="color:maroon">DOSCODE:B792                 </span><span style="color:navy">mov     dx, ds
</span><span style="color:maroon">DOSCODE:B794                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:maroon">DOSCODE:B796                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:maroon">DOSCODE:B798                 </span>assume ds:nothing
<span style="color:maroon">DOSCODE:B798                 </span><span style="color:navy">or      si, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:B79B
DOSCODE:B79B </span>SI_ok_1<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B79B                 </span><span style="color:navy">mov     ax, di
</span><span style="color:maroon">DOSCODE:B79D                 </span><span style="color:navy">not     ax
</span><span style="color:maroon">DOSCODE:B79F                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:maroon">DOSCODE:B7A1                 </span><span style="color:navy">jz      short </span>DI_ok_1
<span style="color:maroon">DOSCODE:B7A3                 </span><span style="color:navy">mov     dx, es
</span><span style="color:maroon">DOSCODE:B7A5                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:maroon">DOSCODE:B7A7                 </span><span style="color:navy">mov     es, dx
</span><span style="color:maroon">DOSCODE:B7A9                 </span><span style="color:navy">or      di, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:B7AC
DOSCODE:B7AC </span>scan_patch2<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B7AC                 </span><span style="color:navy">mov     bx, es
</span><span style="color:maroon">DOSCODE:B7AE                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:B7B0                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:B7B1                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:B7B3                 </span>assume ds:nothing
<span style="color:maroon">DOSCODE:B7B3                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B7B5                 </span>assume es:nothing
<span style="color:maroon">DOSCODE:B7B5                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:B7B8                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">10h
</span><span style="color:maroon">DOSCODE:B7BB                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:B7BD                 </span><span style="color:navy">repe scasb
</span><span style="color:maroon">DOSCODE:B7BF                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:B7C0                 </span><span style="color:navy">mov     si, di
</span><span style="color:maroon">DOSCODE:B7C2                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:maroon">DOSCODE:B7C4                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:B7C5                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B7C7                 </span>assume es:DOSDATA
<span style="color:maroon">DOSCODE:B7C7                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:B7CA
DOSCODE:B7CA </span>NextRec_2<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:B7CA                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:B7CC                 </span><span style="color:navy">mov     ax, si
</span><span style="color:maroon">DOSCODE:B7CE                 </span><span style="color:navy">not     ax
</span><span style="color:maroon">DOSCODE:B7D0                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:maroon">DOSCODE:B7D2                 </span><span style="color:navy">jz      short </span>SI_ok_2
<span style="color:maroon">DOSCODE:B7D4                 </span><span style="color:navy">mov     dx, ds
</span><span style="color:maroon">DOSCODE:B7D6                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:maroon">DOSCODE:B7D8                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:maroon">DOSCODE:B7DA                 </span>assume ds:nothing
<span style="color:maroon">DOSCODE:B7DA                 </span><span style="color:navy">or      si, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:B7DE
DOSCODE:B7DE </span>SI_ok_2<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B7DE                 </span><span style="color:navy">mov     ax, di
</span><span style="color:maroon">DOSCODE:B7E0                 </span><span style="color:navy">not     ax
</span><span style="color:maroon">DOSCODE:B7E2                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:maroon">DOSCODE:B7E4                 </span><span style="color:navy">jz      short </span>DI_ok_2
<span style="color:maroon">DOSCODE:B7E6                 </span><span style="color:navy">mov     dx, es
</span><span style="color:maroon">DOSCODE:B7E8                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:maroon">DOSCODE:B7EA                 </span><span style="color:navy">mov     es, dx
</span><span style="color:maroon">DOSCODE:B7EC                 </span>assume es:nothing
<span style="color:maroon">DOSCODE:B7EC                 </span><span style="color:navy">or      di, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:B7F0
DOSCODE:B7F0 </span>scan_patch3<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B7F0                 </span><span style="color:navy">mov     bx, es
</span><span style="color:maroon">DOSCODE:B7F2                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:B7F4                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:B7F5                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:B7F7                 </span>assume ds:nothing
<span style="color:maroon">DOSCODE:B7F7                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B7F9                 </span>assume es:nothing
<span style="color:maroon">DOSCODE:B7F9                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:B7FC                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">10h
</span><span style="color:maroon">DOSCODE:B7FF                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">0FFh
</span><span style="color:maroon">DOSCODE:B801                 </span><span style="color:navy">repe scasb
</span><span style="color:maroon">DOSCODE:B803                 </span><span style="color:navy">inc     di
</span><span style="color:maroon">DOSCODE:B804                 </span><span style="color:navy">mov     si, di
</span><span style="color:maroon">DOSCODE:B806                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:maroon">DOSCODE:B808                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:B809                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:B80B                 </span>assume es:nothing
<span style="color:maroon">DOSCODE:B80B                 </span><span style="color:navy">mov     di, </span><span style="color:#ff8000">0Fh
</span><span style="color:maroon">DOSCODE:B80E
DOSCODE:B80E </span>NextRec_3<span style="color:navy">:
</span><span style="color:maroon">DOSCODE:B80E                 </span><span style="color:navy">mov     cl, </span><span style="color:#ff8000">4
</span><span style="color:maroon">DOSCODE:B810                 </span><span style="color:navy">mov     ax, si
</span><span style="color:maroon">DOSCODE:B812                 </span><span style="color:navy">not     ax
</span><span style="color:maroon">DOSCODE:B814                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:maroon">DOSCODE:B816                 </span><span style="color:navy">jz      short </span>SI_ok_3
<span style="color:maroon">DOSCODE:B818                 </span><span style="color:navy">mov     dx, ds
</span><span style="color:maroon">DOSCODE:B81A                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:maroon">DOSCODE:B81C                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:maroon">DOSCODE:B81E                 </span>assume ds:nothing
<span style="color:maroon">DOSCODE:B81E                 </span><span style="color:navy">or      si, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:B821
DOSCODE:B821 </span>SI_ok_3<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B821                 </span><span style="color:navy">mov     ax, di
</span><span style="color:maroon">DOSCODE:B823                 </span><span style="color:navy">not     ax
</span><span style="color:maroon">DOSCODE:B825                 </span><span style="color:navy">shr     ax, cl
</span><span style="color:maroon">DOSCODE:B827                 </span><span style="color:navy">jz      short </span>DI_ok_3
<span style="color:maroon">DOSCODE:B829                 </span><span style="color:navy">mov     dx, es
</span><span style="color:maroon">DOSCODE:B82B                 </span><span style="color:navy">sub     dx, ax
</span><span style="color:maroon">DOSCODE:B82D                 </span><span style="color:navy">mov     es, dx
</span><span style="color:maroon">DOSCODE:B82F                 </span>assume es:nothing
<span style="color:maroon">DOSCODE:B82F                 </span><span style="color:navy">or      di, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:B832
DOSCODE:B832 </span>scan_com<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B832                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:B833                 </span><span style="color:navy">mov     dl, al
</span><span style="color:maroon">DOSCODE:B835                 </span><span style="color:navy">dec     si
</span><span style="color:maroon">DOSCODE:B836                 </span><span style="color:navy">lodsw
</span><span style="color:maroon">DOSCODE:B837                 </span><span style="color:navy">mov     cx, ax
</span><span style="color:maroon">DOSCODE:B839                 </span><span style="color:navy">inc     si
</span><span style="color:maroon">DOSCODE:B83A                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:B83C                 </span><span style="color:navy">and     al, </span><span style="color:green">0FEh
</span><span style="color:maroon">DOSCODE:B83E                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0B0h
</span><span style="color:maroon">DOSCODE:B840                 </span><span style="color:navy">jnz     short </span>_TryEnum
<span style="color:maroon">DOSCODE:B842                 </span><span style="color:navy">lodsb
</span><span style="color:maroon">DOSCODE:B843                 </span><span style="color:navy">rep stosb
</span><span style="color:maroon">DOSCODE:B845                 </span><span style="color:navy">jmp     short </span>_TryNext
<span style="color:maroon">DOSCODE:B847 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B847                 </span><span style="color:navy">nop
</span><span style="color:maroon">DOSCODE:B848
DOSCODE:B848 </span>_TryEnum<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B848                 </span><span style="color:navy">cmp     al, </span><span style="color:green">0B2h
</span><span style="color:maroon">DOSCODE:B84A                 </span><span style="color:navy">jnz     short </span>CorruptExe
<span style="color:maroon">DOSCODE:B84C                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:B84E
DOSCODE:B84E </span>_TryNext<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B84E                 </span><span style="color:navy">mov     al, dl
</span><span style="color:maroon">DOSCODE:B850                 </span><span style="color:navy">test    al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:B852
DOSCODE:B852 </span>ExePatch<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B852                 </span><span style="color:navy">call    </span>ExePackPatch
<span style="color:maroon">DOSCODE:B855                 </span><span style="color:navy">call    ss:</span>RationalPatchPtr
<span style="color:maroon">DOSCODE:B85A                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B85B
DOSCODE:B85B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B85B
DOSCODE:B85B
DOSCODE:B85B </span>ExePackPatch    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B85B                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:B85C                 </span><span style="color:navy">mov     bx, es
</span><span style="color:black">DOSCODE:B85E                 </span><span style="color:navy">cmp     bx, </span><span style="color:#ff8000">0FFFh
</span><span style="color:black">DOSCODE:B862                 </span><span style="color:navy">jbe     short </span><span style="color:gray">ep_cont
</span><span style="color:black">DOSCODE:B864                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:B865                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B866 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B866
DOSCODE:B866 </span><span style="color:gray">ep_cont</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B866                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:B867                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:B868                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:B869                 </span><span style="color:navy">push    cx
</span><span style="color:black">DOSCODE:B86A                 </span><span style="color:navy">push    si
</span><span style="color:black">DOSCODE:B86B                 </span><span style="color:navy">push    di
</span><span style="color:black">DOSCODE:B86C                 </span><span style="color:navy">sub     cx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:B86F                 </span><span style="color:navy">jnb     short </span><span style="color:gray">epp_1
</span><span style="color:black">DOSCODE:B871                 </span><span style="color:navy">jmp     </span><span style="color:gray">ep_notpacked
</span><span style="color:black">DOSCODE:B874 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B874
DOSCODE:B874 </span><span style="color:gray">epp_1</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B874                 </span><span style="color:navy">mov     di, cx
</span><span style="color:black">DOSCODE:B876                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:B878                 </span>assume es:DOSDATA
<span style="color:black">DOSCODE:B878                 </span><span style="color:navy">mov     ss:</span>UNPACK_OFFSET<span style="color:navy">, di
</span><span style="color:black">DOSCODE:B87D                 </span><span style="color:navy">cmp     word ptr es:[di], &#039;</span><span style="color:green">BR&#039;
</span><span style="color:black">DOSCODE:B882                 </span><span style="color:navy">jz      short </span><span style="color:gray">epp_2
</span><span style="color:black">DOSCODE:B884                 </span><span style="color:navy">jmp     </span><span style="color:gray">ep_notpacked
</span><span style="color:black">DOSCODE:B887 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B887
DOSCODE:B887 </span><span style="color:gray">epp_2</span><span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B887                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:B888                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B889                 </span>assume ds:DOSDATA
<span style="color:black">DOSCODE:B889                 </span><span style="color:navy">add     di, </span><span style="color:green">6Ch
</span><span style="color:black">DOSCODE:B88C                 </span><span style="color:navy">call    </span>chk_common_str
<span style="color:black">DOSCODE:B88F                 </span><span style="color:navy">jnz     short </span>ep_chkpatch2
<span style="color:black">DOSCODE:B891                 </span><span style="color:navy">mov     si, offset </span>scan_patch1
<span style="color:black">DOSCODE:B894                 </span><span style="color:navy">mov     di, ss:</span>UNPACK_OFFSET
<span style="color:black">DOSCODE:B899                 </span><span style="color:navy">add     di, </span><span style="color:green">28h
</span><span style="color:black">DOSCODE:B89C                 </span><span style="color:navy">mov     cx, </span><span style="color:green">68
</span><span style="color:black">DOSCODE:B89F                 </span><span style="color:navy">mov     bx, </span><span style="color:green">142
</span><span style="color:black">DOSCODE:B8A2                 </span><span style="color:navy">mov     ax, </span><span style="color:green">0EF4Eh
</span><span style="color:black">DOSCODE:B8A5                 </span><span style="color:navy">call    </span>chk_patchsum
<span style="color:black">DOSCODE:B8A8                 </span><span style="color:navy">jb      short </span><span style="color:gray">ep_done1
</span><span style="color:black">DOSCODE:B8AA                 </span><span style="color:navy">mov     si, offset </span>exepatch_start
<span style="color:black">DOSCODE:B8AD                 </span><span style="color:navy">mov     cx, </span><span style="color:green">102
</span><span style="color:black">DOSCODE:B8B0                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B8B2
DOSCODE:B8B2 </span><span style="color:gray">ep_done1</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B8B2                 </span><span style="color:navy">jmp     </span><span style="color:gray">ep_notpacked
</span><span style="color:black">DOSCODE:B8B5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B8B5
DOSCODE:B8B5 </span>ep_chkpatch2<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B8B5                 </span><span style="color:navy">mov     di, </span><span style="color:green">76h
</span><span style="color:black">DOSCODE:B8B8                 </span><span style="color:navy">call    </span>chk_common_str
<span style="color:black">DOSCODE:B8BB                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ep_chkpatch3
</span><span style="color:black">DOSCODE:B8BD                 </span><span style="color:navy">mov     si, offset </span>scan_patch2
<span style="color:black">DOSCODE:B8C0                 </span><span style="color:navy">mov     di, </span><span style="color:green">32h
</span><span style="color:black">DOSCODE:B8C3                 </span><span style="color:navy">mov     cx, </span><span style="color:green">68
</span><span style="color:black">DOSCODE:B8C6                 </span><span style="color:navy">mov     bx, </span><span style="color:green">140
</span><span style="color:black">DOSCODE:B8C9                 </span><span style="color:navy">mov     ax, </span><span style="color:green">78B2h
</span><span style="color:black">DOSCODE:B8CC                 </span><span style="color:navy">call    </span>chk_patchsum
<span style="color:black">DOSCODE:B8CF                 </span><span style="color:navy">jnb     short </span><span style="color:gray">ep_patchcode2
</span><span style="color:black">DOSCODE:B8D1                 </span><span style="color:navy">mov     si, offset </span>scan_patch2
<span style="color:black">DOSCODE:B8D4                 </span><span style="color:navy">mov     cx, </span><span style="color:green">68
</span><span style="color:black">DOSCODE:B8D7                 </span><span style="color:navy">mov     bx, </span><span style="color:green">129
</span><span style="color:black">DOSCODE:B8DA                 </span><span style="color:navy">mov     ax, </span><span style="color:green">1C47h
</span><span style="color:black">DOSCODE:B8DD                 </span><span style="color:navy">call    </span>chk_patchsum
<span style="color:black">DOSCODE:B8E0                 </span><span style="color:navy">jb      short </span><span style="color:gray">ep_notpacked
</span><span style="color:black">DOSCODE:B8E2
DOSCODE:B8E2 </span><span style="color:gray">ep_patchcode2</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B8E2                 </span><span style="color:navy">mov     si, offset </span>exepatch_start
<span style="color:black">DOSCODE:B8E5                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:B8E8                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B8EA                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">4890h
</span><span style="color:black">DOSCODE:B8ED                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:B8EE                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:B8F1                 </span><span style="color:navy">mov     cx, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:B8F4                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B8F6                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:B8F7                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:B8FA                 </span><span style="color:navy">mov     cx, </span><span style="color:green">75
</span><span style="color:black">DOSCODE:B8FD                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B8FF                 </span><span style="color:navy">jmp     short </span><span style="color:gray">ep_notpacked
</span><span style="color:black">DOSCODE:B901 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:B901
DOSCODE:B901 </span><span style="color:gray">ep_chkpatch3</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B901                 </span><span style="color:navy">mov     di, </span><span style="color:green">74h
</span><span style="color:black">DOSCODE:B904                 </span><span style="color:navy">call    </span>chk_common_str
<span style="color:black">DOSCODE:B907                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ep_notpacked
</span><span style="color:black">DOSCODE:B909                 </span><span style="color:navy">mov     si, offset </span>scan_patch3
<span style="color:black">DOSCODE:B90C                 </span><span style="color:navy">mov     di, </span><span style="color:green">32h
</span><span style="color:black">DOSCODE:B90F                 </span><span style="color:navy">mov     cx, </span><span style="color:green">66
</span><span style="color:black">DOSCODE:B912                 </span><span style="color:navy">mov     bx, </span><span style="color:green">139
</span><span style="color:black">DOSCODE:B915                 </span><span style="color:navy">mov     ax, </span><span style="color:green">4EDEh
</span><span style="color:black">DOSCODE:B918                 </span><span style="color:navy">call    </span>chk_patchsum
<span style="color:black">DOSCODE:B91B                 </span><span style="color:navy">jb      short </span><span style="color:gray">ep_notpacked
</span><span style="color:black">DOSCODE:B91D                 </span><span style="color:navy">mov     si, offset </span>exepatch_start
<span style="color:black">DOSCODE:B920                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">3
</span><span style="color:black">DOSCODE:B923                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B925                 </span><span style="color:navy">mov     al, </span><span style="color:#ff8000">48h </span><span style="color:gray">; &#039;H&#039;
</span><span style="color:black">DOSCODE:B927                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:B928                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:B92B                 </span><span style="color:navy">mov     cx, </span><span style="color:green">20
</span><span style="color:black">DOSCODE:B92E                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B930                 </span><span style="color:navy">stosb
</span><span style="color:black">DOSCODE:B931                 </span><span style="color:navy">add     si, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:B934                 </span><span style="color:navy">mov     cx, </span><span style="color:green">75
</span><span style="color:black">DOSCODE:B937                 </span><span style="color:navy">rep movsb
</span><span style="color:black">DOSCODE:B939
DOSCODE:B939 </span><span style="color:gray">ep_notpacked</span><span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B939                 </span><span style="color:navy">pop     di
</span><span style="color:black">DOSCODE:B93A                 </span><span style="color:navy">pop     si
</span><span style="color:black">DOSCODE:B93B                 </span><span style="color:navy">pop     cx
</span><span style="color:black">DOSCODE:B93C                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:B93D                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:B93E                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:B93F                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:B940                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B940 </span>ExePackPatch    endp
<span style="color:black">DOSCODE:B940
DOSCODE:B941
DOSCODE:B941 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:B941
DOSCODE:B941
DOSCODE:B941 </span>chk_common_str  proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:B941                 </span><span style="color:navy">mov     si, offset </span>scan_com
<span style="color:black">DOSCODE:B944                 </span><span style="color:navy">mov     cx, </span><span style="color:green">32
</span><span style="color:black">DOSCODE:B947                 </span><span style="color:navy">repe cmpsb
</span><span style="color:black">DOSCODE:B949                 </span><span style="color:navy">jz      short </span><span style="color:gray">ccs_done
</span><span style="color:black">DOSCODE:B94B                 </span><span style="color:navy">cmp     byte ptr es:[di-</span><span style="color:green">1</span><span style="color:navy">], </span><span style="color:green">56h
</span><span style="color:black">DOSCODE:B950                 </span><span style="color:navy">jnz     short </span><span style="color:gray">ccs_done
</span><span style="color:black">DOSCODE:B952                 </span><span style="color:navy">repe cmpsb
</span><span style="color:black">DOSCODE:B954
DOSCODE:B954 </span><span style="color:gray">ccs_done</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:B954                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:B954 </span>chk_common_str  endp
<span style="color:black">DOSCODE:B954
</span><span style="color:maroon">DOSCODE:B955 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B955
DOSCODE:B955 </span>chk_patchsum<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B955                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B956                 </span><span style="color:navy">repe cmpsb
</span><span style="color:maroon">DOSCODE:B958                 </span><span style="color:navy">jnz     short </span>cp_fail
<span style="color:maroon">DOSCODE:B95A                 </span><span style="color:navy">mov     di, ss:</span>UNPACK_OFFSET
<span style="color:maroon">DOSCODE:B95F                 </span><span style="color:navy">mov     cx, bx
</span><span style="color:maroon">DOSCODE:B961                 </span><span style="color:navy">mov     bx, ax
</span><span style="color:maroon">DOSCODE:B963                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:B965
DOSCODE:B965 </span>ep_chksum<span style="color:navy">:                              </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B965                 </span><span style="color:navy">add     ax, es:[di]
</span><span style="color:maroon">DOSCODE:B968                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:B96B                 </span><span style="color:navy">loop    </span>ep_chksum
<span style="color:maroon">DOSCODE:B96D                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B96E                 </span><span style="color:navy">cmp     ax, bx
</span><span style="color:maroon">DOSCODE:B970                 </span><span style="color:navy">jnz     short </span>cp_fail
<span style="color:maroon">DOSCODE:B972                 </span><span style="color:navy">clc
</span><span style="color:maroon">DOSCODE:B973                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:B974 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B974
DOSCODE:B974 </span>cp_fail<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B974                 </span><span style="color:navy">stc
</span><span style="color:maroon">DOSCODE:B975                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:B975 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:B976 </span>RScanPattern1   <span style="color:navy">db  </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">20h</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">40h</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B976                 </span><span style="color:navy">db  </span><span style="color:#008040">01h</span><span style="color:navy">, </span><span style="color:#008040">00h            </span><span style="color:gray">; 8
DOSCODE:B980 </span>RScanPattern2   <span style="color:navy">db  </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0Eh</span><span style="color:navy">, </span><span style="color:#008040">10h</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">90h</span><span style="color:navy">,</span><span style="color:#008040">0E2h</span><span style="color:navy">,</span><span style="color:#008040">0FEh</span><span style="color:navy">,</span><span style="color:#008040">0E8h</span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B988 </span>RScanPattern3   <span style="color:navy">db  </span><span style="color:#008040">8Bh</span><span style="color:navy">, </span><span style="color:#008040">0Eh</span><span style="color:navy">, </span><span style="color:#008040">10h</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:navy">,</span><span style="color:#008040">0E2h</span><span style="color:navy">,</span><span style="color:#008040">0FEh</span><span style="color:navy">,</span><span style="color:#008040">0E8h</span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B98F </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:B98F
DOSCODE:B98F </span>RationalPatch<span style="color:navy">:                          </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:B98F                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:B990                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:B991                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:B992                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:B993                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:B994                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:B995                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:B996                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:B997                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:B998                 </span><span style="color:navy">mov     di, </span><span style="color:green">0Ah
</span><span style="color:maroon">DOSCODE:B99B                 </span><span style="color:navy">push    cs
</span><span style="color:maroon">DOSCODE:B99C                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B99D                 </span><span style="color:navy">mov     si, offset </span>RScanPattern1
<span style="color:maroon">DOSCODE:B9A0                 </span><span style="color:navy">mov     cx, </span><span style="color:green">10
</span><span style="color:maroon">DOSCODE:B9A3                 </span><span style="color:navy">repe cmpsb
</span><span style="color:maroon">DOSCODE:B9A5                 </span><span style="color:navy">jnz     short </span>rpexit
<span style="color:maroon">DOSCODE:B9A7                 </span><span style="color:navy">mov     ax, </span>word ptr es:0
<span style="color:maroon">DOSCODE:B9AB                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">348
</span><span style="color:maroon">DOSCODE:B9AE                 </span><span style="color:navy">jb      short </span>rpexit
<span style="color:maroon">DOSCODE:B9B0                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">383
</span><span style="color:maroon">DOSCODE:B9B3                 </span><span style="color:navy">ja      short </span>rpexit
<span style="color:maroon">DOSCODE:B9B5                 </span><span style="color:navy">call    </span>VerifyVersion
<span style="color:maroon">DOSCODE:B9B8                 </span><span style="color:navy">jnz     short </span>rpexit
<span style="color:maroon">DOSCODE:B9BA                 </span><span style="color:navy">mov     cx, </span>word ptr es:16h
<span style="color:maroon">DOSCODE:B9BF                 </span><span style="color:navy">sub     cx, </span><span style="color:green">200h
</span><span style="color:maroon">DOSCODE:B9C3                 </span><span style="color:navy">mov     es, </span>word ptr es:20h
<span style="color:maroon">DOSCODE:B9C8                 </span><span style="color:navy">mov     si, offset </span>RScanPattern2
<span style="color:maroon">DOSCODE:B9CB                 </span><span style="color:navy">mov     dx, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:B9CE                 </span><span style="color:navy">call    </span>ScanCodeSeq
<span style="color:maroon">DOSCODE:B9D1                 </span><span style="color:navy">jz      short </span>rpfound
<span style="color:maroon">DOSCODE:B9D3                 </span><span style="color:navy">mov     si, offset </span>RScanPattern3
<span style="color:maroon">DOSCODE:B9D6                 </span><span style="color:navy">mov     dx, </span><span style="color:green">15
</span><span style="color:maroon">DOSCODE:B9D9                 </span><span style="color:navy">call    </span>ScanCodeSeq
<span style="color:maroon">DOSCODE:B9DC                 </span><span style="color:navy">jnz     short </span>rpexit
<span style="color:maroon">DOSCODE:B9DE
DOSCODE:B9DE </span>rpfound<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B9DE                 </span><span style="color:navy">mov     al, </span><span style="color:green">9Ah
</span><span style="color:maroon">DOSCODE:B9E0                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:B9E1                 </span><span style="color:navy">mov     ax, offset </span>RatBugCode
<span style="color:maroon">DOSCODE:B9E4                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:B9E5                 </span><span style="color:navy">mov     ax, ss
</span><span style="color:maroon">DOSCODE:B9E7                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:B9E8                 </span><span style="color:navy">mov     cx, dx
</span><span style="color:maroon">DOSCODE:B9EA                 </span><span style="color:navy">sub     cx, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:B9ED                 </span><span style="color:navy">mov     al, </span><span style="color:green">90h
</span><span style="color:maroon">DOSCODE:B9EF                 </span><span style="color:navy">rep stosb
</span><span style="color:maroon">DOSCODE:B9F1
DOSCODE:B9F1 </span>rpexit<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:B9F1                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:B9F2                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:B9F3                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:B9F4                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:B9F5                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:B9F6                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:B9F7                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:B9F8                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:B9F9                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:B9F9 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:B9FA </span>CPScanPattern   <span style="color:navy">db  </span><span style="color:#008040">89h</span><span style="color:navy">, </span><span style="color:#008040">26h</span><span style="color:navy">, </span><span style="color:#008040">48h</span><span style="color:navy">, </span><span style="color:#008040">01h  </span><span style="color:gray">; 0 </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:B9FA                 </span><span style="color:navy">db  </span><span style="color:#008040">8Ch</span><span style="color:navy">, </span><span style="color:#008040">0Eh</span><span style="color:navy">, </span><span style="color:#008040">4Ch</span><span style="color:navy">, </span><span style="color:#008040">01h  </span><span style="color:gray">; 4
DOSCODE:B9FA                 </span><span style="color:navy">db </span><span style="color:#008040">0C7h</span><span style="color:navy">, </span><span style="color:#008040">06h</span><span style="color:navy">, </span><span style="color:#008040">4Ah</span><span style="color:navy">, </span><span style="color:#008040">01h  </span><span style="color:gray">; 8
DOSCODE:B9FA                 </span><span style="color:navy">db  </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">01h</span><span style="color:navy">, </span><span style="color:#008040">8Ch</span><span style="color:navy">, </span><span style="color:#008040">0Eh  </span><span style="color:gray">; 12
DOSCODE:B9FA                 </span><span style="color:navy">db  </span><span style="color:#008040">13h</span><span style="color:navy">, </span><span style="color:#008040">01h</span><span style="color:navy">,</span><span style="color:#008040">0B8h</span><span style="color:navy">, </span><span style="color:#008040">20h  </span><span style="color:gray">; 16
DOSCODE:B9FA                 </span><span style="color:navy">db  </span><span style="color:#008040">01h</span><span style="color:navy">,</span><span style="color:#008040">0BEh</span><span style="color:navy">, </span><span style="color:#008040">00h</span><span style="color:navy">, </span><span style="color:#008040">01h  </span><span style="color:gray">; 20
</span><span style="color:black">DOSCODE:BA12
DOSCODE:BA12 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BA12
DOSCODE:BA12
DOSCODE:BA12 </span>IsCopyProt      proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BA12                 </span><span style="color:navy">cmp     </span>word ptr ds:11Bh<span style="color:navy">, </span><span style="color:green">5343h
</span><span style="color:black">DOSCODE:BA18                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CP_done
</span><span style="color:black">DOSCODE:BA1A                 </span><span style="color:navy">cmp     </span>word ptr ds:173h<span style="color:navy">, </span><span style="color:green">5044h
</span><span style="color:black">DOSCODE:BA20                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CP_done
</span><span style="color:black">DOSCODE:BA22                 </span><span style="color:navy">cmp     </span>word ptr ds:146h<span style="color:navy">, </span><span style="color:green">0F413h
</span><span style="color:black">DOSCODE:BA28                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CP_done
</span><span style="color:black">DOSCODE:BA2A                 </span><span style="color:navy">cmp     </span>word ptr ds:124h<span style="color:navy">, </span><span style="color:green">8000h
</span><span style="color:black">DOSCODE:BA30                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CP_done
</span><span style="color:black">DOSCODE:BA32                 </span><span style="color:navy">push    cs
</span><span style="color:black">DOSCODE:BA33                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BA34                 </span><span style="color:navy">mov     di, offset </span>CPScanPattern
<span style="color:black">DOSCODE:BA37                 </span><span style="color:navy">mov     si, </span><span style="color:green">175h
</span><span style="color:black">DOSCODE:BA3A                 </span><span style="color:navy">mov     cx, </span><span style="color:green">24
</span><span style="color:black">DOSCODE:BA3D                 </span><span style="color:navy">repe cmpsb
</span><span style="color:black">DOSCODE:BA3F                 </span><span style="color:navy">jnz     short </span><span style="color:gray">CP_done
</span><span style="color:black">DOSCODE:BA41                 </span><span style="color:navy">mov     ss:</span>A20OFF_COUNT<span style="color:navy">, </span><span style="color:green">0Ah
</span><span style="color:black">DOSCODE:BA47
DOSCODE:BA47 </span><span style="color:gray">CP_done</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BA47                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BA47 </span>IsCopyProt      endp
<span style="color:black">DOSCODE:BA47
</span><span style="color:maroon">DOSCODE:BA48 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:BA48
DOSCODE:BA48 </span>initiret<span style="color:navy">:                               </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:BA48                 </span><span style="color:navy">iret
</span><span style="color:maroon">DOSCODE:BA48 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:BA49 </span>InitBioDataSeg  <span style="color:navy">dw </span><span style="color:#008040">70h                  </span><span style="color:#8080ff">; ...
</span><span style="color:black">DOSCODE:BA4B
DOSCODE:BA4B </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BA4B
DOSCODE:BA4B
DOSCODE:BA4B </span>ParaRound       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BA4B                 </span><span style="color:navy">add     ax, </span><span style="color:green">15
</span><span style="color:black">DOSCODE:BA4E                 </span><span style="color:navy">rcr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:BA50                 </span><span style="color:navy">shr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:BA52                 </span><span style="color:navy">shr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:BA54                 </span><span style="color:navy">shr     ax, </span><span style="color:green">1
</span><span style="color:black">DOSCODE:BA56                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BA56 </span>ParaRound       endp
<span style="color:black">DOSCODE:BA56
</span><span style="color:maroon">DOSCODE:BA57 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:BA57
DOSCODE:BA57 </span>DOSINIT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BA57                 </span><span style="color:navy">cli
</span><span style="color:maroon">DOSCODE:BA58                 </span><span style="color:navy">cld
</span><span style="color:maroon">DOSCODE:BA59                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:BA5A                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:BA5B                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:BA5C                 </span><span style="color:navy">push    di
</span><span style="color:maroon">DOSCODE:BA5D                 </span><span style="color:navy">mov     bx, es
</span><span style="color:maroon">DOSCODE:BA5F                 </span><span style="color:navy">mov     ax, offset </span>MEMSTRT
<span style="color:maroon">DOSCODE:BA62                 </span><span style="color:navy">add     ax, </span><span style="color:green">0Fh
</span><span style="color:maroon">DOSCODE:BA65                 </span><span style="color:navy">and     ax, </span><span style="color:green">0FFF0h
</span><span style="color:maroon">DOSCODE:BA68                 </span><span style="color:navy">mov     si, ax
</span><span style="color:maroon">DOSCODE:BA6A                 </span><span style="color:navy">mov     ax, cs
</span><span style="color:maroon">DOSCODE:BA6C                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:BA6E                 </span><span style="color:navy">mov     es, cs:</span>InitBioDataSeg
<span style="color:maroon">DOSCODE:BA73                 </span>assume es:nothing
<span style="color:maroon">DOSCODE:BA73                 </span><span style="color:navy">mov     es, word ptr es:</span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:BA78                 </span>assume es:DOSDATA
<span style="color:maroon">DOSCODE:BA78                 </span><span style="color:navy">xor     di, di
</span><span style="color:maroon">DOSCODE:BA7A                 </span><span style="color:navy">mov     cx, </span><span style="color:green">4970
</span><span style="color:maroon">DOSCODE:BA7D                 </span><span style="color:navy">rep movsb
</span><span style="color:maroon">DOSCODE:BA7F                 </span><span style="color:navy">pop     di
</span><span style="color:maroon">DOSCODE:BA80                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BA81                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:BA82                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:BA83                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:BA84                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:BA85                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:BA86                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BA87                 </span><span style="color:navy">mov     word ptr </span>BiosDataPtr<span style="color:navy">, di
</span><span style="color:maroon">DOSCODE:BA8B                 </span><span style="color:navy">mov     word ptr </span>BiosDataPtr<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, bx
</span><span style="color:maroon">DOSCODE:BA8F                 </span><span style="color:navy">mov     cs:</span>DosDSeg<span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BA94                 </span><span style="color:navy">mov     word ptr cs:</span>LowInt23Addr<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BA99                 </span><span style="color:navy">mov     word ptr cs:</span>LowInt24Addr<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BA9E                 </span><span style="color:navy">mov     word ptr cs:</span>LowInt28Addr<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BAA3                 </span><span style="color:navy">mov     </span>ENDMEM<span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:BAA7                 </span><span style="color:navy">mov     </span>USER_SP<span style="color:navy">, sp
</span><span style="color:maroon">DOSCODE:BAAB                 </span><span style="color:navy">mov     </span>USER_SS<span style="color:navy">, ss
</span><span style="color:maroon">DOSCODE:BAAF                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:BAB1                 </span><span style="color:navy">mov     ss, ax
</span><span style="color:maroon">DOSCODE:BAB3                 </span><span style="color:navy">mov     sp, offset </span>DSKSTACK
<span style="color:maroon">DOSCODE:BAB6                 </span><span style="color:navy">mov     </span>FixExePatch<span style="color:navy">, offset </span>RetExePatch
<span style="color:maroon">DOSCODE:BABC                 </span><span style="color:navy">mov     </span>RationalPatchPtr<span style="color:navy">, offset </span>RetExePatch
<span style="color:maroon">DOSCODE:BAC2                 </span><span style="color:navy">mov     </span>ChkCopyProt<span style="color:navy">, offset </span>RetExePatch
<span style="color:maroon">DOSCODE:BAC8                 </span><span style="color:navy">call    </span>WhatCPUType
<span style="color:maroon">DOSCODE:BACB                 </span><span style="color:navy">cmp     al, </span><span style="color:#ff8000">2
</span><span style="color:maroon">DOSCODE:BACD                 </span><span style="color:navy">mov     ax, offset </span>Rational386Patch
<span style="color:maroon">DOSCODE:BAD0                 </span><span style="color:navy">jnb     short </span>di_set_patch
<span style="color:maroon">DOSCODE:BAD2                 </span><span style="color:navy">mov     ax, offset </span>RetExePatch
<span style="color:maroon">DOSCODE:BAD5
DOSCODE:BAD5 </span>di_set_patch<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BAD5                 </span><span style="color:navy">mov     </span>Rational386PatchPtr<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:BAD8                 </span><span style="color:navy">mov     ax, cs
</span><span style="color:maroon">DOSCODE:BADA                 </span><span style="color:navy">mov     </span>TEMP_DOSLOC<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:BADD                 </span><span style="color:navy">mov     word ptr </span>NULDEV<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:BAE1                 </span><span style="color:navy">mov     word ptr </span>NULDEV<span style="color:navy">, si
</span><span style="color:maroon">DOSCODE:BAE5                 </span><span style="color:navy">mov     </span>SIS_Instance_Data_Ptr_2<span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BAE9                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:BAEA                 </span><span style="color:navy">mov     cx, </span><span style="color:green">7
</span><span style="color:maroon">DOSCODE:BAED                 </span><span style="color:navy">mov     si, offset </span>Instance_Table_2
<span style="color:maroon">DOSCODE:BAF0
DOSCODE:BAF0 </span>Instance_init_loop<span style="color:navy">:                     </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BAF0                 </span><span style="color:navy">mov     word ptr [si], ds
</span><span style="color:maroon">DOSCODE:BAF2                 </span><span style="color:navy">add     si, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:BAF5                 </span><span style="color:navy">loop    </span>Instance_init_loop
<span style="color:maroon">DOSCODE:BAF7                 </span><span style="color:navy">mov     cx, </span><span style="color:green">5
</span><span style="color:maroon">DOSCODE:BAFA                 </span><span style="color:navy">mov     si, offset </span>OldInstanceJunk_6
<span style="color:maroon">DOSCODE:BAFD
DOSCODE:BAFD </span>OldInstance_init_loop<span style="color:navy">:                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BAFD                 </span><span style="color:navy">mov     word ptr [si], ds
</span><span style="color:maroon">DOSCODE:BAFF                 </span><span style="color:navy">add     si, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:BB02                 </span><span style="color:navy">loop    </span>OldInstance_init_loop
<span style="color:maroon">DOSCODE:BB04                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:BB05                 </span><span style="color:navy">push    es
</span><span style="color:maroon">DOSCODE:BB06                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BB07                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:BB08                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:BB0A                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:BB0C                 </span><span style="color:navy">mov     ax, offset </span>initiret
<span style="color:maroon">DOSCODE:BB0F                 </span><span style="color:navy">mov     </span>word ptr [0A8h]<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:BB12                 </span><span style="color:navy">mov     ax, cs
</span><span style="color:maroon">DOSCODE:BB14                 </span><span style="color:navy">mov     </span>word ptr [0AAh]<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:BB17                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BB18                 </span><span style="color:navy">call    </span>CHARINIT
<span style="color:maroon">DOSCODE:BB1B                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:BB1C                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:BB1D                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:BB1E                 </span><span style="color:navy">mov     di, offset </span>SFT0_SFTable
<span style="color:maroon">DOSCODE:BB21                 </span><span style="color:navy">mov     ax, </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:BB24                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB25                 </span><span style="color:navy">dec     al
</span><span style="color:maroon">DOSCODE:BB27                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB28                 </span><span style="color:navy">xor     al, al
</span><span style="color:maroon">DOSCODE:BB2A                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:BB2B                 </span><span style="color:navy">mov     al, </span><span style="color:green">0C3h
</span><span style="color:maroon">DOSCODE:BB2D                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB2E                 </span><span style="color:navy">mov     ax, si
</span><span style="color:maroon">DOSCODE:BB30                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB31                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:BB33                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB34                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:BB36                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB37                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB38                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB39                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:BB3A                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB3B                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB3C                 </span><span style="color:navy">inc     ax
</span><span style="color:maroon">DOSCODE:BB3D                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB3E                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BB3F                 </span><span style="color:navy">add     di, </span><span style="color:green">7
</span><span style="color:maroon">DOSCODE:BB42                 </span><span style="color:navy">add     si, </span><span style="color:green">10
</span><span style="color:maroon">DOSCODE:BB45                 </span><span style="color:navy">mov     cx, </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:BB48                 </span><span style="color:navy">rep movsw
</span><span style="color:maroon">DOSCODE:BB4A                 </span><span style="color:navy">mov     cl, </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:BB4C                 </span><span style="color:navy">mov     al, &#039; &#039;
</span><span style="color:maroon">DOSCODE:BB4E                 </span><span style="color:navy">rep stosb
</span><span style="color:maroon">DOSCODE:BB50                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:BB51                 </span><span style="color:navy">or      byte ptr [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">3
</span><span style="color:maroon">DOSCODE:BB55                 </span><span style="color:navy">mov     word ptr ss:</span>BCON<span style="color:navy">, si
</span><span style="color:maroon">DOSCODE:BB5A                 </span><span style="color:navy">mov     word ptr ss:</span>BCON<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BB5F
DOSCODE:BB5F </span>char_init_loop<span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BB5F                 </span><span style="color:navy">lds     si, [si]
</span><span style="color:maroon">DOSCODE:BB61                 </span><span style="color:navy">call    </span>CHARINIT
<span style="color:maroon">DOSCODE:BB64                 </span><span style="color:navy">test    byte ptr [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:BB68                 </span><span style="color:navy">jz      short </span>char_init_loop
<span style="color:maroon">DOSCODE:BB6A                 </span><span style="color:navy">mov     word ptr ss:</span>BCLOCK<span style="color:navy">, si
</span><span style="color:maroon">DOSCODE:BB6F                 </span><span style="color:navy">mov     word ptr ss:</span>BCLOCK<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BB74                 </span><span style="color:navy">mov     bp, </span><span style="color:green">4970
</span><span style="color:maroon">DOSCODE:BB77                 </span><span style="color:navy">mov     word ptr ss:</span>DPBHEAD<span style="color:navy">, bp
</span><span style="color:maroon">DOSCODE:BB7C                 </span><span style="color:navy">mov     word ptr ss:</span>DPBHEAD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:BB81
DOSCODE:BB81 </span>PERDRV<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BB81                 </span><span style="color:navy">lds     si, [si]
</span><span style="color:maroon">DOSCODE:BB83                 </span><span style="color:navy">cmp     si, -</span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:BB86                 </span><span style="color:navy">jz      short </span>CONTINIT
<span style="color:maroon">DOSCODE:BB88                 </span><span style="color:navy">call    </span>CHARINIT
<span style="color:maroon">DOSCODE:BB8B                 </span><span style="color:navy">test    word ptr [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], </span><span style="color:green">8000h
</span><span style="color:maroon">DOSCODE:BB90                 </span><span style="color:navy">jnz     short </span>PERDRV
<span style="color:maroon">DOSCODE:BB92                 </span><span style="color:navy">mov     cl, ss:</span>CALLUNIT
<span style="color:maroon">DOSCODE:BB97                 </span><span style="color:navy">xor     ch, ch
</span><span style="color:maroon">DOSCODE:BB99                 </span><span style="color:navy">mov     [si+</span><span style="color:green">10</span><span style="color:navy">], cl
</span><span style="color:maroon">DOSCODE:BB9C                 </span><span style="color:navy">mov     dl, ss:</span>NUMIO
<span style="color:maroon">DOSCODE:BBA1                 </span><span style="color:navy">xor     dh, dh
</span><span style="color:maroon">DOSCODE:BBA3                 </span><span style="color:navy">add     ss:</span>NUMIO<span style="color:navy">, cl
</span><span style="color:maroon">DOSCODE:BBA8                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:BBA9                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:BBAA                 </span><span style="color:navy">lds     bx, ss:</span>CALLBPB
<span style="color:maroon">DOSCODE:BBAF
DOSCODE:BBAF </span>PERUNIT<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BBAF                 </span><span style="color:navy">mov     si, [bx]
</span><span style="color:maroon">DOSCODE:BBB1                 </span><span style="color:navy">inc     bx
</span><span style="color:maroon">DOSCODE:BBB2                 </span><span style="color:navy">inc     bx
</span><span style="color:maroon">DOSCODE:BBB3                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">0</span><span style="color:navy">], dl
</span><span style="color:maroon">DOSCODE:BBB7                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">1</span><span style="color:navy">], dh
</span><span style="color:maroon">DOSCODE:BBBB                 </span><span style="color:navy">push    bx
</span><span style="color:maroon">DOSCODE:BBBC                 </span><span style="color:navy">push    cx
</span><span style="color:maroon">DOSCODE:BBBD                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:BBBE                 </span><span style="color:navy">call    </span>$SETDPB
<span style="color:maroon">DOSCODE:BBC1                 </span><span style="color:navy">mov     ax, es:[bp+</span><span style="color:#ff8000">2</span><span style="color:navy">]
</span><span style="color:maroon">DOSCODE:BBC5                 </span><span style="color:navy">cmp     ax, ss:</span>MAXSEC
<span style="color:maroon">DOSCODE:BBCA                 </span><span style="color:navy">jbe     short </span>NOTMAX
<span style="color:maroon">DOSCODE:BBCC                 </span><span style="color:navy">mov     ss:</span>MAXSEC<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:BBD0
DOSCODE:BBD0 </span>NOTMAX<span style="color:navy">:                                 </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BBD0                 </span><span style="color:navy">mov     ax, bp
</span><span style="color:maroon">DOSCODE:BBD2                 </span><span style="color:navy">add     ax, </span><span style="color:green">33
</span><span style="color:maroon">DOSCODE:BBD5                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">19h</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:BBD9                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:BBDD                 </span><span style="color:navy">mov     byte ptr es:[bp+</span><span style="color:#ff8000">18h</span><span style="color:navy">], </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:BBE2                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:BBE3                 </span><span style="color:navy">pop     cx
</span><span style="color:maroon">DOSCODE:BBE4                 </span><span style="color:navy">pop     bx
</span><span style="color:maroon">DOSCODE:BBE5                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:BBE7                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:BBE8                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BBE9                 </span><span style="color:navy">mov     es:[bp+</span><span style="color:#ff8000">13h</span><span style="color:navy">], si
</span><span style="color:maroon">DOSCODE:BBED                 </span><span style="color:navy">mov     word ptr es:[bp+</span><span style="color:#ff8000">15h</span><span style="color:navy">], ds
</span><span style="color:maroon">DOSCODE:BBF1                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:BBF2                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:BBF3                 </span><span style="color:navy">inc     dh
</span><span style="color:maroon">DOSCODE:BBF5                 </span><span style="color:navy">inc     dl
</span><span style="color:maroon">DOSCODE:BBF7                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:BBF9                 </span><span style="color:navy">add     bp, </span><span style="color:green">33
</span><span style="color:maroon">DOSCODE:BBFC                 </span><span style="color:navy">loop    </span>PERUNIT
<span style="color:maroon">DOSCODE:BBFE                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:BBFF                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BC00                 </span><span style="color:navy">jmp     </span>PERDRV
<span style="color:maroon">DOSCODE:BC03 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:BC03
DOSCODE:BC03 </span>CONTINIT<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BC03                 </span><span style="color:navy">sub     bp, </span><span style="color:green">33
</span><span style="color:maroon">DOSCODE:BC06                 </span><span style="color:navy">mov     word ptr [bp+</span><span style="color:#ff8000">19h</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:BC0B                 </span><span style="color:navy">mov     word ptr [bp+</span><span style="color:#ff8000">1Bh</span><span style="color:navy">], </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:BC10                 </span><span style="color:navy">add     bp, </span><span style="color:green">33
</span><span style="color:maroon">DOSCODE:BC13                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:BC14                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BC15                 </span><span style="color:navy">mov     ax, bp
</span><span style="color:maroon">DOSCODE:BC17                 </span><span style="color:navy">call    </span>ParaRound
<span style="color:maroon">DOSCODE:BC1A                 </span><span style="color:navy">mov     dx, ds
</span><span style="color:maroon">DOSCODE:BC1C                 </span><span style="color:navy">add     dx, ax
</span><span style="color:maroon">DOSCODE:BC1E                 </span><span style="color:navy">mov     bx, </span><span style="color:green">0Fh
</span><span style="color:maroon">DOSCODE:BC21                 </span><span style="color:navy">mov     cx, </span>ENDMEM
<span style="color:maroon">DOSCODE:BC25                 </span><span style="color:navy">mov     </span>DOSSEG_INIT<span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BC29                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:BC2A                 </span><span style="color:navy">mov     ax, </span>TEMP_DOSLOC
<span style="color:maroon">DOSCODE:BC2D                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:BC2F                 </span><span style="color:navy">mov     </span>TEMP_DOSLOC<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:maroon">DOSCODE:BC35                 </span><span style="color:navy">call    </span>patch_vec_segments
<span style="color:maroon">DOSCODE:BC38                 </span><span style="color:navy">call    </span>patch_misc_segments
<span style="color:maroon">DOSCODE:BC3B                 </span><span style="color:navy">mov     </span>TEMP_DOSLOC<span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:BC3F                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:BC40                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:BC42                 </span><span style="color:navy">mov     ds, ax
</span><span style="color:maroon">DOSCODE:BC44                 </span><span style="color:navy">mov     es, ax
</span><span style="color:maroon">DOSCODE:BC46                 </span><span style="color:navy">mov     di, </span><span style="color:green">90h
</span><span style="color:maroon">DOSCODE:BC49                 </span><span style="color:navy">mov     ax, ss:</span>TEMP_DOSLOC
<span style="color:maroon">DOSCODE:BC4D                 </span><span style="color:navy">mov     [di+</span><span style="color:#ff8000">2</span><span style="color:navy">], ax
</span><span style="color:maroon">DOSCODE:BC50                 </span><span style="color:navy">mov     di, </span><span style="color:green">82h
</span><span style="color:maroon">DOSCODE:BC53                 </span><span style="color:navy">mov     </span>word ptr ds:0<span style="color:navy">, offset </span>DIVOV
<span style="color:maroon">DOSCODE:BC59                 </span><span style="color:navy">mov     di, </span><span style="color:green">80h         </span>; INTBASE
<span style="color:maroon">DOSCODE:BC5C                 </span><span style="color:navy">mov     ax, offset </span>irett
<span style="color:maroon">DOSCODE:BC5F                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">9
</span><span style="color:maroon">DOSCODE:BC62
DOSCODE:BC62 </span>iset1<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BC62                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BC63                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:BC66                 </span><span style="color:navy">loop    </span>iset1
<span style="color:maroon">DOSCODE:BC68                 </span><span style="color:navy">add     di, </span><span style="color:green">4
</span><span style="color:maroon">DOSCODE:BC6B                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:maroon">DOSCODE:BC6E
DOSCODE:BC6E </span>iset2<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BC6E                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BC6F                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:BC72                 </span><span style="color:navy">loop    </span>iset2
<span style="color:maroon">DOSCODE:BC74                 </span><span style="color:navy">add     di, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:BC77                 </span><span style="color:navy">mov     cx, </span><span style="color:green">14
</span><span style="color:maroon">DOSCODE:BC7A
DOSCODE:BC7A </span>iset3<span style="color:navy">:                                  </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BC7A                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BC7B                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:BC7E                 </span><span style="color:navy">loop    </span>iset3
<span style="color:maroon">DOSCODE:BC80                 </span><span style="color:navy">mov     </span>word ptr ds:0BCh<span style="color:navy">, offset </span>INT2F
<span style="color:maroon">DOSCODE:BC86                 </span><span style="color:navy">mov     ax, ss:</span>TEMP_DOSLOC
<span style="color:maroon">DOSCODE:BC8A                 </span><span style="color:navy">mov     </span>word ptr ds:0BEh<span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:BC8D                 </span><span style="color:navy">mov     </span>byte ptr ds:0C0h<span style="color:navy">, </span><span style="color:green">0EAh
</span><span style="color:maroon">DOSCODE:BC92                 </span><span style="color:navy">mov     </span>word ptr ds:0C1h<span style="color:navy">, offset </span>call_entry
<span style="color:maroon">DOSCODE:BC98                 </span><span style="color:navy">mov     </span>word ptr ds:80h<span style="color:navy">, offset </span>quit
<span style="color:maroon">DOSCODE:BC9E                 </span><span style="color:navy">mov     </span>word ptr ds:84h<span style="color:navy">, offset </span>command
<span style="color:maroon">DOSCODE:BCA4                 </span><span style="color:navy">mov     </span>word ptr ds:88h<span style="color:navy">, </span><span style="color:green">100h
</span><span style="color:maroon">DOSCODE:BCAA                 </span><span style="color:navy">mov     </span>word ptr ds:8Ah<span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:BCAE                 </span><span style="color:navy">mov     </span>word ptr ds:94h<span style="color:navy">, offset </span>ABSDRD
<span style="color:maroon">DOSCODE:BCB4                 </span><span style="color:navy">mov     </span>word ptr ds:98h<span style="color:navy">, offset </span>ABSDWRT
<span style="color:maroon">DOSCODE:BCBA                 </span><span style="color:navy">mov     </span>word ptr ds:9Ch<span style="color:navy">, offset </span>stay_resident
<span style="color:maroon">DOSCODE:BCC0                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:BCC1                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BCC2                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:BCC3                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:BCC4                 </span><span style="color:navy">push    dx
</span><span style="color:maroon">DOSCODE:BCC5                 </span><span style="color:navy">inc     dx
</span><span style="color:maroon">DOSCODE:BCC6                 </span><span style="color:navy">mov     </span>CurrentPDB<span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:BCCA                 </span><span style="color:navy">xor     di, di
</span><span style="color:maroon">DOSCODE:BCCC                 </span><span style="color:navy">mov     es, dx
</span><span style="color:maroon">DOSCODE:BCCE                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:BCD0                 </span><span style="color:navy">mov     cx, </span><span style="color:green">128
</span><span style="color:maroon">DOSCODE:BCD3                 </span><span style="color:navy">rep stosw
</span><span style="color:maroon">DOSCODE:BCD5                 </span><span style="color:navy">mov     ax, </span>ENDMEM
<span style="color:maroon">DOSCODE:BCD8                 </span><span style="color:navy">call    </span>SETMEM
<span style="color:maroon">DOSCODE:BCDB                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:BCDC                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BCDD                 </span><span style="color:navy">mov     di, </span><span style="color:green">24
</span><span style="color:maroon">DOSCODE:BCE0                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:maroon">DOSCODE:BCE2                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BCE3                 </span><span style="color:navy">stosb
</span><span style="color:maroon">DOSCODE:BCE4                 </span><span style="color:navy">mov     al, </span><span style="color:green">0FFh
</span><span style="color:maroon">DOSCODE:BCE6                 </span><span style="color:navy">mov     cx, </span><span style="color:green">17
</span><span style="color:maroon">DOSCODE:BCE9                 </span><span style="color:navy">rep stosb
</span><span style="color:maroon">DOSCODE:BCEB                 </span><span style="color:navy">push    ss
</span><span style="color:maroon">DOSCODE:BCEC                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:BCED                 </span><span style="color:navy">mov     word ptr </span>SFT_ADDR<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, ds
</span><span style="color:maroon">DOSCODE:BCF1                 </span><span style="color:navy">mov     si, offset </span>SysInitTable
<span style="color:maroon">DOSCODE:BCF4                 </span><span style="color:navy">mov     word ptr es:[si+</span><span style="color:#ff8000">6</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:BCF8                 </span><span style="color:navy">mov     word ptr es:[si+</span><span style="color:#ff8000">2</span><span style="color:navy">], es
</span><span style="color:maroon">DOSCODE:BCFC                 </span><span style="color:navy">mov     word ptr es:</span>BUFFHEAD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:maroon">DOSCODE:BD01                 </span><span style="color:navy">mov     si, offset </span>BufferQueue ; HASHINITVAR
<span style="color:maroon">DOSCODE:BD04                 </span><span style="color:navy">mov     word ptr es:</span>BUFFHEAD<span style="color:navy">, si
</span><span style="color:maroon">DOSCODE:BD09                 </span><span style="color:navy">pop     dx
</span><span style="color:maroon">DOSCODE:BD0A                 </span><span style="color:navy">mov     word ptr </span>DMAADD<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:BD0E                 </span><span style="color:navy">mov     es:</span>arena_head<span style="color:navy">, dx
</span><span style="color:maroon">DOSCODE:BD13                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:maroon">DOSCODE:BD15                 </span><span style="color:navy">mov     </span>byte ptr ds:0<span style="color:navy">, &#039;</span><span style="color:green">Z&#039;
</span><span style="color:maroon">DOSCODE:BD1A                 </span><span style="color:navy">mov     </span>word ptr  ds:1<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:maroon">DOSCODE:BD20                 </span><span style="color:navy">mov     ax, ss:</span>ENDMEM
<span style="color:maroon">DOSCODE:BD24                 </span><span style="color:navy">sub     ax, dx
</span><span style="color:maroon">DOSCODE:BD26                 </span><span style="color:navy">dec     ax
</span><span style="color:maroon">DOSCODE:BD27                 </span><span style="color:navy">mov     word ptr byte_0+</span><span style="color:green">3</span><span style="color:navy">, ax
</span><span style="color:maroon">DOSCODE:BD2A                 </span><span style="color:navy">mov     di, offset </span>SFT0_SFTable
<span style="color:maroon">DOSCODE:BD2D                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">3
</span><span style="color:maroon">DOSCODE:BD30                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BD31                 </span><span style="color:navy">mov     di, offset </span>SysInitTable
<span style="color:maroon">DOSCODE:BD34                 </span><span style="color:navy">inc     dx
</span><span style="color:maroon">DOSCODE:BD35                 </span><span style="color:navy">mov     ds, dx
</span><span style="color:maroon">DOSCODE:BD37                 </span><span style="color:navy">mov     dx, offset </span>_seg_reinit
<span style="color:maroon">DOSCODE:BD3A                 </span><span style="color:navy">mov     cx, offset </span>exepatch_start
<span style="color:maroon">DOSCODE:BD3D                 </span><span style="color:navy">sub     cx, offset </span>$STARTCODE
<span style="color:maroon">DOSCODE:BD41                 </span><span style="color:navy">mov     ax, offset </span>initiret
<span style="color:maroon">DOSCODE:BD44                 </span><span style="color:navy">sub     ax, offset </span>$STARTCODE
<span style="color:maroon">DOSCODE:BD47                 </span><span style="color:navy">mov     sp, ss:</span>USER_SP
<span style="color:maroon">DOSCODE:BD4C                 </span><span style="color:navy">mov     ss, ss:</span>USER_SS
<span style="color:maroon">DOSCODE:BD51                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:BD52
DOSCODE:BD52 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BD52
DOSCODE:BD52
DOSCODE:BD52 </span>CHARINIT        proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BD52                 </span><span style="color:navy">mov     ss:</span>DEVCALL<span style="color:navy">, </span><span style="color:green">26
</span><span style="color:black">DOSCODE:BD58                 </span><span style="color:navy">mov     ss:</span>DEVCALL_REQUNIT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:BD5E                 </span><span style="color:navy">mov     ss:</span>DEVCALL_REQFUNC<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:BD64                 </span><span style="color:navy">mov     ss:</span>DEVCALL_REQSTAT<span style="color:navy">, </span><span style="color:#ff8000">0
</span><span style="color:black">DOSCODE:BD6B                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:BD6C                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:BD6D                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:BD6E                 </span><span style="color:navy">mov     bx, offset </span>DEVCALL
<span style="color:black">DOSCODE:BD71                 </span><span style="color:navy">push    ss
</span><span style="color:black">DOSCODE:BD72                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BD73                 </span><span style="color:navy">call    </span>DEVIOCALL2
<span style="color:black">DOSCODE:BD76                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:BD77                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:BD78                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BD79                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BD79 </span>CHARINIT        endp
<span style="color:black">DOSCODE:BD79
DOSCODE:BD7A
DOSCODE:BD7A </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BD7A
DOSCODE:BD7A
DOSCODE:BD7A </span>check_XMM       proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BD7A                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:BD7B                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">4300h
</span><span style="color:black">DOSCODE:BD7E                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - XMS - INSTALLATION CHECK
<span style="color:black">DOSCODE:BD7E                                         </span>; Return: AL = 80h XMS driver installed
<span style="color:black">DOSCODE:BD7E                                         </span>; AL &lt;&gt; 80h no driver
<span style="color:black">DOSCODE:BD80                 </span><span style="color:navy">cmp     al, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:BD82                 </span><span style="color:navy">jnz     short </span><span style="color:gray">cXMM_no_driver
</span><span style="color:black">DOSCODE:BD84                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:BD85                 </span><span style="color:navy">push    dx
</span><span style="color:black">DOSCODE:BD86                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:BD87                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:BD88                 </span><span style="color:navy">mov     ax, </span><span style="color:#ff8000">4310h
</span><span style="color:black">DOSCODE:BD8B                 </span><span style="color:navy">int     </span><span style="color:green">2Fh             </span>; - Multiplex - XMS - GET DRIVER ADDRESS
<span style="color:black">DOSCODE:BD8B                                         </span>; Return: ES:BX -&gt; driver entry point
<span style="color:black">DOSCODE:BD8D                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:black">DOSCODE:BD92                 </span><span style="color:navy">mov     word ptr </span>XMMcontrol<span style="color:navy">, bx
</span><span style="color:black">DOSCODE:BD96                 </span><span style="color:navy">mov     word ptr </span>XMMcontrol<span style="color:navy">+</span><span style="color:green">2</span><span style="color:navy">, es
</span><span style="color:black">DOSCODE:BD9A                 </span><span style="color:navy">clc
</span><span style="color:black">DOSCODE:BD9B                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BD9C                 </span><span style="color:navy">pop     ds
</span><span style="color:black">DOSCODE:BD9D                 </span><span style="color:navy">pop     dx
</span><span style="color:black">DOSCODE:BD9E                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:BD9F                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:BDA0                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BDA1 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:black">DOSCODE:BDA1
DOSCODE:BDA1 </span><span style="color:gray">cXMM_no_driver</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BDA1                 </span><span style="color:navy">stc
</span><span style="color:black">DOSCODE:BDA2                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:BDA3                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BDA3 </span>check_XMM       endp
<span style="color:black">DOSCODE:BDA3
DOSCODE:BDA3 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:BDA4 </span>num_entry       <span style="color:navy">db </span><span style="color:#008040">0                    </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:BDA5 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:BDA5
DOSCODE:BDA5 </span>_seg_reinit<span style="color:navy">:                            </span><span style="color:#8080ff">; ...
</span><span style="color:maroon">DOSCODE:BDA5                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:BDA6                 </span><span style="color:navy">mov     ds, cs:</span>DosDSeg
<span style="color:maroon">DOSCODE:BDAB                 </span><span style="color:navy">call    </span>patch_misc_segments
<span style="color:maroon">DOSCODE:BDAE                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:BDB1                 </span><span style="color:navy">jnz     short </span>patch_vec_seg
<span style="color:maroon">DOSCODE:BDB3                 </span><span style="color:navy">cmp     cs:</span>num_entry<span style="color:navy">, </span><span style="color:green">0
</span><span style="color:maroon">DOSCODE:BDB9                 </span><span style="color:navy">jnz     short </span>second_entry
<span style="color:maroon">DOSCODE:BDBB                 </span><span style="color:navy">mov     ax, ds
</span><span style="color:maroon">DOSCODE:BDBD                 </span><span style="color:navy">call    </span>patch_vec_segments
<span style="color:maroon">DOSCODE:BDC0                 </span><span style="color:navy">call    </span>patch_offset
<span style="color:maroon">DOSCODE:BDC3
DOSCODE:BDC3 </span>second_entry<span style="color:navy">:                           </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BDC3                 </span><span style="color:navy">mov     ax, es
</span><span style="color:maroon">DOSCODE:BDC5                 </span><span style="color:navy">mov     di, offset </span>DOSINTTABLE
<span style="color:maroon">DOSCODE:BDC8                 </span><span style="color:navy">mov     cx, </span><span style="color:green">9
</span><span style="color:maroon">DOSCODE:BDCB                 </span><span style="color:navy">push    ds
</span><span style="color:maroon">DOSCODE:BDCC                 </span><span style="color:navy">pop     es
</span><span style="color:maroon">DOSCODE:BDCD
DOSCODE:BDCD </span>dosinttabloop<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BDCD                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:BDD0                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BDD1                 </span><span style="color:navy">loop    </span>dosinttabloop
<span style="color:maroon">DOSCODE:BDD3                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0F000h
</span><span style="color:maroon">DOSCODE:BDD6                 </span><span style="color:navy">jb      short </span>sr_done
<span style="color:maroon">DOSCODE:BDD8                 </span><span style="color:navy">call    </span>check_XMM
<span style="color:maroon">DOSCODE:BDDB                 </span><span style="color:navy">jb      short </span>sr_done
<span style="color:maroon">DOSCODE:BDDD                 </span><span style="color:navy">call    </span>patch_in_nops
<span style="color:maroon">DOSCODE:BDE0                 </span><span style="color:navy">mov     </span>DosHasHMA<span style="color:navy">, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:BDE5                 </span><span style="color:navy">mov     </span>FixExePatch<span style="color:navy">, offset </span>ExePatch
<span style="color:maroon">DOSCODE:BDEB                 </span><span style="color:navy">mov     </span>ChkCopyProt<span style="color:navy">, offset </span>IsCopyProt
<span style="color:maroon">DOSCODE:BDF1                 </span><span style="color:navy">call    </span>WhatCPUType
<span style="color:maroon">DOSCODE:BDF4                 </span><span style="color:navy">cmp     al, </span><span style="color:green">1
</span><span style="color:maroon">DOSCODE:BDF6                 </span><span style="color:navy">jnz     short </span>sr_done
<span style="color:maroon">DOSCODE:BDF8                 </span><span style="color:navy">mov     </span>RationalPatchPtr<span style="color:navy">, offset </span>RationalPatch
<span style="color:maroon">DOSCODE:BDFE                 </span><span style="color:navy">jmp     short </span>sr_done
<span style="color:maroon">DOSCODE:BE00 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:BE00
DOSCODE:BE00 </span>patch_vec_seg<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BE00                 </span><span style="color:navy">mov     ax, es
</span><span style="color:maroon">DOSCODE:BE02                 </span><span style="color:navy">call    </span>patch_vec_segments
<span style="color:maroon">DOSCODE:BE05
DOSCODE:BE05 </span>sr_done<span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BE05                 </span><span style="color:navy">mov     cs:</span>num_entry<span style="color:navy">, </span><span style="color:#ff8000">1
</span><span style="color:maroon">DOSCODE:BE0B                 </span><span style="color:navy">pop     ds
</span><span style="color:maroon">DOSCODE:BE0C                 </span><span style="color:navy">retf
</span><span style="color:black">DOSCODE:BE0D
DOSCODE:BE0D </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BE0D
DOSCODE:BE0D
DOSCODE:BE0D </span>WhatCPUType     proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE0D                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:BE0E                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:BE0F                 </span><span style="color:navy">xor     bx, bx
</span><span style="color:black">DOSCODE:BE11                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:BE13                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:BE14                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:BE15                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:BE16                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:BE17                 </span><span style="color:navy">and     ax, </span><span style="color:green">0F000h
</span><span style="color:black">DOSCODE:BE1A                 </span><span style="color:navy">cmp     ax, </span><span style="color:green">0F000h
</span><span style="color:black">DOSCODE:BE1D                 </span><span style="color:navy">jz      short </span><span style="color:gray">cpu_8086
</span><span style="color:black">DOSCODE:BE1F                 </span><span style="color:navy">mov     ax, </span><span style="color:green">0F000h
</span><span style="color:black">DOSCODE:BE22                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:BE23                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:BE24                 </span><span style="color:navy">pushf
</span><span style="color:black">DOSCODE:BE25                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:BE26                 </span><span style="color:navy">and     ax, </span><span style="color:green">0F000h
</span><span style="color:black">DOSCODE:BE29                 </span><span style="color:navy">jz      short </span><span style="color:gray">cpu_286
</span><span style="color:black">DOSCODE:BE2B
DOSCODE:BE2B </span>cpu_386<span style="color:navy">:
</span><span style="color:black">DOSCODE:BE2B                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:BE2C
DOSCODE:BE2C </span><span style="color:gray">cpu_286</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE2C                 </span><span style="color:navy">inc     bx
</span><span style="color:black">DOSCODE:BE2D
DOSCODE:BE2D </span><span style="color:gray">cpu_8086</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE2D                 </span><span style="color:navy">mov     ax, bx
</span><span style="color:black">DOSCODE:BE2F                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:BE30                 </span><span style="color:navy">popf
</span><span style="color:black">DOSCODE:BE31                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BE31 </span>WhatCPUType     endp
<span style="color:black">DOSCODE:BE31
DOSCODE:BE32
DOSCODE:BE32 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BE32
DOSCODE:BE32
DOSCODE:BE32 </span>patch_vec_segments proc near            <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE32                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:BE33                 </span><span style="color:navy">xor     cx, cx
</span><span style="color:black">DOSCODE:BE35                 </span><span style="color:navy">mov     es, cx
</span><span style="color:black">DOSCODE:BE37                 </span><span style="color:navy">mov     di, </span><span style="color:green">82h         </span>; INTBASE+2
<span style="color:black">DOSCODE:BE3A                 </span><span style="color:navy">mov     </span>word ptr es:02h<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:BE3E                 </span><span style="color:navy">mov     cx, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:BE41
DOSCODE:BE41 </span><span style="color:gray">ps_set1</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE41                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BE42                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BE45                 </span><span style="color:navy">loop    </span><span style="color:gray">ps_set1
</span><span style="color:black">DOSCODE:BE47                 </span><span style="color:navy">add     di, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:BE4A                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BE4B                 </span><span style="color:navy">add     di, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:BE4E                 </span><span style="color:navy">mov     cx, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:BE51
DOSCODE:BE51 </span><span style="color:gray">ps_set2</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE51                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BE52                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BE55                 </span><span style="color:navy">loop    </span><span style="color:gray">ps_set2
</span><span style="color:black">DOSCODE:BE57                 </span><span style="color:navy">add     di, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:BE5A                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:BE5D
DOSCODE:BE5D </span><span style="color:gray">ps_set3</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE5D                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BE5E                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BE61                 </span><span style="color:navy">loop    </span><span style="color:gray">ps_set3
</span><span style="color:black">DOSCODE:BE63                 </span><span style="color:navy">add     di, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:BE66                 </span><span style="color:navy">mov     cx, </span><span style="color:green">14
</span><span style="color:black">DOSCODE:BE69
DOSCODE:BE69 </span><span style="color:gray">ps_set4</span><span style="color:navy">:                                </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE69                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BE6A                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:BE6D                 </span><span style="color:navy">loop    </span><span style="color:gray">ps_set4
</span><span style="color:black">DOSCODE:BE6F                 </span><span style="color:navy">mov     </span>word ptr es:0C3h<span style="color:navy">, ax
</span><span style="color:black">DOSCODE:BE73                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BE74                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BE74 </span>patch_vec_segments endp
<span style="color:black">DOSCODE:BE74
DOSCODE:BE75
DOSCODE:BE75 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BE75
DOSCODE:BE75
DOSCODE:BE75 </span>patch_misc_segments proc near           <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE75                 </span><span style="color:navy">push    bx
</span><span style="color:black">DOSCODE:BE76                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:BE77                 </span><span style="color:navy">push    ax
</span><span style="color:black">DOSCODE:BE78                 </span><span style="color:navy">mov     ax, es
</span><span style="color:black">DOSCODE:BE7A                 </span><span style="color:navy">push    ds
</span><span style="color:black">DOSCODE:BE7B                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BE7C                 </span><span style="color:navy">mov     di, offset </span>JShare
<span style="color:black">DOSCODE:BE7F                 </span><span style="color:navy">mov     bx, </span>TEMP_DOSLOC
<span style="color:black">DOSCODE:BE83                 </span><span style="color:navy">mov     cx, </span><span style="color:green">15
</span><span style="color:black">DOSCODE:BE86
DOSCODE:BE86 </span><span style="color:gray">jumptabloop</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE86                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BE89                 </span><span style="color:navy">cmp     bx, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:BE8C                 </span><span style="color:navy">jz      short </span><span style="color:gray">share_patch
</span><span style="color:black">DOSCODE:BE8E                 </span><span style="color:navy">cmp     bx, es:[di]
</span><span style="color:black">DOSCODE:BE91                 </span><span style="color:navy">jnz     short </span><span style="color:gray">no_share_patch
</span><span style="color:black">DOSCODE:BE93
DOSCODE:BE93 </span><span style="color:gray">share_patch</span><span style="color:navy">:                            </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE93                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BE94
DOSCODE:BE94 </span><span style="color:gray">no_share_patch</span><span style="color:navy">:                         </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BE94                 </span><span style="color:navy">loop    </span><span style="color:gray">jumptabloop
</span><span style="color:black">DOSCODE:BE96                 </span><span style="color:navy">mov     si, offset </span>COUNTRY_CDPG
<span style="color:black">DOSCODE:BE99                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">4Fh</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:BE9C                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">54h</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:BE9F                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">59h</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:BEA2                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">5Eh</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:BEA5                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">80h</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:BEA9                 </span><span style="color:navy">mov     word ptr [si+</span><span style="color:#ff8000">63h</span><span style="color:navy">], ds
</span><span style="color:black">DOSCODE:BEAC                 </span><span style="color:navy">mov     si, offset </span>FastOpenTable
<span style="color:black">DOSCODE:BEAF                 </span><span style="color:navy">cmp     </span>TEMP_DOSLOC<span style="color:navy">, </span><span style="color:green">0FFFFh
</span><span style="color:black">DOSCODE:BEB4                 </span><span style="color:navy">jz      short </span><span style="color:gray">fast_patch
</span><span style="color:black">DOSCODE:BEB6                 </span><span style="color:navy">mov     cx, </span>TEMP_DOSLOC
<span style="color:black">DOSCODE:BEBA                 </span><span style="color:navy">cmp     cx, [si+</span><span style="color:#ff8000">4</span><span style="color:navy">]
</span><span style="color:black">DOSCODE:BEBD                 </span><span style="color:navy">jnz     short </span><span style="color:gray">no_fast_patch
</span><span style="color:black">DOSCODE:BEBF
DOSCODE:BEBF </span><span style="color:gray">fast_patch</span><span style="color:navy">:                             </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BEBF                 </span><span style="color:navy">mov     [si+</span><span style="color:#ff8000">4</span><span style="color:navy">], ax
</span><span style="color:black">DOSCODE:BEC2
DOSCODE:BEC2 </span><span style="color:gray">no_fast_patch</span><span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BEC2                 </span><span style="color:navy">pop     ax
</span><span style="color:black">DOSCODE:BEC3                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BEC4                 </span><span style="color:navy">pop     bx
</span><span style="color:black">DOSCODE:BEC5                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BEC5 </span>patch_misc_segments endp
<span style="color:black">DOSCODE:BEC5
DOSCODE:BEC6
DOSCODE:BEC6 </span><span style="color:gray">; =============== S U B R O U T I N E =======================================
</span><span style="color:black">DOSCODE:BEC6
DOSCODE:BEC6
DOSCODE:BEC6 </span>patch_offset    proc near               <span style="color:green">; ...
</span><span style="color:black">DOSCODE:BEC6                 </span><span style="color:navy">push    es
</span><span style="color:black">DOSCODE:BEC7                 </span><span style="color:navy">xor     ax, ax
</span><span style="color:black">DOSCODE:BEC9                 </span><span style="color:navy">mov     es, ax
</span><span style="color:black">DOSCODE:BECB                 </span><span style="color:navy">mov     </span>word ptr es:0<span style="color:navy">, offset </span>ldivov
<span style="color:black">DOSCODE:BED2                 </span><span style="color:navy">mov     di, </span><span style="color:green">80h
</span><span style="color:black">DOSCODE:BED5                 </span><span style="color:navy">mov     ax, offset </span>lirett
<span style="color:black">DOSCODE:BED8                 </span><span style="color:navy">mov     cx, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BEDB
DOSCODE:BEDB </span><span style="color:gray">po_iset1</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BEDB                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BEDC                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BEDF                 </span><span style="color:navy">loop    </span><span style="color:gray">po_iset1
</span><span style="color:black">DOSCODE:BEE1                 </span><span style="color:navy">add     di, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:BEE4                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BEE5                 </span><span style="color:navy">add     di, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:BEE8                 </span><span style="color:navy">mov     cx, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:BEEB
DOSCODE:BEEB </span><span style="color:gray">po_iset2</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BEEB                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BEEC                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BEEF                 </span><span style="color:navy">loop    </span><span style="color:gray">po_iset2
</span><span style="color:black">DOSCODE:BEF1                 </span><span style="color:navy">add     di, </span><span style="color:green">4
</span><span style="color:black">DOSCODE:BEF4                 </span><span style="color:navy">mov     cx, </span><span style="color:green">6
</span><span style="color:black">DOSCODE:BEF7
DOSCODE:BEF7 </span><span style="color:gray">po_iset3</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BEF7                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BEF8                 </span><span style="color:navy">add     di, </span><span style="color:green">2
</span><span style="color:black">DOSCODE:BEFB                 </span><span style="color:navy">loop    </span><span style="color:gray">po_iset3
</span><span style="color:black">DOSCODE:BEFD                 </span><span style="color:navy">add     di, </span><span style="color:green">8
</span><span style="color:black">DOSCODE:BF00                 </span><span style="color:navy">mov     cx, </span><span style="color:green">14
</span><span style="color:black">DOSCODE:BF03
DOSCODE:BF03 </span><span style="color:gray">po_iset4</span><span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:black">DOSCODE:BF03                 </span><span style="color:navy">stosw
</span><span style="color:black">DOSCODE:BF04                 </span><span style="color:navy">add     di, </span><span style="color:#ff8000">2
</span><span style="color:black">DOSCODE:BF07                 </span><span style="color:navy">loop    </span><span style="color:gray">po_iset4
</span><span style="color:black">DOSCODE:BF09                 </span><span style="color:navy">mov     </span>word ptr es:0BCh<span style="color:navy">, offset </span>lint2f
<span style="color:black">DOSCODE:BF10                 </span><span style="color:navy">mov     </span>byte ptr es:0C0h<span style="color:navy">, </span><span style="color:green">0EAh
</span><span style="color:black">DOSCODE:BF16                 </span><span style="color:navy">mov     </span>word ptr es:0C1h<span style="color:navy">, offset </span>lcall_entry
<span style="color:black">DOSCODE:BF1D                 </span><span style="color:navy">mov     </span>word ptr es:80h<span style="color:navy">, offset </span>lquit
<span style="color:black">DOSCODE:BF24                 </span><span style="color:navy">mov     </span>word ptr es:84h<span style="color:navy">, offset </span>lcommand
<span style="color:black">DOSCODE:BF2B                 </span><span style="color:navy">mov     </span>word ptr es:94h<span style="color:navy">, offset </span>labsdrd
<span style="color:black">DOSCODE:BF32                 </span><span style="color:navy">mov     </span>word ptr es:98h<span style="color:navy">, offset </span>labsdwrt
<span style="color:black">DOSCODE:BF39                 </span><span style="color:navy">mov     </span>word ptr es:9Ch<span style="color:navy">, offset </span>lstay_resident
<span style="color:black">DOSCODE:BF40                 </span><span style="color:navy">pop     es
</span><span style="color:black">DOSCODE:BF41                 </span><span style="color:navy">retn
</span><span style="color:black">DOSCODE:BF41 </span>patch_offset    endp
<span style="color:black">DOSCODE:BF41
DOSCODE:BF41 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:BF42 </span>patch_table     <span style="color:navy">dw offset </span>ldivov        <span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:BF44                 </span><span style="color:navy">dw offset </span>lquit
<span style="color:gray">DOSCODE:BF46                 </span><span style="color:navy">dw offset </span>lcommand
<span style="color:gray">DOSCODE:BF48                 </span><span style="color:navy">dw offset </span>labsdrd
<span style="color:gray">DOSCODE:BF4A                 </span><span style="color:navy">dw offset </span>labsdwrt
<span style="color:gray">DOSCODE:BF4C                 </span><span style="color:navy">dw offset </span>lstay_resident
<span style="color:gray">DOSCODE:BF4E                 </span><span style="color:navy">dw offset </span>lint2f
<span style="color:gray">DOSCODE:BF50                 </span><span style="color:navy">dw offset </span>lcall_entry
<span style="color:maroon">DOSCODE:BF52 </span><span style="color:gray">; ---------------------------------------------------------------------------
</span><span style="color:maroon">DOSCODE:BF52
DOSCODE:BF52 </span>patch_in_nops<span style="color:navy">:                          </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BF52                 </span><span style="color:navy">push    ax
</span><span style="color:maroon">DOSCODE:BF53                 </span><span style="color:navy">push    si
</span><span style="color:maroon">DOSCODE:BF54                 </span><span style="color:navy">mov     si, offset </span>patch_table
<span style="color:maroon">DOSCODE:BF57                 </span><span style="color:navy">mov     ax, </span><span style="color:green">9090h
</span><span style="color:maroon">DOSCODE:BF5A                 </span><span style="color:navy">mov     cx, </span><span style="color:green">8
</span><span style="color:maroon">DOSCODE:BF5D
DOSCODE:BF5D </span>pin_loop<span style="color:navy">:                               </span><span style="color:green">; ...
</span><span style="color:maroon">DOSCODE:BF5D                 </span><span style="color:navy">mov     di, cs:[si]
</span><span style="color:maroon">DOSCODE:BF60                 </span><span style="color:navy">stosw
</span><span style="color:maroon">DOSCODE:BF61                 </span><span style="color:navy">add     si, </span><span style="color:green">2
</span><span style="color:maroon">DOSCODE:BF64                 </span><span style="color:navy">loop    </span>pin_loop
<span style="color:maroon">DOSCODE:BF66                 </span><span style="color:navy">pop     si
</span><span style="color:maroon">DOSCODE:BF67                 </span><span style="color:navy">pop     ax
</span><span style="color:maroon">DOSCODE:BF68                 </span><span style="color:navy">retn
</span><span style="color:maroon">DOSCODE:BF68 </span><span style="color:gray">; ---------------------------------------------------------------------------
DOSCODE:BF69 </span>MEMSTRT         <span style="color:navy">db </span><span style="color:#008040">7 </span><span style="color:navy">dup(</span><span style="color:#008040">0</span><span style="color:navy">)             </span><span style="color:#8080ff">; ...
</span><span style="color:gray">DOSCODE:BF69 </span>DOSCODE         ends
<span style="color:gray">DOSCODE:BF69
DOSCODE:BF69
DOSCODE:BF69                 </span>end
</span></body></html>
